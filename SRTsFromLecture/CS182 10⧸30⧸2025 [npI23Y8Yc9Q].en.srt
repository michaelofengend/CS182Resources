1
00:01:21,220 --> 00:01:22,870

[clears throat] Okay,

2
00:01:22,870 --> 00:01:22,880
[clears throat] Okay,
 

3
00:01:22,880 --> 00:01:26,230
[clears throat] Okay,
>> Berkeley time. Let's get started.

4
00:01:26,230 --> 00:01:26,240
>> Berkeley time. Let's get started.
 

5
00:01:26,240 --> 00:01:27,910
>> Berkeley time. Let's get started.
So, we're going to continue talking

6
00:01:27,910 --> 00:01:27,920
So, we're going to continue talking
 

7
00:01:27,920 --> 00:01:30,390
So, we're going to continue talking
about attention today and then talk

8
00:01:30,390 --> 00:01:30,400
about attention today and then talk
 

9
00:01:30,400 --> 00:01:32,550
about attention today and then talk
about transformer architectures and

10
00:01:32,550 --> 00:01:32,560
about transformer architectures and
 

11
00:01:32,560 --> 00:01:34,630
about transformer architectures and
finally conclude with talking about

12
00:01:34,630 --> 00:01:34,640
finally conclude with talking about
 

13
00:01:34,640 --> 00:01:36,789
finally conclude with talking about
positional encoding which is a a big

14
00:01:36,789 --> 00:01:36,799
positional encoding which is a a big
 

15
00:01:36,799 --> 00:01:38,950
positional encoding which is a a big
part of these transformer architectures.

16
00:01:38,950 --> 00:01:38,960
part of these transformer architectures.
 

17
00:01:38,960 --> 00:01:41,350
part of these transformer architectures.
So just to recap where we were last

18
00:01:41,350 --> 00:01:41,360
So just to recap where we were last
 

19
00:01:41,360 --> 00:01:43,749
So just to recap where we were last
time, we started out with talking about

20
00:01:43,749 --> 00:01:43,759
time, we started out with talking about
 

21
00:01:43,759 --> 00:01:45,830
time, we started out with talking about
these sequencetose sequence problems

22
00:01:45,830 --> 00:01:45,840
these sequencetose sequence problems
 

23
00:01:45,840 --> 00:01:49,590
these sequencetose sequence problems
particularly in the context of RNN's and

24
00:01:49,590 --> 00:01:49,600
particularly in the context of RNN's and
 

25
00:01:49,600 --> 00:01:53,030
particularly in the context of RNN's and
we talked about a um

26
00:01:53,030 --> 00:01:53,040
we talked about a um
 

27
00:01:53,040 --> 00:01:57,749
we talked about a um
setup like this where I have a series of

28
00:01:57,749 --> 00:01:57,759
setup like this where I have a series of
 

29
00:01:57,759 --> 00:02:00,870
setup like this where I have a series of
uh RNN blocks here. This is unrolled in

30
00:02:00,870 --> 00:02:00,880
uh RNN blocks here. This is unrolled in
 

31
00:02:00,880 --> 00:02:02,630
uh RNN blocks here. This is unrolled in
time. Again I think I should just

32
00:02:02,630 --> 00:02:02,640
time. Again I think I should just
 

33
00:02:02,640 --> 00:02:04,870
time. Again I think I should just
highlight this.

34
00:02:04,870 --> 00:02:04,880
highlight this.
 

35
00:02:04,880 --> 00:02:08,790
highlight this.
This is the time axis X- axis. This is

36
00:02:08,790 --> 00:02:08,800
This is the time axis X- axis. This is
 

37
00:02:08,800 --> 00:02:14,710
This is the time axis X- axis. This is
the layer axis.

38
00:02:14,710 --> 00:02:14,720

 

39
00:02:14,720 --> 00:02:16,309

Okay. So [snorts] here we're showing

40
00:02:16,309 --> 00:02:16,319
Okay. So [snorts] here we're showing
 

41
00:02:16,319 --> 00:02:19,030
Okay. So [snorts] here we're showing
this unrolled in time

42
00:02:19,030 --> 00:02:19,040
this unrolled in time
 

43
00:02:19,040 --> 00:02:21,990
this unrolled in time
and our motivation was to realize that

44
00:02:21,990 --> 00:02:22,000
and our motivation was to realize that
 

45
00:02:22,000 --> 00:02:23,910
and our motivation was to realize that
in this kind of encoder decoder

46
00:02:23,910 --> 00:02:23,920
in this kind of encoder decoder
 

47
00:02:23,920 --> 00:02:26,150
in this kind of encoder decoder
architecture there's this bottleneck and

48
00:02:26,150 --> 00:02:26,160
architecture there's this bottleneck and
 

49
00:02:26,160 --> 00:02:27,670
architecture there's this bottleneck and
we had to pass all this information

50
00:02:27,670 --> 00:02:27,680
we had to pass all this information
 

51
00:02:27,680 --> 00:02:30,390
we had to pass all this information
through this one state and that was a

52
00:02:30,390 --> 00:02:30,400
through this one state and that was a
 

53
00:02:30,400 --> 00:02:33,270
through this one state and that was a
problem right because that made if you

54
00:02:33,270 --> 00:02:33,280
problem right because that made if you
 

55
00:02:33,280 --> 00:02:34,630
problem right because that made if you
wanted to pass a lot of information that

56
00:02:34,630 --> 00:02:34,640
wanted to pass a lot of information that
 

57
00:02:34,640 --> 00:02:36,390
wanted to pass a lot of information that
would make the state very big making the

58
00:02:36,390 --> 00:02:36,400
would make the state very big making the
 

59
00:02:36,400 --> 00:02:37,830
would make the state very big making the
state very big makes things difficult to

60
00:02:37,830 --> 00:02:37,840
state very big makes things difficult to
 

61
00:02:37,840 --> 00:02:40,229
state very big makes things difficult to
trade we don't like that so we wanted to

62
00:02:40,229 --> 00:02:40,239
trade we don't like that so we wanted to
 

63
00:02:40,239 --> 00:02:42,949
trade we don't like that so we wanted to
have a better mechanism by which we can

64
00:02:42,949 --> 00:02:42,959
have a better mechanism by which we can
 

65
00:02:42,959 --> 00:02:46,949
have a better mechanism by which we can
think about um you know information in

66
00:02:46,949 --> 00:02:46,959
think about um you know information in
 

67
00:02:46,959 --> 00:02:48,790
think about um you know information in
terms of time. Okay. And we wanted to be

68
00:02:48,790 --> 00:02:48,800
terms of time. Okay. And we wanted to be
 

69
00:02:48,800 --> 00:02:51,350
terms of time. Okay. And we wanted to be
able to pass that forward. So just as a

70
00:02:51,350 --> 00:02:51,360
able to pass that forward. So just as a
 

71
00:02:51,360 --> 00:02:54,470
able to pass that forward. So just as a
reminder these things um there was a

72
00:02:54,470 --> 00:02:54,480
reminder these things um there was a
 

73
00:02:54,480 --> 00:02:56,390
reminder these things um there was a
point here. So these are things when I'm

74
00:02:56,390 --> 00:02:56,400
point here. So these are things when I'm
 

75
00:02:56,400 --> 00:02:57,509
point here. So these are things when I'm
feeding when I'm doing this auto

76
00:02:57,509 --> 00:02:57,519
feeding when I'm doing this auto
 

77
00:02:57,519 --> 00:02:59,830
feeding when I'm doing this auto
reggressive generation I'm sampling. So

78
00:02:59,830 --> 00:02:59,840
reggressive generation I'm sampling. So
 

79
00:02:59,840 --> 00:03:02,149
reggressive generation I'm sampling. So
uh I forgot to talk about that carefully

80
00:03:02,149 --> 00:03:02,159
uh I forgot to talk about that carefully
 

81
00:03:02,159 --> 00:03:04,390
uh I forgot to talk about that carefully
last time but [snorts]

82
00:03:04,390 --> 00:03:04,400
last time but [snorts]
 

83
00:03:04,400 --> 00:03:06,550
last time but [snorts]
thank for so thank you for the question.

84
00:03:06,550 --> 00:03:06,560
thank for so thank you for the question.
 

85
00:03:06,560 --> 00:03:07,990
thank for so thank you for the question.
But basically we're generating

86
00:03:07,990 --> 00:03:08,000
But basically we're generating
 

87
00:03:08,000 --> 00:03:09,589
But basically we're generating
probabilities and then we're sampling

88
00:03:09,589 --> 00:03:09,599
probabilities and then we're sampling
 

89
00:03:09,599 --> 00:03:12,390
probabilities and then we're sampling
from that to be able to get um the input

90
00:03:12,390 --> 00:03:12,400
from that to be able to get um the input
 

91
00:03:12,400 --> 00:03:15,910
from that to be able to get um the input
to the next u next time step. Also we're

92
00:03:15,910 --> 00:03:15,920
to the next u next time step. Also we're
 

93
00:03:15,920 --> 00:03:17,589
to the next u next time step. Also we're
training this basically all with a cross

94
00:03:17,589 --> 00:03:17,599
training this basically all with a cross
 

95
00:03:17,599 --> 00:03:19,270
training this basically all with a cross
entropy loss. Right? So we're training

96
00:03:19,270 --> 00:03:19,280
entropy loss. Right? So we're training
 

97
00:03:19,280 --> 00:03:21,750
entropy loss. Right? So we're training
on the uh output probabilities of this

98
00:03:21,750 --> 00:03:21,760
on the uh output probabilities of this
 

99
00:03:21,760 --> 00:03:23,670
on the uh output probabilities of this
and we talked about this teacher forcing

100
00:03:23,670 --> 00:03:23,680
and we talked about this teacher forcing
 

101
00:03:23,680 --> 00:03:26,390
and we talked about this teacher forcing
idea for uh for training these things.

102
00:03:26,390 --> 00:03:26,400
idea for uh for training these things.
 

103
00:03:26,400 --> 00:03:28,550
idea for uh for training these things.
Okay.

104
00:03:28,550 --> 00:03:28,560
Okay.
 

105
00:03:28,560 --> 00:03:31,589
Okay.
All of this basically led us to be able

106
00:03:31,589 --> 00:03:31,599
All of this basically led us to be able
 

107
00:03:31,599 --> 00:03:35,190
All of this basically led us to be able
to think about this idea of attention.

108
00:03:35,190 --> 00:03:35,200
to think about this idea of attention.
 

109
00:03:35,200 --> 00:03:37,190
to think about this idea of attention.
And we talked first about this idea of

110
00:03:37,190 --> 00:03:37,200
And we talked first about this idea of
 

111
00:03:37,200 --> 00:03:38,869
And we talked first about this idea of
cross attention, right? So we want to

112
00:03:38,869 --> 00:03:38,879
cross attention, right? So we want to
 

113
00:03:38,879 --> 00:03:41,509
cross attention, right? So we want to
have

114
00:03:41,509 --> 00:03:41,519
have
 

115
00:03:41,519 --> 00:03:44,470
have
keys and values basically that are

116
00:03:44,470 --> 00:03:44,480
keys and values basically that are
 

117
00:03:44,480 --> 00:03:46,390
keys and values basically that are
containing information about whatever

118
00:03:46,390 --> 00:03:46,400
containing information about whatever
 

119
00:03:46,400 --> 00:03:48,630
containing information about whatever
our context is. And then we have a query

120
00:03:48,630 --> 00:03:48,640
our context is. And then we have a query
 

121
00:03:48,640 --> 00:03:50,630
our context is. And then we have a query
coming in and we want to be able to

122
00:03:50,630 --> 00:03:50,640
coming in and we want to be able to
 

123
00:03:50,640 --> 00:03:53,430
coming in and we want to be able to
understand well which of the keys and

124
00:03:53,430 --> 00:03:53,440
understand well which of the keys and
 

125
00:03:53,440 --> 00:03:55,030
understand well which of the keys and
their associated values are the ones

126
00:03:55,030 --> 00:03:55,040
their associated values are the ones
 

127
00:03:55,040 --> 00:03:57,670
their associated values are the ones
that are relevant to us. And for this we

128
00:03:57,670 --> 00:03:57,680
that are relevant to us. And for this we
 

129
00:03:57,680 --> 00:04:00,630
that are relevant to us. And for this we
wanted to have some kind of similarity

130
00:04:00,630 --> 00:04:00,640
wanted to have some kind of similarity
 

131
00:04:00,640 --> 00:04:04,789
wanted to have some kind of similarity
score between the query and the key. so

132
00:04:04,789 --> 00:04:04,799
score between the query and the key. so
 

133
00:04:04,799 --> 00:04:06,869
score between the query and the key. so
that we can understand where we should

134
00:04:06,869 --> 00:04:06,879
that we can understand where we should
 

135
00:04:06,879 --> 00:04:09,190
that we can understand where we should
pay attention to. Okay, everyone

136
00:04:09,190 --> 00:04:09,200
pay attention to. Okay, everyone
 

137
00:04:09,200 --> 00:04:11,589
pay attention to. Okay, everyone
remember this kind of setup that we

138
00:04:11,589 --> 00:04:11,599
remember this kind of setup that we
 

139
00:04:11,599 --> 00:04:13,830
remember this kind of setup that we
talked about.

140
00:04:13,830 --> 00:04:13,840
talked about.
 

141
00:04:13,840 --> 00:04:17,270
talked about.
Okay, any questions about this? Cuz I I

142
00:04:17,270 --> 00:04:17,280
Okay, any questions about this? Cuz I I
 

143
00:04:17,280 --> 00:04:18,469
Okay, any questions about this? Cuz I I
went a little bit fast at the end

144
00:04:18,469 --> 00:04:18,479
went a little bit fast at the end
 

145
00:04:18,479 --> 00:04:19,590
went a little bit fast at the end
because I was running out of time. So,

146
00:04:19,590 --> 00:04:19,600
because I was running out of time. So,
 

147
00:04:19,600 --> 00:04:21,189
because I was running out of time. So,
I'm going to go do a little bit of that

148
00:04:21,189 --> 00:04:21,199
I'm going to go do a little bit of that
 

149
00:04:21,199 --> 00:04:23,189
I'm going to go do a little bit of that
a little bit slowly in [snorts] a few

150
00:04:23,189 --> 00:04:23,199
a little bit slowly in [snorts] a few
 

151
00:04:23,199 --> 00:04:25,510
a little bit slowly in [snorts] a few
minutes here. But any questions? Yes. to

152
00:04:25,510 --> 00:04:25,520
minutes here. But any questions? Yes. to
 

153
00:04:25,520 --> 00:04:29,350
minutes here. But any questions? Yes. to
calculate you. Are you uh feeding input

154
00:04:29,350 --> 00:04:29,360
calculate you. Are you uh feeding input
 

155
00:04:29,360 --> 00:04:33,590
calculate you. Are you uh feeding input
or are you feeding the input for the

156
00:04:33,590 --> 00:04:33,600
or are you feeding the input for the
 

157
00:04:33,600 --> 00:04:36,629
or are you feeding the input for the
different from the input for the encoder

158
00:04:36,629 --> 00:04:36,639
different from the input for the encoder
 

159
00:04:36,639 --> 00:04:39,670
different from the input for the encoder
>> to calculate the query? Am I I'm I'm

160
00:04:39,670 --> 00:04:39,680
>> to calculate the query? Am I I'm I'm
 

161
00:04:39,680 --> 00:04:41,430
>> to calculate the query? Am I I'm I'm
feeding the input, but I will I will

162
00:04:41,430 --> 00:04:41,440
feeding the input, but I will I will
 

163
00:04:41,440 --> 00:04:43,350
feeding the input, but I will I will
first my first layer in a transformer

164
00:04:43,350 --> 00:04:43,360
first my first layer in a transformer
 

165
00:04:43,360 --> 00:04:44,790
first my first layer in a transformer
will actually be an embedding layer. And

166
00:04:44,790 --> 00:04:44,800
will actually be an embedding layer. And
 

167
00:04:44,800 --> 00:04:48,070
will actually be an embedding layer. And
so we'll come to that. Um but I'm so I'm

168
00:04:48,070 --> 00:04:48,080
so we'll come to that. Um but I'm so I'm
 

169
00:04:48,080 --> 00:04:50,550
so we'll come to that. Um but I'm so I'm
I'm taking my my input which will be

170
00:04:50,550 --> 00:04:50,560
I'm taking my my input which will be
 

171
00:04:50,560 --> 00:04:52,070
I'm taking my my input which will be
we'll talk about this it'll be one hot

172
00:04:52,070 --> 00:04:52,080
we'll talk about this it'll be one hot
 

173
00:04:52,080 --> 00:04:54,310
we'll talk about this it'll be one hot
encoded then I'll move it into the

174
00:04:54,310 --> 00:04:54,320
encoded then I'll move it into the
 

175
00:04:54,320 --> 00:04:55,749
encoded then I'll move it into the
embedding dimension and that was what

176
00:04:55,749 --> 00:04:55,759
embedding dimension and that was what
 

177
00:04:55,759 --> 00:05:01,430
embedding dimension and that was what
will go into my um query computation.

178
00:05:01,430 --> 00:05:01,440
will go into my um query computation.
 

179
00:05:01,440 --> 00:05:01,990
will go into my um query computation.
>> Yes.

180
00:05:01,990 --> 00:05:02,000
>> Yes.
 

181
00:05:02,000 --> 00:05:05,430
>> Yes.
>> And the W's are the weight matrices for

182
00:05:05,430 --> 00:05:05,440
>> And the W's are the weight matrices for
 

183
00:05:05,440 --> 00:05:06,710
>> And the W's are the weight matrices for
key query and

184
00:05:06,710 --> 00:05:06,720
key query and
 

185
00:05:06,720 --> 00:05:09,749
key query and
>> W K WQ and WV are the weight matrices.

186
00:05:09,749 --> 00:05:09,759
>> W K WQ and WV are the weight matrices.
 

187
00:05:09,759 --> 00:05:11,990
>> W K WQ and WV are the weight matrices.
These are learned. Remember, we want to

188
00:05:11,990 --> 00:05:12,000
These are learned. Remember, we want to
 

189
00:05:12,000 --> 00:05:14,629
These are learned. Remember, we want to
be able to have when we talked about our

190
00:05:14,629 --> 00:05:14,639
be able to have when we talked about our
 

191
00:05:14,639 --> 00:05:16,629
be able to have when we talked about our
attention mechanism, we talked about

192
00:05:16,629 --> 00:05:16,639
attention mechanism, we talked about
 

193
00:05:16,639 --> 00:05:17,990
attention mechanism, we talked about
well, we want to be able to basically

194
00:05:17,990 --> 00:05:18,000
well, we want to be able to basically
 

195
00:05:18,000 --> 00:05:20,550
well, we want to be able to basically
somehow identify which values are

196
00:05:20,550 --> 00:05:20,560
somehow identify which values are
 

197
00:05:20,560 --> 00:05:23,110
somehow identify which values are
relevant to us. And we want to be able

198
00:05:23,110 --> 00:05:23,120
relevant to us. And we want to be able
 

199
00:05:23,120 --> 00:05:25,909
relevant to us. And we want to be able
to say we want to have nicely gradients

200
00:05:25,909 --> 00:05:25,919
to say we want to have nicely gradients
 

201
00:05:25,919 --> 00:05:27,110
to say we want to have nicely gradients
passed through this so that we can

202
00:05:27,110 --> 00:05:27,120
passed through this so that we can
 

203
00:05:27,120 --> 00:05:28,950
passed through this so that we can
actually learn these things. But we

204
00:05:28,950 --> 00:05:28,960
actually learn these things. But we
 

205
00:05:28,960 --> 00:05:30,870
actually learn these things. But we
never really talked about how to get the

206
00:05:30,870 --> 00:05:30,880
never really talked about how to get the
 

207
00:05:30,880 --> 00:05:33,189
never really talked about how to get the
Q and the K and the V, right? We just

208
00:05:33,189 --> 00:05:33,199
Q and the K and the V, right? We just
 

209
00:05:33,199 --> 00:05:34,629
Q and the K and the V, right? We just
assume that we had these and then what

210
00:05:34,629 --> 00:05:34,639
assume that we had these and then what
 

211
00:05:34,639 --> 00:05:36,710
assume that we had these and then what
do we do with that? So, we want to be

212
00:05:36,710 --> 00:05:36,720
do we do with that? So, we want to be
 

213
00:05:36,720 --> 00:05:38,390
do we do with that? So, we want to be
able to learn these queries, QES, and

214
00:05:38,390 --> 00:05:38,400
able to learn these queries, QES, and
 

215
00:05:38,400 --> 00:05:39,749
able to learn these queries, QES, and
values. And to be able to learn them, we

216
00:05:39,749 --> 00:05:39,759
values. And to be able to learn them, we
 

217
00:05:39,759 --> 00:05:42,469
values. And to be able to learn them, we
learn them basically as these linear

218
00:05:42,469 --> 00:05:42,479
learn them basically as these linear
 

219
00:05:42,479 --> 00:05:45,178
learn them basically as these linear
transformations of the inputs.

220
00:05:45,178 --> 00:05:45,188
transformations of the inputs.
 

221
00:05:45,188 --> 00:05:45,830
transformations of the inputs.
[snorts]

222
00:05:45,830 --> 00:05:45,840
[snorts]
 

223
00:05:45,840 --> 00:05:48,230
[snorts]
Okay,

224
00:05:48,230 --> 00:05:48,240
Okay,
 

225
00:05:48,240 --> 00:05:51,590
Okay,
good.

226
00:05:51,590 --> 00:05:51,600

 

227
00:05:51,600 --> 00:05:55,430

So to be precise, how we calculate this

228
00:05:55,430 --> 00:05:55,440
So to be precise, how we calculate this
 

229
00:05:55,440 --> 00:05:58,870
So to be precise, how we calculate this
is let's say I have my query vector

230
00:05:58,870 --> 00:05:58,880
is let's say I have my query vector
 

231
00:05:58,880 --> 00:06:00,710
is let's say I have my query vector
which is some bias term which I hadn't

232
00:06:00,710 --> 00:06:00,720
which is some bias term which I hadn't
 

233
00:06:00,720 --> 00:06:02,150
which is some bias term which I hadn't
really talked about but there's often a

234
00:06:02,150 --> 00:06:02,160
really talked about but there's often a
 

235
00:06:02,160 --> 00:06:05,029
really talked about but there's often a
bias term here that is also learned uh

236
00:06:05,029 --> 00:06:05,039
bias term here that is also learned uh
 

237
00:06:05,039 --> 00:06:08,230
bias term here that is also learned uh
times this weight matrix Q and then

238
00:06:08,230 --> 00:06:08,240
times this weight matrix Q and then
 

239
00:06:08,240 --> 00:06:11,590
times this weight matrix Q and then
times your um input here I'm calling it

240
00:06:11,590 --> 00:06:11,600
times your um input here I'm calling it
 

241
00:06:11,600 --> 00:06:15,990
times your um input here I'm calling it
XN [snorts] then your key is again your

242
00:06:15,990 --> 00:06:16,000
XN [snorts] then your key is again your
 

243
00:06:16,000 --> 00:06:18,870
XN [snorts] then your key is again your
key your bias for your key plus your

244
00:06:18,870 --> 00:06:18,880
key your bias for your key plus your
 

245
00:06:18,880 --> 00:06:21,430
key your bias for your key plus your
weight matrix for your key times

246
00:06:21,430 --> 00:06:21,440
weight matrix for your key times
 

247
00:06:21,440 --> 00:06:24,469
weight matrix for your key times
whatever your input is

248
00:06:24,469 --> 00:06:24,479
whatever your input is
 

249
00:06:24,479 --> 00:06:26,710
whatever your input is
and then you have a corresponding value

250
00:06:26,710 --> 00:06:26,720
and then you have a corresponding value
 

251
00:06:26,720 --> 00:06:30,230
and then you have a corresponding value
that is again similarly learned. Okay,

252
00:06:30,230 --> 00:06:30,240
that is again similarly learned. Okay,
 

253
00:06:30,240 --> 00:06:35,110
that is again similarly learned. Okay,
beta Q, beta K, beta V, WQ, WK, WV are

254
00:06:35,110 --> 00:06:35,120
beta Q, beta K, beta V, WQ, WK, WV are
 

255
00:06:35,120 --> 00:06:37,110
beta Q, beta K, beta V, WQ, WK, WV are
all learnable.

256
00:06:37,110 --> 00:06:37,120
all learnable.
 

257
00:06:37,120 --> 00:06:39,029
all learnable.
Okay, and gradient descent is what is

258
00:06:39,029 --> 00:06:39,039
Okay, and gradient descent is what is
 

259
00:06:39,039 --> 00:06:41,270
Okay, and gradient descent is what is
going to decide what the entries of this

260
00:06:41,270 --> 00:06:41,280
going to decide what the entries of this
 

261
00:06:41,280 --> 00:06:43,990
going to decide what the entries of this
are.

262
00:06:43,990 --> 00:06:44,000
are.
 

263
00:06:44,000 --> 00:06:46,309
are.
Good.

264
00:06:46,309 --> 00:06:46,319
Good.
 

265
00:06:46,319 --> 00:06:48,950
Good.
>> Yes. Question. What does it mean to have

266
00:06:48,950 --> 00:06:48,960
>> Yes. Question. What does it mean to have
 

267
00:06:48,960 --> 00:06:50,950
>> Yes. Question. What does it mean to have
the keys and the values from the encoder

268
00:06:50,950 --> 00:06:50,960
the keys and the values from the encoder
 

269
00:06:50,960 --> 00:06:52,710
the keys and the values from the encoder
and the queries from the decoder for

270
00:06:52,710 --> 00:06:52,720
and the queries from the decoder for
 

271
00:06:52,720 --> 00:06:53,670
and the queries from the decoder for
positive?

272
00:06:53,670 --> 00:06:53,680
positive?
 

273
00:06:53,680 --> 00:06:54,950
positive?
>> What does it mean? Okay, let's talk

274
00:06:54,950 --> 00:06:54,960
>> What does it mean? Okay, let's talk
 

275
00:06:54,960 --> 00:06:56,150
>> What does it mean? Okay, let's talk
about this. What does it mean to have

276
00:06:56,150 --> 00:06:56,160
about this. What does it mean to have
 

277
00:06:56,160 --> 00:06:57,749
about this. What does it mean to have
the keys and the values from the encoder

278
00:06:57,749 --> 00:06:57,759
the keys and the values from the encoder
 

279
00:06:57,759 --> 00:06:59,990
the keys and the values from the encoder
and queries from the decoder? [snorts]

280
00:06:59,990 --> 00:07:00,000
and queries from the decoder? [snorts]
 

281
00:07:00,000 --> 00:07:03,110
and queries from the decoder? [snorts]
So, let's look

282
00:07:03,110 --> 00:07:03,120
So, let's look
 

283
00:07:03,120 --> 00:07:07,270
So, let's look
here at this picture.

284
00:07:07,270 --> 00:07:07,280

 

285
00:07:07,280 --> 00:07:08,550

So, this is not the transformer

286
00:07:08,550 --> 00:07:08,560
So, this is not the transformer
 

287
00:07:08,560 --> 00:07:09,990
So, this is not the transformer
architecture. We'll come to that in just

288
00:07:09,990 --> 00:07:10,000
architecture. We'll come to that in just
 

289
00:07:10,000 --> 00:07:11,029
architecture. We'll come to that in just
a minute.

290
00:07:11,029 --> 00:07:11,039
a minute.
 

291
00:07:11,039 --> 00:07:13,589
a minute.
What we're saying is that we're putting

292
00:07:13,589 --> 00:07:13,599
What we're saying is that we're putting
 

293
00:07:13,599 --> 00:07:18,469
What we're saying is that we're putting
in inputs that are so my my think my

294
00:07:18,469 --> 00:07:18,479
in inputs that are so my my think my
 

295
00:07:18,479 --> 00:07:20,790
in inputs that are so my my think my
target task is translation right so

296
00:07:20,790 --> 00:07:20,800
target task is translation right so
 

297
00:07:20,800 --> 00:07:23,589
target task is translation right so
let's say I am translating

298
00:07:23,589 --> 00:07:23,599
let's say I am translating
 

299
00:07:23,599 --> 00:07:26,070
let's say I am translating
um some sentence the cow jumped over the

300
00:07:26,070 --> 00:07:26,080
um some sentence the cow jumped over the
 

301
00:07:26,080 --> 00:07:30,150
um some sentence the cow jumped over the
moon okay and I have something uh I have

302
00:07:30,150 --> 00:07:30,160
moon okay and I have something uh I have
 

303
00:07:30,160 --> 00:07:34,070
moon okay and I have something uh I have
some output that now I want to um and I

304
00:07:34,070 --> 00:07:34,080
some output that now I want to um and I
 

305
00:07:34,080 --> 00:07:35,189
some output that now I want to um and I
want to translate this into some

306
00:07:35,189 --> 00:07:35,199
want to translate this into some
 

307
00:07:35,199 --> 00:07:36,870
want to translate this into some
language

308
00:07:36,870 --> 00:07:36,880
language
 

309
00:07:36,880 --> 00:07:39,830
language
so the encoder is taking the origin

310
00:07:39,830 --> 00:07:39,840
so the encoder is taking the origin
 

311
00:07:39,840 --> 00:07:40,870
so the encoder is taking the origin
language anguage in this case English

312
00:07:40,870 --> 00:07:40,880
language anguage in this case English
 

313
00:07:40,880 --> 00:07:42,390
language anguage in this case English
and let's say I'm translating to some

314
00:07:42,390 --> 00:07:42,400
and let's say I'm translating to some
 

315
00:07:42,400 --> 00:07:46,309
and let's say I'm translating to some
other uh other language. The cow jumped

316
00:07:46,309 --> 00:07:46,319
other uh other language. The cow jumped
 

317
00:07:46,319 --> 00:07:47,830
other uh other language. The cow jumped
over the moon. The encoder is going to

318
00:07:47,830 --> 00:07:47,840
over the moon. The encoder is going to
 

319
00:07:47,840 --> 00:07:51,830
over the moon. The encoder is going to
take this process this and generate

320
00:07:51,830 --> 00:07:51,840
take this process this and generate
 

321
00:07:51,840 --> 00:07:54,869
take this process this and generate
uh keys and values for this. Okay, for

322
00:07:54,869 --> 00:07:54,879
uh keys and values for this. Okay, for
 

323
00:07:54,879 --> 00:07:56,869
uh keys and values for this. Okay, for
this input

324
00:07:56,869 --> 00:07:56,879
this input
 

325
00:07:56,879 --> 00:08:00,550
this input
now when I'm at the decoder stage what

326
00:08:00,550 --> 00:08:00,560
now when I'm at the decoder stage what
 

327
00:08:00,560 --> 00:08:02,869
now when I'm at the decoder stage what
I'm going to do is if I'm doing training

328
00:08:02,869 --> 00:08:02,879
I'm going to do is if I'm doing training
 

329
00:08:02,879 --> 00:08:07,110
I'm going to do is if I'm doing training
I will have the uh target output right

330
00:08:07,110 --> 00:08:07,120
I will have the uh target output right
 

331
00:08:07,120 --> 00:08:09,189
I will have the uh target output right
and what I'm doing there is I've shifted

332
00:08:09,189 --> 00:08:09,199
and what I'm doing there is I've shifted
 

333
00:08:09,199 --> 00:08:10,550
and what I'm doing there is I've shifted
everything. So I'm putting in my first

334
00:08:10,550 --> 00:08:10,560
everything. So I'm putting in my first
 

335
00:08:10,560 --> 00:08:12,629
everything. So I'm putting in my first
thing is a start

336
00:08:12,629 --> 00:08:12,639
thing is a start
 

337
00:08:12,639 --> 00:08:14,710
thing is a start
token right. So whatever the decoder

338
00:08:14,710 --> 00:08:14,720
token right. So whatever the decoder
 

339
00:08:14,720 --> 00:08:16,550
token right. So whatever the decoder
generates some query start is my first

340
00:08:16,550 --> 00:08:16,560
generates some query start is my first
 

341
00:08:16,560 --> 00:08:18,869
generates some query start is my first
thing that is my first query. Now I want

342
00:08:18,869 --> 00:08:18,879
thing that is my first query. Now I want
 

343
00:08:18,879 --> 00:08:21,909
thing that is my first query. Now I want
to see what should start look at.

344
00:08:21,909 --> 00:08:21,919
to see what should start look at.
 

345
00:08:21,919 --> 00:08:23,350
to see what should start look at.
So what it's going to look at it's going

346
00:08:23,350 --> 00:08:23,360
So what it's going to look at it's going
 

347
00:08:23,360 --> 00:08:26,070
So what it's going to look at it's going
to look at the keys and the values that

348
00:08:26,070 --> 00:08:26,080
to look at the keys and the values that
 

349
00:08:26,080 --> 00:08:29,029
to look at the keys and the values that
have been generated by the encoder for

350
00:08:29,029 --> 00:08:29,039
have been generated by the encoder for
 

351
00:08:29,039 --> 00:08:31,589
have been generated by the encoder for
the input sentence because start needs

352
00:08:31,589 --> 00:08:31,599
the input sentence because start needs
 

353
00:08:31,599 --> 00:08:33,670
the input sentence because start needs
to know that I am jump translating the

354
00:08:33,670 --> 00:08:33,680
to know that I am jump translating the
 

355
00:08:33,680 --> 00:08:36,230
to know that I am jump translating the
sentence the cow jumped over the moon.

356
00:08:36,230 --> 00:08:36,240
sentence the cow jumped over the moon.
 

357
00:08:36,240 --> 00:08:38,630
sentence the cow jumped over the moon.
So it is looking at that entire sentence

358
00:08:38,630 --> 00:08:38,640
So it is looking at that entire sentence
 

359
00:08:38,640 --> 00:08:41,909
So it is looking at that entire sentence
the keys generated by that sentence

360
00:08:41,909 --> 00:08:41,919
the keys generated by that sentence
 

361
00:08:41,919 --> 00:08:43,909
the keys generated by that sentence
to then generate whatever the intention

362
00:08:43,909 --> 00:08:43,919
to then generate whatever the intention
 

363
00:08:43,919 --> 00:08:46,790
to then generate whatever the intention
matrix is and go forward. Does that make

364
00:08:46,790 --> 00:08:46,800
matrix is and go forward. Does that make
 

365
00:08:46,800 --> 00:08:48,949
matrix is and go forward. Does that make
sense? So then then you have the second

366
00:08:48,949 --> 00:08:48,959
sense? So then then you have the second
 

367
00:08:48,959 --> 00:08:50,389
sense? So then then you have the second
thing then it goes in and then you move

368
00:08:50,389 --> 00:08:50,399
thing then it goes in and then you move
 

369
00:08:50,399 --> 00:08:51,430
thing then it goes in and then you move
on.

370
00:08:51,430 --> 00:08:51,440
on.
 

371
00:08:51,440 --> 00:08:52,630
on.
>> Yes. Question

372
00:08:52,630 --> 00:08:52,640
>> Yes. Question
 

373
00:08:52,640 --> 00:08:54,710
>> Yes. Question
>> are the weight matrices to learn like

374
00:08:54,710 --> 00:08:54,720
>> are the weight matrices to learn like
 

375
00:08:54,720 --> 00:08:57,350
>> are the weight matrices to learn like
your I guess your keys the same between

376
00:08:57,350 --> 00:08:57,360
your I guess your keys the same between
 

377
00:08:57,360 --> 00:08:58,949
your I guess your keys the same between
both the encoder and decoder or does

378
00:08:58,949 --> 00:08:58,959
both the encoder and decoder or does
 

379
00:08:58,959 --> 00:09:01,590
both the encoder and decoder or does
each one have its own like key? they

380
00:09:01,590 --> 00:09:01,600
each one have its own like key? they
 

381
00:09:01,600 --> 00:09:03,670
each one have its own like key? they
have their own key matrix matrices and

382
00:09:03,670 --> 00:09:03,680
have their own key matrix matrices and
 

383
00:09:03,680 --> 00:09:05,350
have their own key matrix matrices and
they and in fact I mean that's one of

384
00:09:05,350 --> 00:09:05,360
they and in fact I mean that's one of
 

385
00:09:05,360 --> 00:09:09,190
they and in fact I mean that's one of
the things in in multi head attention

386
00:09:09,190 --> 00:09:09,200
the things in in multi head attention
 

387
00:09:09,200 --> 00:09:11,190
the things in in multi head attention
you in fact will have within the encoder

388
00:09:11,190 --> 00:09:11,200
you in fact will have within the encoder
 

389
00:09:11,200 --> 00:09:14,230
you in fact will have within the encoder
you will have multiple query matrices

390
00:09:14,230 --> 00:09:14,240
you will have multiple query matrices
 

391
00:09:14,240 --> 00:09:17,110
you will have multiple query matrices
multiple uh key matrices so on and so

392
00:09:17,110 --> 00:09:17,120
multiple uh key matrices so on and so
 

393
00:09:17,120 --> 00:09:19,829
multiple uh key matrices so on and so
forth because there's value in having

394
00:09:19,829 --> 00:09:19,839
forth because there's value in having
 

395
00:09:19,839 --> 00:09:24,470
forth because there's value in having
these be uh having these be separate

396
00:09:24,470 --> 00:09:24,480

 

397
00:09:24,480 --> 00:09:27,430

does that answer your question okay so

398
00:09:27,430 --> 00:09:27,440
does that answer your question okay so
 

399
00:09:27,440 --> 00:09:29,269
does that answer your question okay so
we talked about so this this is this

400
00:09:29,269 --> 00:09:29,279
we talked about so this this is this
 

401
00:09:29,279 --> 00:09:31,910
we talked about so this this is this
cross attention is that basically I'm

402
00:09:31,910 --> 00:09:31,920
cross attention is that basically I'm
 

403
00:09:31,920 --> 00:09:34,389
cross attention is that basically I'm
When I'm here in my decoder, I'm doing

404
00:09:34,389 --> 00:09:34,399
When I'm here in my decoder, I'm doing
 

405
00:09:34,399 --> 00:09:36,150
When I'm here in my decoder, I'm doing
my translation. I have had my start

406
00:09:36,150 --> 00:09:36,160
my translation. I have had my start
 

407
00:09:36,160 --> 00:09:38,230
my translation. I have had my start
token come in or I've had maybe a word

408
00:09:38,230 --> 00:09:38,240
token come in or I've had maybe a word
 

409
00:09:38,240 --> 00:09:40,389
token come in or I've had maybe a word
from my target language, whatever

410
00:09:40,389 --> 00:09:40,399
from my target language, whatever
 

411
00:09:40,399 --> 00:09:42,470
from my target language, whatever
Chinese come in and I want to predict

412
00:09:42,470 --> 00:09:42,480
Chinese come in and I want to predict
 

413
00:09:42,480 --> 00:09:45,590
Chinese come in and I want to predict
the next word. I'm looking now back to

414
00:09:45,590 --> 00:09:45,600
the next word. I'm looking now back to
 

415
00:09:45,600 --> 00:09:48,150
the next word. I'm looking now back to
my encoder to my input sequence. And

416
00:09:48,150 --> 00:09:48,160
my encoder to my input sequence. And
 

417
00:09:48,160 --> 00:09:50,230
my encoder to my input sequence. And
that is why it's called cross attention.

418
00:09:50,230 --> 00:09:50,240
that is why it's called cross attention.
 

419
00:09:50,240 --> 00:09:53,350
that is why it's called cross attention.
It is looking from the target output

420
00:09:53,350 --> 00:09:53,360
It is looking from the target output
 

421
00:09:53,360 --> 00:09:57,356
It is looking from the target output
sequence to the input sequence. Okay.

422
00:09:57,356 --> 00:09:57,366
sequence to the input sequence. Okay.
 

423
00:09:57,366 --> 00:09:57,509
sequence to the input sequence. Okay.
>> [snorts]

424
00:09:57,509 --> 00:09:57,519
>> [snorts]
 

425
00:09:57,519 --> 00:10:00,150
>> [snorts]
>> Self attention on the other hand is

426
00:10:00,150 --> 00:10:00,160
>> Self attention on the other hand is
 

427
00:10:00,160 --> 00:10:04,630
>> Self attention on the other hand is
saying okay um I'm translating a

428
00:10:04,630 --> 00:10:04,640
saying okay um I'm translating a
 

429
00:10:04,640 --> 00:10:06,790
saying okay um I'm translating a
sentence into

430
00:10:06,790 --> 00:10:06,800
sentence into
 

431
00:10:06,800 --> 00:10:09,430
sentence into
uh some language. I guess I only speak

432
00:10:09,430 --> 00:10:09,440
uh some language. I guess I only speak
 

433
00:10:09,440 --> 00:10:11,110
uh some language. I guess I only speak
so many languages so I can't really give

434
00:10:11,110 --> 00:10:11,120
so many languages so I can't really give
 

435
00:10:11,120 --> 00:10:14,230
so many languages so I can't really give
general examples but um let's say my

436
00:10:14,230 --> 00:10:14,240
general examples but um let's say my
 

437
00:10:14,240 --> 00:10:16,470
general examples but um let's say my
again I'm

438
00:10:16,470 --> 00:10:16,480
again I'm
 

439
00:10:16,480 --> 00:10:17,910
again I'm
uh let's say let's let's say I'm

440
00:10:17,910 --> 00:10:17,920
uh let's say let's let's say I'm
 

441
00:10:17,920 --> 00:10:19,430
uh let's say let's let's say I'm
translating from some unknown language

442
00:10:19,430 --> 00:10:19,440
translating from some unknown language
 

443
00:10:19,440 --> 00:10:21,269
translating from some unknown language
into English. Okay, English is my target

444
00:10:21,269 --> 00:10:21,279
into English. Okay, English is my target
 

445
00:10:21,279 --> 00:10:22,870
into English. Okay, English is my target
language just so that I can have an

446
00:10:22,870 --> 00:10:22,880
language just so that I can have an
 

447
00:10:22,880 --> 00:10:24,710
language just so that I can have an
example that everyone can understand.

448
00:10:24,710 --> 00:10:24,720
example that everyone can understand.
 

449
00:10:24,720 --> 00:10:27,110
example that everyone can understand.
But let's say my output is now the cow

450
00:10:27,110 --> 00:10:27,120
But let's say my output is now the cow
 

451
00:10:27,120 --> 00:10:29,670
But let's say my output is now the cow
jumped over the moon. And let's say I've

452
00:10:29,670 --> 00:10:29,680
jumped over the moon. And let's say I've
 

453
00:10:29,680 --> 00:10:32,630
jumped over the moon. And let's say I've
generated the and cow and I want to

454
00:10:32,630 --> 00:10:32,640
generated the and cow and I want to
 

455
00:10:32,640 --> 00:10:36,630
generated the and cow and I want to
predict what the uh next word is which

456
00:10:36,630 --> 00:10:36,640
predict what the uh next word is which
 

457
00:10:36,640 --> 00:10:39,829
predict what the uh next word is which
is over. It's relevant for me at the

458
00:10:39,829 --> 00:10:39,839
is over. It's relevant for me at the
 

459
00:10:39,839 --> 00:10:42,630
is over. It's relevant for me at the
decoder to look also at what is my

460
00:10:42,630 --> 00:10:42,640
decoder to look also at what is my
 

461
00:10:42,640 --> 00:10:45,670
decoder to look also at what is my
decoder just produced. Right? The fact

462
00:10:45,670 --> 00:10:45,680
decoder just produced. Right? The fact
 

463
00:10:45,680 --> 00:10:47,829
decoder just produced. Right? The fact
that I just produced the and cow is

464
00:10:47,829 --> 00:10:47,839
that I just produced the and cow is
 

465
00:10:47,839 --> 00:10:50,790
that I just produced the and cow is
going to help me produce over. So the

466
00:10:50,790 --> 00:10:50,800
going to help me produce over. So the
 

467
00:10:50,800 --> 00:10:53,670
going to help me produce over. So the
decoder self attention is looking back

468
00:10:53,670 --> 00:10:53,680
decoder self attention is looking back
 

469
00:10:53,680 --> 00:10:56,389
decoder self attention is looking back
at what has been produced historically.

470
00:10:56,389 --> 00:10:56,399
at what has been produced historically.
 

471
00:10:56,399 --> 00:10:58,550
at what has been produced historically.
And on the decoder side when we do self

472
00:10:58,550 --> 00:10:58,560
And on the decoder side when we do self
 

473
00:10:58,560 --> 00:11:01,110
And on the decoder side when we do self
attention we will do causal or masked

474
00:11:01,110 --> 00:11:01,120
attention we will do causal or masked
 

475
00:11:01,120 --> 00:11:03,910
attention we will do causal or masked
self attention because it's not fair to

476
00:11:03,910 --> 00:11:03,920
self attention because it's not fair to
 

477
00:11:03,920 --> 00:11:05,910
self attention because it's not fair to
say I'm going to look at the future of

478
00:11:05,910 --> 00:11:05,920
say I'm going to look at the future of
 

479
00:11:05,920 --> 00:11:08,150
say I'm going to look at the future of
the sentence

480
00:11:08,150 --> 00:11:08,160
the sentence
 

481
00:11:08,160 --> 00:11:10,870
the sentence
um and then learn to predict right what

482
00:11:10,870 --> 00:11:10,880
um and then learn to predict right what
 

483
00:11:10,880 --> 00:11:12,150
um and then learn to predict right what
I'm going to do is I want to look only

484
00:11:12,150 --> 00:11:12,160
I'm going to do is I want to look only
 

485
00:11:12,160 --> 00:11:14,790
I'm going to do is I want to look only
at the past. So I'm going to not allow

486
00:11:14,790 --> 00:11:14,800
at the past. So I'm going to not allow
 

487
00:11:14,800 --> 00:11:16,150
at the past. So I'm going to not allow
myself to look at anything in the

488
00:11:16,150 --> 00:11:16,160
myself to look at anything in the
 

489
00:11:16,160 --> 00:11:18,630
myself to look at anything in the
future. On the other hand, when we do

490
00:11:18,630 --> 00:11:18,640
future. On the other hand, when we do
 

491
00:11:18,640 --> 00:11:21,990
future. On the other hand, when we do
self attention for the encoder side,

492
00:11:21,990 --> 00:11:22,000
self attention for the encoder side,
 

493
00:11:22,000 --> 00:11:24,470
self attention for the encoder side,
there I get my entire input sequence all

494
00:11:24,470 --> 00:11:24,480
there I get my entire input sequence all
 

495
00:11:24,480 --> 00:11:27,030
there I get my entire input sequence all
at once. So there everything can look at

496
00:11:27,030 --> 00:11:27,040
at once. So there everything can look at
 

497
00:11:27,040 --> 00:11:29,430
at once. So there everything can look at
everything else. Which is why there's

498
00:11:29,430 --> 00:11:29,440
everything else. Which is why there's
 

499
00:11:29,440 --> 00:11:32,310
everything else. Which is why there's
regular self attention which is used in

500
00:11:32,310 --> 00:11:32,320
regular self attention which is used in
 

501
00:11:32,320 --> 00:11:36,389
regular self attention which is used in
encoders and there is

502
00:11:36,389 --> 00:11:36,399
encoders and there is
 

503
00:11:36,399 --> 00:11:38,550
encoders and there is
masked or causal self attention which is

504
00:11:38,550 --> 00:11:38,560
masked or causal self attention which is
 

505
00:11:38,560 --> 00:11:41,590
masked or causal self attention which is
used in decoders.

506
00:11:41,590 --> 00:11:41,600
used in decoders.
 

507
00:11:41,600 --> 00:11:43,430
used in decoders.
Does that make sense? Yes. Question. Um

508
00:11:43,430 --> 00:11:43,440
Does that make sense? Yes. Question. Um
 

509
00:11:43,440 --> 00:11:45,590
Does that make sense? Yes. Question. Um
in typical encoder decoder architectures

510
00:11:45,590 --> 00:11:45,600
in typical encoder decoder architectures
 

511
00:11:45,600 --> 00:11:47,750
in typical encoder decoder architectures
are all readers being used at once.

512
00:11:47,750 --> 00:11:47,760
are all readers being used at once.
 

513
00:11:47,760 --> 00:11:49,750
are all readers being used at once.
>> In typical encoder decoder architectures

514
00:11:49,750 --> 00:11:49,760
>> In typical encoder decoder architectures
 

515
00:11:49,760 --> 00:11:51,030
>> In typical encoder decoder architectures
are yes

516
00:11:51,030 --> 00:11:51,040
are yes
 

517
00:11:51,040 --> 00:11:54,150
are yes
>> because you will have um just full self

518
00:11:54,150 --> 00:11:54,160
>> because you will have um just full self
 

519
00:11:54,160 --> 00:11:56,550
>> because you will have um just full self
attention in the encoder cross attention

520
00:11:56,550 --> 00:11:56,560
attention in the encoder cross attention
 

521
00:11:56,560 --> 00:11:59,670
attention in the encoder cross attention
to do the translation task and then mask

522
00:11:59,670 --> 00:11:59,680
to do the translation task and then mask
 

523
00:11:59,680 --> 00:12:01,269
to do the translation task and then mask
self attention so that the decoder knows

524
00:12:01,269 --> 00:12:01,279
self attention so that the decoder knows
 

525
00:12:01,279 --> 00:12:03,350
self attention so that the decoder knows
what it just said.

526
00:12:03,350 --> 00:12:03,360
what it just said.
 

527
00:12:03,360 --> 00:12:04,230
what it just said.
>> Yes.

528
00:12:04,230 --> 00:12:04,240
>> Yes.
 

529
00:12:04,240 --> 00:12:07,269
>> Yes.
>> Why not have like multiple input tokens

530
00:12:07,269 --> 00:12:07,279
>> Why not have like multiple input tokens
 

531
00:12:07,279 --> 00:12:09,110
>> Why not have like multiple input tokens
to the decoder and then do self

532
00:12:09,110 --> 00:12:09,120
to the decoder and then do self
 

533
00:12:09,120 --> 00:12:11,110
to the decoder and then do self
attention across those? like why only

534
00:12:11,110 --> 00:12:11,120
attention across those? like why only
 

535
00:12:11,120 --> 00:12:13,110
attention across those? like why only
have one star token? If you can do self

536
00:12:13,110 --> 00:12:13,120
have one star token? If you can do self
 

537
00:12:13,120 --> 00:12:14,949
have one star token? If you can do self
attention in decoder, why not have like

538
00:12:14,949 --> 00:12:14,959
attention in decoder, why not have like
 

539
00:12:14,959 --> 00:12:16,470
attention in decoder, why not have like
five and then produce five words in

540
00:12:16,470 --> 00:12:16,480
five and then produce five words in
 

541
00:12:16,480 --> 00:12:18,710
five and then produce five words in
parallel and have them self attend to

542
00:12:18,710 --> 00:12:18,720
parallel and have them self attend to
 

543
00:12:18,720 --> 00:12:20,069
parallel and have them self attend to
each other?

544
00:12:20,069 --> 00:12:20,079
each other?
 

545
00:12:20,079 --> 00:12:21,910
each other?
>> So, I'm not sure I'm fully understanding

546
00:12:21,910 --> 00:12:21,920
>> So, I'm not sure I'm fully understanding
 

547
00:12:21,920 --> 00:12:23,350
>> So, I'm not sure I'm fully understanding
your idea, but if I understand your

548
00:12:23,350 --> 00:12:23,360
your idea, but if I understand your
 

549
00:12:23,360 --> 00:12:25,829
your idea, but if I understand your
idea, it's like saying, let me have the

550
00:12:25,829 --> 00:12:25,839
idea, it's like saying, let me have the
 

551
00:12:25,839 --> 00:12:27,430
idea, it's like saying, let me have the
start token and then the first word

552
00:12:27,430 --> 00:12:27,440
start token and then the first word
 

553
00:12:27,440 --> 00:12:29,030
start token and then the first word
token and then the second word token and

554
00:12:29,030 --> 00:12:29,040
token and then the second word token and
 

555
00:12:29,040 --> 00:12:31,590
token and then the second word token and
then the third word token and just say

556
00:12:31,590 --> 00:12:31,600
then the third word token and just say
 

557
00:12:31,600 --> 00:12:34,150
then the third word token and just say
just produce the third third word out of

558
00:12:34,150 --> 00:12:34,160
just produce the third third word out of
 

559
00:12:34,160 --> 00:12:35,750
just produce the third third word out of
nothing just looking at the entire

560
00:12:35,750 --> 00:12:35,760
nothing just looking at the entire
 

561
00:12:35,760 --> 00:12:36,389
nothing just looking at the entire
sequence.

562
00:12:36,389 --> 00:12:36,399
sequence.
 

563
00:12:36,399 --> 00:12:39,350
sequence.
>> Yeah, we'll produce all of them. Um so

564
00:12:39,350 --> 00:12:39,360
>> Yeah, we'll produce all of them. Um so
 

565
00:12:39,360 --> 00:12:41,110
>> Yeah, we'll produce all of them. Um so
the challenge is that you're you want to

566
00:12:41,110 --> 00:12:41,120
the challenge is that you're you want to
 

567
00:12:41,120 --> 00:12:44,310
the challenge is that you're you want to
in the end put produce one sentence and

568
00:12:44,310 --> 00:12:44,320
in the end put produce one sentence and
 

569
00:12:44,320 --> 00:12:46,550
in the end put produce one sentence and
now if you produce all of these things

570
00:12:46,550 --> 00:12:46,560
now if you produce all of these things
 

571
00:12:46,560 --> 00:12:50,069
now if you produce all of these things
separately you're going to

572
00:12:50,069 --> 00:12:50,079
separately you're going to
 

573
00:12:50,079 --> 00:12:52,150
separately you're going to
uh end up with this issue and and at the

574
00:12:52,150 --> 00:12:52,160
uh end up with this issue and and at the
 

575
00:12:52,160 --> 00:12:54,389
uh end up with this issue and and at the
end of the day all of these operations

576
00:12:54,389 --> 00:12:54,399
end of the day all of these operations
 

577
00:12:54,399 --> 00:12:57,990
end of the day all of these operations
are um like the on the encoder side

578
00:12:57,990 --> 00:12:58,000
are um like the on the encoder side
 

579
00:12:58,000 --> 00:12:59,350
are um like the on the encoder side
you're doing all of this parallelly

580
00:12:59,350 --> 00:12:59,360
you're doing all of this parallelly
 

581
00:12:59,360 --> 00:13:01,030
you're doing all of this parallelly
anyway on the decoder side you're

582
00:13:01,030 --> 00:13:01,040
anyway on the decoder side you're
 

583
00:13:01,040 --> 00:13:04,870
anyway on the decoder side you're
waiting to have your to have your input

584
00:13:04,870 --> 00:13:04,880
waiting to have your to have your input
 

585
00:13:04,880 --> 00:13:07,430
waiting to have your to have your input
um but you want to have one coherent

586
00:13:07,430 --> 00:13:07,440
um but you want to have one coherent
 

587
00:13:07,440 --> 00:13:08,949
um but you want to have one coherent
sentence and I guess if you did that you

588
00:13:08,949 --> 00:13:08,959
sentence and I guess if you did that you
 

589
00:13:08,959 --> 00:13:10,310
sentence and I guess if you did that you
would have to then do some kind of other

590
00:13:10,310 --> 00:13:10,320
would have to then do some kind of other
 

591
00:13:10,320 --> 00:13:11,910
would have to then do some kind of other
combination to figure out then because

592
00:13:11,910 --> 00:13:11,920
combination to figure out then because
 

593
00:13:11,920 --> 00:13:12,790
combination to figure out then because
all you're producing now is

594
00:13:12,790 --> 00:13:12,800
all you're producing now is
 

595
00:13:12,800 --> 00:13:14,069
all you're producing now is
probabilities and how do you pick which

596
00:13:14,069 --> 00:13:14,079
probabilities and how do you pick which
 

597
00:13:14,079 --> 00:13:15,910
probabilities and how do you pick which
probability is where

598
00:13:15,910 --> 00:13:15,920
probability is where
 

599
00:13:15,920 --> 00:13:18,870
probability is where
>> right now you like there's this the

600
00:13:18,870 --> 00:13:18,880
>> right now you like there's this the
 

601
00:13:18,880 --> 00:13:24,790
>> right now you like there's this the
sampling problem now shows up

602
00:13:24,790 --> 00:13:24,800

 

603
00:13:24,800 --> 00:13:28,949

>> okay

604
00:13:28,949 --> 00:13:28,959

 

605
00:13:28,959 --> 00:13:31,509

so with that let me just reiterate what

606
00:13:31,509 --> 00:13:31,519
so with that let me just reiterate what
 

607
00:13:31,519 --> 00:13:34,470
so with that let me just reiterate what
this attention formula is which is that

608
00:13:34,470 --> 00:13:34,480
this attention formula is which is that
 

609
00:13:34,480 --> 00:13:37,269
this attention formula is which is that
I'm basically using generating a score

610
00:13:37,269 --> 00:13:37,279
I'm basically using generating a score
 

611
00:13:37,279 --> 00:13:39,590
I'm basically using generating a score
based on how similar my keys and my

612
00:13:39,590 --> 00:13:39,600
based on how similar my keys and my
 

613
00:13:39,600 --> 00:13:41,509
based on how similar my keys and my
values are and then I'm turning that

614
00:13:41,509 --> 00:13:41,519
values are and then I'm turning that
 

615
00:13:41,519 --> 00:13:43,430
values are and then I'm turning that
score into a probability using the

616
00:13:43,430 --> 00:13:43,440
score into a probability using the
 

617
00:13:43,440 --> 00:13:45,910
score into a probability using the
softmax. Okay, and the softmax is just

618
00:13:45,910 --> 00:13:45,920
softmax. Okay, and the softmax is just
 

619
00:13:45,920 --> 00:13:48,310
softmax. Okay, and the softmax is just
I'm saying like I'm taking the x of this

620
00:13:48,310 --> 00:13:48,320
I'm saying like I'm taking the x of this
 

621
00:13:48,320 --> 00:13:50,790
I'm saying like I'm taking the x of this
and then I'm normalizing.

622
00:13:50,790 --> 00:13:50,800
and then I'm normalizing.
 

623
00:13:50,800 --> 00:13:53,910
and then I'm normalizing.
Okay, but we talked about the fact that

624
00:13:53,910 --> 00:13:53,920
Okay, but we talked about the fact that
 

625
00:13:53,920 --> 00:13:57,750
Okay, but we talked about the fact that
this actually doesn't work right and why

626
00:13:57,750 --> 00:13:57,760
this actually doesn't work right and why
 

627
00:13:57,760 --> 00:13:59,189
this actually doesn't work right and why
doesn't this work? So if I think about

628
00:13:59,189 --> 00:13:59,199
doesn't this work? So if I think about
 

629
00:13:59,199 --> 00:14:02,329
doesn't this work? So if I think about
my embedding dimension

630
00:14:02,329 --> 00:14:02,339
my embedding dimension
 

631
00:14:02,339 --> 00:14:04,790
my embedding dimension
[snorts] for example this is like,024

632
00:14:04,790 --> 00:14:04,800
[snorts] for example this is like,024
 

633
00:14:04,800 --> 00:14:07,910
[snorts] for example this is like,024
right is a typical um embedding

634
00:14:07,910 --> 00:14:07,920
right is a typical um embedding
 

635
00:14:07,920 --> 00:14:12,069
right is a typical um embedding
dimension that you might have

636
00:14:12,069 --> 00:14:12,079

 

637
00:14:12,079 --> 00:14:15,350

so this dotproduct is now the sum of a

638
00:14:15,350 --> 00:14:15,360
so this dotproduct is now the sum of a
 

639
00:14:15,360 --> 00:14:18,470
so this dotproduct is now the sum of a
thousand entries right

640
00:14:18,470 --> 00:14:18,480
thousand entries right
 

641
00:14:18,480 --> 00:14:21,110
thousand entries right
and so this has the possibility of

642
00:14:21,110 --> 00:14:21,120
and so this has the possibility of
 

643
00:14:21,120 --> 00:14:23,990
and so this has the possibility of
becoming quite big

644
00:14:23,990 --> 00:14:24,000
becoming quite big
 

645
00:14:24,000 --> 00:14:27,829
becoming quite big
and in a soft max if I have some numbers

646
00:14:27,829 --> 00:14:27,839
and in a soft max if I have some numbers
 

647
00:14:27,839 --> 00:14:30,230
and in a soft max if I have some numbers
become come very big.

648
00:14:30,230 --> 00:14:30,240
become come very big.
 

649
00:14:30,240 --> 00:14:31,750
become come very big.
I'm going to end up by kind of

650
00:14:31,750 --> 00:14:31,760
I'm going to end up by kind of
 

651
00:14:31,760 --> 00:14:34,710
I'm going to end up by kind of
saturating my dynamic range, right? I'm

652
00:14:34,710 --> 00:14:34,720
saturating my dynamic range, right? I'm
 

653
00:14:34,720 --> 00:14:36,710
saturating my dynamic range, right? I'm
in the end working in finite precision

654
00:14:36,710 --> 00:14:36,720
in the end working in finite precision
 

655
00:14:36,720 --> 00:14:39,509
in the end working in finite precision
floating point. So I don't want to be

656
00:14:39,509 --> 00:14:39,519
floating point. So I don't want to be
 

657
00:14:39,519 --> 00:14:42,310
floating point. So I don't want to be
saturating things out.

658
00:14:42,310 --> 00:14:42,320
saturating things out.
 

659
00:14:42,320 --> 00:14:44,790
saturating things out.
I want to have things that look like a

660
00:14:44,790 --> 00:14:44,800
I want to have things that look like a
 

661
00:14:44,800 --> 00:14:50,069
I want to have things that look like a
nice distribution, right?

662
00:14:50,069 --> 00:14:50,079
nice distribution, right?
 

663
00:14:50,079 --> 00:14:52,389
nice distribution, right?
So how do I make sure that that happens?

664
00:14:52,389 --> 00:14:52,399
So how do I make sure that that happens?
 

665
00:14:52,399 --> 00:14:54,310
So how do I make sure that that happens?
So if I'm

666
00:14:54,310 --> 00:14:54,320
So if I'm
 

667
00:14:54,320 --> 00:14:57,509
So if I'm
taking a sum of let's say each of these

668
00:14:57,509 --> 00:14:57,519
taking a sum of let's say each of these
 

669
00:14:57,519 --> 00:15:00,550
taking a sum of let's say each of these
are um approximate let's say each of

670
00:15:00,550 --> 00:15:00,560
are um approximate let's say each of
 

671
00:15:00,560 --> 00:15:02,550
are um approximate let's say each of
these are normalized they're RMS norm

672
00:15:02,550 --> 00:15:02,560
these are normalized they're RMS norm
 

673
00:15:02,560 --> 00:15:04,629
these are normalized they're RMS norm
one so it's like I'm adding a bunch of

674
00:15:04,629 --> 00:15:04,639
one so it's like I'm adding a bunch of
 

675
00:15:04,639 --> 00:15:06,629
one so it's like I'm adding a bunch of
ones

676
00:15:06,629 --> 00:15:06,639
ones
 

677
00:15:06,639 --> 00:15:09,750
ones
right so if I look at this this could be

678
00:15:09,750 --> 00:15:09,760
right so if I look at this this could be
 

679
00:15:09,760 --> 00:15:13,350
right so if I look at this this could be
this is something like a thousand

680
00:15:13,350 --> 00:15:13,360
this is something like a thousand
 

681
00:15:13,360 --> 00:15:16,069
this is something like a thousand
right I have 1* 1 1* 1 I'm adding up I'm

682
00:15:16,069 --> 00:15:16,079
right I have 1* 1 1* 1 I'm adding up I'm
 

683
00:15:16,079 --> 00:15:17,350
right I have 1* 1 1* 1 I'm adding up I'm
adding up all of these things and I

684
00:15:17,350 --> 00:15:17,360
adding up all of these things and I
 

685
00:15:17,360 --> 00:15:19,910
adding up all of these things and I
don't want to have these things get

686
00:15:19,910 --> 00:15:19,920
don't want to have these things get
 

687
00:15:19,920 --> 00:15:21,990
don't want to have these things get
super

688
00:15:21,990 --> 00:15:22,000
super
 

689
00:15:22,000 --> 00:15:23,750
super
So what's the standard way of

690
00:15:23,750 --> 00:15:23,760
So what's the standard way of
 

691
00:15:23,760 --> 00:15:26,389
So what's the standard way of
normalizing things? If I have a sum of n

692
00:15:26,389 --> 00:15:26,399
normalizing things? If I have a sum of n
 

693
00:15:26,399 --> 00:15:28,470
normalizing things? If I have a sum of n
things and I want it to look like a

694
00:15:28,470 --> 00:15:28,480
things and I want it to look like a
 

695
00:15:28,480 --> 00:15:30,629
things and I want it to look like a
distribution that I know and love,

696
00:15:30,629 --> 00:15:30,639
distribution that I know and love,
 

697
00:15:30,639 --> 00:15:32,949
distribution that I know and love,
what's the what's the thing that we

698
00:15:32,949 --> 00:15:32,959
what's the what's the thing that we
 

699
00:15:32,959 --> 00:15:37,430
what's the what's the thing that we
always use?

700
00:15:37,430 --> 00:15:37,440

 

701
00:15:37,440 --> 00:15:39,590

CLT, right?

702
00:15:39,590 --> 00:15:39,600
CLT, right?
 

703
00:15:39,600 --> 00:15:41,910
CLT, right?
We say that if I have a sum of many iid

704
00:15:41,910 --> 00:15:41,920
We say that if I have a sum of many iid
 

705
00:15:41,920 --> 00:15:44,389
We say that if I have a sum of many iid
things and I want them to look like a

706
00:15:44,389 --> 00:15:44,399
things and I want them to look like a
 

707
00:15:44,399 --> 00:15:46,389
things and I want them to look like a
standard normal, what is the right

708
00:15:46,389 --> 00:15:46,399
standard normal, what is the right
 

709
00:15:46,399 --> 00:15:48,069
standard normal, what is the right
scaling?

710
00:15:48,069 --> 00:15:48,079
scaling?
 

711
00:15:48,079 --> 00:15:49,670
scaling?
I'm going to use the square root n or

712
00:15:49,670 --> 00:15:49,680
I'm going to use the square root n or
 

713
00:15:49,680 --> 00:15:50,790
I'm going to use the square root n or
square root the number of things that

714
00:15:50,790 --> 00:15:50,800
square root the number of things that
 

715
00:15:50,800 --> 00:15:53,269
square root the number of things that
I'm adding, right? That gets me things

716
00:15:53,269 --> 00:15:53,279
I'm adding, right? That gets me things
 

717
00:15:53,279 --> 00:15:56,790
I'm adding, right? That gets me things
looking like a nice normal distribution.

718
00:15:56,790 --> 00:15:56,800
looking like a nice normal distribution.
 

719
00:15:56,800 --> 00:15:59,670
looking like a nice normal distribution.
So if I was to so I, you know, there's

720
00:15:59,670 --> 00:15:59,680
So if I was to so I, you know, there's
 

721
00:15:59,680 --> 00:16:01,110
So if I was to so I, you know, there's
many different scaling factors I could

722
00:16:01,110 --> 00:16:01,120
many different scaling factors I could
 

723
00:16:01,120 --> 00:16:02,870
many different scaling factors I could
choose here, but the CLT is basically

724
00:16:02,870 --> 00:16:02,880
choose here, but the CLT is basically
 

725
00:16:02,880 --> 00:16:04,150
choose here, but the CLT is basically
what is suggesting that I should choose

726
00:16:04,150 --> 00:16:04,160
what is suggesting that I should choose
 

727
00:16:04,160 --> 00:16:06,310
what is suggesting that I should choose
the square root D. I could if I

728
00:16:06,310 --> 00:16:06,320
the square root D. I could if I
 

729
00:16:06,320 --> 00:16:08,150
the square root D. I could if I
normalized by D, I risk making

730
00:16:08,150 --> 00:16:08,160
normalized by D, I risk making
 

731
00:16:08,160 --> 00:16:10,470
normalized by D, I risk making
everything too small and not being able

732
00:16:10,470 --> 00:16:10,480
everything too small and not being able
 

733
00:16:10,480 --> 00:16:13,189
everything too small and not being able
to resolve things.

734
00:16:13,189 --> 00:16:13,199
to resolve things.
 

735
00:16:13,199 --> 00:16:15,269
to resolve things.
Square root D hits the exactly the sweet

736
00:16:15,269 --> 00:16:15,279
Square root D hits the exactly the sweet
 

737
00:16:15,279 --> 00:16:19,350
Square root D hits the exactly the sweet
spot that we want.

738
00:16:19,350 --> 00:16:19,360

 

739
00:16:19,360 --> 00:16:21,189

And we kind of talked about the scaling

740
00:16:21,189 --> 00:16:21,199
And we kind of talked about the scaling
 

741
00:16:21,199 --> 00:16:22,629
And we kind of talked about the scaling
ideas like back when we were talking

742
00:16:22,629 --> 00:16:22,639
ideas like back when we were talking
 

743
00:16:22,639 --> 00:16:25,030
ideas like back when we were talking
about muon right and muup scalings

744
00:16:25,030 --> 00:16:25,040
about muon right and muup scalings
 

745
00:16:25,040 --> 00:16:26,629
about muon right and muup scalings
Xavier initialization all these things

746
00:16:26,629 --> 00:16:26,639
Xavier initialization all these things
 

747
00:16:26,639 --> 00:16:28,470
Xavier initialization all these things
of like making sure things don't get too

748
00:16:28,470 --> 00:16:28,480
of like making sure things don't get too
 

749
00:16:28,480 --> 00:16:29,910
of like making sure things don't get too
big things don't get too small this kind

750
00:16:29,910 --> 00:16:29,920
big things don't get too small this kind
 

751
00:16:29,920 --> 00:16:33,269
big things don't get too small this kind
of same thinking is leading to these

752
00:16:33,269 --> 00:16:33,279
of same thinking is leading to these
 

753
00:16:33,279 --> 00:16:34,949
of same thinking is leading to these
scaling factors and giving us what the

754
00:16:34,949 --> 00:16:34,959
scaling factors and giving us what the
 

755
00:16:34,959 --> 00:16:37,350
scaling factors and giving us what the
right scaling factor is.

756
00:16:37,350 --> 00:16:37,360
right scaling factor is.
 

757
00:16:37,360 --> 00:16:39,670
right scaling factor is.
Okay

758
00:16:39,670 --> 00:16:39,680
Okay
 

759
00:16:39,680 --> 00:16:45,350
Okay
questions.

760
00:16:45,350 --> 00:16:45,360

 

761
00:16:45,360 --> 00:16:47,749

Okay, good.

762
00:16:47,749 --> 00:16:47,759
Okay, good.
 

763
00:16:47,759 --> 00:16:49,749
Okay, good.
So, we want to prevent these entries of

764
00:16:49,749 --> 00:16:49,759
So, we want to prevent these entries of
 

765
00:16:49,759 --> 00:16:51,110
So, we want to prevent these entries of
the softmax from getting too large.

766
00:16:51,110 --> 00:16:51,120
the softmax from getting too large.
 

767
00:16:51,120 --> 00:16:53,110
the softmax from getting too large.
Good. Then we talked about self

768
00:16:53,110 --> 00:16:53,120
Good. Then we talked about self
 

769
00:16:53,120 --> 00:16:54,470
Good. Then we talked about self
attention. Any questions about this

770
00:16:54,470 --> 00:16:54,480
attention. Any questions about this
 

771
00:16:54,480 --> 00:16:57,030
attention. Any questions about this
picture?

772
00:16:57,030 --> 00:16:57,040
picture?
 

773
00:16:57,040 --> 00:17:01,910
picture?
Basically, you have an input.

774
00:17:01,910 --> 00:17:01,920

 

775
00:17:01,920 --> 00:17:04,230

You generate your queries, your keys,

776
00:17:04,230 --> 00:17:04,240
You generate your queries, your keys,
 

777
00:17:04,240 --> 00:17:06,549
You generate your queries, your keys,
and your values.

778
00:17:06,549 --> 00:17:06,559
and your values.
 

779
00:17:06,559 --> 00:17:08,949
and your values.
The queries and the keys generate a

780
00:17:08,949 --> 00:17:08,959
The queries and the keys generate a
 

781
00:17:08,959 --> 00:17:11,270
The queries and the keys generate a
score that give you an attention. And

782
00:17:11,270 --> 00:17:11,280
score that give you an attention. And
 

783
00:17:11,280 --> 00:17:13,189
score that give you an attention. And
then the attention gives you the weights

784
00:17:13,189 --> 00:17:13,199
then the attention gives you the weights
 

785
00:17:13,199 --> 00:17:14,789
then the attention gives you the weights
by which you can combine the values

786
00:17:14,789 --> 00:17:14,799
by which you can combine the values
 

787
00:17:14,799 --> 00:17:18,470
by which you can combine the values
which give you the output.

788
00:17:18,470 --> 00:17:18,480
which give you the output.
 

789
00:17:18,480 --> 00:17:18,870
which give you the output.
>> Yes.

790
00:17:18,870 --> 00:17:18,880
>> Yes.
 

791
00:17:18,880 --> 00:17:22,230
>> Yes.
>> Uh I think the input of Q and K is

792
00:17:22,230 --> 00:17:22,240
>> Uh I think the input of Q and K is
 

793
00:17:22,240 --> 00:17:24,150
>> Uh I think the input of Q and K is
similar. So at that time it's very hard

794
00:17:24,150 --> 00:17:24,160
similar. So at that time it's very hard
 

795
00:17:24,160 --> 00:17:27,350
similar. So at that time it's very hard
to distinguish. So the to make the

796
00:17:27,350 --> 00:17:27,360
to distinguish. So the to make the
 

797
00:17:27,360 --> 00:17:31,590
to distinguish. So the to make the
difference between Q and K it's

798
00:17:31,590 --> 00:17:31,600
difference between Q and K it's
 

799
00:17:31,600 --> 00:17:32,070
difference between Q and K it's
so

800
00:17:32,070 --> 00:17:32,080
so
 

801
00:17:32,080 --> 00:17:34,310
so
>> so the sizes of these things are all the

802
00:17:34,310 --> 00:17:34,320
>> so the sizes of these things are all the
 

803
00:17:34,320 --> 00:17:37,110
>> so the sizes of these things are all the
same right. So conceptually the

804
00:17:37,110 --> 00:17:37,120
same right. So conceptually the
 

805
00:17:37,120 --> 00:17:38,470
same right. So conceptually the
difference between the queries and the

806
00:17:38,470 --> 00:17:38,480
difference between the queries and the
 

807
00:17:38,480 --> 00:17:41,270
difference between the queries and the
keys is in some sense all conceptual

808
00:17:41,270 --> 00:17:41,280
keys is in some sense all conceptual
 

809
00:17:41,280 --> 00:17:44,789
keys is in some sense all conceptual
because the query is

810
00:17:44,789 --> 00:17:44,799
because the query is
 

811
00:17:44,799 --> 00:17:47,830
because the query is
like what is looking for attention and

812
00:17:47,830 --> 00:17:47,840
like what is looking for attention and
 

813
00:17:47,840 --> 00:17:49,430
like what is looking for attention and
the keys are telling you where to give

814
00:17:49,430 --> 00:17:49,440
the keys are telling you where to give
 

815
00:17:49,440 --> 00:17:51,909
the keys are telling you where to give
attention to.

816
00:17:51,909 --> 00:17:51,919
attention to.
 

817
00:17:51,919 --> 00:17:53,430
attention to.
The queries are the questions, right?

818
00:17:53,430 --> 00:17:53,440
The queries are the questions, right?
 

819
00:17:53,440 --> 00:17:57,590
The queries are the questions, right?
They're the queries. Um but they they're

820
00:17:57,590 --> 00:17:57,600
They're the queries. Um but they they're
 

821
00:17:57,600 --> 00:18:00,390
They're the queries. Um but they they're
they're all representations of the

822
00:18:00,390 --> 00:18:00,400
they're all representations of the
 

823
00:18:00,400 --> 00:18:02,870
they're all representations of the
input.

824
00:18:02,870 --> 00:18:02,880
input.
 

825
00:18:02,880 --> 00:18:04,310
input.
Uh but they're trying to do different

826
00:18:04,310 --> 00:18:04,320
Uh but they're trying to do different
 

827
00:18:04,320 --> 00:18:06,310
Uh but they're trying to do different
things and they're they're they they are

828
00:18:06,310 --> 00:18:06,320
things and they're they're they they are
 

829
00:18:06,320 --> 00:18:09,270
things and they're they're they they are
different in that sense.

830
00:18:09,270 --> 00:18:09,280
different in that sense.
 

831
00:18:09,280 --> 00:18:11,110
different in that sense.
>> Yeah. Yes.

832
00:18:11,110 --> 00:18:11,120
>> Yeah. Yes.
 

833
00:18:11,120 --> 00:18:14,150
>> Yeah. Yes.
>> Um as for D so like with multi head

834
00:18:14,150 --> 00:18:14,160
>> Um as for D so like with multi head
 

835
00:18:14,160 --> 00:18:15,750
>> Um as for D so like with multi head
attention are there just going to be

836
00:18:15,750 --> 00:18:15,760
attention are there just going to be
 

837
00:18:15,760 --> 00:18:17,110
attention are there just going to be
like different embedding sizes

838
00:18:17,110 --> 00:18:17,120
like different embedding sizes
 

839
00:18:17,120 --> 00:18:18,549
like different embedding sizes
basically?

840
00:18:18,549 --> 00:18:18,559
basically?
 

841
00:18:18,559 --> 00:18:20,230
basically?
>> Okay. So yeah let's go to multi head

842
00:18:20,230 --> 00:18:20,240
>> Okay. So yeah let's go to multi head
 

843
00:18:20,240 --> 00:18:23,350
>> Okay. So yeah let's go to multi head
attention. So multi head attention what

844
00:18:23,350 --> 00:18:23,360
attention. So multi head attention what
 

845
00:18:23,360 --> 00:18:27,909
attention. So multi head attention what
we're saying is look in practice it

846
00:18:27,909 --> 00:18:27,919
we're saying is look in practice it
 

847
00:18:27,919 --> 00:18:31,669
we're saying is look in practice it
turns out that there is value to having

848
00:18:31,669 --> 00:18:31,679
turns out that there is value to having
 

849
00:18:31,679 --> 00:18:34,310
turns out that there is value to having
many different kinds of information that

850
00:18:34,310 --> 00:18:34,320
many different kinds of information that
 

851
00:18:34,320 --> 00:18:36,070
many different kinds of information that
one might want to process right so there

852
00:18:36,070 --> 00:18:36,080
one might want to process right so there
 

853
00:18:36,080 --> 00:18:39,029
one might want to process right so there
might be some attention that you want to

854
00:18:39,029 --> 00:18:39,039
might be some attention that you want to
 

855
00:18:39,039 --> 00:18:42,470
might be some attention that you want to
give in certain

856
00:18:42,470 --> 00:18:42,480
give in certain
 

857
00:18:42,480 --> 00:18:44,549
give in certain
um is you might you just want to be able

858
00:18:44,549 --> 00:18:44,559
um is you might you just want to be able
 

859
00:18:44,559 --> 00:18:46,230
um is you might you just want to be able
to differentiate different kinds of

860
00:18:46,230 --> 00:18:46,240
to differentiate different kinds of
 

861
00:18:46,240 --> 00:18:49,110
to differentiate different kinds of
information

862
00:18:49,110 --> 00:18:49,120
information
 

863
00:18:49,120 --> 00:18:51,590
information
so if I look at this input What I'm

864
00:18:51,590 --> 00:18:51,600
so if I look at this input What I'm
 

865
00:18:51,600 --> 00:18:54,630
so if I look at this input What I'm
doing is I'm giving it opportunity. So

866
00:18:54,630 --> 00:18:54,640
doing is I'm giving it opportunity. So
 

867
00:18:54,640 --> 00:18:57,430
doing is I'm giving it opportunity. So
if I generate like this is this is a

868
00:18:57,430 --> 00:18:57,440
if I generate like this is this is a
 

869
00:18:57,440 --> 00:18:59,190
if I generate like this is this is a
query related to this input that is also

870
00:18:59,190 --> 00:18:59,200
query related to this input that is also
 

871
00:18:59,200 --> 00:19:01,830
query related to this input that is also
a query related to this input.

872
00:19:01,830 --> 00:19:01,840
a query related to this input.
 

873
00:19:01,840 --> 00:19:04,630
a query related to this input.
This query might want to look at

874
00:19:04,630 --> 00:19:04,640
This query might want to look at
 

875
00:19:04,640 --> 00:19:08,390
This query might want to look at
different parts of the past or or or my

876
00:19:08,390 --> 00:19:08,400
different parts of the past or or or my
 

877
00:19:08,400 --> 00:19:10,630
different parts of the past or or or my
or my neighbors in my context compared

878
00:19:10,630 --> 00:19:10,640
or my neighbors in my context compared
 

879
00:19:10,640 --> 00:19:14,230
or my neighbors in my context compared
to that query. I'm allowing myself basic

880
00:19:14,230 --> 00:19:14,240
to that query. I'm allowing myself basic
 

881
00:19:14,240 --> 00:19:17,029
to that query. I'm allowing myself basic
to basically to look at different things

882
00:19:17,029 --> 00:19:17,039
to basically to look at different things
 

883
00:19:17,039 --> 00:19:21,590
to basically to look at different things
by having different attention heads.

884
00:19:21,590 --> 00:19:21,600
by having different attention heads.
 

885
00:19:21,600 --> 00:19:23,350
by having different attention heads.
And the important thing to remember is

886
00:19:23,350 --> 00:19:23,360
And the important thing to remember is
 

887
00:19:23,360 --> 00:19:26,310
And the important thing to remember is
that I'm going it's important that

888
00:19:26,310 --> 00:19:26,320
that I'm going it's important that
 

889
00:19:26,320 --> 00:19:28,230
that I'm going it's important that
whatever my attention does right

890
00:19:28,230 --> 00:19:28,240
whatever my attention does right
 

891
00:19:28,240 --> 00:19:31,029
whatever my attention does right
whatever the size of the input is the

892
00:19:31,029 --> 00:19:31,039
whatever the size of the input is the
 

893
00:19:31,039 --> 00:19:34,150
whatever the size of the input is the
output had better be the same size. One

894
00:19:34,150 --> 00:19:34,160
output had better be the same size. One
 

895
00:19:34,160 --> 00:19:35,590
output had better be the same size. One
simple reason for this is that you want

896
00:19:35,590 --> 00:19:35,600
simple reason for this is that you want
 

897
00:19:35,600 --> 00:19:38,230
simple reason for this is that you want
to add a residual connection. So you

898
00:19:38,230 --> 00:19:38,240
to add a residual connection. So you
 

899
00:19:38,240 --> 00:19:40,310
to add a residual connection. So you
want to come have the input come and add

900
00:19:40,310 --> 00:19:40,320
want to come have the input come and add
 

901
00:19:40,320 --> 00:19:43,029
want to come have the input come and add
itself in again. And for that to work

902
00:19:43,029 --> 00:19:43,039
itself in again. And for that to work
 

903
00:19:43,039 --> 00:19:45,029
itself in again. And for that to work
the shapes have to match. Okay. That's

904
00:19:45,029 --> 00:19:45,039
the shapes have to match. Okay. That's
 

905
00:19:45,039 --> 00:19:47,590
the shapes have to match. Okay. That's
one simple reason.

906
00:19:47,590 --> 00:19:47,600
one simple reason.
 

907
00:19:47,600 --> 00:19:49,990
one simple reason.
So if you want to have this output be

908
00:19:49,990 --> 00:19:50,000
So if you want to have this output be
 

909
00:19:50,000 --> 00:19:52,870
So if you want to have this output be
the exact same size,

910
00:19:52,870 --> 00:19:52,880
the exact same size,
 

911
00:19:52,880 --> 00:19:54,549
the exact same size,
there's only so many degrees of freedom

912
00:19:54,549 --> 00:19:54,559
there's only so many degrees of freedom
 

913
00:19:54,559 --> 00:19:55,990
there's only so many degrees of freedom
that you have in terms of how to

914
00:19:55,990 --> 00:19:56,000
that you have in terms of how to
 

915
00:19:56,000 --> 00:19:58,150
that you have in terms of how to
distribute your your resources or your

916
00:19:58,150 --> 00:19:58,160
distribute your your resources or your
 

917
00:19:58,160 --> 00:20:00,710
distribute your your resources or your
your um I don't want to use the word

918
00:20:00,710 --> 00:20:00,720
your um I don't want to use the word
 

919
00:20:00,720 --> 00:20:02,710
your um I don't want to use the word
attention, but

920
00:20:02,710 --> 00:20:02,720
attention, but
 

921
00:20:02,720 --> 00:20:07,029
attention, but
um and so one way is to say that if I do

922
00:20:07,029 --> 00:20:07,039
um and so one way is to say that if I do
 

923
00:20:07,039 --> 00:20:09,430
um and so one way is to say that if I do
multi-head attention, I'm going to give

924
00:20:09,430 --> 00:20:09,440
multi-head attention, I'm going to give
 

925
00:20:09,440 --> 00:20:11,430
multi-head attention, I'm going to give
you know if I have let's say if I do two

926
00:20:11,430 --> 00:20:11,440
you know if I have let's say if I do two
 

927
00:20:11,440 --> 00:20:13,990
you know if I have let's say if I do two
head attention, I'm going to give

928
00:20:13,990 --> 00:20:14,000
head attention, I'm going to give
 

929
00:20:14,000 --> 00:20:17,990
head attention, I'm going to give
half of the uh channels to this guy and

930
00:20:17,990 --> 00:20:18,000
half of the uh channels to this guy and
 

931
00:20:18,000 --> 00:20:21,510
half of the uh channels to this guy and
half of the channels to this head.

932
00:20:21,510 --> 00:20:21,520
half of the channels to this head.
 

933
00:20:21,520 --> 00:20:23,029
half of the channels to this head.
You could do it some other way, but the

934
00:20:23,029 --> 00:20:23,039
You could do it some other way, but the
 

935
00:20:23,039 --> 00:20:24,310
You could do it some other way, but the
standard way is to just distribute them

936
00:20:24,310 --> 00:20:24,320
standard way is to just distribute them
 

937
00:20:24,320 --> 00:20:26,950
standard way is to just distribute them
all evenly.

938
00:20:26,950 --> 00:20:26,960
all evenly.
 

939
00:20:26,960 --> 00:20:32,630
all evenly.
Okay?

940
00:20:32,630 --> 00:20:32,640

 

941
00:20:32,640 --> 00:20:34,470

And n is basically the number of my

942
00:20:34,470 --> 00:20:34,480
And n is basically the number of my
 

943
00:20:34,480 --> 00:20:35,830
And n is basically the number of my
inputs, right? So the important thing is

944
00:20:35,830 --> 00:20:35,840
inputs, right? So the important thing is
 

945
00:20:35,840 --> 00:20:40,310
inputs, right? So the important thing is
that this attention matrix is is n byn.

946
00:20:40,310 --> 00:20:40,320
that this attention matrix is is n byn.
 

947
00:20:40,320 --> 00:20:42,070
that this attention matrix is is n byn.
So that this this works out and you get

948
00:20:42,070 --> 00:20:42,080
So that this this works out and you get
 

949
00:20:42,080 --> 00:20:44,390
So that this this works out and you get
this and then you just concatenate

950
00:20:44,390 --> 00:20:44,400
this and then you just concatenate
 

951
00:20:44,400 --> 00:20:47,110
this and then you just concatenate
these. So you can have, you know, this

952
00:20:47,110 --> 00:20:47,120
these. So you can have, you know, this
 

953
00:20:47,120 --> 00:20:48,950
these. So you can have, you know, this
is looking at like the pink stuff. This

954
00:20:48,950 --> 00:20:48,960
is looking at like the pink stuff. This
 

955
00:20:48,960 --> 00:20:50,310
is looking at like the pink stuff. This
is looking at the yellow stuff. This is

956
00:20:50,310 --> 00:20:50,320
is looking at the yellow stuff. This is
 

957
00:20:50,320 --> 00:20:51,990
is looking at the yellow stuff. This is
looking at each of these is having their

958
00:20:51,990 --> 00:20:52,000
looking at each of these is having their
 

959
00:20:52,000 --> 00:20:54,789
looking at each of these is having their
own separate stuff that they're trying

960
00:20:54,789 --> 00:20:54,799
own separate stuff that they're trying
 

961
00:20:54,799 --> 00:20:56,710
own separate stuff that they're trying
to look at.

962
00:20:56,710 --> 00:20:56,720
to look at.
 

963
00:20:56,720 --> 00:20:57,350
to look at.
>> Yes.

964
00:20:57,350 --> 00:20:57,360
>> Yes.
 

965
00:20:57,360 --> 00:20:59,590
>> Yes.
>> What is like the difference for having

966
00:20:59,590 --> 00:20:59,600
>> What is like the difference for having
 

967
00:20:59,600 --> 00:21:03,590
>> What is like the difference for having
like two head and two head attention but

968
00:21:03,590 --> 00:21:03,600
like two head and two head attention but
 

969
00:21:03,600 --> 00:21:05,750
like two head and two head attention but
like each one has like a thousand point

970
00:21:05,750 --> 00:21:05,760
like each one has like a thousand point
 

971
00:21:05,760 --> 00:21:08,630
like each one has like a thousand point
then like having one concentrated like

972
00:21:08,630 --> 00:21:08,640
then like having one concentrated like
 

973
00:21:08,640 --> 00:21:12,070
then like having one concentrated like
20 20 48

974
00:21:12,070 --> 00:21:12,080
20 20 48
 

975
00:21:12,080 --> 00:21:14,470
20 20 48
attention. So if I if I had all of these

976
00:21:14,470 --> 00:21:14,480
attention. So if I if I had all of these
 

977
00:21:14,480 --> 00:21:17,270
attention. So if I if I had all of these
combined into a picture like this,

978
00:21:17,270 --> 00:21:17,280
combined into a picture like this,
 

979
00:21:17,280 --> 00:21:21,510
combined into a picture like this,
right? Then

980
00:21:21,510 --> 00:21:21,520

 

981
00:21:21,520 --> 00:21:24,070

I'm only basically I'm not allowing the

982
00:21:24,070 --> 00:21:24,080
I'm only basically I'm not allowing the
 

983
00:21:24,080 --> 00:21:26,789
I'm only basically I'm not allowing the
different channels that I have. So every

984
00:21:26,789 --> 00:21:26,799
different channels that I have. So every
 

985
00:21:26,799 --> 00:21:30,070
different channels that I have. So every
you know I have I have multiple channels

986
00:21:30,070 --> 00:21:30,080
you know I have I have multiple channels
 

987
00:21:30,080 --> 00:21:32,549
you know I have I have multiple channels
per

988
00:21:32,549 --> 00:21:32,559
per
 

989
00:21:32,559 --> 00:21:35,430
per
uh per input token

990
00:21:35,430 --> 00:21:35,440
uh per input token
 

991
00:21:35,440 --> 00:21:37,990
uh per input token
and by having multi head attention I'm

992
00:21:37,990 --> 00:21:38,000
and by having multi head attention I'm
 

993
00:21:38,000 --> 00:21:40,310
and by having multi head attention I'm
allowing different parts of that

994
00:21:40,310 --> 00:21:40,320
allowing different parts of that
 

995
00:21:40,320 --> 00:21:42,950
allowing different parts of that
embedding vector to focus on possibly

996
00:21:42,950 --> 00:21:42,960
embedding vector to focus on possibly
 

997
00:21:42,960 --> 00:21:44,950
embedding vector to focus on possibly
different things

998
00:21:44,950 --> 00:21:44,960
different things
 

999
00:21:44,960 --> 00:21:47,270
different things
right I have a24 dimensions where I can

1000
00:21:47,270 --> 00:21:47,280
right I have a24 dimensions where I can
 

1001
00:21:47,280 --> 00:21:49,830
right I have a24 dimensions where I can
store information

1002
00:21:49,830 --> 00:21:49,840
store information
 

1003
00:21:49,840 --> 00:21:53,110
store information
and if all 24 of those dimensions said

1004
00:21:53,110 --> 00:21:53,120
and if all 24 of those dimensions said
 

1005
00:21:53,120 --> 00:21:55,190
and if all 24 of those dimensions said
that okay you have to pay attention to

1006
00:21:55,190 --> 00:21:55,200
that okay you have to pay attention to
 

1007
00:21:55,200 --> 00:21:58,230
that okay you have to pay attention to
the third and the eighth token

1008
00:21:58,230 --> 00:21:58,240
the third and the eighth token
 

1009
00:21:58,240 --> 00:22:00,070
the third and the eighth token
because that's how my attention matrix

1010
00:22:00,070 --> 00:22:00,080
because that's how my attention matrix
 

1011
00:22:00,080 --> 00:22:02,950
because that's how my attention matrix
worked out. Then all of those will have

1012
00:22:02,950 --> 00:22:02,960
worked out. Then all of those will have
 

1013
00:22:02,960 --> 00:22:04,230
worked out. Then all of those will have
to do this. But what this allows you to

1014
00:22:04,230 --> 00:22:04,240
to do this. But what this allows you to
 

1015
00:22:04,240 --> 00:22:09,750
to do this. But what this allows you to
do is that I can have um this like I can

1016
00:22:09,750 --> 00:22:09,760
do is that I can have um this like I can
 

1017
00:22:09,760 --> 00:22:12,549
do is that I can have um this like I can
say that okay the first 10 channels you

1018
00:22:12,549 --> 00:22:12,559
say that okay the first 10 channels you
 

1019
00:22:12,559 --> 00:22:14,310
say that okay the first 10 channels you
pay attention to the third tok to token

1020
00:22:14,310 --> 00:22:14,320
pay attention to the third tok to token
 

1021
00:22:14,320 --> 00:22:15,909
pay attention to the third tok to token
and then the next 10 channels you pay

1022
00:22:15,909 --> 00:22:15,919
and then the next 10 channels you pay
 

1023
00:22:15,919 --> 00:22:17,270
and then the next 10 channels you pay
attention to the eighth token and the

1024
00:22:17,270 --> 00:22:17,280
attention to the eighth token and the
 

1025
00:22:17,280 --> 00:22:18,710
attention to the eighth token and the
next 10 channels you pay attention to

1026
00:22:18,710 --> 00:22:18,720
next 10 channels you pay attention to
 

1027
00:22:18,720 --> 00:22:22,070
next 10 channels you pay attention to
the 25th token and you can do these kind

1028
00:22:22,070 --> 00:22:22,080
the 25th token and you can do these kind
 

1029
00:22:22,080 --> 00:22:24,549
the 25th token and you can do these kind
of different different things. things.

1030
00:22:24,549 --> 00:22:24,559
of different different things. things.
 

1031
00:22:24,559 --> 00:22:25,990
of different different things. things.
It allows you to have a finer

1032
00:22:25,990 --> 00:22:26,000
It allows you to have a finer
 

1033
00:22:26,000 --> 00:22:28,710
It allows you to have a finer
granularity of representation of

1034
00:22:28,710 --> 00:22:28,720
granularity of representation of
 

1035
00:22:28,720 --> 00:22:30,470
granularity of representation of
information within that embedding

1036
00:22:30,470 --> 00:22:30,480
information within that embedding
 

1037
00:22:30,480 --> 00:22:32,789
information within that embedding
dimension within your channels. That's

1038
00:22:32,789 --> 00:22:32,799
dimension within your channels. That's
 

1039
00:22:32,799 --> 00:22:35,029
dimension within your channels. That's
what this these multi heads get by you

1040
00:22:35,029 --> 00:22:35,039
what this these multi heads get by you
 

1041
00:22:35,039 --> 00:22:37,110
what this these multi heads get by you
as opposed to just one thing where you

1042
00:22:37,110 --> 00:22:37,120
as opposed to just one thing where you
 

1043
00:22:37,120 --> 00:22:38,470
as opposed to just one thing where you
have all those dimensions but they're

1044
00:22:38,470 --> 00:22:38,480
have all those dimensions but they're
 

1045
00:22:38,480 --> 00:22:41,590
have all those dimensions but they're
all doing the same thing.

1046
00:22:41,590 --> 00:22:41,600
all doing the same thing.
 

1047
00:22:41,600 --> 00:22:42,950
all doing the same thing.
Does that Yeah.

1048
00:22:42,950 --> 00:22:42,960
Does that Yeah.
 

1049
00:22:42,960 --> 00:22:45,350
Does that Yeah.
>> Is there a convention around like how

1050
00:22:45,350 --> 00:22:45,360
>> Is there a convention around like how
 

1051
00:22:45,360 --> 00:22:47,510
>> Is there a convention around like how
many heads you want to have in your

1052
00:22:47,510 --> 00:22:47,520
many heads you want to have in your
 

1053
00:22:47,520 --> 00:22:48,950
many heads you want to have in your
multi head attention or is that just

1054
00:22:48,950 --> 00:22:48,960
multi head attention or is that just
 

1055
00:22:48,960 --> 00:22:51,029
multi head attention or is that just
sort of like a hyperparameter you mess

1056
00:22:51,029 --> 00:22:51,039
sort of like a hyperparameter you mess
 

1057
00:22:51,039 --> 00:22:53,270
sort of like a hyperparameter you mess
with for a while? I think that that's

1058
00:22:53,270 --> 00:22:53,280
with for a while? I think that that's
 

1059
00:22:53,280 --> 00:22:55,590
with for a while? I think that that's
just a hyperparameter you mess with for

1060
00:22:55,590 --> 00:22:55,600
just a hyperparameter you mess with for
 

1061
00:22:55,600 --> 00:22:58,710
just a hyperparameter you mess with for
a while. People have tried different

1062
00:22:58,710 --> 00:22:58,720
a while. People have tried different
 

1063
00:22:58,720 --> 00:23:01,270
a while. People have tried different
things and intuitively there's a

1064
00:23:01,270 --> 00:23:01,280
things and intuitively there's a
 

1065
00:23:01,280 --> 00:23:03,510
things and intuitively there's a
trade-off between like just spreading

1066
00:23:03,510 --> 00:23:03,520
trade-off between like just spreading
 

1067
00:23:03,520 --> 00:23:06,310
trade-off between like just spreading
too thin versus and not having enough

1068
00:23:06,310 --> 00:23:06,320
too thin versus and not having enough
 

1069
00:23:06,320 --> 00:23:08,549
too thin versus and not having enough
representational capacity versus

1070
00:23:08,549 --> 00:23:08,559
representational capacity versus
 

1071
00:23:08,559 --> 00:23:10,230
representational capacity versus
collapsing everything into one thing and

1072
00:23:10,230 --> 00:23:10,240
collapsing everything into one thing and
 

1073
00:23:10,240 --> 00:23:14,310
collapsing everything into one thing and
like losing things to averaging. So um I

1074
00:23:14,310 --> 00:23:14,320
like losing things to averaging. So um I
 

1075
00:23:14,320 --> 00:23:15,990
like losing things to averaging. So um I
don't know if there's any obvious rules

1076
00:23:15,990 --> 00:23:16,000
don't know if there's any obvious rules
 

1077
00:23:16,000 --> 00:23:18,950
don't know if there's any obvious rules
of thumb of what to do

1078
00:23:18,950 --> 00:23:18,960
of thumb of what to do
 

1079
00:23:18,960 --> 00:23:20,789
of thumb of what to do
but I am going to try and talk about

1080
00:23:20,789 --> 00:23:20,799
but I am going to try and talk about
 

1081
00:23:20,799 --> 00:23:22,789
but I am going to try and talk about
different architectures in the next

1082
00:23:22,789 --> 00:23:22,799
different architectures in the next
 

1083
00:23:22,799 --> 00:23:24,630
different architectures in the next
lecture. So maybe by next lecture I will

1084
00:23:24,630 --> 00:23:24,640
lecture. So maybe by next lecture I will
 

1085
00:23:24,640 --> 00:23:26,950
lecture. So maybe by next lecture I will
have a better answer to that. Yes.

1086
00:23:26,950 --> 00:23:26,960
have a better answer to that. Yes.
 

1087
00:23:26,960 --> 00:23:29,830
have a better answer to that. Yes.
>> Uh when you do the concatenation for

1088
00:23:29,830 --> 00:23:29,840
>> Uh when you do the concatenation for
 

1089
00:23:29,840 --> 00:23:32,310
>> Uh when you do the concatenation for
multi head does the order matters? Which

1090
00:23:32,310 --> 00:23:32,320
multi head does the order matters? Which
 

1091
00:23:32,320 --> 00:23:33,590
multi head does the order matters? Which
one is on top? Which one is

1092
00:23:33,590 --> 00:23:33,600
one is on top? Which one is
 

1093
00:23:33,600 --> 00:23:35,110
one is on top? Which one is
>> when you do the concatenation for multi

1094
00:23:35,110 --> 00:23:35,120
>> when you do the concatenation for multi
 

1095
00:23:35,120 --> 00:23:36,710
>> when you do the concatenation for multi
head? It does matter. You want to have

1096
00:23:36,710 --> 00:23:36,720
head? It does matter. You want to have
 

1097
00:23:36,720 --> 00:23:38,310
head? It does matter. You want to have
kind of you want to preserve the

1098
00:23:38,310 --> 00:23:38,320
kind of you want to preserve the
 

1099
00:23:38,320 --> 00:23:40,549
kind of you want to preserve the
ordering. you're not going to mix up the

1100
00:23:40,549 --> 00:23:40,559
ordering. you're not going to mix up the
 

1101
00:23:40,559 --> 00:23:42,789
ordering. you're not going to mix up the
ordering because you want to I mean one

1102
00:23:42,789 --> 00:23:42,799
ordering because you want to I mean one
 

1103
00:23:42,799 --> 00:23:44,630
ordering because you want to I mean one
way to think about it is that you're we

1104
00:23:44,630 --> 00:23:44,640
way to think about it is that you're we
 

1105
00:23:44,640 --> 00:23:46,230
way to think about it is that you're we
have this intuition in convolutional

1106
00:23:46,230 --> 00:23:46,240
have this intuition in convolutional
 

1107
00:23:46,240 --> 00:23:49,270
have this intuition in convolutional
neural nets of like uh channel-wise

1108
00:23:49,270 --> 00:23:49,280
neural nets of like uh channel-wise
 

1109
00:23:49,280 --> 00:23:50,710
neural nets of like uh channel-wise
convolutions right or depthwise

1110
00:23:50,710 --> 00:23:50,720
convolutions right or depthwise
 

1111
00:23:50,720 --> 00:23:53,029
convolutions right or depthwise
convolutions so like you can have one

1112
00:23:53,029 --> 00:23:53,039
convolutions so like you can have one
 

1113
00:23:53,039 --> 00:23:55,190
convolutions so like you can have one
channel of information and if it it

1114
00:23:55,190 --> 00:23:55,200
channel of information and if it it
 

1115
00:23:55,200 --> 00:24:01,750
channel of information and if it it
keeps process like it's doing its thing

1116
00:24:01,750 --> 00:24:01,760

 

1117
00:24:01,760 --> 00:24:02,470

>> yes

1118
00:24:02,470 --> 00:24:02,480
>> yes
 

1119
00:24:02,480 --> 00:24:04,870
>> yes
>> so when you are multi do you split the

1120
00:24:04,870 --> 00:24:04,880
>> so when you are multi do you split the
 

1121
00:24:04,880 --> 00:24:06,710
>> so when you are multi do you split the
input like do you

1122
00:24:06,710 --> 00:24:06,720
input like do you
 

1123
00:24:06,720 --> 00:24:08,390
input like do you
>> yes so I'm splitting the input I'm

1124
00:24:08,390 --> 00:24:08,400
>> yes so I'm splitting the input I'm
 

1125
00:24:08,400 --> 00:24:12,149
>> yes so I'm splitting the input I'm
literally saying look

1126
00:24:12,149 --> 00:24:12,159
literally saying look
 

1127
00:24:12,159 --> 00:24:14,149
literally saying look
this is my input this is my D this is my

1128
00:24:14,149 --> 00:24:14,159
this is my input this is my D this is my
 

1129
00:24:14,159 --> 00:24:17,510
this is my input this is my D this is my
embedding position this is 1 124 okay

1130
00:24:17,510 --> 00:24:17,520
embedding position this is 1 124 okay
 

1131
00:24:17,520 --> 00:24:20,470
embedding position this is 1 124 okay
I'm going to send 512 of you to this

1132
00:24:20,470 --> 00:24:20,480
I'm going to send 512 of you to this
 

1133
00:24:20,480 --> 00:24:22,950
I'm going to send 512 of you to this
attention head and 512 of you to this

1134
00:24:22,950 --> 00:24:22,960
attention head and 512 of you to this
 

1135
00:24:22,960 --> 00:24:25,269
attention head and 512 of you to this
attention head each of you are going to

1136
00:24:25,269 --> 00:24:25,279
attention head each of you are going to
 

1137
00:24:25,279 --> 00:24:27,430
attention head each of you are going to
produce 512

1138
00:24:27,430 --> 00:24:27,440
produce 512
 

1139
00:24:27,440 --> 00:24:30,070
produce 512
components and then I'm going to

1140
00:24:30,070 --> 00:24:30,080
components and then I'm going to
 

1141
00:24:30,080 --> 00:24:31,909
components and then I'm going to
concatenate those together to get my

1142
00:24:31,909 --> 00:24:31,919
concatenate those together to get my
 

1143
00:24:31,919 --> 00:24:35,269
concatenate those together to get my
output

1144
00:24:35,269 --> 00:24:35,279

 

1145
00:24:35,279 --> 00:24:38,630

does that make sense

1146
00:24:38,630 --> 00:24:38,640

 

1147
00:24:38,640 --> 00:24:39,990

Yes. Uh

1148
00:24:39,990 --> 00:24:40,000
Yes. Uh
 

1149
00:24:40,000 --> 00:24:43,110
Yes. Uh
>> wouldn't it be better to like just allow

1150
00:24:43,110 --> 00:24:43,120
>> wouldn't it be better to like just allow
 

1151
00:24:43,120 --> 00:24:44,950
>> wouldn't it be better to like just allow
all of our heads to like look at the

1152
00:24:44,950 --> 00:24:44,960
all of our heads to like look at the
 

1153
00:24:44,960 --> 00:24:47,269
all of our heads to like look at the
entire input and they can like choose

1154
00:24:47,269 --> 00:24:47,279
entire input and they can like choose
 

1155
00:24:47,279 --> 00:24:49,350
entire input and they can like choose
which parts of the input to look at?

1156
00:24:49,350 --> 00:24:49,360
which parts of the input to look at?
 

1157
00:24:49,360 --> 00:24:51,750
which parts of the input to look at?
Wouldn't it be better to allow ah so

1158
00:24:51,750 --> 00:24:51,760
Wouldn't it be better to allow ah so
 

1159
00:24:51,760 --> 00:24:54,549
Wouldn't it be better to allow ah so
you're saying that instead of having you

1160
00:24:54,549 --> 00:24:54,559
you're saying that instead of having you
 

1161
00:24:54,559 --> 00:24:57,590
you're saying that instead of having you
know having this d over 2d over2 just

1162
00:24:57,590 --> 00:24:57,600
know having this d over 2d over2 just
 

1163
00:24:57,600 --> 00:25:00,070
know having this d over 2d over2 just
have a dlength attention head here and d

1164
00:25:00,070 --> 00:25:00,080
have a dlength attention head here and d
 

1165
00:25:00,080 --> 00:25:01,750
have a dlength attention head here and d
here and d here and d here look at the

1166
00:25:01,750 --> 00:25:01,760
here and d here and d here look at the
 

1167
00:25:01,760 --> 00:25:03,190
here and d here and d here look at the
whole thing and just have many many

1168
00:25:03,190 --> 00:25:03,200
whole thing and just have many many
 

1169
00:25:03,200 --> 00:25:05,750
whole thing and just have many many
attention heads that are all looking at

1170
00:25:05,750 --> 00:25:05,760
attention heads that are all looking at
 

1171
00:25:05,760 --> 00:25:07,350
attention heads that are all looking at
the entire vector as opposed to just

1172
00:25:07,350 --> 00:25:07,360
the entire vector as opposed to just
 

1173
00:25:07,360 --> 00:25:08,149
the entire vector as opposed to just
half of the vector.

1174
00:25:08,149 --> 00:25:08,159
half of the vector.
 

1175
00:25:08,159 --> 00:25:09,750
half of the vector.
>> So so the output that they're giving is

1176
00:25:09,750 --> 00:25:09,760
>> So so the output that they're giving is
 

1177
00:25:09,760 --> 00:25:11,590
>> So so the output that they're giving is
still d over h but

1178
00:25:11,590 --> 00:25:11,600
still d over h but
 

1179
00:25:11,600 --> 00:25:13,510
still d over h but
>> but they're looking at half of it. So

1180
00:25:13,510 --> 00:25:13,520
>> but they're looking at half of it. So
 

1181
00:25:13,520 --> 00:25:16,310
>> but they're looking at half of it. So
looking at the whole thing that would

1182
00:25:16,310 --> 00:25:16,320
looking at the whole thing that would
 

1183
00:25:16,320 --> 00:25:17,990
looking at the whole thing that would
make that I I can see how that would

1184
00:25:17,990 --> 00:25:18,000
make that I I can see how that would
 

1185
00:25:18,000 --> 00:25:19,269
make that I I can see how that would
make sense. One of the reasons to do

1186
00:25:19,269 --> 00:25:19,279
make sense. One of the reasons to do
 

1187
00:25:19,279 --> 00:25:22,230
make sense. One of the reasons to do
this is computational efficiency like

1188
00:25:22,230 --> 00:25:22,240
this is computational efficiency like
 

1189
00:25:22,240 --> 00:25:23,350
this is computational efficiency like
you know that then you have bigger

1190
00:25:23,350 --> 00:25:23,360
you know that then you have bigger
 

1191
00:25:23,360 --> 00:25:24,950
you know that then you have bigger
matrix multiplies you have more stuff to

1192
00:25:24,950 --> 00:25:24,960
matrix multiplies you have more stuff to
 

1193
00:25:24,960 --> 00:25:27,909
matrix multiplies you have more stuff to
do. So one like one motivation for

1194
00:25:27,909 --> 00:25:27,919
do. So one like one motivation for
 

1195
00:25:27,919 --> 00:25:29,750
do. So one like one motivation for
splitting this is so that you're you're

1196
00:25:29,750 --> 00:25:29,760
splitting this is so that you're you're
 

1197
00:25:29,760 --> 00:25:31,909
splitting this is so that you're you're
kind of keeping the total computation

1198
00:25:31,909 --> 00:25:31,919
kind of keeping the total computation
 

1199
00:25:31,919 --> 00:25:34,230
kind of keeping the total computation
the same.

1200
00:25:34,230 --> 00:25:34,240
the same.
 

1201
00:25:34,240 --> 00:25:36,310
the same.
Uh

1202
00:25:36,310 --> 00:25:36,320
Uh
 

1203
00:25:36,320 --> 00:25:38,149
Uh
so it's an easier it's an easier apples

1204
00:25:38,149 --> 00:25:38,159
so it's an easier it's an easier apples
 

1205
00:25:38,159 --> 00:25:40,789
so it's an easier it's an easier apples
to apples comparison.

1206
00:25:40,789 --> 00:25:40,799
to apples comparison.
 

1207
00:25:40,799 --> 00:25:43,190
to apples comparison.
Yeah

1208
00:25:43,190 --> 00:25:43,200
Yeah
 

1209
00:25:43,200 --> 00:25:44,870
Yeah
but you it makes sense that if you had

1210
00:25:44,870 --> 00:25:44,880
but you it makes sense that if you had
 

1211
00:25:44,880 --> 00:25:47,110
but you it makes sense that if you had
more stuff you could you could do that.

1212
00:25:47,110 --> 00:25:47,120
more stuff you could you could do that.
 

1213
00:25:47,120 --> 00:25:49,510
more stuff you could you could do that.
>> Yes. I had was also that by splitting

1214
00:25:49,510 --> 00:25:49,520
>> Yes. I had was also that by splitting
 

1215
00:25:49,520 --> 00:25:51,350
>> Yes. I had was also that by splitting
the multi head you introduce like an

1216
00:25:51,350 --> 00:25:51,360
the multi head you introduce like an
 

1217
00:25:51,360 --> 00:25:53,510
the multi head you introduce like an
inductive bias towards specialization

1218
00:25:53,510 --> 00:25:53,520
inductive bias towards specialization
 

1219
00:25:53,520 --> 00:25:55,190
inductive bias towards specialization
right which because I think what he's

1220
00:25:55,190 --> 00:25:55,200
right which because I think what he's
 

1221
00:25:55,200 --> 00:25:57,029
right which because I think what he's
describing is what you just get if you

1222
00:25:57,029 --> 00:25:57,039
describing is what you just get if you
 

1223
00:25:57,039 --> 00:25:59,669
describing is what you just get if you
have a single big attention right is it

1224
00:25:59,669 --> 00:25:59,679
have a single big attention right is it
 

1225
00:25:59,679 --> 00:26:01,510
have a single big attention right is it
just everything depends on everything

1226
00:26:01,510 --> 00:26:01,520
just everything depends on everything
 

1227
00:26:01,520 --> 00:26:03,750
just everything depends on everything
unless that's maybe not what he's saying

1228
00:26:03,750 --> 00:26:03,760
unless that's maybe not what he's saying
 

1229
00:26:03,760 --> 00:26:07,430
unless that's maybe not what he's saying
>> um I mean you don't know what what is

1230
00:26:07,430 --> 00:26:07,440
>> um I mean you don't know what what is
 

1231
00:26:07,440 --> 00:26:08,789
>> um I mean you don't know what what is
happening under the hood right it's

1232
00:26:08,789 --> 00:26:08,799
happening under the hood right it's
 

1233
00:26:08,799 --> 00:26:10,789
happening under the hood right it's
conceivable that if I gave you the full

1234
00:26:10,789 --> 00:26:10,799
conceivable that if I gave you the full
 

1235
00:26:10,799 --> 00:26:13,190
conceivable that if I gave you the full
vector you could choose to ignore half

1236
00:26:13,190 --> 00:26:13,200
vector you could choose to ignore half
 

1237
00:26:13,200 --> 00:26:14,789
vector you could choose to ignore half
the channels if that was what was

1238
00:26:14,789 --> 00:26:14,799
the channels if that was what was
 

1239
00:26:14,799 --> 00:26:17,269
the channels if that was what was
important to you these networks

1240
00:26:17,269 --> 00:26:17,279
important to you these networks
 

1241
00:26:17,279 --> 00:26:23,350
important to you these networks
typically don't do that. But um

1242
00:26:23,350 --> 00:26:23,360
typically don't do that. But um
 

1243
00:26:23,360 --> 00:26:25,269
typically don't do that. But um
I have I have I don't know anything that

1244
00:26:25,269 --> 00:26:25,279
I have I have I don't know anything that
 

1245
00:26:25,279 --> 00:26:28,149
I have I have I don't know anything that
says that this is Yeah, it it might be.

1246
00:26:28,149 --> 00:26:28,159
says that this is Yeah, it it might be.
 

1247
00:26:28,159 --> 00:26:31,990
says that this is Yeah, it it might be.
But I I um

1248
00:26:31,990 --> 00:26:32,000
But I I um
 

1249
00:26:32,000 --> 00:26:35,510
But I I um
I I guess I don't I think there is

1250
00:26:35,510 --> 00:26:35,520
I I guess I don't I think there is
 

1251
00:26:35,520 --> 00:26:37,029
I I guess I don't I think there is
probably some inductive bias to her

1252
00:26:37,029 --> 00:26:37,039
probably some inductive bias to her
 

1253
00:26:37,039 --> 00:26:38,390
probably some inductive bias to her
specialization and maybe there's been

1254
00:26:38,390 --> 00:26:38,400
specialization and maybe there's been
 

1255
00:26:38,400 --> 00:26:39,750
specialization and maybe there's been
work that has looked at this. I don't

1256
00:26:39,750 --> 00:26:39,760
work that has looked at this. I don't
 

1257
00:26:39,760 --> 00:26:41,750
work that has looked at this. I don't
know necessarily

1258
00:26:41,750 --> 00:26:41,760
know necessarily
 

1259
00:26:41,760 --> 00:26:44,230
know necessarily
of that, but I don't think that giving

1260
00:26:44,230 --> 00:26:44,240
of that, but I don't think that giving
 

1261
00:26:44,240 --> 00:26:45,830
of that, but I don't think that giving
everything to everyone would necessarily

1262
00:26:45,830 --> 00:26:45,840
everything to everyone would necessarily
 

1263
00:26:45,840 --> 00:26:47,350
everything to everyone would necessarily
push you away from specialization. I

1264
00:26:47,350 --> 00:26:47,360
push you away from specialization. I
 

1265
00:26:47,360 --> 00:26:49,269
push you away from specialization. I
think that the capacity and possibility

1266
00:26:49,269 --> 00:26:49,279
think that the capacity and possibility
 

1267
00:26:49,279 --> 00:26:51,029
think that the capacity and possibility
for specialization still would remain if

1268
00:26:51,029 --> 00:26:51,039
for specialization still would remain if
 

1269
00:26:51,039 --> 00:26:53,590
for specialization still would remain if
you had multiple induction heads still

1270
00:26:53,590 --> 00:26:53,600
you had multiple induction heads still
 

1271
00:26:53,600 --> 00:26:56,950
you had multiple induction heads still
with a large

1272
00:26:56,950 --> 00:26:56,960
with a large
 

1273
00:26:56,960 --> 00:26:58,230
with a large
uh like with the whole embedding

1274
00:26:58,230 --> 00:26:58,240
uh like with the whole embedding
 

1275
00:26:58,240 --> 00:26:59,909
uh like with the whole embedding
dimension available to it is my

1276
00:26:59,909 --> 00:26:59,919
dimension available to it is my
 

1277
00:26:59,919 --> 00:27:07,590
dimension available to it is my
intuition but that's just my intuition.

1278
00:27:07,590 --> 00:27:07,600

 

1279
00:27:07,600 --> 00:27:11,430

>> Yes. Um, I often see in the attention

1280
00:27:11,430 --> 00:27:11,440
>> Yes. Um, I often see in the attention
 

1281
00:27:11,440 --> 00:27:15,110
>> Yes. Um, I often see in the attention
literature that people do an MLP after

1282
00:27:15,110 --> 00:27:15,120
literature that people do an MLP after
 

1283
00:27:15,120 --> 00:27:18,390
literature that people do an MLP after
the concatenation to mix like to uh

1284
00:27:18,390 --> 00:27:18,400
the concatenation to mix like to uh
 

1285
00:27:18,400 --> 00:27:19,830
the concatenation to mix like to uh
allow for all of the different channels

1286
00:27:19,830 --> 00:27:19,840
allow for all of the different channels
 

1287
00:27:19,840 --> 00:27:21,510
allow for all of the different channels
that were that were split up to

1288
00:27:21,510 --> 00:27:21,520
that were that were split up to
 

1289
00:27:21,520 --> 00:27:22,870
that were that were split up to
>> the transformer will have that. Yes.

1290
00:27:22,870 --> 00:27:22,880
>> the transformer will have that. Yes.
 

1291
00:27:22,880 --> 00:27:23,190
>> the transformer will have that. Yes.
Yeah,

1292
00:27:23,190 --> 00:27:23,200
Yeah,
 

1293
00:27:23,200 --> 00:27:24,870
Yeah,
>> it it's coming.

1294
00:27:24,870 --> 00:27:24,880
>> it it's coming.
 

1295
00:27:24,880 --> 00:27:27,350
>> it it's coming.
>> Yeah. Yeah. So, is there any reason not

1296
00:27:27,350 --> 00:27:27,360
>> Yeah. Yeah. So, is there any reason not
 

1297
00:27:27,360 --> 00:27:29,510
>> Yeah. Yeah. So, is there any reason not
to do that beforehand to kind of do the

1298
00:27:29,510 --> 00:27:29,520
to do that beforehand to kind of do the
 

1299
00:27:29,520 --> 00:27:31,909
to do that beforehand to kind of do the
same thing? So like to allow an MLP to

1300
00:27:31,909 --> 00:27:31,919
same thing? So like to allow an MLP to
 

1301
00:27:31,919 --> 00:27:35,510
same thing? So like to allow an MLP to
project from D into D over H for each of

1302
00:27:35,510 --> 00:27:35,520
project from D into D over H for each of
 

1303
00:27:35,520 --> 00:27:37,430
project from D into D over H for each of
the heads to be able to mix the input

1304
00:27:37,430 --> 00:27:37,440
the heads to be able to mix the input
 

1305
00:27:37,440 --> 00:27:41,269
the heads to be able to mix the input
channels before doing attention.

1306
00:27:41,269 --> 00:27:41,279
channels before doing attention.
 

1307
00:27:41,279 --> 00:27:42,950
channels before doing attention.
Is it just the scalability cuz

1308
00:27:42,950 --> 00:27:42,960
Is it just the scalability cuz
 

1309
00:27:42,960 --> 00:27:45,590
Is it just the scalability cuz
>> that's what the key matrices

1310
00:27:45,590 --> 00:27:45,600
>> that's what the key matrices
 

1311
00:27:45,600 --> 00:27:47,430
>> that's what the key matrices
>> no cuz the query and key matrices only

1312
00:27:47,430 --> 00:27:47,440
>> no cuz the query and key matrices only
 

1313
00:27:47,440 --> 00:27:49,590
>> no cuz the query and key matrices only
get to CD over H like you you split them

1314
00:27:49,590 --> 00:27:49,600
get to CD over H like you you split them
 

1315
00:27:49,600 --> 00:27:51,510
get to CD over H like you you split them
before but couldn't you do that as a

1316
00:27:51,510 --> 00:27:51,520
before but couldn't you do that as a
 

1317
00:27:51,520 --> 00:27:52,230
before but couldn't you do that as a
projection rather than

1318
00:27:52,230 --> 00:27:52,240
projection rather than
 

1319
00:27:52,240 --> 00:27:54,230
projection rather than
>> so you want to put an MLP here.

1320
00:27:54,230 --> 00:27:54,240
>> so you want to put an MLP here.
 

1321
00:27:54,240 --> 00:27:55,909
>> so you want to put an MLP here.
>> Yes.

1322
00:27:55,909 --> 00:27:55,919
>> Yes.
 

1323
00:27:55,919 --> 00:28:00,149
>> Yes.
to project into D from D to D over H and

1324
00:28:00,149 --> 00:28:00,159
to project into D from D to D over H and
 

1325
00:28:00,159 --> 00:28:02,070
to project into D from D to D over H and
then so that each head can mix from the

1326
00:28:02,070 --> 00:28:02,080
then so that each head can mix from the
 

1327
00:28:02,080 --> 00:28:04,230
then so that each head can mix from the
input channels. I guess

1328
00:28:04,230 --> 00:28:04,240
input channels. I guess
 

1329
00:28:04,240 --> 00:28:06,870
input channels. I guess
>> I guess so I guess you could add MLPS in

1330
00:28:06,870 --> 00:28:06,880
>> I guess so I guess you could add MLPS in
 

1331
00:28:06,880 --> 00:28:10,149
>> I guess so I guess you could add MLPS in
many places but the thing is that um

1332
00:28:10,149 --> 00:28:10,159
many places but the thing is that um
 

1333
00:28:10,159 --> 00:28:12,950
many places but the thing is that um
then you're you're adding computation

1334
00:28:12,950 --> 00:28:12,960
then you're you're adding computation
 

1335
00:28:12,960 --> 00:28:17,110
then you're you're adding computation
for necessarily unclear what the um gain

1336
00:28:17,110 --> 00:28:17,120
for necessarily unclear what the um gain
 

1337
00:28:17,120 --> 00:28:18,789
for necessarily unclear what the um gain
is. The nice thing about this is that it

1338
00:28:18,789 --> 00:28:18,799
is. The nice thing about this is that it
 

1339
00:28:18,799 --> 00:28:20,789
is. The nice thing about this is that it
can it's being done all in parallel.

1340
00:28:20,789 --> 00:28:20,799
can it's being done all in parallel.
 

1341
00:28:20,799 --> 00:28:25,830
can it's being done all in parallel.
You're not waiting on on anything.

1342
00:28:25,830 --> 00:28:25,840
You're not waiting on on anything.
 

1343
00:28:25,840 --> 00:28:27,990
You're not waiting on on anything.
Okay,

1344
00:28:27,990 --> 00:28:28,000
Okay,
 

1345
00:28:28,000 --> 00:28:29,750
Okay,
so

1346
00:28:29,750 --> 00:28:29,760
so
 

1347
00:28:29,760 --> 00:28:32,870
so
with that, just a couple of uh things

1348
00:28:32,870 --> 00:28:32,880
with that, just a couple of uh things
 

1349
00:28:32,880 --> 00:28:35,350
with that, just a couple of uh things
that I wanted to point out. I uh didn't

1350
00:28:35,350 --> 00:28:35,360
that I wanted to point out. I uh didn't
 

1351
00:28:35,360 --> 00:28:37,350
that I wanted to point out. I uh didn't
really get to talk about this last time,

1352
00:28:37,350 --> 00:28:37,360
really get to talk about this last time,
 

1353
00:28:37,360 --> 00:28:40,789
really get to talk about this last time,
but nowadays people don't necessarily

1354
00:28:40,789 --> 00:28:40,799
but nowadays people don't necessarily
 

1355
00:28:40,799 --> 00:28:42,389
but nowadays people don't necessarily
just use self attention or cross

1356
00:28:42,389 --> 00:28:42,399
just use self attention or cross
 

1357
00:28:42,399 --> 00:28:45,029
just use self attention or cross
attention. The most common thing that

1358
00:28:45,029 --> 00:28:45,039
attention. The most common thing that
 

1359
00:28:45,039 --> 00:28:46,950
attention. The most common thing that
people use is multi-query attention and

1360
00:28:46,950 --> 00:28:46,960
people use is multi-query attention and
 

1361
00:28:46,960 --> 00:28:49,029
people use is multi-query attention and
multi-query group attention. And

1362
00:28:49,029 --> 00:28:49,039
multi-query group attention. And
 

1363
00:28:49,039 --> 00:28:52,950
multi-query group attention. And
basically you're using the same keys and

1364
00:28:52,950 --> 00:28:52,960
basically you're using the same keys and
 

1365
00:28:52,960 --> 00:28:55,269
basically you're using the same keys and
values throughout, right? And you're

1366
00:28:55,269 --> 00:28:55,279
values throughout, right? And you're
 

1367
00:28:55,279 --> 00:28:57,350
values throughout, right? And you're
only changing the query for each head in

1368
00:28:57,350 --> 00:28:57,360
only changing the query for each head in
 

1369
00:28:57,360 --> 00:28:59,990
only changing the query for each head in
multi head attention.

1370
00:28:59,990 --> 00:29:00,000
multi head attention.
 

1371
00:29:00,000 --> 00:29:01,510
multi head attention.
So you're not recmputing the keys and

1372
00:29:01,510 --> 00:29:01,520
So you're not recmputing the keys and
 

1373
00:29:01,520 --> 00:29:04,389
So you're not recmputing the keys and
the values. And that's that helps.

1374
00:29:04,389 --> 00:29:04,399
the values. And that's that helps.
 

1375
00:29:04,399 --> 00:29:06,549
the values. And that's that helps.
A variation on that is to do multi-query

1376
00:29:06,549 --> 00:29:06,559
A variation on that is to do multi-query
 

1377
00:29:06,559 --> 00:29:07,990
A variation on that is to do multi-query
group attention. So instead of saying

1378
00:29:07,990 --> 00:29:08,000
group attention. So instead of saying
 

1379
00:29:08,000 --> 00:29:09,909
group attention. So instead of saying
that, okay, I'm not going to compute the

1380
00:29:09,909 --> 00:29:09,919
that, okay, I'm not going to compute the
 

1381
00:29:09,919 --> 00:29:11,909
that, okay, I'm not going to compute the
keys and the values for everything, but

1382
00:29:11,909 --> 00:29:11,919
keys and the values for everything, but
 

1383
00:29:11,919 --> 00:29:13,750
keys and the values for everything, but
I'm going to have these three heads have

1384
00:29:13,750 --> 00:29:13,760
I'm going to have these three heads have
 

1385
00:29:13,760 --> 00:29:15,350
I'm going to have these three heads have
the same keys and values and these three

1386
00:29:15,350 --> 00:29:15,360
the same keys and values and these three
 

1387
00:29:15,360 --> 00:29:16,630
the same keys and values and these three
other heads have the same keys and

1388
00:29:16,630 --> 00:29:16,640
other heads have the same keys and
 

1389
00:29:16,640 --> 00:29:18,870
other heads have the same keys and
values. So I group them so that groups

1390
00:29:18,870 --> 00:29:18,880
values. So I group them so that groups
 

1391
00:29:18,880 --> 00:29:20,389
values. So I group them so that groups
of the heads have the same keys and

1392
00:29:20,389 --> 00:29:20,399
of the heads have the same keys and
 

1393
00:29:20,399 --> 00:29:23,669
of the heads have the same keys and
values. Um but I allow some variation in

1394
00:29:23,669 --> 00:29:23,679
values. Um but I allow some variation in
 

1395
00:29:23,679 --> 00:29:25,590
values. Um but I allow some variation in
them. And again these are just different

1396
00:29:25,590 --> 00:29:25,600
them. And again these are just different
 

1397
00:29:25,600 --> 00:29:27,430
them. And again these are just different
ways of getting basically computational

1398
00:29:27,430 --> 00:29:27,440
ways of getting basically computational
 

1399
00:29:27,440 --> 00:29:30,230
ways of getting basically computational
efficiency in terms of uh getting these

1400
00:29:30,230 --> 00:29:30,240
efficiency in terms of uh getting these
 

1401
00:29:30,240 --> 00:29:31,750
efficiency in terms of uh getting these
things to work faster. Yes.

1402
00:29:31,750 --> 00:29:31,760
things to work faster. Yes.
 

1403
00:29:31,760 --> 00:29:33,590
things to work faster. Yes.
>> Why is it okay to reuse keys and values

1404
00:29:33,590 --> 00:29:33,600
>> Why is it okay to reuse keys and values
 

1405
00:29:33,600 --> 00:29:35,029
>> Why is it okay to reuse keys and values
but not queries?

1406
00:29:35,029 --> 00:29:35,039
but not queries?
 

1407
00:29:35,039 --> 00:29:37,909
but not queries?
>> Why is it okay to reuse keys and values

1408
00:29:37,909 --> 00:29:37,919
>> Why is it okay to reuse keys and values
 

1409
00:29:37,919 --> 00:29:39,990
>> Why is it okay to reuse keys and values
but not queries? Because the keys and

1410
00:29:39,990 --> 00:29:40,000
but not queries? Because the keys and
 

1411
00:29:40,000 --> 00:29:43,510
but not queries? Because the keys and
values are kind of what has happened

1412
00:29:43,510 --> 00:29:43,520
values are kind of what has happened
 

1413
00:29:43,520 --> 00:29:45,669
values are kind of what has happened
already in some sense, right? and I'm

1414
00:29:45,669 --> 00:29:45,679
already in some sense, right? and I'm
 

1415
00:29:45,679 --> 00:29:47,909
already in some sense, right? and I'm
looking at the context. So the context

1416
00:29:47,909 --> 00:29:47,919
looking at the context. So the context
 

1417
00:29:47,919 --> 00:29:49,750
looking at the context. So the context
is represented some way. It is what it

1418
00:29:49,750 --> 00:29:49,760
is represented some way. It is what it
 

1419
00:29:49,760 --> 00:29:52,549
is represented some way. It is what it
is. But maybe I'm asking diff by having

1420
00:29:52,549 --> 00:29:52,559
is. But maybe I'm asking diff by having
 

1421
00:29:52,559 --> 00:29:54,549
is. But maybe I'm asking diff by having
a differentiation in the query. I'm

1422
00:29:54,549 --> 00:29:54,559
a differentiation in the query. I'm
 

1423
00:29:54,559 --> 00:29:56,870
a differentiation in the query. I'm
allowing different perspectives of

1424
00:29:56,870 --> 00:29:56,880
allowing different perspectives of
 

1425
00:29:56,880 --> 00:29:59,510
allowing different perspectives of
myself to interact with those. If I just

1426
00:29:59,510 --> 00:29:59,520
myself to interact with those. If I just
 

1427
00:29:59,520 --> 00:30:02,389
myself to interact with those. If I just
had the same everything, then what's the

1428
00:30:02,389 --> 00:30:02,399
had the same everything, then what's the
 

1429
00:30:02,399 --> 00:30:09,909
had the same everything, then what's the
point of having multiple heads?

1430
00:30:09,909 --> 00:30:09,919

 

1431
00:30:09,919 --> 00:30:13,510

Okay.

1432
00:30:13,510 --> 00:30:13,520

 

1433
00:30:13,520 --> 00:30:16,710

So with that now um

1434
00:30:16,710 --> 00:30:16,720
So with that now um
 

1435
00:30:16,720 --> 00:30:19,510
So with that now um
let's come to this basic building block

1436
00:30:19,510 --> 00:30:19,520
let's come to this basic building block
 

1437
00:30:19,520 --> 00:30:22,070
let's come to this basic building block
or basic transformer architecture. Okay.

1438
00:30:22,070 --> 00:30:22,080
or basic transformer architecture. Okay.
 

1439
00:30:22,080 --> 00:30:23,269
or basic transformer architecture. Okay.
So this is a picture that you're

1440
00:30:23,269 --> 00:30:23,279
So this is a picture that you're
 

1441
00:30:23,279 --> 00:30:25,110
So this is a picture that you're
probably going to see online a lot

1442
00:30:25,110 --> 00:30:25,120
probably going to see online a lot
 

1443
00:30:25,120 --> 00:30:26,470
probably going to see online a lot
probably. How many people have seen this

1444
00:30:26,470 --> 00:30:26,480
probably. How many people have seen this
 

1445
00:30:26,480 --> 00:30:28,771
probably. How many people have seen this
picture somewhere right? Like this is

1446
00:30:28,771 --> 00:30:28,781
picture somewhere right? Like this is
 

1447
00:30:28,781 --> 00:30:30,230
picture somewhere right? Like this is
[snorts] so this is the famous figure

1448
00:30:30,230 --> 00:30:30,240
[snorts] so this is the famous figure
 

1449
00:30:30,240 --> 00:30:32,389
[snorts] so this is the famous figure
one from the attention is all your all

1450
00:30:32,389 --> 00:30:32,399
one from the attention is all your all
 

1451
00:30:32,399 --> 00:30:35,110
one from the attention is all your all
you need paper and this is the first

1452
00:30:35,110 --> 00:30:35,120
you need paper and this is the first
 

1453
00:30:35,120 --> 00:30:36,950
you need paper and this is the first
transformer architecture that was

1454
00:30:36,950 --> 00:30:36,960
transformer architecture that was
 

1455
00:30:36,960 --> 00:30:38,710
transformer architecture that was
proposed. There are now variations that

1456
00:30:38,710 --> 00:30:38,720
proposed. There are now variations that
 

1457
00:30:38,720 --> 00:30:40,070
proposed. There are now variations that
have happened from this and it's been

1458
00:30:40,070 --> 00:30:40,080
have happened from this and it's been
 

1459
00:30:40,080 --> 00:30:42,149
have happened from this and it's been
modified quite a bit but this is the

1460
00:30:42,149 --> 00:30:42,159
modified quite a bit but this is the
 

1461
00:30:42,159 --> 00:30:44,710
modified quite a bit but this is the
kind of key um thing and so we're going

1462
00:30:44,710 --> 00:30:44,720
kind of key um thing and so we're going
 

1463
00:30:44,720 --> 00:30:47,590
kind of key um thing and so we're going
to try to walk through this uh one by

1464
00:30:47,590 --> 00:30:47,600
to try to walk through this uh one by
 

1465
00:30:47,600 --> 00:30:50,149
to try to walk through this uh one by
one. Okay.

1466
00:30:50,149 --> 00:30:50,159
one. Okay.
 

1467
00:30:50,159 --> 00:30:56,070
one. Okay.
So you have the inputs here and

1468
00:30:56,070 --> 00:30:56,080

 

1469
00:30:56,080 --> 00:30:58,149

the inputs then go through an input

1470
00:30:58,149 --> 00:30:58,159
the inputs then go through an input
 

1471
00:30:58,159 --> 00:31:00,070
the inputs then go through an input
embedding layer. Okay. And I'm going to

1472
00:31:00,070 --> 00:31:00,080
embedding layer. Okay. And I'm going to
 

1473
00:31:00,080 --> 00:31:01,669
embedding layer. Okay. And I'm going to
talk about this input embedding layer in

1474
00:31:01,669 --> 00:31:01,679
talk about this input embedding layer in
 

1475
00:31:01,679 --> 00:31:03,510
talk about this input embedding layer in
maybe 10 minutes. So hold questions

1476
00:31:03,510 --> 00:31:03,520
maybe 10 minutes. So hold questions
 

1477
00:31:03,520 --> 00:31:05,110
maybe 10 minutes. So hold questions
about that. [snorts]

1478
00:31:05,110 --> 00:31:05,120
about that. [snorts]
 

1479
00:31:05,120 --> 00:31:06,630
about that. [snorts]
Um

1480
00:31:06,630 --> 00:31:06,640
Um
 

1481
00:31:06,640 --> 00:31:09,350
Um
then comes this

1482
00:31:09,350 --> 00:31:09,360
then comes this
 

1483
00:31:09,360 --> 00:31:11,350
then comes this
positional encoding.

1484
00:31:11,350 --> 00:31:11,360
positional encoding.
 

1485
00:31:11,360 --> 00:31:13,750
positional encoding.
Okay, I'm going to talk about this in 15

1486
00:31:13,750 --> 00:31:13,760
Okay, I'm going to talk about this in 15
 

1487
00:31:13,760 --> 00:31:15,669
Okay, I'm going to talk about this in 15
minutes. So hold questions about that as

1488
00:31:15,669 --> 00:31:15,679
minutes. So hold questions about that as
 

1489
00:31:15,679 --> 00:31:17,350
minutes. So hold questions about that as
well. [snorts]

1490
00:31:17,350 --> 00:31:17,360
well. [snorts]
 

1491
00:31:17,360 --> 00:31:19,430
well. [snorts]
Um but then what you have is basically

1492
00:31:19,430 --> 00:31:19,440
Um but then what you have is basically
 

1493
00:31:19,440 --> 00:31:21,510
Um but then what you have is basically
you have this multi head attention

1494
00:31:21,510 --> 00:31:21,520
you have this multi head attention
 

1495
00:31:21,520 --> 00:31:24,950
you have this multi head attention
coming here and you have this residual

1496
00:31:24,950 --> 00:31:24,960
coming here and you have this residual
 

1497
00:31:24,960 --> 00:31:28,549
coming here and you have this residual
connection that is going into an add and

1498
00:31:28,549 --> 00:31:28,559
connection that is going into an add and
 

1499
00:31:28,559 --> 00:31:30,389
connection that is going into an add and
norm block. So this is the normalization

1500
00:31:30,389 --> 00:31:30,399
norm block. So this is the normalization
 

1501
00:31:30,399 --> 00:31:32,389
norm block. So this is the normalization
block. So what happens is that you have

1502
00:31:32,389 --> 00:31:32,399
block. So what happens is that you have
 

1503
00:31:32,399 --> 00:31:35,190
block. So what happens is that you have
this whatever this X is here it comes

1504
00:31:35,190 --> 00:31:35,200
this whatever this X is here it comes
 

1505
00:31:35,200 --> 00:31:37,029
this whatever this X is here it comes
and gets added in and then the whole

1506
00:31:37,029 --> 00:31:37,039
and gets added in and then the whole
 

1507
00:31:37,039 --> 00:31:40,149
and gets added in and then the whole
thing gets normalized. Okay. And then

1508
00:31:40,149 --> 00:31:40,159
thing gets normalized. Okay. And then
 

1509
00:31:40,159 --> 00:31:43,029
thing gets normalized. Okay. And then
you go into an MLP and again you have

1510
00:31:43,029 --> 00:31:43,039
you go into an MLP and again you have
 

1511
00:31:43,039 --> 00:31:44,789
you go into an MLP and again you have
this come in and then the whole thing

1512
00:31:44,789 --> 00:31:44,799
this come in and then the whole thing
 

1513
00:31:44,799 --> 00:31:46,710
this come in and then the whole thing
gets normalized. Okay. This is your

1514
00:31:46,710 --> 00:31:46,720
gets normalized. Okay. This is your
 

1515
00:31:46,720 --> 00:31:50,470
gets normalized. Okay. This is your
encoder block.

1516
00:31:50,470 --> 00:31:50,480

 

1517
00:31:50,480 --> 00:31:52,310

So what you see here is that why this

1518
00:31:52,310 --> 00:31:52,320
So what you see here is that why this
 

1519
00:31:52,320 --> 00:31:53,590
So what you see here is that why this
paper is called attention all you need

1520
00:31:53,590 --> 00:31:53,600
paper is called attention all you need
 

1521
00:31:53,600 --> 00:31:56,630
paper is called attention all you need
is that they have removed any state

1522
00:31:56,630 --> 00:31:56,640
is that they have removed any state
 

1523
00:31:56,640 --> 00:31:59,430
is that they have removed any state
right? There's now no RNN.

1524
00:31:59,430 --> 00:31:59,440
right? There's now no RNN.
 

1525
00:31:59,440 --> 00:32:02,149
right? There's now no RNN.
There is nothing that is remembering the

1526
00:32:02,149 --> 00:32:02,159
There is nothing that is remembering the
 

1527
00:32:02,159 --> 00:32:04,070
There is nothing that is remembering the
past explicitly. There's no state.

1528
00:32:04,070 --> 00:32:04,080
past explicitly. There's no state.
 

1529
00:32:04,080 --> 00:32:06,230
past explicitly. There's no state.
There's no recursive recurrence

1530
00:32:06,230 --> 00:32:06,240
There's no recursive recurrence
 

1531
00:32:06,240 --> 00:32:09,269
There's no recursive recurrence
operation there at all. And so instead,

1532
00:32:09,269 --> 00:32:09,279
operation there at all. And so instead,
 

1533
00:32:09,279 --> 00:32:10,950
operation there at all. And so instead,
it's just replaced with these attention

1534
00:32:10,950 --> 00:32:10,960
it's just replaced with these attention
 

1535
00:32:10,960 --> 00:32:12,230
it's just replaced with these attention
blocks. Which is why this paper is

1536
00:32:12,230 --> 00:32:12,240
blocks. Which is why this paper is
 

1537
00:32:12,240 --> 00:32:13,909
blocks. Which is why this paper is
called attention is all you need.

1538
00:32:13,909 --> 00:32:13,919
called attention is all you need.
 

1539
00:32:13,919 --> 00:32:15,269
called attention is all you need.
Because previously, attention blocks

1540
00:32:15,269 --> 00:32:15,279
Because previously, attention blocks
 

1541
00:32:15,279 --> 00:32:18,630
Because previously, attention blocks
were used in addition to recurrent

1542
00:32:18,630 --> 00:32:18,640
were used in addition to recurrent
 

1543
00:32:18,640 --> 00:32:21,190
were used in addition to recurrent
blocks in recurrent neural networks.

1544
00:32:21,190 --> 00:32:21,200
blocks in recurrent neural networks.
 

1545
00:32:21,200 --> 00:32:23,509
blocks in recurrent neural networks.
Make sense?

1546
00:32:23,509 --> 00:32:23,519
Make sense?
 

1547
00:32:23,519 --> 00:32:25,190
Make sense?
And so here in the first in this

1548
00:32:25,190 --> 00:32:25,200
And so here in the first in this
 

1549
00:32:25,200 --> 00:32:27,430
And so here in the first in this
attention, I believe there were six such

1550
00:32:27,430 --> 00:32:27,440
attention, I believe there were six such
 

1551
00:32:27,440 --> 00:32:30,070
attention, I believe there were six such
enclos. So you have six of these stacked

1552
00:32:30,070 --> 00:32:30,080
enclos. So you have six of these stacked
 

1553
00:32:30,080 --> 00:32:32,549
enclos. So you have six of these stacked
on top of each other.

1554
00:32:32,549 --> 00:32:32,559
on top of each other.
 

1555
00:32:32,559 --> 00:32:34,389
on top of each other.
And then you take the output of the last

1556
00:32:34,389 --> 00:32:34,399
And then you take the output of the last
 

1557
00:32:34,399 --> 00:32:35,990
And then you take the output of the last
encoder

1558
00:32:35,990 --> 00:32:36,000
encoder
 

1559
00:32:36,000 --> 00:32:38,389
encoder
and encoder block, not the last encoder.

1560
00:32:38,389 --> 00:32:38,399
and encoder block, not the last encoder.
 

1561
00:32:38,399 --> 00:32:39,990
and encoder block, not the last encoder.
This whole thing is the encoder. I have

1562
00:32:39,990 --> 00:32:40,000
This whole thing is the encoder. I have
 

1563
00:32:40,000 --> 00:32:43,430
This whole thing is the encoder. I have
six of these.

1564
00:32:43,430 --> 00:32:43,440

 

1565
00:32:43,440 --> 00:32:44,950

NX means that they're they're just

1566
00:32:44,950 --> 00:32:44,960
NX means that they're they're just
 

1567
00:32:44,960 --> 00:32:46,789
NX means that they're they're just
saying that do this n times where n is

1568
00:32:46,789 --> 00:32:46,799
saying that do this n times where n is
 

1569
00:32:46,799 --> 00:32:49,430
saying that do this n times where n is
in this paper equal to six.

1570
00:32:49,430 --> 00:32:49,440
in this paper equal to six.
 

1571
00:32:49,440 --> 00:32:54,310
in this paper equal to six.
And then you feed that

1572
00:32:54,310 --> 00:32:54,320

 

1573
00:32:54,320 --> 00:32:57,590

to have cross attention for the uh

1574
00:32:57,590 --> 00:32:57,600
to have cross attention for the uh
 

1575
00:32:57,600 --> 00:33:01,269
to have cross attention for the uh
decoder part. Okay. And what the decoder

1576
00:33:01,269 --> 00:33:01,279
decoder part. Okay. And what the decoder
 

1577
00:33:01,279 --> 00:33:04,710
decoder part. Okay. And what the decoder
is doing is now I have these outputs,

1578
00:33:04,710 --> 00:33:04,720
is doing is now I have these outputs,
 

1579
00:33:04,720 --> 00:33:07,509
is doing is now I have these outputs,
right? I'm doing translation. So at

1580
00:33:07,509 --> 00:33:07,519
right? I'm doing translation. So at
 

1581
00:33:07,519 --> 00:33:09,669
right? I'm doing translation. So at
training time I actually have outputs

1582
00:33:09,669 --> 00:33:09,679
training time I actually have outputs
 

1583
00:33:09,679 --> 00:33:12,710
training time I actually have outputs
coming in and they're again going

1584
00:33:12,710 --> 00:33:12,720
coming in and they're again going
 

1585
00:33:12,720 --> 00:33:15,990
coming in and they're again going
through uh a multi head uh attention

1586
00:33:15,990 --> 00:33:16,000
through uh a multi head uh attention
 

1587
00:33:16,000 --> 00:33:18,149
through uh a multi head uh attention
first and then they're going into this

1588
00:33:18,149 --> 00:33:18,159
first and then they're going into this
 

1589
00:33:18,159 --> 00:33:20,710
first and then they're going into this
cross attention block where now they're

1590
00:33:20,710 --> 00:33:20,720
cross attention block where now they're
 

1591
00:33:20,720 --> 00:33:22,230
cross attention block where now they're
looking at what has come out of the

1592
00:33:22,230 --> 00:33:22,240
looking at what has come out of the
 

1593
00:33:22,240 --> 00:33:24,310
looking at what has come out of the
encoder and then they're going into an

1594
00:33:24,310 --> 00:33:24,320
encoder and then they're going into an
 

1595
00:33:24,320 --> 00:33:28,149
encoder and then they're going into an
MLP. Okay. So at the decoder you have

1596
00:33:28,149 --> 00:33:28,159
MLP. Okay. So at the decoder you have
 

1597
00:33:28,159 --> 00:33:30,230
MLP. Okay. So at the decoder you have
first a self attention block. It's

1598
00:33:30,230 --> 00:33:30,240
first a self attention block. It's
 

1599
00:33:30,240 --> 00:33:31,909
first a self attention block. It's
masked so you cannot look at the future.

1600
00:33:31,909 --> 00:33:31,919
masked so you cannot look at the future.
 

1601
00:33:31,919 --> 00:33:34,950
masked so you cannot look at the future.
You can only look at the past. Then you

1602
00:33:34,950 --> 00:33:34,960
You can only look at the past. Then you
 

1603
00:33:34,960 --> 00:33:36,230
You can only look at the past. Then you
have a cross attention with what has

1604
00:33:36,230 --> 00:33:36,240
have a cross attention with what has
 

1605
00:33:36,240 --> 00:33:37,830
have a cross attention with what has
come in from the encoder and then you

1606
00:33:37,830 --> 00:33:37,840
come in from the encoder and then you
 

1607
00:33:37,840 --> 00:33:41,110
come in from the encoder and then you
have the MLP.

1608
00:33:41,110 --> 00:33:41,120
have the MLP.
 

1609
00:33:41,120 --> 00:33:42,950
have the MLP.
Okay. And this picture is a little bit

1610
00:33:42,950 --> 00:33:42,960
Okay. And this picture is a little bit
 

1611
00:33:42,960 --> 00:33:45,350
Okay. And this picture is a little bit
confusing but what I want to point out

1612
00:33:45,350 --> 00:33:45,360
confusing but what I want to point out
 

1613
00:33:45,360 --> 00:33:47,990
confusing but what I want to point out
it it is not every layer of the encoder

1614
00:33:47,990 --> 00:33:48,000
it it is not every layer of the encoder
 

1615
00:33:48,000 --> 00:33:49,669
it it is not every layer of the encoder
that is connecting to every layer of the

1616
00:33:49,669 --> 00:33:49,679
that is connecting to every layer of the
 

1617
00:33:49,679 --> 00:33:52,310
that is connecting to every layer of the
decoder but it is just the last layer of

1618
00:33:52,310 --> 00:33:52,320
decoder but it is just the last layer of
 

1619
00:33:52,320 --> 00:33:54,710
decoder but it is just the last layer of
the encoder that is connecting to every

1620
00:33:54,710 --> 00:33:54,720
the encoder that is connecting to every
 

1621
00:33:54,720 --> 00:33:57,350
the encoder that is connecting to every
layer of the decoder.

1622
00:33:57,350 --> 00:33:57,360
layer of the decoder.
 

1623
00:33:57,360 --> 00:34:00,950
layer of the decoder.
Okay.

1624
00:34:00,950 --> 00:34:00,960

 

1625
00:34:00,960 --> 00:34:03,110

And then from here you have a linear

1626
00:34:03,110 --> 00:34:03,120
And then from here you have a linear
 

1627
00:34:03,120 --> 00:34:05,430
And then from here you have a linear
layer that then gives you your scores

1628
00:34:05,430 --> 00:34:05,440
layer that then gives you your scores
 

1629
00:34:05,440 --> 00:34:09,109
layer that then gives you your scores
for each of your target words. And then

1630
00:34:09,109 --> 00:34:09,119
for each of your target words. And then
 

1631
00:34:09,119 --> 00:34:11,030
for each of your target words. And then
you have a soft max and that gives you

1632
00:34:11,030 --> 00:34:11,040
you have a soft max and that gives you
 

1633
00:34:11,040 --> 00:34:13,109
you have a soft max and that gives you
your output probabilities. And of course

1634
00:34:13,109 --> 00:34:13,119
your output probabilities. And of course
 

1635
00:34:13,119 --> 00:34:14,389
your output probabilities. And of course
when you're running this at inference

1636
00:34:14,389 --> 00:34:14,399
when you're running this at inference
 

1637
00:34:14,399 --> 00:34:17,669
when you're running this at inference
time, you know, all that's going in here

1638
00:34:17,669 --> 00:34:17,679
time, you know, all that's going in here
 

1639
00:34:17,679 --> 00:34:22,389
time, you know, all that's going in here
is a start token. There's nothing else.

1640
00:34:22,389 --> 00:34:22,399
is a start token. There's nothing else.
 

1641
00:34:22,399 --> 00:34:23,030
is a start token. There's nothing else.
>> Yes.

1642
00:34:23,030 --> 00:34:23,040
>> Yes.
 

1643
00:34:23,040 --> 00:34:24,869
>> Yes.
>> If this works so well, why did it take

1644
00:34:24,869 --> 00:34:24,879
>> If this works so well, why did it take
 

1645
00:34:24,879 --> 00:34:26,389
>> If this works so well, why did it take
so long for people to realize you don't

1646
00:34:26,389 --> 00:34:26,399
so long for people to realize you don't
 

1647
00:34:26,399 --> 00:34:29,750
so long for people to realize you don't
need the RNN components?

1648
00:34:29,750 --> 00:34:29,760
need the RNN components?
 

1649
00:34:29,760 --> 00:34:32,550
need the RNN components?
Everything is simple in hindsight.

1650
00:34:32,550 --> 00:34:32,560
Everything is simple in hindsight.
 

1651
00:34:32,560 --> 00:34:35,270
Everything is simple in hindsight.
Um that's like this is just once you

1652
00:34:35,270 --> 00:34:35,280
Um that's like this is just once you
 

1653
00:34:35,280 --> 00:34:39,030
Um that's like this is just once you
understand something it makes sense. But

1654
00:34:39,030 --> 00:34:39,040
understand something it makes sense. But
 

1655
00:34:39,040 --> 00:34:40,790
understand something it makes sense. But
uh

1656
00:34:40,790 --> 00:34:40,800
uh
 

1657
00:34:40,800 --> 00:34:43,589
uh
innovation takes time like that's just

1658
00:34:43,589 --> 00:34:43,599
innovation takes time like that's just
 

1659
00:34:43,599 --> 00:34:45,349
innovation takes time like that's just
uh

1660
00:34:45,349 --> 00:34:45,359
uh
 

1661
00:34:45,359 --> 00:34:47,270
uh
I [laughter]

1662
00:34:47,270 --> 00:34:47,280
I [laughter]
 

1663
00:34:47,280 --> 00:34:50,550
I [laughter]
yeah it takes time uh and you have to

1664
00:34:50,550 --> 00:34:50,560
yeah it takes time uh and you have to
 

1665
00:34:50,560 --> 00:34:51,669
yeah it takes time uh and you have to
you have to think through things. I

1666
00:34:51,669 --> 00:34:51,679
you have to think through things. I
 

1667
00:34:51,679 --> 00:34:54,710
you have to think through things. I
don't know why this was the particular

1668
00:34:54,710 --> 00:34:54,720
don't know why this was the particular
 

1669
00:34:54,720 --> 00:34:57,589
don't know why this was the particular
sequence of uh ways in which things

1670
00:34:57,589 --> 00:34:57,599
sequence of uh ways in which things
 

1671
00:34:57,599 --> 00:34:59,190
sequence of uh ways in which things
worked out but yeah

1672
00:34:59,190 --> 00:34:59,200
worked out but yeah
 

1673
00:34:59,200 --> 00:35:02,630
worked out but yeah
>> wait sorry this already but what is

1674
00:35:02,630 --> 00:35:02,640
>> wait sorry this already but what is
 

1675
00:35:02,640 --> 00:35:04,630
>> wait sorry this already but what is
mean

1676
00:35:04,630 --> 00:35:04,640
mean
 

1677
00:35:04,640 --> 00:35:08,310
mean
>> just an MLP

1678
00:35:08,310 --> 00:35:08,320

 

1679
00:35:08,320 --> 00:35:12,470

>> one second

1680
00:35:12,470 --> 00:35:12,480

 

1681
00:35:12,480 --> 00:35:14,630

>> you say only the last encoder is

1682
00:35:14,630 --> 00:35:14,640
>> you say only the last encoder is
 

1683
00:35:14,640 --> 00:35:17,990
>> you say only the last encoder is
connected to the uh all the decoders yes

1684
00:35:17,990 --> 00:35:18,000
connected to the uh all the decoders yes
 

1685
00:35:18,000 --> 00:35:19,990
connected to the uh all the decoders yes
>> for the cross correlation right what

1686
00:35:19,990 --> 00:35:20,000
>> for the cross correlation right what
 

1687
00:35:20,000 --> 00:35:21,829
>> for the cross correlation right what
about the the previous encoder are they

1688
00:35:21,829 --> 00:35:21,839
about the the previous encoder are they
 

1689
00:35:21,839 --> 00:35:22,710
about the the previous encoder are they
connected to?

1690
00:35:22,710 --> 00:35:22,720
connected to?
 

1691
00:35:22,720 --> 00:35:24,390
connected to?
>> So the previous encoder is like think

1692
00:35:24,390 --> 00:35:24,400
>> So the previous encoder is like think
 

1693
00:35:24,400 --> 00:35:26,710
>> So the previous encoder is like think
about this this way, right? So I have

1694
00:35:26,710 --> 00:35:26,720
about this this way, right? So I have
 

1695
00:35:26,720 --> 00:35:31,190
about this this way, right? So I have
basically I have my input coming in

1696
00:35:31,190 --> 00:35:31,200
basically I have my input coming in
 

1697
00:35:31,200 --> 00:35:35,589
basically I have my input coming in
and then I have block one,

1698
00:35:35,589 --> 00:35:35,599
and then I have block one,
 

1699
00:35:35,599 --> 00:35:40,069
and then I have block one,
block two,

1700
00:35:40,069 --> 00:35:40,079

 

1701
00:35:40,079 --> 00:35:43,829

block six, right? So I have six copies

1702
00:35:43,829 --> 00:35:43,839
block six, right? So I have six copies
 

1703
00:35:43,839 --> 00:35:46,790
block six, right? So I have six copies
of this whole thing that stack one on

1704
00:35:46,790 --> 00:35:46,800
of this whole thing that stack one on
 

1705
00:35:46,800 --> 00:35:49,829
of this whole thing that stack one on
top of the other. One only feeds to two.

1706
00:35:49,829 --> 00:35:49,839
top of the other. One only feeds to two.
 

1707
00:35:49,839 --> 00:35:53,510
top of the other. One only feeds to two.
two only feeds to three and then six

1708
00:35:53,510 --> 00:35:53,520
two only feeds to three and then six
 

1709
00:35:53,520 --> 00:35:56,550
two only feeds to three and then six
goes to decoder.

1710
00:35:56,550 --> 00:35:56,560
goes to decoder.
 

1711
00:35:56,560 --> 00:36:00,230
goes to decoder.
Does that make sense?

1712
00:36:00,230 --> 00:36:00,240

 

1713
00:36:00,240 --> 00:36:01,589

>> Yes.

1714
00:36:01,589 --> 00:36:01,599
>> Yes.
 

1715
00:36:01,599 --> 00:36:03,270
>> Yes.
>> Six goes to each block.

1716
00:36:03,270 --> 00:36:03,280
>> Six goes to each block.
 

1717
00:36:03,280 --> 00:36:05,030
>> Six goes to each block.
>> Six goes to each block of the decoder.

1718
00:36:05,030 --> 00:36:05,040
>> Six goes to each block of the decoder.
 

1719
00:36:05,040 --> 00:36:10,069
>> Six goes to each block of the decoder.
So six goes to um I can

1720
00:36:10,069 --> 00:36:10,079
So six goes to um I can
 

1721
00:36:10,079 --> 00:36:14,150
So six goes to um I can
six goes to here and here and here and

1722
00:36:14,150 --> 00:36:14,160
six goes to here and here and here and
 

1723
00:36:14,160 --> 00:36:17,670
six goes to here and here and here and
here and here everywhere in the decoder.

1724
00:36:17,670 --> 00:36:17,680
here and here everywhere in the decoder.
 

1725
00:36:17,680 --> 00:36:20,390
here and here everywhere in the decoder.
>> Yes. So in the part where like the the

1726
00:36:20,390 --> 00:36:20,400
>> Yes. So in the part where like the the
 

1727
00:36:20,400 --> 00:36:22,470
>> Yes. So in the part where like the the
last the sixth encoder goes to the

1728
00:36:22,470 --> 00:36:22,480
last the sixth encoder goes to the
 

1729
00:36:22,480 --> 00:36:25,589
last the sixth encoder goes to the
decoder we also have the like the

1730
00:36:25,589 --> 00:36:25,599
decoder we also have the like the
 

1731
00:36:25,599 --> 00:36:28,470
decoder we also have the like the
decoder multi attention goes to that

1732
00:36:28,470 --> 00:36:28,480
decoder multi attention goes to that
 

1733
00:36:28,480 --> 00:36:30,390
decoder multi attention goes to that
multi attention as well then how does

1734
00:36:30,390 --> 00:36:30,400
multi attention as well then how does
 

1735
00:36:30,400 --> 00:36:31,430
multi attention as well then how does
that like work

1736
00:36:31,430 --> 00:36:31,440
that like work
 

1737
00:36:31,440 --> 00:36:32,710
that like work
>> I'm not sure I'm understanding the

1738
00:36:32,710 --> 00:36:32,720
>> I'm not sure I'm understanding the
 

1739
00:36:32,720 --> 00:36:34,069
>> I'm not sure I'm understanding the
question so

1740
00:36:34,069 --> 00:36:34,079
question so
 

1741
00:36:34,079 --> 00:36:36,069
question so
>> the yeah in that three arrow part three

1742
00:36:36,069 --> 00:36:36,079
>> the yeah in that three arrow part three
 

1743
00:36:36,079 --> 00:36:37,990
>> the yeah in that three arrow part three
arrow part yeah how does that work

1744
00:36:37,990 --> 00:36:38,000
arrow part yeah how does that work
 

1745
00:36:38,000 --> 00:36:39,750
arrow part yeah how does that work
>> so this is the keys and the values are

1746
00:36:39,750 --> 00:36:39,760
>> so this is the keys and the values are
 

1747
00:36:39,760 --> 00:36:42,470
>> so this is the keys and the values are
coming in from the encoder and the

1748
00:36:42,470 --> 00:36:42,480
coming in from the encoder and the
 

1749
00:36:42,480 --> 00:36:44,150
coming in from the encoder and the
queries are coming from the decoder

1750
00:36:44,150 --> 00:36:44,160
queries are coming from the decoder
 

1751
00:36:44,160 --> 00:36:46,710
queries are coming from the decoder
right so this is cross attention

1752
00:36:46,710 --> 00:36:46,720
right so this is cross attention
 

1753
00:36:46,720 --> 00:36:49,589
right so this is cross attention
so here The here the car queries keys

1754
00:36:49,589 --> 00:36:49,599
so here The here the car queries keys
 

1755
00:36:49,599 --> 00:36:51,829
so here The here the car queries keys
and values are all just based on the

1756
00:36:51,829 --> 00:36:51,839
and values are all just based on the
 

1757
00:36:51,839 --> 00:36:53,589
and values are all just based on the
decoder. So this is self attention. This

1758
00:36:53,589 --> 00:36:53,599
decoder. So this is self attention. This
 

1759
00:36:53,599 --> 00:36:56,950
decoder. So this is self attention. This
is the cross attention part.

1760
00:36:56,950 --> 00:36:56,960
is the cross attention part.
 

1761
00:36:56,960 --> 00:36:59,829
is the cross attention part.
And for for cross attention part is done

1762
00:36:59,829 --> 00:36:59,839
And for for cross attention part is done
 

1763
00:36:59,839 --> 00:37:01,750
And for for cross attention part is done
individually for each decoder, right? Or

1764
00:37:01,750 --> 00:37:01,760
individually for each decoder, right? Or
 

1765
00:37:01,760 --> 00:37:06,310
individually for each decoder, right? Or
alternate physics.

1766
00:37:06,310 --> 00:37:06,320

 

1767
00:37:06,320 --> 00:37:07,829

>> Uh I'm not sure I'm understanding your

1768
00:37:07,829 --> 00:37:07,839
>> Uh I'm not sure I'm understanding your
 

1769
00:37:07,839 --> 00:37:08,230
>> Uh I'm not sure I'm understanding your
question.

1770
00:37:08,230 --> 00:37:08,240
question.
 

1771
00:37:08,240 --> 00:37:13,510
question.
>> For the cross uh for the cross

1772
00:37:13,510 --> 00:37:13,520
>> For the cross uh for the cross
 

1773
00:37:13,520 --> 00:37:14,550
>> For the cross uh for the cross
individually for each

1774
00:37:14,550 --> 00:37:14,560
individually for each
 

1775
00:37:14,560 --> 00:37:16,390
individually for each
>> so each decoder block. Yeah. The decoder

1776
00:37:16,390 --> 00:37:16,400
>> so each decoder block. Yeah. The decoder
 

1777
00:37:16,400 --> 00:37:17,829
>> so each decoder block. Yeah. The decoder
has six blocks. Each of them has

1778
00:37:17,829 --> 00:37:17,839
has six blocks. Each of them has
 

1779
00:37:17,839 --> 00:37:19,030
has six blocks. Each of them has
separate weights, separate things,

1780
00:37:19,030 --> 00:37:19,040
separate weights, separate things,
 

1781
00:37:19,040 --> 00:37:20,069
separate weights, separate things,
separate parameters that are learned

1782
00:37:20,069 --> 00:37:20,079
separate parameters that are learned
 

1783
00:37:20,079 --> 00:37:21,589
separate parameters that are learned
separately, independently. They're not

1784
00:37:21,589 --> 00:37:21,599
separately, independently. They're not
 

1785
00:37:21,599 --> 00:37:24,230
separately, independently. They're not
the same over and over again.

1786
00:37:24,230 --> 00:37:24,240
the same over and over again.
 

1787
00:37:24,240 --> 00:37:24,950
the same over and over again.
>> Yes.

1788
00:37:24,950 --> 00:37:24,960
>> Yes.
 

1789
00:37:24,960 --> 00:37:27,190
>> Yes.
>> We still need to make encoders and

1790
00:37:27,190 --> 00:37:27,200
>> We still need to make encoders and
 

1791
00:37:27,200 --> 00:37:29,910
>> We still need to make encoders and
decoders have the same numbers of layers

1792
00:37:29,910 --> 00:37:29,920
decoders have the same numbers of layers
 

1793
00:37:29,920 --> 00:37:32,790
decoders have the same numbers of layers
because now you only take

1794
00:37:32,790 --> 00:37:32,800
because now you only take
 

1795
00:37:32,800 --> 00:37:35,910
because now you only take
>> No, you don't need to have necessarily

1796
00:37:35,910 --> 00:37:35,920
>> No, you don't need to have necessarily
 

1797
00:37:35,920 --> 00:37:37,349
>> No, you don't need to have necessarily
>> I mean in fact like now there's modern

1798
00:37:37,349 --> 00:37:37,359
>> I mean in fact like now there's modern
 

1799
00:37:37,359 --> 00:37:38,950
>> I mean in fact like now there's modern
architectures that are encoder only or

1800
00:37:38,950 --> 00:37:38,960
architectures that are encoder only or
 

1801
00:37:38,960 --> 00:37:41,109
architectures that are encoder only or
decoder only, right? So, and we'll talk

1802
00:37:41,109 --> 00:37:41,119
decoder only, right? So, and we'll talk
 

1803
00:37:41,119 --> 00:37:44,630
decoder only, right? So, and we'll talk
about this, but yes, but you don't need

1804
00:37:44,630 --> 00:37:44,640
about this, but yes, but you don't need
 

1805
00:37:44,640 --> 00:37:47,349
about this, but yes, but you don't need
to have them necessarily be the same

1806
00:37:47,349 --> 00:37:47,359
to have them necessarily be the same
 

1807
00:37:47,359 --> 00:37:48,870
to have them necessarily be the same
because here, for example, it's not like

1808
00:37:48,870 --> 00:37:48,880
because here, for example, it's not like
 

1809
00:37:48,880 --> 00:37:50,950
because here, for example, it's not like
there's a correspondence. It's not like

1810
00:37:50,950 --> 00:37:50,960
there's a correspondence. It's not like
 

1811
00:37:50,960 --> 00:37:52,390
there's a correspondence. It's not like
it just so happens here that there were

1812
00:37:52,390 --> 00:37:52,400
it just so happens here that there were
 

1813
00:37:52,400 --> 00:37:53,910
it just so happens here that there were
six encoder layers and six decoder

1814
00:37:53,910 --> 00:37:53,920
six encoder layers and six decoder
 

1815
00:37:53,920 --> 00:37:55,109
six encoder layers and six decoder
layers. It was the first paper they were

1816
00:37:55,109 --> 00:37:55,119
layers. It was the first paper they were
 

1817
00:37:55,119 --> 00:37:57,430
layers. It was the first paper they were
trying something.

1818
00:37:57,430 --> 00:37:57,440
trying something.
 

1819
00:37:57,440 --> 00:38:00,069
trying something.
>> So, the NXs don't need to be the same.

1820
00:38:00,069 --> 00:38:00,079
>> So, the NXs don't need to be the same.
 

1821
00:38:00,079 --> 00:38:01,750
>> So, the NXs don't need to be the same.
>> They do not need to be the same in

1822
00:38:01,750 --> 00:38:01,760
>> They do not need to be the same in
 

1823
00:38:01,760 --> 00:38:03,190
>> They do not need to be the same in
general for a general transformer

1824
00:38:03,190 --> 00:38:03,200
general for a general transformer
 

1825
00:38:03,200 --> 00:38:04,950
general for a general transformer
architecture. So for a general

1826
00:38:04,950 --> 00:38:04,960
architecture. So for a general
 

1827
00:38:04,960 --> 00:38:06,470
architecture. So for a general
transformer architecture which we will

1828
00:38:06,470 --> 00:38:06,480
transformer architecture which we will
 

1829
00:38:06,480 --> 00:38:09,510
transformer architecture which we will
talk about probably next time. Um a

1830
00:38:09,510 --> 00:38:09,520
talk about probably next time. Um a
 

1831
00:38:09,520 --> 00:38:12,310
talk about probably next time. Um a
couple of things to keep in mind is that

1832
00:38:12,310 --> 00:38:12,320
couple of things to keep in mind is that
 

1833
00:38:12,320 --> 00:38:13,589
couple of things to keep in mind is that
here you're noticing that this

1834
00:38:13,589 --> 00:38:13,599
here you're noticing that this
 

1835
00:38:13,599 --> 00:38:17,670
here you're noticing that this
normalization is coming after the

1836
00:38:17,670 --> 00:38:17,680
normalization is coming after the
 

1837
00:38:17,680 --> 00:38:21,750
normalization is coming after the
attention and the MLP blocks. Uh more

1838
00:38:21,750 --> 00:38:21,760
attention and the MLP blocks. Uh more
 

1839
00:38:21,760 --> 00:38:23,670
attention and the MLP blocks. Uh more
recent architectures now the kind of the

1840
00:38:23,670 --> 00:38:23,680
recent architectures now the kind of the
 

1841
00:38:23,680 --> 00:38:26,710
recent architectures now the kind of the
the norm is to put the normalization

1842
00:38:26,710 --> 00:38:26,720
the norm is to put the normalization
 

1843
00:38:26,720 --> 00:38:29,510
the norm is to put the normalization
before the attention and before the MLP.

1844
00:38:29,510 --> 00:38:29,520
before the attention and before the MLP.
 

1845
00:38:29,520 --> 00:38:31,510
before the attention and before the MLP.
And one advantage of this is basically

1846
00:38:31,510 --> 00:38:31,520
And one advantage of this is basically
 

1847
00:38:31,520 --> 00:38:34,710
And one advantage of this is basically
when you're looking at the path for the

1848
00:38:34,710 --> 00:38:34,720
when you're looking at the path for the
 

1849
00:38:34,720 --> 00:38:37,109
when you're looking at the path for the
gradient to come through on back prop

1850
00:38:37,109 --> 00:38:37,119
gradient to come through on back prop
 

1851
00:38:37,119 --> 00:38:39,430
gradient to come through on back prop
here if you put the norm after this the

1852
00:38:39,430 --> 00:38:39,440
here if you put the norm after this the
 

1853
00:38:39,440 --> 00:38:43,030
here if you put the norm after this the
gradient is hit by the normalization

1854
00:38:43,030 --> 00:38:43,040
gradient is hit by the normalization
 

1855
00:38:43,040 --> 00:38:45,829
gradient is hit by the normalization
whereas if you put it before then you

1856
00:38:45,829 --> 00:38:45,839
whereas if you put it before then you
 

1857
00:38:45,839 --> 00:38:48,230
whereas if you put it before then you
can have this gradient superighway that

1858
00:38:48,230 --> 00:38:48,240
can have this gradient superighway that
 

1859
00:38:48,240 --> 00:38:49,670
can have this gradient superighway that
doesn't that isn't affected by the

1860
00:38:49,670 --> 00:38:49,680
doesn't that isn't affected by the
 

1861
00:38:49,680 --> 00:38:51,990
doesn't that isn't affected by the
normalization. So these normalization

1862
00:38:51,990 --> 00:38:52,000
normalization. So these normalization
 

1863
00:38:52,000 --> 00:38:55,190
normalization. So these normalization
blocks are now typically before the uh

1864
00:38:55,190 --> 00:38:55,200
blocks are now typically before the uh
 

1865
00:38:55,200 --> 00:38:58,230
blocks are now typically before the uh
attention head and before the MLP.

1866
00:38:58,230 --> 00:38:58,240
attention head and before the MLP.
 

1867
00:38:58,240 --> 00:39:01,030
attention head and before the MLP.
>> Yes. Um, in this image, what's the input

1868
00:39:01,030 --> 00:39:01,040
>> Yes. Um, in this image, what's the input
 

1869
00:39:01,040 --> 00:39:03,510
>> Yes. Um, in this image, what's the input
exactly to the mass multipension? Like I

1870
00:39:03,510 --> 00:39:03,520
exactly to the mass multipension? Like I
 

1871
00:39:03,520 --> 00:39:05,270
exactly to the mass multipension? Like I
say embedding, but wouldn't it be the

1872
00:39:05,270 --> 00:39:05,280
say embedding, but wouldn't it be the
 

1873
00:39:05,280 --> 00:39:07,829
say embedding, but wouldn't it be the
previous decoder block like the output

1874
00:39:07,829 --> 00:39:07,839
previous decoder block like the output
 

1875
00:39:07,839 --> 00:39:10,157
previous decoder block like the output
of the attention?

1876
00:39:10,157 --> 00:39:10,167
of the attention?
 

1877
00:39:10,167 --> 00:39:11,349
of the attention?
[clears throat]

1878
00:39:11,349 --> 00:39:11,359
[clears throat]
 

1879
00:39:11,359 --> 00:39:12,710
[clears throat]
>> Sorry, I'm not sure I'm understanding

1880
00:39:12,710 --> 00:39:12,720
>> Sorry, I'm not sure I'm understanding
 

1881
00:39:12,720 --> 00:39:13,109
>> Sorry, I'm not sure I'm understanding
the

1882
00:39:13,109 --> 00:39:13,119
the
 

1883
00:39:13,119 --> 00:39:15,270
the
>> so like the input to the mass multi head

1884
00:39:15,270 --> 00:39:15,280
>> so like the input to the mass multi head
 

1885
00:39:15,280 --> 00:39:15,829
>> so like the input to the mass multi head
attention.

1886
00:39:15,829 --> 00:39:15,839
attention.
 

1887
00:39:15,839 --> 00:39:16,310
attention.
>> Yes.

1888
00:39:16,310 --> 00:39:16,320
>> Yes.
 

1889
00:39:16,320 --> 00:39:18,310
>> Yes.
>> Uh, like wouldn't that have to be

1890
00:39:18,310 --> 00:39:18,320
>> Uh, like wouldn't that have to be
 

1891
00:39:18,320 --> 00:39:19,589
>> Uh, like wouldn't that have to be
because that would be self attention,

1892
00:39:19,589 --> 00:39:19,599
because that would be self attention,
 

1893
00:39:19,599 --> 00:39:20,230
because that would be self attention,
right?

1894
00:39:20,230 --> 00:39:20,240
right?
 

1895
00:39:20,240 --> 00:39:22,390
right?
>> Yes. So that would be the output from

1896
00:39:22,390 --> 00:39:22,400
>> Yes. So that would be the output from
 

1897
00:39:22,400 --> 00:39:24,550
>> Yes. So that would be the output from
the previous decoder block

1898
00:39:24,550 --> 00:39:24,560
the previous decoder block
 

1899
00:39:24,560 --> 00:39:26,310
the previous decoder block
>> from from not the decoder block the

1900
00:39:26,310 --> 00:39:26,320
>> from from not the decoder block the
 

1901
00:39:26,320 --> 00:39:29,430
>> from from not the decoder block the
previous input the previous se sequence

1902
00:39:29,430 --> 00:39:29,440
previous input the previous se sequence
 

1903
00:39:29,440 --> 00:39:31,750
previous input the previous se sequence
right. So if my

1904
00:39:31,750 --> 00:39:31,760
right. So if my
 

1905
00:39:31,760 --> 00:39:34,790
right. So if my
uh so this

1906
00:39:34,790 --> 00:39:34,800
uh so this
 

1907
00:39:34,800 --> 00:39:38,390
uh so this
remember this n here

1908
00:39:38,390 --> 00:39:38,400
remember this n here
 

1909
00:39:38,400 --> 00:39:41,430
remember this n here
and I look at this picture

1910
00:39:41,430 --> 00:39:41,440
and I look at this picture
 

1911
00:39:41,440 --> 00:39:45,589
and I look at this picture
this n is telling me how many how long

1912
00:39:45,589 --> 00:39:45,599
this n is telling me how many how long
 

1913
00:39:45,599 --> 00:39:48,630
this n is telling me how many how long
my sequence has been. So if it's just

1914
00:39:48,630 --> 00:39:48,640
my sequence has been. So if it's just
 

1915
00:39:48,640 --> 00:39:49,990
my sequence has been. So if it's just
the first token, there's just one thing

1916
00:39:49,990 --> 00:39:50,000
the first token, there's just one thing
 

1917
00:39:50,000 --> 00:39:51,349
the first token, there's just one thing
there. If it's two tokens, there's two

1918
00:39:51,349 --> 00:39:51,359
there. If it's two tokens, there's two
 

1919
00:39:51,359 --> 00:39:59,270
there. If it's two tokens, there's two
things there.

1920
00:39:59,270 --> 00:39:59,280

 

1921
00:39:59,280 --> 00:40:01,270

>> So like my my I'm looking at the

1922
00:40:01,270 --> 00:40:01,280
>> So like my my I'm looking at the
 

1923
00:40:01,280 --> 00:40:02,950
>> So like my my I'm looking at the
previous tokens in the sentence. No, it

1924
00:40:02,950 --> 00:40:02,960
previous tokens in the sentence. No, it
 

1925
00:40:02,960 --> 00:40:04,230
previous tokens in the sentence. No, it
has nothing to do with with which

1926
00:40:04,230 --> 00:40:04,240
has nothing to do with with which
 

1927
00:40:04,240 --> 00:40:08,150
has nothing to do with with which
decoder block I'm in.

1928
00:40:08,150 --> 00:40:08,160
decoder block I'm in.
 

1929
00:40:08,160 --> 00:40:08,870
decoder block I'm in.
>> Yes.

1930
00:40:08,870 --> 00:40:08,880
>> Yes.
 

1931
00:40:08,880 --> 00:40:12,550
>> Yes.
>> Why we choose six blocks

1932
00:40:12,550 --> 00:40:12,560
>> Why we choose six blocks
 

1933
00:40:12,560 --> 00:40:13,030
>> Why we choose six blocks
better?

1934
00:40:13,030 --> 00:40:13,040
better?
 

1935
00:40:13,040 --> 00:40:15,589
better?
>> They liked six.

1936
00:40:15,589 --> 00:40:15,599
>> They liked six.
 

1937
00:40:15,599 --> 00:40:18,630
>> They liked six.
>> I have no idea. uh but like as you will

1938
00:40:18,630 --> 00:40:18,640
>> I have no idea. uh but like as you will
 

1939
00:40:18,640 --> 00:40:22,150
>> I have no idea. uh but like as you will
see this is just this is the first paper

1940
00:40:22,150 --> 00:40:22,160
see this is just this is the first paper
 

1941
00:40:22,160 --> 00:40:23,109
see this is just this is the first paper
there's many many different

1942
00:40:23,109 --> 00:40:23,119
there's many many different
 

1943
00:40:23,119 --> 00:40:25,109
there's many many different
architectures

1944
00:40:25,109 --> 00:40:25,119
architectures
 

1945
00:40:25,119 --> 00:40:27,510
architectures
okay yes

1946
00:40:27,510 --> 00:40:27,520
okay yes
 

1947
00:40:27,520 --> 00:40:30,069
okay yes
>> so during inference time do they like

1948
00:40:30,069 --> 00:40:30,079
>> so during inference time do they like
 

1949
00:40:30,079 --> 00:40:32,390
>> so during inference time do they like
feed whatever output eventually out go

1950
00:40:32,390 --> 00:40:32,400
feed whatever output eventually out go
 

1951
00:40:32,400 --> 00:40:34,310
feed whatever output eventually out go
back to the output embedding and goes to

1952
00:40:34,310 --> 00:40:34,320
back to the output embedding and goes to
 

1953
00:40:34,320 --> 00:40:36,790
back to the output embedding and goes to
the decoder again

1954
00:40:36,790 --> 00:40:36,800
the decoder again
 

1955
00:40:36,800 --> 00:40:39,990
the decoder again
>> during inference time do they feed

1956
00:40:39,990 --> 00:40:40,000
>> during inference time do they feed
 

1957
00:40:40,000 --> 00:40:41,910
>> during inference time do they feed
>> like the the output from the output

1958
00:40:41,910 --> 00:40:41,920
>> like the the output from the output
 

1959
00:40:41,920 --> 00:40:43,990
>> like the the output from the output
probabilities like the eventual word

1960
00:40:43,990 --> 00:40:44,000
probabilities like the eventual word
 

1961
00:40:44,000 --> 00:40:47,109
probabilities like the eventual word
coming out of it go back to the Yes.

1962
00:40:47,109 --> 00:40:47,119
coming out of it go back to the Yes.
 

1963
00:40:47,119 --> 00:40:49,270
coming out of it go back to the Yes.
Yes. Yes. Because you will you will then

1964
00:40:49,270 --> 00:40:49,280
Yes. Yes. Because you will you will then
 

1965
00:40:49,280 --> 00:40:50,470
Yes. Yes. Because you will you will then
you will basically sample from those

1966
00:40:50,470 --> 00:40:50,480
you will basically sample from those
 

1967
00:40:50,480 --> 00:40:51,990
you will basically sample from those
probabilities, take whatever it is and

1968
00:40:51,990 --> 00:40:52,000
probabilities, take whatever it is and
 

1969
00:40:52,000 --> 00:40:54,630
probabilities, take whatever it is and
do auto reggressive generation because

1970
00:40:54,630 --> 00:40:54,640
do auto reggressive generation because
 

1971
00:40:54,640 --> 00:40:56,390
do auto reggressive generation because
the the training is only on next token

1972
00:40:56,390 --> 00:40:56,400
the the training is only on next token
 

1973
00:40:56,400 --> 00:40:59,750
the the training is only on next token
prediction.

1974
00:40:59,750 --> 00:40:59,760

 

1975
00:40:59,760 --> 00:41:02,230

Okay, good. So, I'm going to skip this

1976
00:41:02,230 --> 00:41:02,240
Okay, good. So, I'm going to skip this
 

1977
00:41:02,240 --> 00:41:03,990
Okay, good. So, I'm going to skip this
and see if I have time. I'll come back

1978
00:41:03,990 --> 00:41:04,000
and see if I have time. I'll come back
 

1979
00:41:04,000 --> 00:41:06,230
and see if I have time. I'll come back
to it later. But I want to actually talk

1980
00:41:06,230 --> 00:41:06,240
to it later. But I want to actually talk
 

1981
00:41:06,240 --> 00:41:10,790
to it later. But I want to actually talk
about any last questions about this.

1982
00:41:10,790 --> 00:41:10,800
about any last questions about this.
 

1983
00:41:10,800 --> 00:41:12,790
about any last questions about this.
We're going to talk about it more.

1984
00:41:12,790 --> 00:41:12,800
We're going to talk about it more.
 

1985
00:41:12,800 --> 00:41:15,030
We're going to talk about it more.
Um but I want to talk about this

1986
00:41:15,030 --> 00:41:15,040
Um but I want to talk about this
 

1987
00:41:15,040 --> 00:41:18,710
Um but I want to talk about this
embedding layer. Okay. So this

1988
00:41:18,710 --> 00:41:18,720
embedding layer. Okay. So this
 

1989
00:41:18,720 --> 00:41:20,790
embedding layer. Okay. So this
architecture uh and I'm using this

1990
00:41:20,790 --> 00:41:20,800
architecture uh and I'm using this
 

1991
00:41:20,800 --> 00:41:23,030
architecture uh and I'm using this
architecture as an example of the first

1992
00:41:23,030 --> 00:41:23,040
architecture as an example of the first
 

1993
00:41:23,040 --> 00:41:25,030
architecture as an example of the first
transformer architecture. Again like

1994
00:41:25,030 --> 00:41:25,040
transformer architecture. Again like
 

1995
00:41:25,040 --> 00:41:27,510
transformer architecture. Again like
please note that this is not the one and

1996
00:41:27,510 --> 00:41:27,520
please note that this is not the one and
 

1997
00:41:27,520 --> 00:41:29,589
please note that this is not the one and
only set in stone way to build a

1998
00:41:29,589 --> 00:41:29,599
only set in stone way to build a
 

1999
00:41:29,599 --> 00:41:31,589
only set in stone way to build a
transformer. This is the spirit of it

2000
00:41:31,589 --> 00:41:31,599
transformer. This is the spirit of it
 

2001
00:41:31,599 --> 00:41:33,990
transformer. This is the spirit of it
and there are many variations uh on how

2002
00:41:33,990 --> 00:41:34,000
and there are many variations uh on how
 

2003
00:41:34,000 --> 00:41:36,230
and there are many variations uh on how
this is done. But I want to talk about

2004
00:41:36,230 --> 00:41:36,240
this is done. But I want to talk about
 

2005
00:41:36,240 --> 00:41:41,750
this is done. But I want to talk about
this uh embedding layers. Okay.

2006
00:41:41,750 --> 00:41:41,760

 

2007
00:41:41,760 --> 00:41:43,990

So what is our input really coming into

2008
00:41:43,990 --> 00:41:44,000
So what is our input really coming into
 

2009
00:41:44,000 --> 00:41:46,069
So what is our input really coming into
this transformer? Our input is a word

2010
00:41:46,069 --> 00:41:46,079
this transformer? Our input is a word
 

2011
00:41:46,079 --> 00:41:48,069
this transformer? Our input is a word
from our vocabulary, right? Or a token

2012
00:41:48,069 --> 00:41:48,079
from our vocabulary, right? Or a token
 

2013
00:41:48,079 --> 00:41:51,109
from our vocabulary, right? Or a token
from our vocabulary.

2014
00:41:51,109 --> 00:41:51,119
from our vocabulary.
 

2015
00:41:51,119 --> 00:41:53,990
from our vocabulary.
And so this is something for example a

2016
00:41:53,990 --> 00:41:54,000
And so this is something for example a
 

2017
00:41:54,000 --> 00:41:56,309
And so this is something for example a
size for a vocabulary. It can be much

2018
00:41:56,309 --> 00:41:56,319
size for a vocabulary. It can be much
 

2019
00:41:56,319 --> 00:41:57,430
size for a vocabulary. It can be much
larger than this. But let's say it's

2020
00:41:57,430 --> 00:41:57,440
larger than this. But let's say it's
 

2021
00:41:57,440 --> 00:41:59,349
larger than this. But let's say it's
like 32,000, right? Is the size of your

2022
00:41:59,349 --> 00:41:59,359
like 32,000, right? Is the size of your
 

2023
00:41:59,359 --> 00:42:01,990
like 32,000, right? Is the size of your
vocabulary. So what does that mean in

2024
00:42:01,990 --> 00:42:02,000
vocabulary. So what does that mean in
 

2025
00:42:02,000 --> 00:42:04,309
vocabulary. So what does that mean in
terms of inputs? What is coming in? What

2026
00:42:04,309 --> 00:42:04,319
terms of inputs? What is coming in? What
 

2027
00:42:04,319 --> 00:42:08,150
terms of inputs? What is coming in? What
is coming in is a 32,000 long vector

2028
00:42:08,150 --> 00:42:08,160
is coming in is a 32,000 long vector
 

2029
00:42:08,160 --> 00:42:10,790
is coming in is a 32,000 long vector
that is one hot encoded. it is telling

2030
00:42:10,790 --> 00:42:10,800
that is one hot encoded. it is telling
 

2031
00:42:10,800 --> 00:42:15,190
that is one hot encoded. it is telling
me which token is it. Okay, so this is

2032
00:42:15,190 --> 00:42:15,200
me which token is it. Okay, so this is
 

2033
00:42:15,200 --> 00:42:18,309
me which token is it. Okay, so this is
what my inputs are looking like. If I

2034
00:42:18,309 --> 00:42:18,319
what my inputs are looking like. If I
 

2035
00:42:18,319 --> 00:42:20,710
what my inputs are looking like. If I
have a vocabulary that's 32,000, I have

2036
00:42:20,710 --> 00:42:20,720
have a vocabulary that's 32,000, I have
 

2037
00:42:20,720 --> 00:42:22,550
have a vocabulary that's 32,000, I have
to somehow represent that in vectors,

2038
00:42:22,550 --> 00:42:22,560
to somehow represent that in vectors,
 

2039
00:42:22,560 --> 00:42:23,910
to somehow represent that in vectors,
right? What is the natural way to do

2040
00:42:23,910 --> 00:42:23,920
right? What is the natural way to do
 

2041
00:42:23,920 --> 00:42:25,510
right? What is the natural way to do
that? I'm going to take a one hot

2042
00:42:25,510 --> 00:42:25,520
that? I'm going to take a one hot
 

2043
00:42:25,520 --> 00:42:27,670
that? I'm going to take a one hot
encodic. Does that make sense to

2044
00:42:27,670 --> 00:42:27,680
encodic. Does that make sense to
 

2045
00:42:27,680 --> 00:42:30,309
encodic. Does that make sense to
everyone?

2046
00:42:30,309 --> 00:42:30,319
everyone?
 

2047
00:42:30,319 --> 00:42:32,230
everyone?
I do not want to be going through with

2048
00:42:32,230 --> 00:42:32,240
I do not want to be going through with
 

2049
00:42:32,240 --> 00:42:34,069
I do not want to be going through with
32,000

2050
00:42:34,069 --> 00:42:34,079
32,000
 

2051
00:42:34,079 --> 00:42:36,710
32,000
length vectors where most of the stuff

2052
00:42:36,710 --> 00:42:36,720
length vectors where most of the stuff
 

2053
00:42:36,720 --> 00:42:39,109
length vectors where most of the stuff
is zero, right? I want to somehow have

2054
00:42:39,109 --> 00:42:39,119
is zero, right? I want to somehow have
 

2055
00:42:39,119 --> 00:42:41,750
is zero, right? I want to somehow have
some a better embedding and a better way

2056
00:42:41,750 --> 00:42:41,760
some a better embedding and a better way
 

2057
00:42:41,760 --> 00:42:44,309
some a better embedding and a better way
of representing this information.

2058
00:42:44,309 --> 00:42:44,319
of representing this information.
 

2059
00:42:44,319 --> 00:42:46,790
of representing this information.
And that is what this

2060
00:42:46,790 --> 00:42:46,800
And that is what this
 

2061
00:42:46,800 --> 00:42:49,990
And that is what this
um input embedding is basically doing.

2062
00:42:49,990 --> 00:42:50,000
um input embedding is basically doing.
 

2063
00:42:50,000 --> 00:42:51,910
um input embedding is basically doing.
This input embedding is essentially a

2064
00:42:51,910 --> 00:42:51,920
This input embedding is essentially a
 

2065
00:42:51,920 --> 00:42:54,069
This input embedding is essentially a
linear layer, right? It's saying take

2066
00:42:54,069 --> 00:42:54,079
linear layer, right? It's saying take
 

2067
00:42:54,079 --> 00:42:57,670
linear layer, right? It's saying take
this 32,000 dimension thing and project

2068
00:42:57,670 --> 00:42:57,680
this 32,000 dimension thing and project
 

2069
00:42:57,680 --> 00:42:59,829
this 32,000 dimension thing and project
it into something that is smaller

2070
00:42:59,829 --> 00:42:59,839
it into something that is smaller
 

2071
00:42:59,839 --> 00:43:02,230
it into something that is smaller
like,024.

2072
00:43:02,230 --> 00:43:02,240
like,024.
 

2073
00:43:02,240 --> 00:43:04,069
like,024.
Okay, which is a typical embedding

2074
00:43:04,069 --> 00:43:04,079
Okay, which is a typical embedding
 

2075
00:43:04,079 --> 00:43:10,309
Okay, which is a typical embedding
dimension that you might see. Okay.

2076
00:43:10,309 --> 00:43:10,319

 

2077
00:43:10,319 --> 00:43:13,829

Similarly, here at the output

2078
00:43:13,829 --> 00:43:13,839
Similarly, here at the output
 

2079
00:43:13,839 --> 00:43:17,190
Similarly, here at the output
you have this linear layer, right? So

2080
00:43:17,190 --> 00:43:17,200
you have this linear layer, right? So
 

2081
00:43:17,200 --> 00:43:18,470
you have this linear layer, right? So
everything that's going through this

2082
00:43:18,470 --> 00:43:18,480
everything that's going through this
 

2083
00:43:18,480 --> 00:43:21,030
everything that's going through this
network like this, like this here, these

2084
00:43:21,030 --> 00:43:21,040
network like this, like this here, these
 

2085
00:43:21,040 --> 00:43:22,390
network like this, like this here, these
are all these thousand dimensional

2086
00:43:22,390 --> 00:43:22,400
are all these thousand dimensional
 

2087
00:43:22,400 --> 00:43:24,950
are all these thousand dimensional
vectors.

2088
00:43:24,950 --> 00:43:24,960
vectors.
 

2089
00:43:24,960 --> 00:43:27,349
vectors.
But now I need to produce scores. And

2090
00:43:27,349 --> 00:43:27,359
But now I need to produce scores. And
 

2091
00:43:27,359 --> 00:43:30,550
But now I need to produce scores. And
how many scores do I need to produce?

2092
00:43:30,550 --> 00:43:30,560
how many scores do I need to produce?
 

2093
00:43:30,560 --> 00:43:33,030
how many scores do I need to produce?
32,000. Right? I need to know what is

2094
00:43:33,030 --> 00:43:33,040
32,000. Right? I need to know what is
 

2095
00:43:33,040 --> 00:43:35,589
32,000. Right? I need to know what is
the most likely next token from my

2096
00:43:35,589 --> 00:43:35,599
the most likely next token from my
 

2097
00:43:35,599 --> 00:43:38,390
the most likely next token from my
vocabulary. So again, I need a way of go

2098
00:43:38,390 --> 00:43:38,400
vocabulary. So again, I need a way of go
 

2099
00:43:38,400 --> 00:43:41,109
vocabulary. So again, I need a way of go
taking a thousand dimensional thing and

2100
00:43:41,109 --> 00:43:41,119
taking a thousand dimensional thing and
 

2101
00:43:41,119 --> 00:43:43,990
taking a thousand dimensional thing and
converting it into a 32,000dimensional

2102
00:43:43,990 --> 00:43:44,000
converting it into a 32,000dimensional
 

2103
00:43:44,000 --> 00:43:46,230
converting it into a 32,000dimensional
thing.

2104
00:43:46,230 --> 00:43:46,240
thing.
 

2105
00:43:46,240 --> 00:43:49,750
thing.
That's what this linear layer is doing.

2106
00:43:49,750 --> 00:43:49,760
That's what this linear layer is doing.
 

2107
00:43:49,760 --> 00:43:55,030
That's what this linear layer is doing.
Okay, everyone with me till here? Okay.

2108
00:43:55,030 --> 00:43:55,040
Okay, everyone with me till here? Okay.
 

2109
00:43:55,040 --> 00:43:57,270
Okay, everyone with me till here? Okay.
So now

2110
00:43:57,270 --> 00:43:57,280
So now
 

2111
00:43:57,280 --> 00:44:00,309
So now
when I think about this, how how am I

2112
00:44:00,309 --> 00:44:00,319
when I think about this, how how am I
 

2113
00:44:00,319 --> 00:44:01,750
when I think about this, how how am I
going to think about what these what

2114
00:44:01,750 --> 00:44:01,760
going to think about what these what
 

2115
00:44:01,760 --> 00:44:04,390
going to think about what these what
these input embeddings um should be and

2116
00:44:04,390 --> 00:44:04,400
these input embeddings um should be and
 

2117
00:44:04,400 --> 00:44:07,109
these input embeddings um should be and
how do I really um uh go about doing

2118
00:44:07,109 --> 00:44:07,119
how do I really um uh go about doing
 

2119
00:44:07,119 --> 00:44:09,750
how do I really um uh go about doing
them? So when I have this input coming

2120
00:44:09,750 --> 00:44:09,760
them? So when I have this input coming
 

2121
00:44:09,760 --> 00:44:11,510
them? So when I have this input coming
in,

2122
00:44:11,510 --> 00:44:11,520
in,
 

2123
00:44:11,520 --> 00:44:15,190
in,
I have this 32,000 long vector.

2124
00:44:15,190 --> 00:44:15,200
I have this 32,000 long vector.
 

2125
00:44:15,200 --> 00:44:17,030
I have this 32,000 long vector.
Okay.

2126
00:44:17,030 --> 00:44:17,040
Okay.
 

2127
00:44:17,040 --> 00:44:20,870
Okay.
But is it like I know that everything

2128
00:44:20,870 --> 00:44:20,880
But is it like I know that everything
 

2129
00:44:20,880 --> 00:44:22,950
But is it like I know that everything
there is essentially zero, right? I only

2130
00:44:22,950 --> 00:44:22,960
there is essentially zero, right? I only
 

2131
00:44:22,960 --> 00:44:25,190
there is essentially zero, right? I only
have this one entry

2132
00:44:25,190 --> 00:44:25,200
have this one entry
 

2133
00:44:25,200 --> 00:44:27,750
have this one entry
that is non zero. Most of it is actually

2134
00:44:27,750 --> 00:44:27,760
that is non zero. Most of it is actually
 

2135
00:44:27,760 --> 00:44:30,710
that is non zero. Most of it is actually
zero. Okay.

2136
00:44:30,710 --> 00:44:30,720
zero. Okay.
 

2137
00:44:30,720 --> 00:44:33,190
zero. Okay.
I want to be able to get from this an

2138
00:44:33,190 --> 00:44:33,200
I want to be able to get from this an
 

2139
00:44:33,200 --> 00:44:36,309
I want to be able to get from this an
input to my attention heads that is

2140
00:44:36,309 --> 00:44:36,319
input to my attention heads that is
 

2141
00:44:36,319 --> 00:44:40,790
input to my attention heads that is
essentially something like RMS norm one.

2142
00:44:40,790 --> 00:44:40,800
essentially something like RMS norm one.
 

2143
00:44:40,800 --> 00:44:42,150
essentially something like RMS norm one.
I don't want the entries to be too

2144
00:44:42,150 --> 00:44:42,160
I don't want the entries to be too
 

2145
00:44:42,160 --> 00:44:43,670
I don't want the entries to be too
small. I don't want the entries to be

2146
00:44:43,670 --> 00:44:43,680
small. I don't want the entries to be
 

2147
00:44:43,680 --> 00:44:45,030
small. I don't want the entries to be
too large.

2148
00:44:45,030 --> 00:44:45,040
too large.
 

2149
00:44:45,040 --> 00:44:46,870
too large.
So how do I think this? What does this

2150
00:44:46,870 --> 00:44:46,880
So how do I think this? What does this
 

2151
00:44:46,880 --> 00:44:50,470
So how do I think this? What does this
tell me about how I'm going to you know

2152
00:44:50,470 --> 00:44:50,480
tell me about how I'm going to you know
 

2153
00:44:50,480 --> 00:44:53,910
tell me about how I'm going to you know
initialize this W uh weight matrix that

2154
00:44:53,910 --> 00:44:53,920
initialize this W uh weight matrix that
 

2155
00:44:53,920 --> 00:44:57,270
initialize this W uh weight matrix that
is going to uh be my linear layer

2156
00:44:57,270 --> 00:44:57,280
is going to uh be my linear layer
 

2157
00:44:57,280 --> 00:45:00,069
is going to uh be my linear layer
essentially. Okay.

2158
00:45:00,069 --> 00:45:00,079
essentially. Okay.
 

2159
00:45:00,079 --> 00:45:03,670
essentially. Okay.
So for this matrix or this vector sorry

2160
00:45:03,670 --> 00:45:03,680
So for this matrix or this vector sorry
 

2161
00:45:03,680 --> 00:45:06,950
So for this matrix or this vector sorry
my RMS norm is essentially like 1 over

2162
00:45:06,950 --> 00:45:06,960
my RMS norm is essentially like 1 over
 

2163
00:45:06,960 --> 00:45:10,150
my RMS norm is essentially like 1 over
32,000 right? But I don't really want to

2164
00:45:10,150 --> 00:45:10,160
32,000 right? But I don't really want to
 

2165
00:45:10,160 --> 00:45:12,309
32,000 right? But I don't really want to
think about this in the RMS to RMS norm

2166
00:45:12,309 --> 00:45:12,319
think about this in the RMS to RMS norm
 

2167
00:45:12,319 --> 00:45:15,190
think about this in the RMS to RMS norm
perspective because now I have this very

2168
00:45:15,190 --> 00:45:15,200
perspective because now I have this very
 

2169
00:45:15,200 --> 00:45:17,670
perspective because now I have this very
strong structure on my input vector,

2170
00:45:17,670 --> 00:45:17,680
strong structure on my input vector,
 

2171
00:45:17,680 --> 00:45:18,950
strong structure on my input vector,
right? I have this I know that

2172
00:45:18,950 --> 00:45:18,960
right? I have this I know that
 

2173
00:45:18,960 --> 00:45:20,390
right? I have this I know that
everything is zero and only one thing is

2174
00:45:20,390 --> 00:45:20,400
everything is zero and only one thing is
 

2175
00:45:20,400 --> 00:45:22,710
everything is zero and only one thing is
one. So instead I'm going to think about

2176
00:45:22,710 --> 00:45:22,720
one. So instead I'm going to think about
 

2177
00:45:22,720 --> 00:45:25,829
one. So instead I'm going to think about
this is that if I have this vector here

2178
00:45:25,829 --> 00:45:25,839
this is that if I have this vector here
 

2179
00:45:25,839 --> 00:45:29,270
this is that if I have this vector here
and I'm it's being hit by a matrix,

2180
00:45:29,270 --> 00:45:29,280
and I'm it's being hit by a matrix,
 

2181
00:45:29,280 --> 00:45:31,190
and I'm it's being hit by a matrix,
the fact that only one of these things

2182
00:45:31,190 --> 00:45:31,200
the fact that only one of these things
 

2183
00:45:31,200 --> 00:45:33,190
the fact that only one of these things
is one means that what this is going to

2184
00:45:33,190 --> 00:45:33,200
is one means that what this is going to
 

2185
00:45:33,200 --> 00:45:34,550
is one means that what this is going to
be doing is it's going to be picking out

2186
00:45:34,550 --> 00:45:34,560
be doing is it's going to be picking out
 

2187
00:45:34,560 --> 00:45:39,190
be doing is it's going to be picking out
a column from this matrix W, right?

2188
00:45:39,190 --> 00:45:39,200
a column from this matrix W, right?
 

2189
00:45:39,200 --> 00:45:42,630
a column from this matrix W, right?
So this Y that I'm going to get out is

2190
00:45:42,630 --> 00:45:42,640
So this Y that I'm going to get out is
 

2191
00:45:42,640 --> 00:45:44,470
So this Y that I'm going to get out is
going to be just basically pulling a

2192
00:45:44,470 --> 00:45:44,480
going to be just basically pulling a
 

2193
00:45:44,480 --> 00:45:47,270
going to be just basically pulling a
column from here. And so I want to

2194
00:45:47,270 --> 00:45:47,280
column from here. And so I want to
 

2195
00:45:47,280 --> 00:45:49,270
column from here. And so I want to
basically have the columns of this

2196
00:45:49,270 --> 00:45:49,280
basically have the columns of this
 

2197
00:45:49,280 --> 00:45:51,670
basically have the columns of this
matrix W to be approximately RMS norm

2198
00:45:51,670 --> 00:45:51,680
matrix W to be approximately RMS norm
 

2199
00:45:51,680 --> 00:45:53,510
matrix W to be approximately RMS norm
one. And that will give me the right

2200
00:45:53,510 --> 00:45:53,520
one. And that will give me the right
 

2201
00:45:53,520 --> 00:45:57,030
one. And that will give me the right
kind of properties

2202
00:45:57,030 --> 00:45:57,040

 

2203
00:45:57,040 --> 00:45:59,670

uh for my uh for my setup. Does that

2204
00:45:59,670 --> 00:45:59,680
uh for my uh for my setup. Does that
 

2205
00:45:59,680 --> 00:46:03,589
uh for my uh for my setup. Does that
make sense to everyone?

2206
00:46:03,589 --> 00:46:03,599

 

2207
00:46:03,599 --> 00:46:07,109

Okay, good.

2208
00:46:07,109 --> 00:46:07,119

 

2209
00:46:07,119 --> 00:46:09,910

questions.

2210
00:46:09,910 --> 00:46:09,920
questions.
 

2211
00:46:09,920 --> 00:46:12,309
questions.
Um, okay. And then similarly, let's

2212
00:46:12,309 --> 00:46:12,319
Um, okay. And then similarly, let's
 

2213
00:46:12,319 --> 00:46:13,990
Um, okay. And then similarly, let's
think about the dembedding, right? Like,

2214
00:46:13,990 --> 00:46:14,000
think about the dembedding, right? Like,
 

2215
00:46:14,000 --> 00:46:16,390
think about the dembedding, right? Like,
so this this linear layer here is

2216
00:46:16,390 --> 00:46:16,400
so this this linear layer here is
 

2217
00:46:16,400 --> 00:46:18,230
so this this linear layer here is
basically the dmbedding. I've embedded

2218
00:46:18,230 --> 00:46:18,240
basically the dmbedding. I've embedded
 

2219
00:46:18,240 --> 00:46:19,910
basically the dmbedding. I've embedded
everything and now I want to expand back

2220
00:46:19,910 --> 00:46:19,920
everything and now I want to expand back
 

2221
00:46:19,920 --> 00:46:22,390
everything and now I want to expand back
out to my vocabulary to get my

2222
00:46:22,390 --> 00:46:22,400
out to my vocabulary to get my
 

2223
00:46:22,400 --> 00:46:24,550
out to my vocabulary to get my
probabilities.

2224
00:46:24,550 --> 00:46:24,560
probabilities.
 

2225
00:46:24,560 --> 00:46:26,309
probabilities.
So now I have this dmbedding layer. Now

2226
00:46:26,309 --> 00:46:26,319
So now I have this dmbedding layer. Now
 

2227
00:46:26,319 --> 00:46:28,710
So now I have this dmbedding layer. Now
here I have a very tall matrix because I

2228
00:46:28,710 --> 00:46:28,720
here I have a very tall matrix because I
 

2229
00:46:28,720 --> 00:46:30,309
here I have a very tall matrix because I
have a thousand dimensional vector and

2230
00:46:30,309 --> 00:46:30,319
have a thousand dimensional vector and
 

2231
00:46:30,319 --> 00:46:33,270
have a thousand dimensional vector and
I'm blowing it up into a 32,000

2232
00:46:33,270 --> 00:46:33,280
I'm blowing it up into a 32,000
 

2233
00:46:33,280 --> 00:46:36,950
I'm blowing it up into a 32,000
dimensional vector.

2234
00:46:36,950 --> 00:46:36,960

 

2235
00:46:36,960 --> 00:46:38,710

And I have a normalization layer right

2236
00:46:38,710 --> 00:46:38,720
And I have a normalization layer right
 

2237
00:46:38,720 --> 00:46:41,190
And I have a normalization layer right
before. So I have some maybe Q matrix

2238
00:46:41,190 --> 00:46:41,200
before. So I have some maybe Q matrix
 

2239
00:46:41,200 --> 00:46:45,109
before. So I have some maybe Q matrix
time alpha equal to beta. And this alpha

2240
00:46:45,109 --> 00:46:45,119
time alpha equal to beta. And this alpha
 

2241
00:46:45,119 --> 00:46:48,150
time alpha equal to beta. And this alpha
has RMS norm one. Okay. And so now we

2242
00:46:48,150 --> 00:46:48,160
has RMS norm one. Okay. And so now we
 

2243
00:46:48,160 --> 00:46:50,710
has RMS norm one. Okay. And so now we
want to make sure again that the entries

2244
00:46:50,710 --> 00:46:50,720
want to make sure again that the entries
 

2245
00:46:50,720 --> 00:46:53,430
want to make sure again that the entries
of this thing are not too big. Why do we

2246
00:46:53,430 --> 00:46:53,440
of this thing are not too big. Why do we
 

2247
00:46:53,440 --> 00:46:55,270
of this thing are not too big. Why do we
want to make sure that the entries of

2248
00:46:55,270 --> 00:46:55,280
want to make sure that the entries of
 

2249
00:46:55,280 --> 00:46:57,030
want to make sure that the entries of
this vector are not too big? What is

2250
00:46:57,030 --> 00:46:57,040
this vector are not too big? What is
 

2251
00:46:57,040 --> 00:46:58,870
this vector are not too big? What is
what is what is this 32,000 dimensional

2252
00:46:58,870 --> 00:46:58,880
what is what is this 32,000 dimensional
 

2253
00:46:58,880 --> 00:47:02,630
what is what is this 32,000 dimensional
vector going to be an input for?

2254
00:47:02,630 --> 00:47:02,640
vector going to be an input for?
 

2255
00:47:02,640 --> 00:47:03,109
vector going to be an input for?
>> Soft max.

2256
00:47:03,109 --> 00:47:03,119
>> Soft max.
 

2257
00:47:03,119 --> 00:47:05,190
>> Soft max.
>> The soft max, right? And so what's bad

2258
00:47:05,190 --> 00:47:05,200
>> The soft max, right? And so what's bad
 

2259
00:47:05,200 --> 00:47:07,750
>> The soft max, right? And so what's bad
for softmaxes? Stuff that becomes really

2260
00:47:07,750 --> 00:47:07,760
for softmaxes? Stuff that becomes really
 

2261
00:47:07,760 --> 00:47:10,230
for softmaxes? Stuff that becomes really
big because then you just saturate and

2262
00:47:10,230 --> 00:47:10,240
big because then you just saturate and
 

2263
00:47:10,240 --> 00:47:12,870
big because then you just saturate and
you don't get any uh information out of

2264
00:47:12,870 --> 00:47:12,880
you don't get any uh information out of
 

2265
00:47:12,880 --> 00:47:16,550
you don't get any uh information out of
this. Okay. Um I mean eventually you

2266
00:47:16,550 --> 00:47:16,560
this. Okay. Um I mean eventually you
 

2267
00:47:16,560 --> 00:47:17,990
this. Okay. Um I mean eventually you
want to be saturating because eventually

2268
00:47:17,990 --> 00:47:18,000
want to be saturating because eventually
 

2269
00:47:18,000 --> 00:47:20,230
want to be saturating because eventually
you want to say this is the best token

2270
00:47:20,230 --> 00:47:20,240
you want to say this is the best token
 

2271
00:47:20,240 --> 00:47:22,950
you want to say this is the best token
but at initialization you don't know

2272
00:47:22,950 --> 00:47:22,960
but at initialization you don't know
 

2273
00:47:22,960 --> 00:47:27,190
but at initialization you don't know
what is what. Right? Okay. So this is

2274
00:47:27,190 --> 00:47:27,200
what is what. Right? Okay. So this is
 

2275
00:47:27,200 --> 00:47:29,510
what is what. Right? Okay. So this is
like an a variation on the kinds of

2276
00:47:29,510 --> 00:47:29,520
like an a variation on the kinds of
 

2277
00:47:29,520 --> 00:47:30,870
like an a variation on the kinds of
exercises we've been doing. So maybe

2278
00:47:30,870 --> 00:47:30,880
exercises we've been doing. So maybe
 

2279
00:47:30,880 --> 00:47:32,790
exercises we've been doing. So maybe
take a minute and try and do this on

2280
00:47:32,790 --> 00:47:32,800
take a minute and try and do this on
 

2281
00:47:32,800 --> 00:47:34,870
take a minute and try and do this on
your own just for a break or you can

2282
00:47:34,870 --> 00:47:34,880
your own just for a break or you can
 

2283
00:47:34,880 --> 00:47:37,750
your own just for a break or you can
just chitchat.

2284
00:47:37,750 --> 00:47:37,760
just chitchat.
 

2285
00:47:37,760 --> 00:47:41,109
just chitchat.
But is the question clear?

2286
00:47:41,109 --> 00:47:41,119
But is the question clear?
 

2287
00:47:41,119 --> 00:47:42,950
But is the question clear?
Right. How how should we think about

2288
00:47:42,950 --> 00:47:42,960
Right. How how should we think about
 

2289
00:47:42,960 --> 00:47:53,589
Right. How how should we think about
initializing this dmbedding matrix?

2290
00:47:53,589 --> 00:47:53,599

 

2291
00:47:53,599 --> 00:48:14,390

Yeah.

2292
00:48:14,390 --> 00:48:14,400

 

2293
00:48:14,400 --> 00:48:17,743

>> Yeah.

2294
00:48:17,743 --> 00:48:17,753

 

2295
00:48:17,753 --> 00:48:31,670

[clears throat]

2296
00:48:31,670 --> 00:48:31,680

 

2297
00:48:31,680 --> 00:48:35,990

Because this is this

2298
00:48:35,990 --> 00:48:36,000

 

2299
00:48:36,000 --> 00:48:57,270

Yeah.

2300
00:48:57,270 --> 00:48:57,280

 

2301
00:48:57,280 --> 00:49:04,710

So now we're right.

2302
00:49:04,710 --> 00:49:04,720

 

2303
00:49:04,720 --> 00:49:09,510

So we

2304
00:49:09,510 --> 00:49:09,520

 

2305
00:49:09,520 --> 00:49:12,390

want this to have

2306
00:49:12,390 --> 00:49:12,400
want this to have
 

2307
00:49:12,400 --> 00:49:21,279
want this to have
we want this. So now we're

2308
00:49:21,279 --> 00:49:21,289

 

2309
00:49:21,289 --> 00:49:30,069

[music]

2310
00:49:30,069 --> 00:49:30,079

 

2311
00:49:30,079 --> 00:49:34,790

probably

2312
00:49:34,790 --> 00:49:34,800

 

2313
00:49:34,800 --> 00:49:54,710

not.

2314
00:49:54,710 --> 00:49:54,720

 

2315
00:49:54,720 --> 00:49:56,549

>> Okay. So, let me let's talk about this

2316
00:49:56,549 --> 00:49:56,559
>> Okay. So, let me let's talk about this
 

2317
00:49:56,559 --> 00:50:03,270
>> Okay. So, let me let's talk about this
together.

2318
00:50:03,270 --> 00:50:03,280

 

2319
00:50:03,280 --> 00:50:04,230

Okay,

2320
00:50:04,230 --> 00:50:04,240
Okay,
 

2321
00:50:04,240 --> 00:50:06,710
Okay,
>> so here we're thinking of this guy and

2322
00:50:06,710 --> 00:50:06,720
>> so here we're thinking of this guy and
 

2323
00:50:06,720 --> 00:50:08,710
>> so here we're thinking of this guy and
this guy has RMS norm one. And basically

2324
00:50:08,710 --> 00:50:08,720
this guy has RMS norm one. And basically
 

2325
00:50:08,720 --> 00:50:10,950
this guy has RMS norm one. And basically
that means that we have approximately

2326
00:50:10,950 --> 00:50:10,960
that means that we have approximately
 

2327
00:50:10,960 --> 00:50:13,430
that means that we have approximately
every entry is oneish, right? That's

2328
00:50:13,430 --> 00:50:13,440
every entry is oneish, right? That's
 

2329
00:50:13,440 --> 00:50:14,870
every entry is oneish, right? That's
like kind of the intuition that we have

2330
00:50:14,870 --> 00:50:14,880
like kind of the intuition that we have
 

2331
00:50:14,880 --> 00:50:16,950
like kind of the intuition that we have
when we're thinking about this. And so

2332
00:50:16,950 --> 00:50:16,960
when we're thinking about this. And so
 

2333
00:50:16,960 --> 00:50:18,790
when we're thinking about this. And so
when we're doing this matrix vector

2334
00:50:18,790 --> 00:50:18,800
when we're doing this matrix vector
 

2335
00:50:18,800 --> 00:50:21,510
when we're doing this matrix vector
multiplication, I have a row times this

2336
00:50:21,510 --> 00:50:21,520
multiplication, I have a row times this
 

2337
00:50:21,520 --> 00:50:23,270
multiplication, I have a row times this
column, a row time this column, a row

2338
00:50:23,270 --> 00:50:23,280
column, a row time this column, a row
 

2339
00:50:23,280 --> 00:50:25,190
column, a row time this column, a row
times this column. this row times this

2340
00:50:25,190 --> 00:50:25,200
times this column. this row times this
 

2341
00:50:25,200 --> 00:50:27,510
times this column. this row times this
column gives me this entry for this this

2342
00:50:27,510 --> 00:50:27,520
column gives me this entry for this this
 

2343
00:50:27,520 --> 00:50:29,510
column gives me this entry for this this
vector. So if I want to make sure that

2344
00:50:29,510 --> 00:50:29,520
vector. So if I want to make sure that
 

2345
00:50:29,520 --> 00:50:33,589
vector. So if I want to make sure that
each of these entries now is not too big

2346
00:50:33,589 --> 00:50:33,599
each of these entries now is not too big
 

2347
00:50:33,599 --> 00:50:35,829
each of these entries now is not too big
right I want to make sure that this is

2348
00:50:35,829 --> 00:50:35,839
right I want to make sure that this is
 

2349
00:50:35,839 --> 00:50:39,829
right I want to make sure that this is
basically like RMS norm

2350
00:50:39,829 --> 00:50:39,839
basically like RMS norm
 

2351
00:50:39,839 --> 00:50:42,870
basically like RMS norm
one over<unk> th00and right so that when

2352
00:50:42,870 --> 00:50:42,880
one over<unk> th00and right so that when
 

2353
00:50:42,880 --> 00:50:47,030
one over<unk> th00and right so that when
I multiply it by this thing this is a

2354
00:50:47,030 --> 00:50:47,040
I multiply it by this thing this is a
 

2355
00:50:47,040 --> 00:50:49,109
I multiply it by this thing this is a
reasonable size and if I have that

2356
00:50:49,109 --> 00:50:49,119
reasonable size and if I have that
 

2357
00:50:49,119 --> 00:50:50,950
reasonable size and if I have that
initialization then all of these are

2358
00:50:50,950 --> 00:50:50,960
initialization then all of these are
 

2359
00:50:50,960 --> 00:50:53,030
initialization then all of these are
going to be coming out roughly similar

2360
00:50:53,030 --> 00:50:53,040
going to be coming out roughly similar
 

2361
00:50:53,040 --> 00:50:56,069
going to be coming out roughly similar
size and roughly equal okay so I want

2362
00:50:56,069 --> 00:50:56,079
size and roughly equal okay so I want
 

2363
00:50:56,079 --> 00:51:01,750
size and roughly equal okay so I want
basically each row

2364
00:51:01,750 --> 00:51:01,760

 

2365
00:51:01,760 --> 00:51:03,750

of Q

2366
00:51:03,750 --> 00:51:03,760
of Q
 

2367
00:51:03,760 --> 00:51:06,470
of Q
to be

2368
00:51:06,470 --> 00:51:06,480
to be
 

2369
00:51:06,480 --> 00:51:12,309
to be
uh RMS approximate

2370
00:51:12,309 --> 00:51:12,319

 

2371
00:51:12,319 --> 00:51:14,630

and that will give me the right uh

2372
00:51:14,630 --> 00:51:14,640
and that will give me the right uh
 

2373
00:51:14,640 --> 00:51:17,349
and that will give me the right uh
scaling and [clears throat] I mean one

2374
00:51:17,349 --> 00:51:17,359
scaling and [clears throat] I mean one
 

2375
00:51:17,359 --> 00:51:18,790
scaling and [clears throat] I mean one
question that you might have is like why

2376
00:51:18,790 --> 00:51:18,800
question that you might have is like why
 

2377
00:51:18,800 --> 00:51:21,190
question that you might have is like why
not think about this in the spectral

2378
00:51:21,190 --> 00:51:21,200
not think about this in the spectral
 

2379
00:51:21,200 --> 00:51:22,549
not think about this in the spectral
norm way that we've been thinking about

2380
00:51:22,549 --> 00:51:22,559
norm way that we've been thinking about
 

2381
00:51:22,559 --> 00:51:26,309
norm way that we've been thinking about
right so it turns out that here in this

2382
00:51:26,309 --> 00:51:26,319
right so it turns out that here in this
 

2383
00:51:26,319 --> 00:51:27,829
right so it turns out that here in this
case because you are going to be

2384
00:51:27,829 --> 00:51:27,839
case because you are going to be
 

2385
00:51:27,839 --> 00:51:29,910
case because you are going to be
initializing and you're going to be have

2386
00:51:29,910 --> 00:51:29,920
initializing and you're going to be have
 

2387
00:51:29,920 --> 00:51:31,270
initializing and you're going to be have
this is going to be a tall matrix. So

2388
00:51:31,270 --> 00:51:31,280
this is going to be a tall matrix. So
 

2389
00:51:31,280 --> 00:51:33,190
this is going to be a tall matrix. So
it's going to be very well conditioned

2390
00:51:33,190 --> 00:51:33,200
it's going to be very well conditioned
 

2391
00:51:33,200 --> 00:51:37,430
it's going to be very well conditioned
and so you're going to have um

2392
00:51:37,430 --> 00:51:37,440
and so you're going to have um
 

2393
00:51:37,440 --> 00:51:40,140
and so you're going to have um
uh basically no no zero singular values

2394
00:51:40,140 --> 00:51:40,150
uh basically no no zero singular values
 

2395
00:51:40,150 --> 00:51:41,109
uh basically no no zero singular values
[clears throat] and all of them are

2396
00:51:41,109 --> 00:51:41,119
[clears throat] and all of them are
 

2397
00:51:41,119 --> 00:51:43,430
[clears throat] and all of them are
going to be about the same because of

2398
00:51:43,430 --> 00:51:43,440
going to be about the same because of
 

2399
00:51:43,440 --> 00:51:45,030
going to be about the same because of
the fact that if you're initializing

2400
00:51:45,030 --> 00:51:45,040
the fact that if you're initializing
 

2401
00:51:45,040 --> 00:51:47,589
the fact that if you're initializing
this randomly your singular values are

2402
00:51:47,589 --> 00:51:47,599
this randomly your singular values are
 

2403
00:51:47,599 --> 00:51:50,230
this randomly your singular values are
going to all come from the sums of a lot

2404
00:51:50,230 --> 00:51:50,240
going to all come from the sums of a lot
 

2405
00:51:50,240 --> 00:51:52,630
going to all come from the sums of a lot
of random numbers, right? And so they're

2406
00:51:52,630 --> 00:51:52,640
of random numbers, right? And so they're
 

2407
00:51:52,640 --> 00:51:53,829
of random numbers, right? And so they're
all going to concentrate. They're all

2408
00:51:53,829 --> 00:51:53,839
all going to concentrate. They're all
 

2409
00:51:53,839 --> 00:51:55,349
all going to concentrate. They're all
going to be roughly the same. So it's

2410
00:51:55,349 --> 00:51:55,359
going to be roughly the same. So it's
 

2411
00:51:55,359 --> 00:51:56,710
going to be roughly the same. So it's
going to be pretty well conditioned. And

2412
00:51:56,710 --> 00:51:56,720
going to be pretty well conditioned. And
 

2413
00:51:56,720 --> 00:51:59,510
going to be pretty well conditioned. And
so you can basically have the frobinius

2414
00:51:59,510 --> 00:51:59,520
so you can basically have the frobinius
 

2415
00:51:59,520 --> 00:52:04,790
so you can basically have the frobinius
norm be uh just a multiple of the uh

2416
00:52:04,790 --> 00:52:04,800
norm be uh just a multiple of the uh
 

2417
00:52:04,800 --> 00:52:07,750
norm be uh just a multiple of the uh
spectral norm because the probinous norm

2418
00:52:07,750 --> 00:52:07,760
spectral norm because the probinous norm
 

2419
00:52:07,760 --> 00:52:09,109
spectral norm because the probinous norm
is all of the singular values squared.

2420
00:52:09,109 --> 00:52:09,119
is all of the singular values squared.
 

2421
00:52:09,119 --> 00:52:10,549
is all of the singular values squared.
The spectral norm is the top singular

2422
00:52:10,549 --> 00:52:10,559
The spectral norm is the top singular
 

2423
00:52:10,559 --> 00:52:11,829
The spectral norm is the top singular
value but all of your singular values

2424
00:52:11,829 --> 00:52:11,839
value but all of your singular values
 

2425
00:52:11,839 --> 00:52:13,990
value but all of your singular values
are exactly the same.

2426
00:52:13,990 --> 00:52:14,000
are exactly the same.
 

2427
00:52:14,000 --> 00:52:16,390
are exactly the same.
Right? So yes the spectral norm thinking

2428
00:52:16,390 --> 00:52:16,400
Right? So yes the spectral norm thinking
 

2429
00:52:16,400 --> 00:52:18,630
Right? So yes the spectral norm thinking
will also give you the uh give you a

2430
00:52:18,630 --> 00:52:18,640
will also give you the uh give you a
 

2431
00:52:18,640 --> 00:52:20,150
will also give you the uh give you a
similar intuition.

2432
00:52:20,150 --> 00:52:20,160
similar intuition.
 

2433
00:52:20,160 --> 00:52:21,670
similar intuition.
the looking at it row by row is

2434
00:52:21,670 --> 00:52:21,680
the looking at it row by row is
 

2435
00:52:21,680 --> 00:52:22,790
the looking at it row by row is
essentially looking at the probinius

2436
00:52:22,790 --> 00:52:22,800
essentially looking at the probinius
 

2437
00:52:22,800 --> 00:52:24,150
essentially looking at the probinius
norm instead of looking at the spectral

2438
00:52:24,150 --> 00:52:24,160
norm instead of looking at the spectral
 

2439
00:52:24,160 --> 00:52:27,190
norm instead of looking at the spectral
norm. Okay.

2440
00:52:27,190 --> 00:52:27,200
norm. Okay.
 

2441
00:52:27,200 --> 00:52:30,870
norm. Okay.
Okay. So this is really just a way of

2442
00:52:30,870 --> 00:52:30,880
Okay. So this is really just a way of
 

2443
00:52:30,880 --> 00:52:32,470
Okay. So this is really just a way of
you know remembering things that we have

2444
00:52:32,470 --> 00:52:32,480
you know remembering things that we have
 

2445
00:52:32,480 --> 00:52:34,950
you know remembering things that we have
been doing and thinking about how we

2446
00:52:34,950 --> 00:52:34,960
been doing and thinking about how we
 

2447
00:52:34,960 --> 00:52:38,309
been doing and thinking about how we
want to get to um having these things be

2448
00:52:38,309 --> 00:52:38,319
want to get to um having these things be
 

2449
00:52:38,319 --> 00:52:41,109
want to get to um having these things be
well behaved. Okay any questions about

2450
00:52:41,109 --> 00:52:41,119
well behaved. Okay any questions about
 

2451
00:52:41,119 --> 00:52:43,990
well behaved. Okay any questions about
embedding layers and dembedding layers.

2452
00:52:43,990 --> 00:52:44,000
embedding layers and dembedding layers.
 

2453
00:52:44,000 --> 00:52:46,470
embedding layers and dembedding layers.
So one interesting thing to note is that

2454
00:52:46,470 --> 00:52:46,480
So one interesting thing to note is that
 

2455
00:52:46,480 --> 00:52:48,549
So one interesting thing to note is that
um historically

2456
00:52:48,549 --> 00:52:48,559
um historically
 

2457
00:52:48,559 --> 00:52:50,790
um historically
the embedding and the dembedding layers

2458
00:52:50,790 --> 00:52:50,800
the embedding and the dembedding layers
 

2459
00:52:50,800 --> 00:52:53,750
the embedding and the dembedding layers
were often weight shared

2460
00:52:53,750 --> 00:52:53,760
were often weight shared
 

2461
00:52:53,760 --> 00:52:57,510
were often weight shared
um in the sense that it's like well I am

2462
00:52:57,510 --> 00:52:57,520
um in the sense that it's like well I am
 

2463
00:52:57,520 --> 00:52:58,790
um in the sense that it's like well I am
they're they're trying to do the same

2464
00:52:58,790 --> 00:52:58,800
they're they're trying to do the same
 

2465
00:52:58,800 --> 00:53:00,309
they're they're trying to do the same
thing right they're translating back and

2466
00:53:00,309 --> 00:53:00,319
thing right they're translating back and
 

2467
00:53:00,319 --> 00:53:02,870
thing right they're translating back and
forth from this 32,000 language to the

2468
00:53:02,870 --> 00:53:02,880
forth from this 32,000 language to the
 

2469
00:53:02,880 --> 00:53:04,950
forth from this 32,000 language to the
1000 language

2470
00:53:04,950 --> 00:53:04,960
1000 language
 

2471
00:53:04,960 --> 00:53:06,630
1000 language
and so these these two things are

2472
00:53:06,630 --> 00:53:06,640
and so these these two things are
 

2473
00:53:06,640 --> 00:53:08,390
and so these these two things are
they're actually inverses right like you

2474
00:53:08,390 --> 00:53:08,400
they're actually inverses right like you
 

2475
00:53:08,400 --> 00:53:11,030
they're actually inverses right like you
want to do an inversion operation

2476
00:53:11,030 --> 00:53:11,040
want to do an inversion operation
 

2477
00:53:11,040 --> 00:53:12,470
want to do an inversion operation
but the way it was thought of is that

2478
00:53:12,470 --> 00:53:12,480
but the way it was thought of is that
 

2479
00:53:12,480 --> 00:53:14,150
but the way it was thought of is that
well you do the transpose which the poor

2480
00:53:14,150 --> 00:53:14,160
well you do the transpose which the poor
 

2481
00:53:14,160 --> 00:53:15,750
well you do the transpose which the poor
man's inverse. So let's just put the

2482
00:53:15,750 --> 00:53:15,760
man's inverse. So let's just put the
 

2483
00:53:15,760 --> 00:53:19,109
man's inverse. So let's just put the
transpose there and and h and have these

2484
00:53:19,109 --> 00:53:19,119
transpose there and and h and have these
 

2485
00:53:19,119 --> 00:53:21,750
transpose there and and h and have these
things be weight shared. Nowadays you

2486
00:53:21,750 --> 00:53:21,760
things be weight shared. Nowadays you
 

2487
00:53:21,760 --> 00:53:24,790
things be weight shared. Nowadays you
actually end up uh having

2488
00:53:24,790 --> 00:53:24,800
actually end up uh having
 

2489
00:53:24,800 --> 00:53:27,990
actually end up uh having
different um different embedding

2490
00:53:27,990 --> 00:53:28,000
different um different embedding
 

2491
00:53:28,000 --> 00:53:29,670
different um different embedding
matrices that are that are embedding and

2492
00:53:29,670 --> 00:53:29,680
matrices that are that are embedding and
 

2493
00:53:29,680 --> 00:53:31,030
matrices that are that are embedding and
dembedding matrices that are separately

2494
00:53:31,030 --> 00:53:31,040
dembedding matrices that are separately
 

2495
00:53:31,040 --> 00:53:33,270
dembedding matrices that are separately
learned. I should mention that when

2496
00:53:33,270 --> 00:53:33,280
learned. I should mention that when
 

2497
00:53:33,280 --> 00:53:35,589
learned. I should mention that when
things were weight shared, you would

2498
00:53:35,589 --> 00:53:35,599
things were weight shared, you would
 

2499
00:53:35,599 --> 00:53:40,470
things were weight shared, you would
often scale the uh input embedding one

2500
00:53:40,470 --> 00:53:40,480
often scale the uh input embedding one
 

2501
00:53:40,480 --> 00:53:43,510
often scale the uh input embedding one
uh up a little bit because you have this

2502
00:53:43,510 --> 00:53:43,520
uh up a little bit because you have this
 

2503
00:53:43,520 --> 00:53:46,230
uh up a little bit because you have this
extremely sparse vector coming in,

2504
00:53:46,230 --> 00:53:46,240
extremely sparse vector coming in,
 

2505
00:53:46,240 --> 00:53:47,750
extremely sparse vector coming in,
right? And so if you're weight sharing

2506
00:53:47,750 --> 00:53:47,760
right? And so if you're weight sharing
 

2507
00:53:47,760 --> 00:53:49,030
right? And so if you're weight sharing
with something that doesn't have that

2508
00:53:49,030 --> 00:53:49,040
with something that doesn't have that
 

2509
00:53:49,040 --> 00:53:50,870
with something that doesn't have that
kind of sparse vector coming in, you

2510
00:53:50,870 --> 00:53:50,880
kind of sparse vector coming in, you
 

2511
00:53:50,880 --> 00:53:52,150
kind of sparse vector coming in, you
want to make sure that your scales are

2512
00:53:52,150 --> 00:53:52,160
want to make sure that your scales are
 

2513
00:53:52,160 --> 00:53:55,030
want to make sure that your scales are
okay. And so you would upscale the uh

2514
00:53:55,030 --> 00:53:55,040
okay. And so you would upscale the uh
 

2515
00:53:55,040 --> 00:53:57,190
okay. And so you would upscale the uh
the input embedding layer. But these are

2516
00:53:57,190 --> 00:53:57,200
the input embedding layer. But these are
 

2517
00:53:57,200 --> 00:53:58,549
the input embedding layer. But these are
all details and these are this is I'm

2518
00:53:58,549 --> 00:53:58,559
all details and these are this is I'm
 

2519
00:53:58,559 --> 00:53:59,750
all details and these are this is I'm
not going to go into details on it

2520
00:53:59,750 --> 00:53:59,760
not going to go into details on it
 

2521
00:53:59,760 --> 00:54:03,270
not going to go into details on it
because nowadays the state-of-the-art is

2522
00:54:03,270 --> 00:54:03,280
because nowadays the state-of-the-art is
 

2523
00:54:03,280 --> 00:54:05,589
because nowadays the state-of-the-art is
to actually have independent things that

2524
00:54:05,589 --> 00:54:05,599
to actually have independent things that
 

2525
00:54:05,599 --> 00:54:07,109
to actually have independent things that
are learned for the embedding and the

2526
00:54:07,109 --> 00:54:07,119
are learned for the embedding and the
 

2527
00:54:07,119 --> 00:54:09,750
are learned for the embedding and the
dembedding because in some sense the

2528
00:54:09,750 --> 00:54:09,760
dembedding because in some sense the
 

2529
00:54:09,760 --> 00:54:11,430
dembedding because in some sense the
transpose is only the poor man's inverse

2530
00:54:11,430 --> 00:54:11,440
transpose is only the poor man's inverse
 

2531
00:54:11,440 --> 00:54:13,190
transpose is only the poor man's inverse
right and you know having an actual

2532
00:54:13,190 --> 00:54:13,200
right and you know having an actual
 

2533
00:54:13,200 --> 00:54:14,870
right and you know having an actual
different allows you to learn the better

2534
00:54:14,870 --> 00:54:14,880
different allows you to learn the better
 

2535
00:54:14,880 --> 00:54:17,430
different allows you to learn the better
inverse in some sense.

2536
00:54:17,430 --> 00:54:17,440
inverse in some sense.
 

2537
00:54:17,440 --> 00:54:17,990
inverse in some sense.
>> Yes.

2538
00:54:17,990 --> 00:54:18,000
>> Yes.
 

2539
00:54:18,000 --> 00:54:20,470
>> Yes.
>> Do you typically add a bias or or is it

2540
00:54:20,470 --> 00:54:20,480
>> Do you typically add a bias or or is it
 

2541
00:54:20,480 --> 00:54:24,309
>> Do you typically add a bias or or is it
not in practice like for the embedding?

2542
00:54:24,309 --> 00:54:24,319
not in practice like for the embedding?
 

2543
00:54:24,319 --> 00:54:26,870
not in practice like for the embedding?
>> Do you typically add a bias? I don't

2544
00:54:26,870 --> 00:54:26,880
>> Do you typically add a bias? I don't
 

2545
00:54:26,880 --> 00:54:30,630
>> Do you typically add a bias? I don't
think so. Yeah.

2546
00:54:30,630 --> 00:54:30,640
think so. Yeah.
 

2547
00:54:30,640 --> 00:54:31,750
think so. Yeah.
>> Yeah.

2548
00:54:31,750 --> 00:54:31,760
>> Yeah.
 

2549
00:54:31,760 --> 00:54:34,230
>> Yeah.
>> So, we're thinking of like the embedding

2550
00:54:34,230 --> 00:54:34,240
>> So, we're thinking of like the embedding
 

2551
00:54:34,240 --> 00:54:36,470
>> So, we're thinking of like the embedding
vector. You said all the entries are

2552
00:54:36,470 --> 00:54:36,480
vector. You said all the entries are
 

2553
00:54:36,480 --> 00:54:38,309
vector. You said all the entries are
like on the order of one,

2554
00:54:38,309 --> 00:54:38,319
like on the order of one,
 

2555
00:54:38,319 --> 00:54:41,910
like on the order of one,
>> right? Or the embedding the I me I the

2556
00:54:41,910 --> 00:54:41,920
>> right? Or the embedding the I me I the
 

2557
00:54:41,920 --> 00:54:43,829
>> right? Or the embedding the I me I the
input vector, right? Whatever the this

2558
00:54:43,829 --> 00:54:43,839
input vector, right? Whatever the this
 

2559
00:54:43,839 --> 00:54:46,150
input vector, right? Whatever the this
this this

2560
00:54:46,150 --> 00:54:46,160
this this
 

2561
00:54:46,160 --> 00:54:48,390
this this
alpha vector is basically what is coming

2562
00:54:48,390 --> 00:54:48,400
alpha vector is basically what is coming
 

2563
00:54:48,400 --> 00:54:51,910
alpha vector is basically what is coming
out of here.

2564
00:54:51,910 --> 00:54:51,920
out of here.
 

2565
00:54:51,920 --> 00:54:53,589
out of here.
Sorry, it's coming out of here. It's

2566
00:54:53,589 --> 00:54:53,599
Sorry, it's coming out of here. It's
 

2567
00:54:53,599 --> 00:54:55,109
Sorry, it's coming out of here. It's
this is this is the D- embedding layer.

2568
00:54:55,109 --> 00:54:55,119
this is this is the D- embedding layer.
 

2569
00:54:55,119 --> 00:54:57,270
this is this is the D- embedding layer.
And so this has been normalized. So

2570
00:54:57,270 --> 00:54:57,280
And so this has been normalized. So
 

2571
00:54:57,280 --> 00:54:58,390
And so this has been normalized. So
that's why I'm saying that it's

2572
00:54:58,390 --> 00:54:58,400
that's why I'm saying that it's
 

2573
00:54:58,400 --> 00:54:59,190
that's why I'm saying that it's
approximately.

2574
00:54:59,190 --> 00:54:59,200
approximately.
 

2575
00:54:59,200 --> 00:55:01,430
approximately.
>> So do we also want the output the 32 to

2576
00:55:01,430 --> 00:55:01,440
>> So do we also want the output the 32 to
 

2577
00:55:01,440 --> 00:55:03,270
>> So do we also want the output the 32 to
also have each entry be like order of

2578
00:55:03,270 --> 00:55:03,280
also have each entry be like order of
 

2579
00:55:03,280 --> 00:55:04,309
also have each entry be like order of
one or

2580
00:55:04,309 --> 00:55:04,319
one or
 

2581
00:55:04,319 --> 00:55:07,030
one or
>> I want it to be order of oneish is right

2582
00:55:07,030 --> 00:55:07,040
>> I want it to be order of oneish is right
 

2583
00:55:07,040 --> 00:55:09,190
>> I want it to be order of oneish is right
because I I I'm not I'm not feeding it

2584
00:55:09,190 --> 00:55:09,200
because I I I'm not I'm not feeding it
 

2585
00:55:09,200 --> 00:55:12,230
because I I I'm not I'm not feeding it
into an MLP but I want to have again I

2586
00:55:12,230 --> 00:55:12,240
into an MLP but I want to have again I
 

2587
00:55:12,240 --> 00:55:15,910
into an MLP but I want to have again I
don't want to have huge range or I don't

2588
00:55:15,910 --> 00:55:15,920
don't want to have huge range or I don't
 

2589
00:55:15,920 --> 00:55:18,150
don't want to have huge range or I don't
want to have some things dominating it

2590
00:55:18,150 --> 00:55:18,160
want to have some things dominating it
 

2591
00:55:18,160 --> 00:55:21,349
want to have some things dominating it
because I want to put it into a softmax.

2592
00:55:21,349 --> 00:55:21,359
because I want to put it into a softmax.
 

2593
00:55:21,359 --> 00:55:22,630
because I want to put it into a softmax.
So I guess when you're saying like that

2594
00:55:22,630 --> 00:55:22,640
So I guess when you're saying like that
 

2595
00:55:22,640 --> 00:55:25,589
So I guess when you're saying like that
the the rows of Q should be RMS one over

2596
00:55:25,589 --> 00:55:25,599
the the rows of Q should be RMS one over
 

2597
00:55:25,599 --> 00:55:27,190
the the rows of Q should be RMS one over
a th00and it's the same as like the

2598
00:55:27,190 --> 00:55:27,200
a th00and it's the same as like the
 

2599
00:55:27,200 --> 00:55:28,950
a th00and it's the same as like the
entries of the rows should each be order

2600
00:55:28,950 --> 00:55:28,960
entries of the rows should each be order
 

2601
00:55:28,960 --> 00:55:30,870
entries of the rows should each be order
of like one over a thousand because when

2602
00:55:30,870 --> 00:55:30,880
of like one over a thousand because when
 

2603
00:55:30,880 --> 00:55:35,270
of like one over a thousand because when
you add a thousand of them you get one

2604
00:55:35,270 --> 00:55:35,280
you add a thousand of them you get one
 

2605
00:55:35,280 --> 00:55:41,030
you add a thousand of them you get one
>> oh should this be one over

2606
00:55:41,030 --> 00:55:41,040

 

2607
00:55:41,040 --> 00:55:45,109

so I'm thinking that the RMS norm

2608
00:55:45,109 --> 00:55:45,119
so I'm thinking that the RMS norm
 

2609
00:55:45,119 --> 00:55:49,990
so I'm thinking that the RMS norm
of this should be 1 over<unk> th00and

2610
00:55:49,990 --> 00:55:50,000
of this should be 1 over<unk> th00and
 

2611
00:55:50,000 --> 00:55:55,430
of this should be 1 over<unk> th00and
So that means every entry

2612
00:55:55,430 --> 00:55:55,440
So that means every entry
 

2613
00:55:55,440 --> 00:55:56,789
So that means every entry
Oh, did I make a mistake? Should this

2614
00:55:56,789 --> 00:55:56,799
Oh, did I make a mistake? Should this
 

2615
00:55:56,799 --> 00:56:00,710
Oh, did I make a mistake? Should this
piece be one over a thousand?

2616
00:56:00,710 --> 00:56:00,720

 

2617
00:56:00,720 --> 00:56:03,750

Let me do it out.

2618
00:56:03,750 --> 00:56:03,760
Let me do it out.
 

2619
00:56:03,760 --> 00:56:06,230
Let me do it out.
So I have basically

2620
00:56:06,230 --> 00:56:06,240
So I have basically
 

2621
00:56:06,240 --> 00:56:11,270
So I have basically
let's call this uh I have some q1 * 1 +

2622
00:56:11,270 --> 00:56:11,280
let's call this uh I have some q1 * 1 +
 

2623
00:56:11,280 --> 00:56:16,630
let's call this uh I have some q1 * 1 +
q2 * 1 +

2624
00:56:16,630 --> 00:56:16,640

 

2625
00:56:16,640 --> 00:56:21,670

uh q1^ 2 q2 q1^ 2 * 1 and I want this to

2626
00:56:21,670 --> 00:56:21,680
uh q1^ 2 q2 q1^ 2 * 1 and I want this to
 

2627
00:56:21,680 --> 00:56:24,549
uh q1^ 2 q2 q1^ 2 * 1 and I want this to
be about 1.

2628
00:56:24,549 --> 00:56:24,559
be about 1.
 

2629
00:56:24,559 --> 00:56:29,910
be about 1.
So I have sigma qi squared to be

2630
00:56:29,910 --> 00:56:29,920
So I have sigma qi squared to be
 

2631
00:56:29,920 --> 00:56:34,230
So I have sigma qi squared to be
about 1 which means that I have

2632
00:56:34,230 --> 00:56:34,240
about 1 which means that I have
 

2633
00:56:34,240 --> 00:56:39,430
about 1 which means that I have
uh qi squared to be about a th00and

2634
00:56:39,430 --> 00:56:39,440
uh qi squared to be about a th00and
 

2635
00:56:39,440 --> 00:56:46,549
uh qi squared to be about a th00and
which means that I want qi^2

2636
00:56:46,549 --> 00:56:46,559

 

2637
00:56:46,559 --> 00:56:49,750

oh 1 over 1. No sorry what am I doing

2638
00:56:49,750 --> 00:56:49,760
oh 1 over 1. No sorry what am I doing
 

2639
00:56:49,760 --> 00:56:52,390
oh 1 over 1. No sorry what am I doing
wrong here? I have 1,00 * this is equal

2640
00:56:52,390 --> 00:56:52,400
wrong here? I have 1,00 * this is equal
 

2641
00:56:52,400 --> 00:56:56,470
wrong here? I have 1,00 * this is equal
to 1. Qi square is 1 over 1,00 which

2642
00:56:56,470 --> 00:56:56,480
to 1. Qi square is 1 over 1,00 which
 

2643
00:56:56,480 --> 00:56:59,430
to 1. Qi square is 1 over 1,00 which
means that qi is approximately 1

2644
00:56:59,430 --> 00:56:59,440
means that qi is approximately 1
 

2645
00:56:59,440 --> 00:57:01,190
means that qi is approximately 1
over<unk>

2646
00:57:01,190 --> 00:57:01,200
over<unk>
 

2647
00:57:01,200 --> 00:57:04,150
over<unk>
1000. So I should not say rms. I should

2648
00:57:04,150 --> 00:57:04,160
1000. So I should not say rms. I should
 

2649
00:57:04,160 --> 00:57:07,349
1000. So I should not say rms. I should
just want every row every entry of Q

2650
00:57:07,349 --> 00:57:07,359
just want every row every entry of Q
 

2651
00:57:07,359 --> 00:57:09,510
just want every row every entry of Q
should be approximately this is a better

2652
00:57:09,510 --> 00:57:09,520
should be approximately this is a better
 

2653
00:57:09,520 --> 00:57:23,030
should be approximately this is a better
way of writing it.

2654
00:57:23,030 --> 00:57:23,040

 

2655
00:57:23,040 --> 00:57:25,910

>> Yeah. Thanks. Is this clear?

2656
00:57:25,910 --> 00:57:25,920
>> Yeah. Thanks. Is this clear?
 

2657
00:57:25,920 --> 00:57:27,349
>> Yeah. Thanks. Is this clear?
>> Yeah. And I was also curious because I

2658
00:57:27,349 --> 00:57:27,359
>> Yeah. And I was also curious because I
 

2659
00:57:27,359 --> 00:57:28,630
>> Yeah. And I was also curious because I
know they originally put this like a one

2660
00:57:28,630 --> 00:57:28,640
know they originally put this like a one
 

2661
00:57:28,640 --> 00:57:30,390
know they originally put this like a one
pot. So it's just a single one and a

2662
00:57:30,390 --> 00:57:30,400
pot. So it's just a single one and a
 

2663
00:57:30,400 --> 00:57:32,069
pot. So it's just a single one and a
bunch of zeros. But now our output it's

2664
00:57:32,069 --> 00:57:32,079
bunch of zeros. But now our output it's
 

2665
00:57:32,079 --> 00:57:34,069
bunch of zeros. But now our output it's
a bunch of entries that are each like

2666
00:57:34,069 --> 00:57:34,079
a bunch of entries that are each like
 

2667
00:57:34,079 --> 00:57:34,470
a bunch of entries that are each like
one.

2668
00:57:34,470 --> 00:57:34,480
one.
 

2669
00:57:34,480 --> 00:57:37,030
one.
>> Yes. Yes. Which is why originally when

2670
00:57:37,030 --> 00:57:37,040
>> Yes. Yes. Which is why originally when
 

2671
00:57:37,040 --> 00:57:38,470
>> Yes. Yes. Which is why originally when
there was this weight sharing that was

2672
00:57:38,470 --> 00:57:38,480
there was this weight sharing that was
 

2673
00:57:38,480 --> 00:57:39,510
there was this weight sharing that was
happening where the embedding and the

2674
00:57:39,510 --> 00:57:39,520
happening where the embedding and the
 

2675
00:57:39,520 --> 00:57:40,789
happening where the embedding and the
dembedding were basically the same

2676
00:57:40,789 --> 00:57:40,799
dembedding were basically the same
 

2677
00:57:40,799 --> 00:57:43,109
dembedding were basically the same
matrix transposed. You would scale up

2678
00:57:43,109 --> 00:57:43,119
matrix transposed. You would scale up
 

2679
00:57:43,119 --> 00:57:46,309
matrix transposed. You would scale up
the input embedding because of the

2680
00:57:46,309 --> 00:57:46,319
the input embedding because of the
 

2681
00:57:46,319 --> 00:57:51,829
the input embedding because of the
sparsity of the input vector.

2682
00:57:51,829 --> 00:57:51,839

 

2683
00:57:51,839 --> 00:57:54,309

Okay. Good.

2684
00:57:54,309 --> 00:57:54,319
Okay. Good.
 

2685
00:57:54,319 --> 00:57:57,349
Okay. Good.
So now let's move on to talking about um

2686
00:57:57,349 --> 00:57:57,359
So now let's move on to talking about um
 

2687
00:57:57,359 --> 00:58:01,109
So now let's move on to talking about um
positional encoding. Okay.

2688
00:58:01,109 --> 00:58:01,119
positional encoding. Okay.
 

2689
00:58:01,119 --> 00:58:02,789
positional encoding. Okay.
So there's a couple of different

2690
00:58:02,789 --> 00:58:02,799
So there's a couple of different
 

2691
00:58:02,799 --> 00:58:05,030
So there's a couple of different
standard positional encoding strategies

2692
00:58:05,030 --> 00:58:05,040
standard positional encoding strategies
 

2693
00:58:05,040 --> 00:58:08,069
standard positional encoding strategies
that have been used. Let me talk you to

2694
00:58:08,069 --> 00:58:08,079
that have been used. Let me talk you to
 

2695
00:58:08,079 --> 00:58:09,750
that have been used. Let me talk you to
you first very briefly about the

2696
00:58:09,750 --> 00:58:09,760
you first very briefly about the
 

2697
00:58:09,760 --> 00:58:11,990
you first very briefly about the
original positional encoding in this

2698
00:58:11,990 --> 00:58:12,000
original positional encoding in this
 

2699
00:58:12,000 --> 00:58:15,030
original positional encoding in this
paper and what this positional encoding

2700
00:58:15,030 --> 00:58:15,040
paper and what this positional encoding
 

2701
00:58:15,040 --> 00:58:22,150
paper and what this positional encoding
here means. Okay.

2702
00:58:22,150 --> 00:58:22,160

 

2703
00:58:22,160 --> 00:58:25,270

And this picture actually kind of is a

2704
00:58:25,270 --> 00:58:25,280
And this picture actually kind of is a
 

2705
00:58:25,280 --> 00:58:27,910
And this picture actually kind of is a
is a good caricature of what that is

2706
00:58:27,910 --> 00:58:27,920
is a good caricature of what that is
 

2707
00:58:27,920 --> 00:58:30,230
is a good caricature of what that is
because the position encoding in the

2708
00:58:30,230 --> 00:58:30,240
because the position encoding in the
 

2709
00:58:30,240 --> 00:58:35,670
because the position encoding in the
original setup is basically trying to is

2710
00:58:35,670 --> 00:58:35,680
original setup is basically trying to is
 

2711
00:58:35,680 --> 00:58:39,589
original setup is basically trying to is
is is is is additive. So what you're

2712
00:58:39,589 --> 00:58:39,599
is is is is additive. So what you're
 

2713
00:58:39,599 --> 00:58:41,270
is is is is additive. So what you're
trying to do here is you're trying to

2714
00:58:41,270 --> 00:58:41,280
trying to do here is you're trying to
 

2715
00:58:41,280 --> 00:58:44,630
trying to do here is you're trying to
say look when I think about attention

2716
00:58:44,630 --> 00:58:44,640
say look when I think about attention
 

2717
00:58:44,640 --> 00:58:48,630
say look when I think about attention
the attention the Q key the Q and the K

2718
00:58:48,630 --> 00:58:48,640
the attention the Q key the Q and the K
 

2719
00:58:48,640 --> 00:58:52,549
the attention the Q key the Q and the K
and the V m V vectors and the uh

2720
00:58:52,549 --> 00:58:52,559
and the V m V vectors and the uh
 

2721
00:58:52,559 --> 00:58:54,870
and the V m V vectors and the uh
associated weight matrices they're all

2722
00:58:54,870 --> 00:58:54,880
associated weight matrices they're all
 

2723
00:58:54,880 --> 00:58:56,470
associated weight matrices they're all
just linear operations right I have my

2724
00:58:56,470 --> 00:58:56,480
just linear operations right I have my
 

2725
00:58:56,480 --> 00:58:58,789
just linear operations right I have my
entire input sequence and I'm just doing

2726
00:58:58,789 --> 00:58:58,799
entire input sequence and I'm just doing
 

2727
00:58:58,799 --> 00:59:01,190
entire input sequence and I'm just doing
a linear transformation

2728
00:59:01,190 --> 00:59:01,200
a linear transformation
 

2729
00:59:01,200 --> 00:59:03,109
a linear transformation
of all of these things I'm not really

2730
00:59:03,109 --> 00:59:03,119
of all of these things I'm not really
 

2731
00:59:03,119 --> 00:59:04,789
of all of these things I'm not really
paying attention to which was the first

2732
00:59:04,789 --> 00:59:04,799
paying attention to which was the first
 

2733
00:59:04,799 --> 00:59:06,789
paying attention to which was the first
word and which was the second word I

2734
00:59:06,789 --> 00:59:06,799
word and which was the second word I
 

2735
00:59:06,799 --> 00:59:08,390
word and which was the second word I
mean it matters in terms of what is hit

2736
00:59:08,390 --> 00:59:08,400
mean it matters in terms of what is hit
 

2737
00:59:08,400 --> 00:59:10,150
mean it matters in terms of what is hit
by what? But these are all learned

2738
00:59:10,150 --> 00:59:10,160
by what? But these are all learned
 

2739
00:59:10,160 --> 00:59:12,309
by what? But these are all learned
weight vectors,

2740
00:59:12,309 --> 00:59:12,319
weight vectors,
 

2741
00:59:12,319 --> 00:59:15,349
weight vectors,
right? So

2742
00:59:15,349 --> 00:59:15,359
right? So
 

2743
00:59:15,359 --> 00:59:17,430
right? So
should I be thinking about explicitly

2744
00:59:17,430 --> 00:59:17,440
should I be thinking about explicitly
 

2745
00:59:17,440 --> 00:59:19,829
should I be thinking about explicitly
somehow telling the model that wait this

2746
00:59:19,829 --> 00:59:19,839
somehow telling the model that wait this
 

2747
00:59:19,839 --> 00:59:21,270
somehow telling the model that wait this
was the first word and this was the

2748
00:59:21,270 --> 00:59:21,280
was the first word and this was the
 

2749
00:59:21,280 --> 00:59:22,870
was the first word and this was the
second word and this was the third word

2750
00:59:22,870 --> 00:59:22,880
second word and this was the third word
 

2751
00:59:22,880 --> 00:59:26,230
second word and this was the third word
because in language order matters. So

2752
00:59:26,230 --> 00:59:26,240
because in language order matters. So
 

2753
00:59:26,240 --> 00:59:28,549
because in language order matters. So
how do I additionally encode position?

2754
00:59:28,549 --> 00:59:28,559
how do I additionally encode position?
 

2755
00:59:28,559 --> 00:59:31,750
how do I additionally encode position?
Right? there's no no longer any state

2756
00:59:31,750 --> 00:59:31,760
Right? there's no no longer any state
 

2757
00:59:31,760 --> 00:59:33,670
Right? there's no no longer any state
that is keeping track of the position in

2758
00:59:33,670 --> 00:59:33,680
that is keeping track of the position in
 

2759
00:59:33,680 --> 00:59:36,549
that is keeping track of the position in
a recurrent network like I have you know

2760
00:59:36,549 --> 00:59:36,559
a recurrent network like I have you know
 

2761
00:59:36,559 --> 00:59:38,549
a recurrent network like I have you know
by just running over and over again I'm

2762
00:59:38,549 --> 00:59:38,559
by just running over and over again I'm
 

2763
00:59:38,559 --> 00:59:41,910
by just running over and over again I'm
keeping track of time in some sense

2764
00:59:41,910 --> 00:59:41,920
keeping track of time in some sense
 

2765
00:59:41,920 --> 00:59:44,390
keeping track of time in some sense
but now

2766
00:59:44,390 --> 00:59:44,400
but now
 

2767
00:59:44,400 --> 00:59:45,829
but now
where am I going to keep track of time

2768
00:59:45,829 --> 00:59:45,839
where am I going to keep track of time
 

2769
00:59:45,839 --> 00:59:47,270
where am I going to keep track of time
right there's nothing in this attention

2770
00:59:47,270 --> 00:59:47,280
right there's nothing in this attention
 

2771
00:59:47,280 --> 00:59:49,990
right there's nothing in this attention
I'm executing it all in parallel where

2772
00:59:49,990 --> 00:59:50,000
I'm executing it all in parallel where
 

2773
00:59:50,000 --> 00:59:52,390
I'm executing it all in parallel where
is my time that was the motivation for

2774
00:59:52,390 --> 00:59:52,400
is my time that was the motivation for
 

2775
00:59:52,400 --> 00:59:56,789
is my time that was the motivation for
these positional encodings okay

2776
00:59:56,789 --> 00:59:56,799
these positional encodings okay
 

2777
00:59:56,799 --> 00:59:58,549
these positional encodings okay
how do I tell the

2778
00:59:58,549 --> 00:59:58,559
how do I tell the
 

2779
00:59:58,559 --> 01:00:01,589
how do I tell the
what came first.

2780
01:00:01,589 --> 01:00:01,599
what came first.
 

2781
01:00:01,599 --> 01:00:04,789
what came first.
And so the desire was to be able to say,

2782
01:00:04,789 --> 01:00:04,799
And so the desire was to be able to say,
 

2783
01:00:04,799 --> 01:00:07,829
And so the desire was to be able to say,
how can I somehow differentiate

2784
01:00:07,829 --> 01:00:07,839
how can I somehow differentiate
 

2785
01:00:07,839 --> 01:00:11,109
how can I somehow differentiate
between the different input tokens that

2786
01:00:11,109 --> 01:00:11,119
between the different input tokens that
 

2787
01:00:11,119 --> 01:00:15,589
between the different input tokens that
are coming in at different times.

2788
01:00:15,589 --> 01:00:15,599

 

2789
01:00:15,599 --> 01:00:17,829

The idea what that was in the original

2790
01:00:17,829 --> 01:00:17,839
The idea what that was in the original
 

2791
01:00:17,839 --> 01:00:21,910
The idea what that was in the original
paper was to say okay let us add a

2792
01:00:21,910 --> 01:00:21,920
paper was to say okay let us add a
 

2793
01:00:21,920 --> 01:00:26,309
paper was to say okay let us add a
vector to your input so that there will

2794
01:00:26,309 --> 01:00:26,319
vector to your input so that there will
 

2795
01:00:26,319 --> 01:00:29,910
vector to your input so that there will
be some small variation based on where

2796
01:00:29,910 --> 01:00:29,920
be some small variation based on where
 

2797
01:00:29,920 --> 01:00:32,789
be some small variation based on where
you were in the in the actual sequence.

2798
01:00:32,789 --> 01:00:32,799
you were in the in the actual sequence.
 

2799
01:00:32,799 --> 01:00:35,190
you were in the in the actual sequence.
And something nice that varies with that

2800
01:00:35,190 --> 01:00:35,200
And something nice that varies with that
 

2801
01:00:35,200 --> 01:00:37,190
And something nice that varies with that
can vary uh with time is basically

2802
01:00:37,190 --> 01:00:37,200
can vary uh with time is basically
 

2803
01:00:37,200 --> 01:00:40,630
can vary uh with time is basically
taking a suicide or cosine.

2804
01:00:40,630 --> 01:00:40,640
taking a suicide or cosine.
 

2805
01:00:40,640 --> 01:00:42,630
taking a suicide or cosine.
And so

2806
01:00:42,630 --> 01:00:42,640
And so
 

2807
01:00:42,640 --> 01:00:48,390
And so
what this did was it literally said

2808
01:00:48,390 --> 01:00:48,400

 

2809
01:00:48,400 --> 01:00:50,710

let me just add a vector to every single

2810
01:00:50,710 --> 01:00:50,720
let me just add a vector to every single
 

2811
01:00:50,720 --> 01:00:54,390
let me just add a vector to every single
one of my inputs that has some sinoide

2812
01:00:54,390 --> 01:00:54,400
one of my inputs that has some sinoide
 

2813
01:00:54,400 --> 01:00:58,549
one of my inputs that has some sinoide
associated with it depending on the time

2814
01:00:58,549 --> 01:00:58,559
associated with it depending on the time
 

2815
01:00:58,559 --> 01:01:00,710
associated with it depending on the time
okay or the the time your position in

2816
01:01:00,710 --> 01:01:00,720
okay or the the time your position in
 

2817
01:01:00,720 --> 01:01:03,990
okay or the the time your position in
the sequence.

2818
01:01:03,990 --> 01:01:04,000

 

2819
01:01:04,000 --> 01:01:06,549

That was the highle idea and I'm just

2820
01:01:06,549 --> 01:01:06,559
That was the highle idea and I'm just
 

2821
01:01:06,559 --> 01:01:08,390
That was the highle idea and I'm just
not going to spend too much time on it

2822
01:01:08,390 --> 01:01:08,400
not going to spend too much time on it
 

2823
01:01:08,400 --> 01:01:10,950
not going to spend too much time on it
because it is now outdated and obsolete

2824
01:01:10,950 --> 01:01:10,960
because it is now outdated and obsolete
 

2825
01:01:10,960 --> 01:01:13,030
because it is now outdated and obsolete
and no one uses it. Um, and it was

2826
01:01:13,030 --> 01:01:13,040
and no one uses it. Um, and it was
 

2827
01:01:13,040 --> 01:01:14,470
and no one uses it. Um, and it was
proven to be like all of these other

2828
01:01:14,470 --> 01:01:14,480
proven to be like all of these other
 

2829
01:01:14,480 --> 01:01:15,510
proven to be like all of these other
things I'm going to talk about have

2830
01:01:15,510 --> 01:01:15,520
things I'm going to talk about have
 

2831
01:01:15,520 --> 01:01:17,589
things I'm going to talk about have
superseded this. But this was the highle

2832
01:01:17,589 --> 01:01:17,599
superseded this. But this was the highle
 

2833
01:01:17,599 --> 01:01:20,710
superseded this. But this was the highle
original idea and I just wanted to get

2834
01:01:20,710 --> 01:01:20,720
original idea and I just wanted to get
 

2835
01:01:20,720 --> 01:01:23,750
original idea and I just wanted to get
that uh to you. There's the Simon Prince

2836
01:01:23,750 --> 01:01:23,760
that uh to you. There's the Simon Prince
 

2837
01:01:23,760 --> 01:01:25,829
that uh to you. There's the Simon Prince
book has a has a nice figure showing

2838
01:01:25,829 --> 01:01:25,839
book has a has a nice figure showing
 

2839
01:01:25,839 --> 01:01:29,829
book has a has a nice figure showing
kind of how this uh

2840
01:01:29,829 --> 01:01:29,839
kind of how this uh
 

2841
01:01:29,839 --> 01:01:31,910
kind of how this uh
what these position embeddings really

2842
01:01:31,910 --> 01:01:31,920
what these position embeddings really
 

2843
01:01:31,920 --> 01:01:33,270
what these position embeddings really
look like. But even the book doesn't go

2844
01:01:33,270 --> 01:01:33,280
look like. But even the book doesn't go
 

2845
01:01:33,280 --> 01:01:36,950
look like. But even the book doesn't go
into much detail about it. Okay,

2846
01:01:36,950 --> 01:01:36,960
into much detail about it. Okay,
 

2847
01:01:36,960 --> 01:01:39,589
into much detail about it. Okay,
it turned out so that people said,

2848
01:01:39,589 --> 01:01:39,599
it turned out so that people said,
 

2849
01:01:39,599 --> 01:01:42,950
it turned out so that people said,
"Okay, this is interesting.

2850
01:01:42,950 --> 01:01:42,960
"Okay, this is interesting.
 

2851
01:01:42,960 --> 01:01:44,950
"Okay, this is interesting.
But

2852
01:01:44,950 --> 01:01:44,960
But
 

2853
01:01:44,960 --> 01:01:47,349
But
what if we tried something else? What if

2854
01:01:47,349 --> 01:01:47,359
what if we tried something else? What if
 

2855
01:01:47,359 --> 01:01:49,910
what if we tried something else? What if
we tried another embedding strategy?"

2856
01:01:49,910 --> 01:01:49,920
we tried another embedding strategy?"
 

2857
01:01:49,920 --> 01:01:51,750
we tried another embedding strategy?"
And this embedding strategy was called

2858
01:01:51,750 --> 01:01:51,760
And this embedding strategy was called
 

2859
01:01:51,760 --> 01:01:54,069
And this embedding strategy was called
nope.

2860
01:01:54,069 --> 01:01:54,079
nope.
 

2861
01:01:54,079 --> 01:01:55,510
nope.
Can you guess what it was based on the

2862
01:01:55,510 --> 01:01:55,520
Can you guess what it was based on the
 

2863
01:01:55,520 --> 01:01:57,510
Can you guess what it was based on the
name?

2864
01:01:57,510 --> 01:01:57,520
name?
 

2865
01:01:57,520 --> 01:02:01,510
name?
>> No positional embedding. So we said that

2866
01:02:01,510 --> 01:02:01,520
>> No positional embedding. So we said that
 

2867
01:02:01,520 --> 01:02:03,990
>> No positional embedding. So we said that
okay you know yeah the attention like

2868
01:02:03,990 --> 01:02:04,000
okay you know yeah the attention like
 

2869
01:02:04,000 --> 01:02:05,750
okay you know yeah the attention like
maybe just the structure of the

2870
01:02:05,750 --> 01:02:05,760
maybe just the structure of the
 

2871
01:02:05,760 --> 01:02:08,390
maybe just the structure of the
attention itself it does kind of matter

2872
01:02:08,390 --> 01:02:08,400
attention itself it does kind of matter
 

2873
01:02:08,400 --> 01:02:10,150
attention itself it does kind of matter
um what your position is because it does

2874
01:02:10,150 --> 01:02:10,160
um what your position is because it does
 

2875
01:02:10,160 --> 01:02:12,309
um what your position is because it does
matter which layer of the uh which row

2876
01:02:12,309 --> 01:02:12,319
matter which layer of the uh which row
 

2877
01:02:12,319 --> 01:02:14,230
matter which layer of the uh which row
of the matrix you're going to hit uh

2878
01:02:14,230 --> 01:02:14,240
of the matrix you're going to hit uh
 

2879
01:02:14,240 --> 01:02:17,430
of the matrix you're going to hit uh
will vary based on your uh position your

2880
01:02:17,430 --> 01:02:17,440
will vary based on your uh position your
 

2881
01:02:17,440 --> 01:02:19,030
will vary based on your uh position your
distance from the start token is yet

2882
01:02:19,030 --> 01:02:19,040
distance from the start token is yet
 

2883
01:02:19,040 --> 01:02:21,270
distance from the start token is yet
another way of keeping track of where

2884
01:02:21,270 --> 01:02:21,280
another way of keeping track of where
 

2885
01:02:21,280 --> 01:02:23,589
another way of keeping track of where
you are right you know that I'm I just

2886
01:02:23,589 --> 01:02:23,599
you are right you know that I'm I just
 

2887
01:02:23,599 --> 01:02:25,030
you are right you know that I'm I just
follow the start token because I can

2888
01:02:25,030 --> 01:02:25,040
follow the start token because I can
 

2889
01:02:25,040 --> 01:02:26,789
follow the start token because I can
always look at I can always have an

2890
01:02:26,789 --> 01:02:26,799
always look at I can always have an
 

2891
01:02:26,799 --> 01:02:30,069
always look at I can always have an
attention that is looking at

2892
01:02:30,069 --> 01:02:30,079
attention that is looking at
 

2893
01:02:30,079 --> 01:02:31,910
attention that is looking at
uh how far I am from the start token,

2894
01:02:31,910 --> 01:02:31,920
uh how far I am from the start token,
 

2895
01:02:31,920 --> 01:02:33,190
uh how far I am from the start token,
right? The start token will always get

2896
01:02:33,190 --> 01:02:33,200
right? The start token will always get
 

2897
01:02:33,200 --> 01:02:35,510
right? The start token will always get
encoded. I there will always be a key

2898
01:02:35,510 --> 01:02:35,520
encoded. I there will always be a key
 

2899
01:02:35,520 --> 01:02:37,109
encoded. I there will always be a key
for that. And so I can keep track of my

2900
01:02:37,109 --> 01:02:37,119
for that. And so I can keep track of my
 

2901
01:02:37,119 --> 01:02:38,630
for that. And so I can keep track of my
position by looking at my distance from

2902
01:02:38,630 --> 01:02:38,640
position by looking at my distance from
 

2903
01:02:38,640 --> 01:02:40,710
position by looking at my distance from
the start token. So actually attention

2904
01:02:40,710 --> 01:02:40,720
the start token. So actually attention
 

2905
01:02:40,720 --> 01:02:43,510
the start token. So actually attention
has embedded in it a position encoding

2906
01:02:43,510 --> 01:02:43,520
has embedded in it a position encoding
 

2907
01:02:43,520 --> 01:02:45,190
has embedded in it a position encoding
already.

2908
01:02:45,190 --> 01:02:45,200
already.
 

2909
01:02:45,200 --> 01:02:47,190
already.
And so this motivated people to say like

2910
01:02:47,190 --> 01:02:47,200
And so this motivated people to say like
 

2911
01:02:47,200 --> 01:02:49,829
And so this motivated people to say like
why don't we just try nope no position

2912
01:02:49,829 --> 01:02:49,839
why don't we just try nope no position
 

2913
01:02:49,839 --> 01:02:52,710
why don't we just try nope no position
encoding at all. And turns out that this

2914
01:02:52,710 --> 01:02:52,720
encoding at all. And turns out that this
 

2915
01:02:52,720 --> 01:02:55,349
encoding at all. And turns out that this
actually matches performance of the

2916
01:02:55,349 --> 01:02:55,359
actually matches performance of the
 

2917
01:02:55,359 --> 01:02:57,349
actually matches performance of the
original per position encoding in many

2918
01:02:57,349 --> 01:02:57,359
original per position encoding in many
 

2919
01:02:57,359 --> 01:02:59,109
original per position encoding in many
many cases.

2920
01:02:59,109 --> 01:02:59,119
many cases.
 

2921
01:02:59,119 --> 01:03:01,829
many cases.
Okay, so once this was realized then

2922
01:03:01,829 --> 01:03:01,839
Okay, so once this was realized then
 

2923
01:03:01,839 --> 01:03:04,069
Okay, so once this was realized then
kind of that old position encoding was

2924
01:03:04,069 --> 01:03:04,079
kind of that old position encoding was
 

2925
01:03:04,079 --> 01:03:06,390
kind of that old position encoding was
simply never used because nope is almost

2926
01:03:06,390 --> 01:03:06,400
simply never used because nope is almost
 

2927
01:03:06,400 --> 01:03:08,230
simply never used because nope is almost
the same.

2928
01:03:08,230 --> 01:03:08,240
the same.
 

2929
01:03:08,240 --> 01:03:10,150
the same.
Okay,

2930
01:03:10,150 --> 01:03:10,160
Okay,
 

2931
01:03:10,160 --> 01:03:11,910
Okay,
so nope is the second positional

2932
01:03:11,910 --> 01:03:11,920
so nope is the second positional
 

2933
01:03:11,920 --> 01:03:14,150
so nope is the second positional
encoding.

2934
01:03:14,150 --> 01:03:14,160
encoding.
 

2935
01:03:14,160 --> 01:03:16,150
encoding.
The third position encoding that I want

2936
01:03:16,150 --> 01:03:16,160
The third position encoding that I want
 

2937
01:03:16,160 --> 01:03:19,029
The third position encoding that I want
to talk about. So here nope is just let

2938
01:03:19,029 --> 01:03:19,039
to talk about. So here nope is just let
 

2939
01:03:19,039 --> 01:03:22,069
to talk about. So here nope is just let
me just say no position encoding.

2940
01:03:22,069 --> 01:03:22,079
me just say no position encoding.
 

2941
01:03:22,079 --> 01:03:23,910
me just say no position encoding.
>> I I have a question about that. So does

2942
01:03:23,910 --> 01:03:23,920
>> I I have a question about that. So does
 

2943
01:03:23,920 --> 01:03:26,309
>> I I have a question about that. So does
that did they never try that? Like I

2944
01:03:26,309 --> 01:03:26,319
that did they never try that? Like I
 

2945
01:03:26,319 --> 01:03:27,589
that did they never try that? Like I
would have imagined that in the

2946
01:03:27,589 --> 01:03:27,599
would have imagined that in the
 

2947
01:03:27,599 --> 01:03:28,710
would have imagined that in the
attention is all you need paper that

2948
01:03:28,710 --> 01:03:28,720
attention is all you need paper that
 

2949
01:03:28,720 --> 01:03:29,829
attention is all you need paper that
would be the first thing that you do,

2950
01:03:29,829 --> 01:03:29,839
would be the first thing that you do,
 

2951
01:03:29,839 --> 01:03:33,029
would be the first thing that you do,
right? It's just not have that.

2952
01:03:33,029 --> 01:03:33,039
right? It's just not have that.
 

2953
01:03:33,039 --> 01:03:35,029
right? It's just not have that.
>> No, unfortunately. And probably like

2954
01:03:35,029 --> 01:03:35,039
>> No, unfortunately. And probably like
 

2955
01:03:35,039 --> 01:03:36,710
>> No, unfortunately. And probably like
probably what is to blame is like the

2956
01:03:36,710 --> 01:03:36,720
probably what is to blame is like the
 

2957
01:03:36,720 --> 01:03:38,870
probably what is to blame is like the
crazy conference deadline pressure,

2958
01:03:38,870 --> 01:03:38,880
crazy conference deadline pressure,
 

2959
01:03:38,880 --> 01:03:43,270
crazy conference deadline pressure,
right? They needed to get a paper out.

2960
01:03:43,270 --> 01:03:43,280

 

2961
01:03:43,280 --> 01:03:45,029

Uh I mean I have no idea. I don't know

2962
01:03:45,029 --> 01:03:45,039
Uh I mean I have no idea. I don't know
 

2963
01:03:45,039 --> 01:03:46,870
Uh I mean I have no idea. I don't know
the authors there. I don't know what

2964
01:03:46,870 --> 01:03:46,880
the authors there. I don't know what
 

2965
01:03:46,880 --> 01:03:49,990
the authors there. I don't know what
happened. But the way research is done

2966
01:03:49,990 --> 01:03:50,000
happened. But the way research is done
 

2967
01:03:50,000 --> 01:03:52,230
happened. But the way research is done
these days is that you're just trying to

2968
01:03:52,230 --> 01:03:52,240
these days is that you're just trying to
 

2969
01:03:52,240 --> 01:03:54,630
these days is that you're just trying to
get something out before the deadline

2970
01:03:54,630 --> 01:03:54,640
get something out before the deadline
 

2971
01:03:54,640 --> 01:03:55,990
get something out before the deadline
and you're you're rushing rushing

2972
01:03:55,990 --> 01:03:56,000
and you're you're rushing rushing
 

2973
01:03:56,000 --> 01:03:57,510
and you're you're rushing rushing
rushing rushing rushing. This kind of

2974
01:03:57,510 --> 01:03:57,520
rushing rushing rushing. This kind of
 

2975
01:03:57,520 --> 01:04:00,150
rushing rushing rushing. This kind of
worked. Let's publish it. Right? We're

2976
01:04:00,150 --> 01:04:00,160
worked. Let's publish it. Right? We're
 

2977
01:04:00,160 --> 01:04:03,109
worked. Let's publish it. Right? We're
not doing a systematic controlled

2978
01:04:03,109 --> 01:04:03,119
not doing a systematic controlled
 

2979
01:04:03,119 --> 01:04:05,430
not doing a systematic controlled
ablation on every single possible thing

2980
01:04:05,430 --> 01:04:05,440
ablation on every single possible thing
 

2981
01:04:05,440 --> 01:04:07,349
ablation on every single possible thing
that may or may not work. We don't have

2982
01:04:07,349 --> 01:04:07,359
that may or may not work. We don't have
 

2983
01:04:07,359 --> 01:04:09,270
that may or may not work. We don't have
time.

2984
01:04:09,270 --> 01:04:09,280
time.
 

2985
01:04:09,280 --> 01:04:11,510
time.
Which, you know, is probably not the

2986
01:04:11,510 --> 01:04:11,520
Which, you know, is probably not the
 

2987
01:04:11,520 --> 01:04:13,510
Which, you know, is probably not the
right way to be doing things, but uh

2988
01:04:13,510 --> 01:04:13,520
right way to be doing things, but uh
 

2989
01:04:13,520 --> 01:04:16,150
right way to be doing things, but uh
this is uh I'm just making the story up.

2990
01:04:16,150 --> 01:04:16,160
this is uh I'm just making the story up.
 

2991
01:04:16,160 --> 01:04:17,589
this is uh I'm just making the story up.
I don't really know. But that's my

2992
01:04:17,589 --> 01:04:17,599
I don't really know. But that's my
 

2993
01:04:17,599 --> 01:04:24,390
I don't really know. But that's my
guess.

2994
01:04:24,390 --> 01:04:24,400

 

2995
01:04:24,400 --> 01:04:27,829

Okay. So let's now move to the second

2996
01:04:27,829 --> 01:04:27,839
Okay. So let's now move to the second
 

2997
01:04:27,839 --> 01:04:29,990
Okay. So let's now move to the second
idea which is or the third idea which is

2998
01:04:29,990 --> 01:04:30,000
idea which is or the third idea which is
 

2999
01:04:30,000 --> 01:04:32,870
idea which is or the third idea which is
learned relative positional encoding.

3000
01:04:32,870 --> 01:04:32,880
learned relative positional encoding.
 

3001
01:04:32,880 --> 01:04:34,390
learned relative positional encoding.
So one thing that people were thinking

3002
01:04:34,390 --> 01:04:34,400
So one thing that people were thinking
 

3003
01:04:34,400 --> 01:04:36,309
So one thing that people were thinking
is that okay they they notice that nope

3004
01:04:36,309 --> 01:04:36,319
is that okay they they notice that nope
 

3005
01:04:36,319 --> 01:04:38,470
is that okay they they notice that nope
works

3006
01:04:38,470 --> 01:04:38,480
works
 

3007
01:04:38,480 --> 01:04:40,390
works
but maybe something that could be

3008
01:04:40,390 --> 01:04:40,400
but maybe something that could be
 

3009
01:04:40,400 --> 01:04:43,670
but maybe something that could be
important is more so than the absolute

3010
01:04:43,670 --> 01:04:43,680
important is more so than the absolute
 

3011
01:04:43,680 --> 01:04:45,029
important is more so than the absolute
position of whether I'm the third

3012
01:04:45,029 --> 01:04:45,039
position of whether I'm the third
 

3013
01:04:45,039 --> 01:04:47,109
position of whether I'm the third
sentence or the fifth fifth maybe

3014
01:04:47,109 --> 01:04:47,119
sentence or the fifth fifth maybe
 

3015
01:04:47,119 --> 01:04:48,710
sentence or the fifth fifth maybe
whether I'm the third token or the fifth

3016
01:04:48,710 --> 01:04:48,720
whether I'm the third token or the fifth
 

3017
01:04:48,720 --> 01:04:51,349
whether I'm the third token or the fifth
token or whatever maybe what does matter

3018
01:04:51,349 --> 01:04:51,359
token or whatever maybe what does matter
 

3019
01:04:51,359 --> 01:04:55,670
token or whatever maybe what does matter
is am I you know three or four or five

3020
01:04:55,670 --> 01:04:55,680
is am I you know three or four or five
 

3021
01:04:55,680 --> 01:04:58,470
is am I you know three or four or five
tokens away from you or am I 15 tokens

3022
01:04:58,470 --> 01:04:58,480
tokens away from you or am I 15 tokens
 

3023
01:04:58,480 --> 01:05:00,630
tokens away from you or am I 15 tokens
away from you or am I you know 200

3024
01:05:00,630 --> 01:05:00,640
away from you or am I you know 200
 

3025
01:05:00,640 --> 01:05:03,270
away from you or am I you know 200
tokens away from you. the relative

3026
01:05:03,270 --> 01:05:03,280
tokens away from you. the relative
 

3027
01:05:03,280 --> 01:05:06,470
tokens away from you. the relative
positions between tokens maybe matters

3028
01:05:06,470 --> 01:05:06,480
positions between tokens maybe matters
 

3029
01:05:06,480 --> 01:05:09,589
positions between tokens maybe matters
more than the

3030
01:05:09,589 --> 01:05:09,599
more than the
 

3031
01:05:09,599 --> 01:05:12,950
more than the
absolute position uh between that I'm

3032
01:05:12,950 --> 01:05:12,960
absolute position uh between that I'm
 

3033
01:05:12,960 --> 01:05:14,390
absolute position uh between that I'm
actually at right it doesn't matter that

3034
01:05:14,390 --> 01:05:14,400
actually at right it doesn't matter that
 

3035
01:05:14,400 --> 01:05:16,470
actually at right it doesn't matter that
I'm the 25th word but it does matter

3036
01:05:16,470 --> 01:05:16,480
I'm the 25th word but it does matter
 

3037
01:05:16,480 --> 01:05:21,829
I'm the 25th word but it does matter
that I just came after a full stop

3038
01:05:21,829 --> 01:05:21,839

 

3039
01:05:21,839 --> 01:05:24,470

right so how can we capture this

3040
01:05:24,470 --> 01:05:24,480
right so how can we capture this
 

3041
01:05:24,480 --> 01:05:27,430
right so how can we capture this
relativity or the relative position uh

3042
01:05:27,430 --> 01:05:27,440
relativity or the relative position uh
 

3043
01:05:27,440 --> 01:05:31,430
relativity or the relative position uh
and that was the kind of motivation here

3044
01:05:31,430 --> 01:05:31,440
and that was the kind of motivation here
 

3045
01:05:31,440 --> 01:05:34,230
and that was the kind of motivation here
and So the idea was okay the previous

3046
01:05:34,230 --> 01:05:34,240
and So the idea was okay the previous
 

3047
01:05:34,240 --> 01:05:35,910
and So the idea was okay the previous
kind of position encoding just tried to

3048
01:05:35,910 --> 01:05:35,920
kind of position encoding just tried to
 

3049
01:05:35,920 --> 01:05:40,710
kind of position encoding just tried to
add something directly um in but maybe

3050
01:05:40,710 --> 01:05:40,720
add something directly um in but maybe
 

3051
01:05:40,720 --> 01:05:42,470
add something directly um in but maybe
what we can do is really just think

3052
01:05:42,470 --> 01:05:42,480
what we can do is really just think
 

3053
01:05:42,480 --> 01:05:44,870
what we can do is really just think
about can we modify the attention

3054
01:05:44,870 --> 01:05:44,880
about can we modify the attention
 

3055
01:05:44,880 --> 01:05:49,510
about can we modify the attention
mechanism itself somehow to be able to

3056
01:05:49,510 --> 01:05:49,520
mechanism itself somehow to be able to
 

3057
01:05:49,520 --> 01:05:51,829
mechanism itself somehow to be able to
capture the relative position of a query

3058
01:05:51,829 --> 01:05:51,839
capture the relative position of a query
 

3059
01:05:51,839 --> 01:05:54,549
capture the relative position of a query
in a key. Right? The reason that

3060
01:05:54,549 --> 01:05:54,559
in a key. Right? The reason that
 

3061
01:05:54,559 --> 01:05:55,910
in a key. Right? The reason that
positional encodings were added

3062
01:05:55,910 --> 01:05:55,920
positional encodings were added
 

3063
01:05:55,920 --> 01:05:59,109
positional encodings were added
externally was that the naive attention

3064
01:05:59,109 --> 01:05:59,119
externally was that the naive attention
 

3065
01:05:59,119 --> 01:06:01,829
externally was that the naive attention
didn't have that uh anything about the

3066
01:06:01,829 --> 01:06:01,839
didn't have that uh anything about the
 

3067
01:06:01,839 --> 01:06:04,710
didn't have that uh anything about the
indices in that formula itself. Does

3068
01:06:04,710 --> 01:06:04,720
indices in that formula itself. Does
 

3069
01:06:04,720 --> 01:06:06,950
indices in that formula itself. Does
everyone see that? So if I think about

3070
01:06:06,950 --> 01:06:06,960
everyone see that? So if I think about
 

3071
01:06:06,960 --> 01:06:15,990
everyone see that? So if I think about
just basic attention,

3072
01:06:15,990 --> 01:06:16,000

 

3073
01:06:16,000 --> 01:06:18,710

right? Um I was computing a score

3074
01:06:18,710 --> 01:06:18,720
right? Um I was computing a score
 

3075
01:06:18,720 --> 01:06:20,950
right? Um I was computing a score
basically score

3076
01:06:20,950 --> 01:06:20,960
basically score
 

3077
01:06:20,960 --> 01:06:22,789
basically score
si

3078
01:06:22,789 --> 01:06:22,799
si
 

3079
01:06:22,799 --> 01:06:24,870
si
of my

3080
01:06:24,870 --> 01:06:24,880
of my
 

3081
01:06:24,880 --> 01:06:27,510
of my
uh

3082
01:06:27,510 --> 01:06:27,520
uh
 

3083
01:06:27,520 --> 01:06:31,510
uh
query at time t with my key at position

3084
01:06:31,510 --> 01:06:31,520
query at time t with my key at position
 

3085
01:06:31,520 --> 01:06:34,950
query at time t with my key at position
i. And this was divided by this square

3086
01:06:34,950 --> 01:06:34,960
i. And this was divided by this square
 

3087
01:06:34,960 --> 01:06:38,069
i. And this was divided by this square
root d. This was my score.

3088
01:06:38,069 --> 01:06:38,079
root d. This was my score.
 

3089
01:06:38,079 --> 01:06:44,069
root d. This was my score.
Um, query at time t.

3090
01:06:44,069 --> 01:06:44,079

 

3091
01:06:44,079 --> 01:06:45,829

I

3092
01:06:45,829 --> 01:06:45,839
I
 

3093
01:06:45,839 --> 01:06:48,470
I
or ki is

3094
01:06:48,470 --> 01:06:48,480
or ki is
 

3095
01:06:48,480 --> 01:06:53,990
or ki is
key at position i.

3096
01:06:53,990 --> 01:06:54,000
key at position i.
 

3097
01:06:54,000 --> 01:06:56,870
key at position i.
And then from this I had a probability

3098
01:06:56,870 --> 01:06:56,880
And then from this I had a probability
 

3099
01:06:56,880 --> 01:07:00,230
And then from this I had a probability
that I computed which is pi

3100
01:07:00,230 --> 01:07:00,240
that I computed which is pi
 

3101
01:07:00,240 --> 01:07:04,630
that I computed which is pi
is e to the si divided by

3102
01:07:04,630 --> 01:07:04,640
is e to the si divided by
 

3103
01:07:04,640 --> 01:07:07,190
is e to the si divided by
e to the

3104
01:07:07,190 --> 01:07:07,200
e to the
 

3105
01:07:07,200 --> 01:07:11,349
e to the
let's say sj over j right I used a soft

3106
01:07:11,349 --> 01:07:11,359
let's say sj over j right I used a soft
 

3107
01:07:11,359 --> 01:07:18,150
let's say sj over j right I used a soft
max to then compute this probability.

3108
01:07:18,150 --> 01:07:18,160

 

3109
01:07:18,160 --> 01:07:21,109

Okay. So what learned relative position

3110
01:07:21,109 --> 01:07:21,119
Okay. So what learned relative position
 

3111
01:07:21,119 --> 01:07:28,390
Okay. So what learned relative position
encoding said let me modify this

3112
01:07:28,390 --> 01:07:28,400

 

3113
01:07:28,400 --> 01:07:32,390

and let me instead say pi

3114
01:07:32,390 --> 01:07:32,400
and let me instead say pi
 

3115
01:07:32,400 --> 01:07:36,549
and let me instead say pi
is equal to e to the si

3116
01:07:36,549 --> 01:07:36,559
is equal to e to the si
 

3117
01:07:36,559 --> 01:07:38,150
is equal to e to the si
plus

3118
01:07:38,150 --> 01:07:38,160
plus
 

3119
01:07:38,160 --> 01:07:47,990
plus
something.

3120
01:07:47,990 --> 01:07:48,000

 

3121
01:07:48,000 --> 01:07:49,670

And it'll have to be I'll also have to

3122
01:07:49,670 --> 01:07:49,680
And it'll have to be I'll also have to
 

3123
01:07:49,680 --> 01:07:51,430
And it'll have to be I'll also have to
add those things to the denominator

3124
01:07:51,430 --> 01:07:51,440
add those things to the denominator
 

3125
01:07:51,440 --> 01:07:54,309
add those things to the denominator
because I want to make sure that my

3126
01:07:54,309 --> 01:07:54,319
because I want to make sure that my
 

3127
01:07:54,319 --> 01:07:56,230
because I want to make sure that my
normalization still works out, right? I

3128
01:07:56,230 --> 01:07:56,240
normalization still works out, right? I
 

3129
01:07:56,240 --> 01:07:57,750
normalization still works out, right? I
still want to have a probability come

3130
01:07:57,750 --> 01:07:57,760
still want to have a probability come
 

3131
01:07:57,760 --> 01:08:01,029
still want to have a probability come
out, but I want to modify this

3132
01:08:01,029 --> 01:08:01,039
out, but I want to modify this
 

3133
01:08:01,039 --> 01:08:02,549
out, but I want to modify this
probability that's going to come out and

3134
01:08:02,549 --> 01:08:02,559
probability that's going to come out and
 

3135
01:08:02,559 --> 01:08:05,510
probability that's going to come out and
I want to modify it in a way that

3136
01:08:05,510 --> 01:08:05,520
I want to modify it in a way that
 

3137
01:08:05,520 --> 01:08:09,349
I want to modify it in a way that
depends on the relative positions.

3138
01:08:09,349 --> 01:08:09,359
depends on the relative positions.
 

3139
01:08:09,359 --> 01:08:11,510
depends on the relative positions.
Okay,

3140
01:08:11,510 --> 01:08:11,520
Okay,
 

3141
01:08:11,520 --> 01:08:14,069
Okay,
does that make sense to everyone? So, I

3142
01:08:14,069 --> 01:08:14,079
does that make sense to everyone? So, I
 

3143
01:08:14,079 --> 01:08:18,789
does that make sense to everyone? So, I
want to somehow change this thing.

3144
01:08:18,789 --> 01:08:18,799
want to somehow change this thing.
 

3145
01:08:18,799 --> 01:08:20,550
want to somehow change this thing.
I don't know how I want to change it

3146
01:08:20,550 --> 01:08:20,560
I don't know how I want to change it
 

3147
01:08:20,560 --> 01:08:22,149
I don't know how I want to change it
exactly, but I have some idea that I

3148
01:08:22,149 --> 01:08:22,159
exactly, but I have some idea that I
 

3149
01:08:22,159 --> 01:08:23,749
exactly, but I have some idea that I
want to change this in a way that the

3150
01:08:23,749 --> 01:08:23,759
want to change this in a way that the
 

3151
01:08:23,759 --> 01:08:27,430
want to change this in a way that the
relative positions matter.

3152
01:08:27,430 --> 01:08:27,440
relative positions matter.
 

3153
01:08:27,440 --> 01:08:28,709
relative positions matter.
So, what are we going to do? We don't

3154
01:08:28,709 --> 01:08:28,719
So, what are we going to do? We don't
 

3155
01:08:28,719 --> 01:08:30,550
So, what are we going to do? We don't
know how we want to do it. We just have

3156
01:08:30,550 --> 01:08:30,560
know how we want to do it. We just have
 

3157
01:08:30,560 --> 01:08:32,309
know how we want to do it. We just have
some idea that we want to do it. So,

3158
01:08:32,309 --> 01:08:32,319
some idea that we want to do it. So,
 

3159
01:08:32,319 --> 01:08:34,630
some idea that we want to do it. So,
we're going to do the same thing. We're

3160
01:08:34,630 --> 01:08:34,640
we're going to do the same thing. We're
 

3161
01:08:34,640 --> 01:08:36,470
we're going to do the same thing. We're
going to learn the something, right? So

3162
01:08:36,470 --> 01:08:36,480
going to learn the something, right? So
 

3163
01:08:36,480 --> 01:08:38,070
going to learn the something, right? So
I want to instead of this I want to

3164
01:08:38,070 --> 01:08:38,080
I want to instead of this I want to
 

3165
01:08:38,080 --> 01:08:42,789
I want to instead of this I want to
write pi is equal to e to the si plus

3166
01:08:42,789 --> 01:08:42,799
write pi is equal to e to the si plus
 

3167
01:08:42,799 --> 01:08:47,269
write pi is equal to e to the si plus
some I want to call this b uh maybe

3168
01:08:47,269 --> 01:08:47,279
some I want to call this b uh maybe
 

3169
01:08:47,279 --> 01:08:51,829
some I want to call this b uh maybe
shift

3170
01:08:51,829 --> 01:08:51,839

 

3171
01:08:51,839 --> 01:08:56,630

and this b shift is a function

3172
01:08:56,630 --> 01:08:56,640

 

3173
01:08:56,640 --> 01:08:59,990

of t

3174
01:08:59,990 --> 01:09:00,000
of t
 

3175
01:09:00,000 --> 01:09:04,390
of t
and i or t minus i really is the uh what

3176
01:09:04,390 --> 01:09:04,400
and i or t minus i really is the uh what
 

3177
01:09:04,400 --> 01:09:06,070
and i or t minus i really is the uh what
you want to think about it as Maybe I

3178
01:09:06,070 --> 01:09:06,080
you want to think about it as Maybe I
 

3179
01:09:06,080 --> 01:09:07,430
you want to think about it as Maybe I
shouldn't even say T and I, but I want

3180
01:09:07,430 --> 01:09:07,440
shouldn't even say T and I, but I want
 

3181
01:09:07,440 --> 01:09:12,309
shouldn't even say T and I, but I want
to think about T minus I because

3182
01:09:12,309 --> 01:09:12,319
to think about T minus I because
 

3183
01:09:12,319 --> 01:09:15,749
to think about T minus I because
I want to say that

3184
01:09:15,749 --> 01:09:15,759
I want to say that
 

3185
01:09:15,759 --> 01:09:17,910
I want to say that
I want this B like let's say I'm at

3186
01:09:17,910 --> 01:09:17,920
I want this B like let's say I'm at
 

3187
01:09:17,920 --> 01:09:21,030
I want this B like let's say I'm at
position 10. Okay? And I'm looking at

3188
01:09:21,030 --> 01:09:21,040
position 10. Okay? And I'm looking at
 

3189
01:09:21,040 --> 01:09:24,550
position 10. Okay? And I'm looking at
position 7 behind me. The B for position

3190
01:09:24,550 --> 01:09:24,560
position 7 behind me. The B for position
 

3191
01:09:24,560 --> 01:09:26,950
position 7 behind me. The B for position
10 compared to 7 should be the same as

3192
01:09:26,950 --> 01:09:26,960
10 compared to 7 should be the same as
 

3193
01:09:26,960 --> 01:09:31,430
10 compared to 7 should be the same as
the B for position 11 compared to 8, 12

3194
01:09:31,430 --> 01:09:31,440
the B for position 11 compared to 8, 12
 

3195
01:09:31,440 --> 01:09:33,510
the B for position 11 compared to 8, 12
compared to 9. Basically everything with

3196
01:09:33,510 --> 01:09:33,520
compared to 9. Basically everything with
 

3197
01:09:33,520 --> 01:09:35,910
compared to 9. Basically everything with
a minus3

3198
01:09:35,910 --> 01:09:35,920
a minus3
 

3199
01:09:35,920 --> 01:09:37,749
a minus3
should be the same. Everything with a

3200
01:09:37,749 --> 01:09:37,759
should be the same. Everything with a
 

3201
01:09:37,759 --> 01:09:39,669
should be the same. Everything with a
minus4 should be the same. All I care

3202
01:09:39,669 --> 01:09:39,679
minus4 should be the same. All I care
 

3203
01:09:39,679 --> 01:09:41,829
minus4 should be the same. All I care
about is this relative relative

3204
01:09:41,829 --> 01:09:41,839
about is this relative relative
 

3205
01:09:41,839 --> 01:09:44,309
about is this relative relative
distance. Okay. So I'm going to weight

3206
01:09:44,309 --> 01:09:44,319
distance. Okay. So I'm going to weight
 

3207
01:09:44,319 --> 01:09:47,110
distance. Okay. So I'm going to weight
share. I'm going to have the same

3208
01:09:47,110 --> 01:09:47,120
share. I'm going to have the same
 

3209
01:09:47,120 --> 01:09:51,030
share. I'm going to have the same
parameter based on just this difference

3210
01:09:51,030 --> 01:09:51,040
parameter based on just this difference
 

3211
01:09:51,040 --> 01:09:55,110
parameter based on just this difference
t minus i. And I'm gonna learn this

3212
01:09:55,110 --> 01:09:55,120
t minus i. And I'm gonna learn this
 

3213
01:09:55,120 --> 01:09:59,030
t minus i. And I'm gonna learn this
particular um

3214
01:09:59,030 --> 01:09:59,040
particular um
 

3215
01:09:59,040 --> 01:10:00,630
particular um
so I should call this maybe this will be

3216
01:10:00,630 --> 01:10:00,640
so I should call this maybe this will be
 

3217
01:10:00,640 --> 01:10:02,630
so I should call this maybe this will be
better if I I should not call this pi I

3218
01:10:02,630 --> 01:10:02,640
better if I I should not call this pi I
 

3219
01:10:02,640 --> 01:10:06,950
better if I I should not call this pi I
should call this P of T comma I

3220
01:10:06,950 --> 01:10:06,960
should call this P of T comma I
 

3221
01:10:06,960 --> 01:10:09,750
should call this P of T comma I
and I'll call this

3222
01:10:09,750 --> 01:10:09,760
and I'll call this
 

3223
01:10:09,760 --> 01:10:13,350
and I'll call this
P of T comma I

3224
01:10:13,350 --> 01:10:13,360
P of T comma I
 

3225
01:10:13,360 --> 01:10:16,470
P of T comma I
P of T comma I

3226
01:10:16,470 --> 01:10:16,480
P of T comma I
 

3227
01:10:16,480 --> 01:10:20,149
P of T comma I
and here let me label this B

3228
01:10:20,149 --> 01:10:20,159
and here let me label this B
 

3229
01:10:20,159 --> 01:10:24,229
and here let me label this B
of T minus I

3230
01:10:24,229 --> 01:10:24,239
of T minus I
 

3231
01:10:24,239 --> 01:10:29,430
of T minus I
and here this sum is over J

3232
01:10:29,430 --> 01:10:29,440
and here this sum is over J
 

3233
01:10:29,440 --> 01:10:32,310
and here this sum is over J
um

3234
01:10:32,310 --> 01:10:32,320
um
 

3235
01:10:32,320 --> 01:10:39,669
um
E to the SJ + B of T minus J.

3236
01:10:39,669 --> 01:10:39,679
E to the SJ + B of T minus J.
 

3237
01:10:39,679 --> 01:10:41,990
E to the SJ + B of T minus J.
Okay.

3238
01:10:41,990 --> 01:10:42,000
Okay.
 

3239
01:10:42,000 --> 01:10:51,110
Okay.
And these guys I'm just going to learn.

3240
01:10:51,110 --> 01:10:51,120

 

3241
01:10:51,120 --> 01:10:53,990

That's why it's called learned relative

3242
01:10:53,990 --> 01:10:54,000
That's why it's called learned relative
 

3243
01:10:54,000 --> 01:10:55,669
That's why it's called learned relative
position encoding. Okay? Because it

3244
01:10:55,669 --> 01:10:55,679
position encoding. Okay? Because it
 

3245
01:10:55,679 --> 01:10:57,830
position encoding. Okay? Because it
matter cares about the relative position

3246
01:10:57,830 --> 01:10:57,840
matter cares about the relative position
 

3247
01:10:57,840 --> 01:11:00,390
matter cares about the relative position
and you're just learning what that

3248
01:11:00,390 --> 01:11:00,400
and you're just learning what that
 

3249
01:11:00,400 --> 01:11:03,350
and you're just learning what that
appropriate factor should be.

3250
01:11:03,350 --> 01:11:03,360
appropriate factor should be.
 

3251
01:11:03,360 --> 01:11:03,910
appropriate factor should be.
>> Yes.

3252
01:11:03,910 --> 01:11:03,920
>> Yes.
 

3253
01:11:03,920 --> 01:11:06,070
>> Yes.
>> So it's a function of just like t minus

3254
01:11:06,070 --> 01:11:06,080
>> So it's a function of just like t minus
 

3255
01:11:06,080 --> 01:11:06,630
>> So it's a function of just like t minus
i.

3256
01:11:06,630 --> 01:11:06,640
i.
 

3257
01:11:06,640 --> 01:11:08,870
i.
>> It's just a function of t minus i. Yeah.

3258
01:11:08,870 --> 01:11:08,880
>> It's just a function of t minus i. Yeah.
 

3259
01:11:08,880 --> 01:11:10,390
>> It's just a function of t minus i. Yeah.
And you want you care about the sign,

3260
01:11:10,390 --> 01:11:10,400
And you want you care about the sign,
 

3261
01:11:10,400 --> 01:11:12,070
And you want you care about the sign,
right? Because you care it's not

3262
01:11:12,070 --> 01:11:12,080
right? Because you care it's not
 

3263
01:11:12,080 --> 01:11:13,910
right? Because you care it's not
absolute value of t minus i. You care

3264
01:11:13,910 --> 01:11:13,920
absolute value of t minus i. You care
 

3265
01:11:13,920 --> 01:11:15,350
absolute value of t minus i. You care
about whether I was first or whether I

3266
01:11:15,350 --> 01:11:15,360
about whether I was first or whether I
 

3267
01:11:15,360 --> 01:11:16,870
about whether I was first or whether I
was whether I came first or whether I

3268
01:11:16,870 --> 01:11:16,880
was whether I came first or whether I
 

3269
01:11:16,880 --> 01:11:19,110
was whether I came first or whether I
came after.

3270
01:11:19,110 --> 01:11:19,120
came after.
 

3271
01:11:19,120 --> 01:11:20,950
came after.
So this will this will go positive and

3272
01:11:20,950 --> 01:11:20,960
So this will this will go positive and
 

3273
01:11:20,960 --> 01:11:26,870
So this will this will go positive and
negative and that matters.

3274
01:11:26,870 --> 01:11:26,880

 

3275
01:11:26,880 --> 01:11:29,990

So this learn position em uh embedding

3276
01:11:29,990 --> 01:11:30,000
So this learn position em uh embedding
 

3277
01:11:30,000 --> 01:11:32,550
So this learn position em uh embedding
or learned relative position embedding

3278
01:11:32,550 --> 01:11:32,560
or learned relative position embedding
 

3279
01:11:32,560 --> 01:11:34,950
or learned relative position embedding
did outperform the original and did

3280
01:11:34,950 --> 01:11:34,960
did outperform the original and did
 

3281
01:11:34,960 --> 01:11:37,830
did outperform the original and did
outperform nope in some cases. It still

3282
01:11:37,830 --> 01:11:37,840
outperform nope in some cases. It still
 

3283
01:11:37,840 --> 01:11:41,030
outperform nope in some cases. It still
wasn't a runaway success but it beat

3284
01:11:41,030 --> 01:11:41,040
wasn't a runaway success but it beat
 

3285
01:11:41,040 --> 01:11:43,189
wasn't a runaway success but it beat
those things a little bit.

3286
01:11:43,189 --> 01:11:43,199
those things a little bit.
 

3287
01:11:43,199 --> 01:11:45,510
those things a little bit.
>> Yes. Question practice. What does the

3288
01:11:45,510 --> 01:11:45,520
>> Yes. Question practice. What does the
 

3289
01:11:45,520 --> 01:11:47,350
>> Yes. Question practice. What does the
model end up learning from V subshift?

3290
01:11:47,350 --> 01:11:47,360
model end up learning from V subshift?
 

3291
01:11:47,360 --> 01:11:49,590
model end up learning from V subshift?
like what does it look like?

3292
01:11:49,590 --> 01:11:49,600
like what does it look like?
 

3293
01:11:49,600 --> 01:11:52,550
like what does it look like?
>> Um I don't know. I I don't know the

3294
01:11:52,550 --> 01:11:52,560
>> Um I don't know. I I don't know the
 

3295
01:11:52,560 --> 01:11:53,910
>> Um I don't know. I I don't know the
answer to that. I there might be some

3296
01:11:53,910 --> 01:11:53,920
answer to that. I there might be some
 

3297
01:11:53,920 --> 01:11:55,910
answer to that. I there might be some
pattern. I just don't know the answer.

3298
01:11:55,910 --> 01:11:55,920
pattern. I just don't know the answer.
 

3299
01:11:55,920 --> 01:11:58,149
pattern. I just don't know the answer.
I'm sure that the original papers that

3300
01:11:58,149 --> 01:11:58,159
I'm sure that the original papers that
 

3301
01:11:58,159 --> 01:11:59,350
I'm sure that the original papers that
introduced this will talk about it, but

3302
01:11:59,350 --> 01:11:59,360
introduced this will talk about it, but
 

3303
01:11:59,360 --> 01:11:59,910
introduced this will talk about it, but
I don't know. I'm

3304
01:11:59,910 --> 01:11:59,920
I don't know. I'm
 

3305
01:11:59,920 --> 01:12:01,830
I don't know. I'm
>> curious if it resembles the signal

3306
01:12:01,830 --> 01:12:01,840
>> curious if it resembles the signal
 

3307
01:12:01,840 --> 01:12:03,590
>> curious if it resembles the signal
pattern of the original

3308
01:12:03,590 --> 01:12:03,600
pattern of the original
 

3309
01:12:03,600 --> 01:12:05,350
pattern of the original
>> I would be very surprised if it did

3310
01:12:05,350 --> 01:12:05,360
>> I would be very surprised if it did
 

3311
01:12:05,360 --> 01:12:06,950
>> I would be very surprised if it did
because I think there's just so many

3312
01:12:06,950 --> 01:12:06,960
because I think there's just so many
 

3313
01:12:06,960 --> 01:12:11,830
because I think there's just so many
ways to keep time. Um

3314
01:12:11,830 --> 01:12:11,840

 

3315
01:12:11,840 --> 01:12:14,070

>> yes. Is there a reason why we choose to

3316
01:12:14,070 --> 01:12:14,080
>> yes. Is there a reason why we choose to
 

3317
01:12:14,080 --> 01:12:16,550
>> yes. Is there a reason why we choose to
learn the difference between T and I?

3318
01:12:16,550 --> 01:12:16,560
learn the difference between T and I?
 

3319
01:12:16,560 --> 01:12:18,790
learn the difference between T and I?
Because um I mean I would imagine maybe

3320
01:12:18,790 --> 01:12:18,800
Because um I mean I would imagine maybe
 

3321
01:12:18,800 --> 01:12:20,950
Because um I mean I would imagine maybe
sometimes if you have like an adjective

3322
01:12:20,950 --> 01:12:20,960
sometimes if you have like an adjective
 

3323
01:12:20,960 --> 01:12:23,110
sometimes if you have like an adjective
and another word, it really matters that

3324
01:12:23,110 --> 01:12:23,120
and another word, it really matters that
 

3325
01:12:23,120 --> 01:12:25,430
and another word, it really matters that
you look at like one directly after, but

3326
01:12:25,430 --> 01:12:25,440
you look at like one directly after, but
 

3327
01:12:25,440 --> 01:12:29,270
you look at like one directly after, but
maybe for let's say a subject and the

3328
01:12:29,270 --> 01:12:29,280
maybe for let's say a subject and the
 

3329
01:12:29,280 --> 01:12:31,669
maybe for let's say a subject and the
object of its verb. It actually matters

3330
01:12:31,669 --> 01:12:31,679
object of its verb. It actually matters
 

3331
01:12:31,679 --> 01:12:33,669
object of its verb. It actually matters
more that you don't look at the word

3332
01:12:33,669 --> 01:12:33,679
more that you don't look at the word
 

3333
01:12:33,679 --> 01:12:35,510
more that you don't look at the word
right after it but maybe like the word

3334
01:12:35,510 --> 01:12:35,520
right after it but maybe like the word
 

3335
01:12:35,520 --> 01:12:36,550
right after it but maybe like the word
to

3336
01:12:36,550 --> 01:12:36,560
to
 

3337
01:12:36,560 --> 01:12:37,669
to
>> and that will be handled by the

3338
01:12:37,669 --> 01:12:37,679
>> and that will be handled by the
 

3339
01:12:37,679 --> 01:12:40,229
>> and that will be handled by the
attention mechanism. Right?

3340
01:12:40,229 --> 01:12:40,239
attention mechanism. Right?
 

3341
01:12:40,239 --> 01:12:41,990
attention mechanism. Right?
This is all this is saying is giving you

3342
01:12:41,990 --> 01:12:42,000
This is all this is saying is giving you
 

3343
01:12:42,000 --> 01:12:44,709
This is all this is saying is giving you
a way of saying that

3344
01:12:44,709 --> 01:12:44,719
a way of saying that
 

3345
01:12:44,719 --> 01:12:45,750
a way of saying that
you were [clears throat]

3346
01:12:45,750 --> 01:12:45,760
you were [clears throat]
 

3347
01:12:45,760 --> 01:12:48,550
you were [clears throat]
you know it's giving you an option to

3348
01:12:48,550 --> 01:12:48,560
you know it's giving you an option to
 

3349
01:12:48,560 --> 01:12:50,630
you know it's giving you an option to
depend on

3350
01:12:50,630 --> 01:12:50,640
depend on
 

3351
01:12:50,640 --> 01:12:52,950
depend on
the relative position. So it's not

3352
01:12:52,950 --> 01:12:52,960
the relative position. So it's not
 

3353
01:12:52,960 --> 01:12:55,430
the relative position. So it's not
saying that you have to

3354
01:12:55,430 --> 01:12:55,440
saying that you have to
 

3355
01:12:55,440 --> 01:12:57,590
saying that you have to
uh care about it in some sense

3356
01:12:57,590 --> 01:12:57,600
uh care about it in some sense
 

3357
01:12:57,600 --> 01:13:00,630
uh care about it in some sense
>> that makes sense

3358
01:13:00,630 --> 01:13:00,640
>> that makes sense
 

3359
01:13:00,640 --> 01:13:01,910
>> that makes sense
>> because you're going to learn it. So in

3360
01:13:01,910 --> 01:13:01,920
>> because you're going to learn it. So in
 

3361
01:13:01,920 --> 01:13:04,070
>> because you're going to learn it. So in
in the cases in for the attention heads

3362
01:13:04,070 --> 01:13:04,080
in the cases in for the attention heads
 

3363
01:13:04,080 --> 01:13:06,149
in the cases in for the attention heads
where the relative position doesn't

3364
01:13:06,149 --> 01:13:06,159
where the relative position doesn't
 

3365
01:13:06,159 --> 01:13:07,910
where the relative position doesn't
matter

3366
01:13:07,910 --> 01:13:07,920
matter
 

3367
01:13:07,920 --> 01:13:10,229
matter
these things are going to you know not

3368
01:13:10,229 --> 01:13:10,239
these things are going to you know not
 

3369
01:13:10,239 --> 01:13:11,270
these things are going to you know not
be anything you're going to end up being

3370
01:13:11,270 --> 01:13:11,280
be anything you're going to end up being
 

3371
01:13:11,280 --> 01:13:13,430
be anything you're going to end up being
zeros or close to zero and when it

3372
01:13:13,430 --> 01:13:13,440
zeros or close to zero and when it
 

3373
01:13:13,440 --> 01:13:16,390
zeros or close to zero and when it
matters it will adjust like that's magic

3374
01:13:16,390 --> 01:13:16,400
matters it will adjust like that's magic
 

3375
01:13:16,400 --> 01:13:18,870
matters it will adjust like that's magic
of gradient descent.

3376
01:13:18,870 --> 01:13:18,880
of gradient descent.
 

3377
01:13:18,880 --> 01:13:19,590
of gradient descent.
>> Yes.

3378
01:13:19,590 --> 01:13:19,600
>> Yes.
 

3379
01:13:19,600 --> 01:13:21,270
>> Yes.
>> But how is that going factoring into the

3380
01:13:21,270 --> 01:13:21,280
>> But how is that going factoring into the
 

3381
01:13:21,280 --> 01:13:22,790
>> But how is that going factoring into the
attention mechanism when we're adding it

3382
01:13:22,790 --> 01:13:22,800
attention mechanism when we're adding it
 

3383
01:13:22,800 --> 01:13:24,950
attention mechanism when we're adding it
here in the soft max which is after the

3384
01:13:24,950 --> 01:13:24,960
here in the soft max which is after the
 

3385
01:13:24,960 --> 01:13:27,110
here in the soft max which is after the
attention?

3386
01:13:27,110 --> 01:13:27,120
attention?
 

3387
01:13:27,120 --> 01:13:28,790
attention?
>> No no this is in the attention score

3388
01:13:28,790 --> 01:13:28,800
>> No no this is in the attention score
 

3389
01:13:28,800 --> 01:13:30,630
>> No no this is in the attention score
calculation. This is when I'm

3390
01:13:30,630 --> 01:13:30,640
calculation. This is when I'm
 

3391
01:13:30,640 --> 01:13:32,950
calculation. This is when I'm
calculating the attention value.

3392
01:13:32,950 --> 01:13:32,960
calculating the attention value.
 

3393
01:13:32,960 --> 01:13:36,070
calculating the attention value.
>> This is changing my attention matrix.

3394
01:13:36,070 --> 01:13:36,080
>> This is changing my attention matrix.
 

3395
01:13:36,080 --> 01:13:37,750
>> This is changing my attention matrix.
>> Okay, I see

3396
01:13:37,750 --> 01:13:37,760
>> Okay, I see
 

3397
01:13:37,760 --> 01:13:48,470
>> Okay, I see
>> this changes.

3398
01:13:48,470 --> 01:13:48,480

 

3399
01:13:48,480 --> 01:13:50,550

This is not the softmax at the end where

3400
01:13:50,550 --> 01:13:50,560
This is not the softmax at the end where
 

3401
01:13:50,560 --> 01:13:56,310
This is not the softmax at the end where
I'm computing uh probabilities.

3402
01:13:56,310 --> 01:13:56,320

 

3403
01:13:56,320 --> 01:13:58,790

Good question. Okay. So that brings me

3404
01:13:58,790 --> 01:13:58,800
Good question. Okay. So that brings me
 

3405
01:13:58,800 --> 01:14:03,669
Good question. Okay. So that brings me
now to the last one which is rope which

3406
01:14:03,669 --> 01:14:03,679
now to the last one which is rope which
 

3407
01:14:03,679 --> 01:14:05,910
now to the last one which is rope which
is the thing that is now used all the

3408
01:14:05,910 --> 01:14:05,920
is the thing that is now used all the
 

3409
01:14:05,920 --> 01:14:07,990
is the thing that is now used all the
time. Okay.

3410
01:14:07,990 --> 01:14:08,000
time. Okay.
 

3411
01:14:08,000 --> 01:14:11,910
time. Okay.
Okay. So what is rope?

3412
01:14:11,910 --> 01:14:11,920
Okay. So what is rope?
 

3413
01:14:11,920 --> 01:14:17,110
Okay. So what is rope?
Basically, we want to somehow modify

3414
01:14:17,110 --> 01:14:17,120

 

3415
01:14:17,120 --> 01:14:24,390

the attention calculation

3416
01:14:24,390 --> 01:14:24,400

 

3417
01:14:24,400 --> 01:14:28,390

to capture

3418
01:14:28,390 --> 01:14:28,400

 

3419
01:14:28,400 --> 01:14:29,990

um

3420
01:14:29,990 --> 01:14:30,000
um
 

3421
01:14:30,000 --> 01:14:32,790
um
the relative position

3422
01:14:32,790 --> 01:14:32,800
the relative position
 

3423
01:14:32,800 --> 01:14:34,950
the relative position
and we don't want to learn it. Okay,

3424
01:14:34,950 --> 01:14:34,960
and we don't want to learn it. Okay,
 

3425
01:14:34,960 --> 01:14:37,990
and we don't want to learn it. Okay,
that's what like we uh we tried this

3426
01:14:37,990 --> 01:14:38,000
that's what like we uh we tried this
 

3427
01:14:38,000 --> 01:14:39,510
that's what like we uh we tried this
learning thing but we want to do better.

3428
01:14:39,510 --> 01:14:39,520
learning thing but we want to do better.
 

3429
01:14:39,520 --> 01:14:43,030
learning thing but we want to do better.
Okay.

3430
01:14:43,030 --> 01:14:43,040

 

3431
01:14:43,040 --> 01:14:45,189

So what is currently capturing what is

3432
01:14:45,189 --> 01:14:45,199
So what is currently capturing what is
 

3433
01:14:45,199 --> 01:14:46,870
So what is currently capturing what is
the currently the heart of the attention

3434
01:14:46,870 --> 01:14:46,880
the currently the heart of the attention
 

3435
01:14:46,880 --> 01:14:48,470
the currently the heart of the attention
mechanism? Well, one thing one way you

3436
01:14:48,470 --> 01:14:48,480
mechanism? Well, one thing one way you
 

3437
01:14:48,480 --> 01:14:49,990
mechanism? Well, one thing one way you
can think about it it is that this this

3438
01:14:49,990 --> 01:14:50,000
can think about it it is that this this
 

3439
01:14:50,000 --> 01:14:51,669
can think about it it is that this this
inner product, right? Actually I should

3440
01:14:51,669 --> 01:14:51,679
inner product, right? Actually I should
 

3441
01:14:51,679 --> 01:14:58,149
inner product, right? Actually I should
write it as Q K. Not that it matters but

3442
01:14:58,149 --> 01:14:58,159

 

3443
01:14:58,159 --> 01:15:01,110

I have this Q of K T at time T times

3444
01:15:01,110 --> 01:15:01,120
I have this Q of K T at time T times
 

3445
01:15:01,120 --> 01:15:04,790
I have this Q of K T at time T times
this or this inner product with uh K at

3446
01:15:04,790 --> 01:15:04,800
this or this inner product with uh K at
 

3447
01:15:04,800 --> 01:15:06,950
this or this inner product with uh K at
time I. And I want to modify this

3448
01:15:06,950 --> 01:15:06,960
time I. And I want to modify this
 

3449
01:15:06,960 --> 01:15:11,030
time I. And I want to modify this
somehow to capture

3450
01:15:11,030 --> 01:15:11,040
somehow to capture
 

3451
01:15:11,040 --> 01:15:14,630
somehow to capture
um this T and this I somehow in

3452
01:15:14,630 --> 01:15:14,640
um this T and this I somehow in
 

3453
01:15:14,640 --> 01:15:20,149
um this T and this I somehow in
particular T minus I. Okay.

3454
01:15:20,149 --> 01:15:20,159

 

3455
01:15:20,159 --> 01:15:22,630

So one thing that kind of that was the

3456
01:15:22,630 --> 01:15:22,640
So one thing that kind of that was the
 

3457
01:15:22,640 --> 01:15:24,070
So one thing that kind of that was the
motivation for this or one way to think

3458
01:15:24,070 --> 01:15:24,080
motivation for this or one way to think
 

3459
01:15:24,080 --> 01:15:25,189
motivation for this or one way to think
about this is that when I think about

3460
01:15:25,189 --> 01:15:25,199
about this is that when I think about
 

3461
01:15:25,199 --> 01:15:28,390
about this is that when I think about
this this is an inner product, right?

3462
01:15:28,390 --> 01:15:28,400
this this is an inner product, right?
 

3463
01:15:28,400 --> 01:15:30,870
this this is an inner product, right?
And the inner product is something that

3464
01:15:30,870 --> 01:15:30,880
And the inner product is something that
 

3465
01:15:30,880 --> 01:15:33,510
And the inner product is something that
can that has two components, right? When

3466
01:15:33,510 --> 01:15:33,520
can that has two components, right? When
 

3467
01:15:33,520 --> 01:15:35,510
can that has two components, right? When
I think about the inner product between

3468
01:15:35,510 --> 01:15:35,520
I think about the inner product between
 

3469
01:15:35,520 --> 01:15:37,830
I think about the inner product between
two vectors, the inner product between

3470
01:15:37,830 --> 01:15:37,840
two vectors, the inner product between
 

3471
01:15:37,840 --> 01:15:40,630
two vectors, the inner product between
two vectors depends on the magnitude of

3472
01:15:40,630 --> 01:15:40,640
two vectors depends on the magnitude of
 

3473
01:15:40,640 --> 01:15:43,350
two vectors depends on the magnitude of
the vectors and also depends on the

3474
01:15:43,350 --> 01:15:43,360
the vectors and also depends on the
 

3475
01:15:43,360 --> 01:15:49,030
the vectors and also depends on the
angle between the vectors, right? And so

3476
01:15:49,030 --> 01:15:49,040
angle between the vectors, right? And so
 

3477
01:15:49,040 --> 01:15:51,830
angle between the vectors, right? And so
can I somehow modify this inner product

3478
01:15:51,830 --> 01:15:51,840
can I somehow modify this inner product
 

3479
01:15:51,840 --> 01:15:56,229
can I somehow modify this inner product
in a way that can maybe pull in the

3480
01:15:56,229 --> 01:15:56,239
in a way that can maybe pull in the
 

3481
01:15:56,239 --> 01:15:59,669
in a way that can maybe pull in the
information about

3482
01:15:59,669 --> 01:15:59,679
information about
 

3483
01:15:59,679 --> 01:16:02,229
information about
relative position.

3484
01:16:02,229 --> 01:16:02,239
relative position.
 

3485
01:16:02,239 --> 01:16:05,350
relative position.
And so the key idea was to think about

3486
01:16:05,350 --> 01:16:05,360
And so the key idea was to think about
 

3487
01:16:05,360 --> 01:16:06,870
And so the key idea was to think about
let's just think about two dimensions

3488
01:16:06,870 --> 01:16:06,880
let's just think about two dimensions
 

3489
01:16:06,880 --> 01:16:08,310
let's just think about two dimensions
right so let's say your embedding

3490
01:16:08,310 --> 01:16:08,320
right so let's say your embedding
 

3491
01:16:08,320 --> 01:16:09,990
right so let's say your embedding
dimension is two which will never be the

3492
01:16:09,990 --> 01:16:10,000
dimension is two which will never be the
 

3493
01:16:10,000 --> 01:16:12,790
dimension is two which will never be the
case but just for a thought experiment

3494
01:16:12,790 --> 01:16:12,800
case but just for a thought experiment
 

3495
01:16:12,800 --> 01:16:15,830
case but just for a thought experiment
let's say d is equal to two and so I

3496
01:16:15,830 --> 01:16:15,840
let's say d is equal to two and so I
 

3497
01:16:15,840 --> 01:16:22,630
let's say d is equal to two and so I
have my uh my q t1 and my qt2 this is my

3498
01:16:22,630 --> 01:16:22,640
have my uh my q t1 and my qt2 this is my
 

3499
01:16:22,640 --> 01:16:24,229
have my uh my q t1 and my qt2 this is my
two-dimensional

3500
01:16:24,229 --> 01:16:24,239
two-dimensional
 

3501
01:16:24,239 --> 01:16:26,790
two-dimensional
uh vector here

3502
01:16:26,790 --> 01:16:26,800
uh vector here
 

3503
01:16:26,800 --> 01:16:30,630
uh vector here
I have this rotation matrix r

3504
01:16:30,630 --> 01:16:30,640
I have this rotation matrix r
 

3505
01:16:30,640 --> 01:16:34,550
I have this rotation matrix r
I can think of this is cosine let's say

3506
01:16:34,550 --> 01:16:34,560
I can think of this is cosine let's say
 

3507
01:16:34,560 --> 01:16:38,070
I can think of this is cosine let's say
omega - sin omega

3508
01:16:38,070 --> 01:16:38,080
omega - sin omega
 

3509
01:16:38,080 --> 01:16:42,709
omega - sin omega
sin omega cosine omega right and if I

3510
01:16:42,709 --> 01:16:42,719
sin omega cosine omega right and if I
 

3511
01:16:42,719 --> 01:16:46,790
sin omega cosine omega right and if I
take a vector and I multiply it by r

3512
01:16:46,790 --> 01:16:46,800
take a vector and I multiply it by r
 

3513
01:16:46,800 --> 01:16:49,590
take a vector and I multiply it by r
what does r do r ro rotates the vector

3514
01:16:49,590 --> 01:16:49,600
what does r do r ro rotates the vector
 

3515
01:16:49,600 --> 01:16:54,470
what does r do r ro rotates the vector
by omega right

3516
01:16:54,470 --> 01:16:54,480
by omega right
 

3517
01:16:54,480 --> 01:16:56,950
by omega right
so if I rotated for example so now if I

3518
01:16:56,950 --> 01:16:56,960
so if I rotated for example so now if I
 

3519
01:16:56,960 --> 01:17:03,270
so if I rotated for example so now if I
had let's say I had some Um

3520
01:17:03,270 --> 01:17:03,280

 

3521
01:17:03,280 --> 01:17:05,030

if I considered the following if I

3522
01:17:05,030 --> 01:17:05,040
if I considered the following if I
 

3523
01:17:05,040 --> 01:17:07,590
if I considered the following if I
considered

3524
01:17:07,590 --> 01:17:07,600
considered
 

3525
01:17:07,600 --> 01:17:10,790
considered
RT * QT so I'm going to think about how

3526
01:17:10,790 --> 01:17:10,800
RT * QT so I'm going to think about how
 

3527
01:17:10,800 --> 01:17:14,310
RT * QT so I'm going to think about how
I can make this R depend on

3528
01:17:14,310 --> 01:17:14,320
I can make this R depend on
 

3529
01:17:14,320 --> 01:17:19,910
I can make this R depend on
an R I * KI.

3530
01:17:19,910 --> 01:17:19,920

 

3531
01:17:19,920 --> 01:17:22,390

This is equal to

3532
01:17:22,390 --> 01:17:22,400
This is equal to
 

3533
01:17:22,400 --> 01:17:27,430
This is equal to
qt transpose rt transpose

3534
01:17:27,430 --> 01:17:27,440
qt transpose rt transpose
 

3535
01:17:27,440 --> 01:17:33,030
qt transpose rt transpose
r i ki right this inner product.

3536
01:17:33,030 --> 01:17:33,040
r i ki right this inner product.
 

3537
01:17:33,040 --> 01:17:38,950
r i ki right this inner product.
And so what is this? Now

3538
01:17:38,950 --> 01:17:38,960

 

3539
01:17:38,960 --> 01:17:42,550

this rtranspose ra is basically a

3540
01:17:42,550 --> 01:17:42,560
this rtranspose ra is basically a
 

3541
01:17:42,560 --> 01:17:45,270
this rtranspose ra is basically a
rotation by

3542
01:17:45,270 --> 01:17:45,280
rotation by
 

3543
01:17:45,280 --> 01:17:49,189
rotation by
omega t minus ome or omega i minus omega

3544
01:17:49,189 --> 01:17:49,199
omega t minus ome or omega i minus omega
 

3545
01:17:49,199 --> 01:17:51,669
omega t minus ome or omega i minus omega
t

3546
01:17:51,669 --> 01:17:51,679
t
 

3547
01:17:51,679 --> 01:17:53,669
t
right here if I maybe if I should write

3548
01:17:53,669 --> 01:17:53,679
right here if I maybe if I should write
 

3549
01:17:53,679 --> 01:17:58,790
right here if I maybe if I should write
this as r t omega t omega t omega t

3550
01:17:58,790 --> 01:17:58,800
this as r t omega t omega t omega t
 

3551
01:17:58,800 --> 01:18:02,310
this as r t omega t omega t omega t
omega t

3552
01:18:02,310 --> 01:18:02,320

 

3553
01:18:02,320 --> 01:18:05,510

rtpose is going by minus omega and r i

3554
01:18:05,510 --> 01:18:05,520
rtpose is going by minus omega and r i
 

3555
01:18:05,520 --> 01:18:09,590
rtpose is going by minus omega and r i
is going forward by omega i. So this

3556
01:18:09,590 --> 01:18:09,600
is going forward by omega i. So this
 

3557
01:18:09,600 --> 01:18:11,750
is going forward by omega i. So this
rotation now I'm capturing basically

3558
01:18:11,750 --> 01:18:11,760
rotation now I'm capturing basically
 

3559
01:18:11,760 --> 01:18:15,430
rotation now I'm capturing basically
something about the relative position

3560
01:18:15,430 --> 01:18:15,440
something about the relative position
 

3561
01:18:15,440 --> 01:18:18,630
something about the relative position
into this score into this inner product

3562
01:18:18,630 --> 01:18:18,640
into this score into this inner product
 

3563
01:18:18,640 --> 01:18:22,070
into this score into this inner product
in the attention calculation itself.

3564
01:18:22,070 --> 01:18:22,080
in the attention calculation itself.
 

3565
01:18:22,080 --> 01:18:24,310
in the attention calculation itself.
I have I have time right? Yeah. Okay. I

3566
01:18:24,310 --> 01:18:24,320
I have I have time right? Yeah. Okay. I
 

3567
01:18:24,320 --> 01:18:26,390
I have I have time right? Yeah. Okay. I
have three whole minutes. People are

3568
01:18:26,390 --> 01:18:26,400
have three whole minutes. People are
 

3569
01:18:26,400 --> 01:18:31,590
have three whole minutes. People are
coming in. Okay.

3570
01:18:31,590 --> 01:18:31,600

 

3571
01:18:31,600 --> 01:18:34,390

So this is the key key idea that

3572
01:18:34,390 --> 01:18:34,400
So this is the key key idea that
 

3573
01:18:34,400 --> 01:18:36,950
So this is the key key idea that
basically we want to be able to exploit

3574
01:18:36,950 --> 01:18:36,960
basically we want to be able to exploit
 

3575
01:18:36,960 --> 01:18:38,950
basically we want to be able to exploit
to be able to get relative position

3576
01:18:38,950 --> 01:18:38,960
to be able to get relative position
 

3577
01:18:38,960 --> 01:18:42,310
to be able to get relative position
encoding. Okay. So in two dimensions

3578
01:18:42,310 --> 01:18:42,320
encoding. Okay. So in two dimensions
 

3579
01:18:42,320 --> 01:18:48,390
encoding. Okay. So in two dimensions
basically if I choose a particular omega

3580
01:18:48,390 --> 01:18:48,400
basically if I choose a particular omega
 

3581
01:18:48,400 --> 01:18:50,870
basically if I choose a particular omega
by choosing different ome by by having a

3582
01:18:50,870 --> 01:18:50,880
by choosing different ome by by having a
 

3583
01:18:50,880 --> 01:18:53,430
by choosing different ome by by having a
different value for omega

3584
01:18:53,430 --> 01:18:53,440
different value for omega
 

3585
01:18:53,440 --> 01:18:57,189
different value for omega
I can change the relative angle of my Q

3586
01:18:57,189 --> 01:18:57,199
I can change the relative angle of my Q
 

3587
01:18:57,199 --> 01:19:00,229
I can change the relative angle of my Q
and query vector like right and so I can

3588
01:19:00,229 --> 01:19:00,239
and query vector like right and so I can
 

3589
01:19:00,239 --> 01:19:01,830
and query vector like right and so I can
change whether they're very aligned

3590
01:19:01,830 --> 01:19:01,840
change whether they're very aligned
 

3591
01:19:01,840 --> 01:19:04,070
change whether they're very aligned
which will lead to a high inner product

3592
01:19:04,070 --> 01:19:04,080
which will lead to a high inner product
 

3593
01:19:04,080 --> 01:19:05,910
which will lead to a high inner product
or whether they're not aligned which

3594
01:19:05,910 --> 01:19:05,920
or whether they're not aligned which
 

3595
01:19:05,920 --> 01:19:09,270
or whether they're not aligned which
will lead to a low inner product. Okay.

3596
01:19:09,270 --> 01:19:09,280
will lead to a low inner product. Okay.
 

3597
01:19:09,280 --> 01:19:13,030
will lead to a low inner product. Okay.
So how does this work in our setup? So

3598
01:19:13,030 --> 01:19:13,040
So how does this work in our setup? So
 

3599
01:19:13,040 --> 01:19:15,750
So how does this work in our setup? So
in our setup we have D is not equal to

3600
01:19:15,750 --> 01:19:15,760
in our setup we have D is not equal to
 

3601
01:19:15,760 --> 01:19:18,149
in our setup we have D is not equal to
two. We have a very very very long

3602
01:19:18,149 --> 01:19:18,159
two. We have a very very very long
 

3603
01:19:18,159 --> 01:19:21,270
two. We have a very very very long
vector D. Right?

3604
01:19:21,270 --> 01:19:21,280
vector D. Right?
 

3605
01:19:21,280 --> 01:19:23,350
vector D. Right?
And what I'm going to do is I'm going to

3606
01:19:23,350 --> 01:19:23,360
And what I'm going to do is I'm going to
 

3607
01:19:23,360 --> 01:19:25,030
And what I'm going to do is I'm going to
So this is I these are all my different

3608
01:19:25,030 --> 01:19:25,040
So this is I these are all my different
 

3609
01:19:25,040 --> 01:19:27,830
So this is I these are all my different
channels. And I'm going to break this up

3610
01:19:27,830 --> 01:19:27,840
channels. And I'm going to break this up
 

3611
01:19:27,840 --> 01:19:30,709
channels. And I'm going to break this up
into packs of two. So this is a

3612
01:19:30,709 --> 01:19:30,719
into packs of two. So this is a
 

3613
01:19:30,719 --> 01:19:32,070
into packs of two. So this is a
two-dimensional vector. This is a

3614
01:19:32,070 --> 01:19:32,080
two-dimensional vector. This is a
 

3615
01:19:32,080 --> 01:19:33,910
two-dimensional vector. This is a
two-dimensional vector. This is a like

3616
01:19:33,910 --> 01:19:33,920
two-dimensional vector. This is a like
 

3617
01:19:33,920 --> 01:19:36,070
two-dimensional vector. This is a like
I'm going to think of this as 22 222 22

3618
01:19:36,070 --> 01:19:36,080
I'm going to think of this as 22 222 22
 

3619
01:19:36,080 --> 01:19:38,630
I'm going to think of this as 22 222 22
two22 and I'm going to think of each of

3620
01:19:38,630 --> 01:19:38,640
two22 and I'm going to think of each of
 

3621
01:19:38,640 --> 01:19:40,310
two22 and I'm going to think of each of
these essentially as a complex number

3622
01:19:40,310 --> 01:19:40,320
these essentially as a complex number
 

3623
01:19:40,320 --> 01:19:42,390
these essentially as a complex number
right basically when I think about my

3624
01:19:42,390 --> 01:19:42,400
right basically when I think about my
 

3625
01:19:42,400 --> 01:19:43,669
right basically when I think about my
two dimensional vector I can think of

3626
01:19:43,669 --> 01:19:43,679
two dimensional vector I can think of
 

3627
01:19:43,679 --> 01:19:45,189
two dimensional vector I can think of
that as a complex number right it has a

3628
01:19:45,189 --> 01:19:45,199
that as a complex number right it has a
 

3629
01:19:45,199 --> 01:19:47,750
that as a complex number right it has a
it has a magnitude it has a phase um

3630
01:19:47,750 --> 01:19:47,760
it has a magnitude it has a phase um
 

3631
01:19:47,760 --> 01:19:49,430
it has a magnitude it has a phase um
every vector in the 2D plane is just a

3632
01:19:49,430 --> 01:19:49,440
every vector in the 2D plane is just a
 

3633
01:19:49,440 --> 01:19:50,870
every vector in the 2D plane is just a
complex number similarly I'm going to

3634
01:19:50,870 --> 01:19:50,880
complex number similarly I'm going to
 

3635
01:19:50,880 --> 01:19:53,510
complex number similarly I'm going to
think of this

3636
01:19:53,510 --> 01:19:53,520
think of this
 

3637
01:19:53,520 --> 01:19:55,110
think of this
just as a complex number or a two

3638
01:19:55,110 --> 01:19:55,120
just as a complex number or a two
 

3639
01:19:55,120 --> 01:19:57,669
just as a complex number or a two
dimensional vector what have you and I'm

3640
01:19:57,669 --> 01:19:57,679
dimensional vector what have you and I'm
 

3641
01:19:57,679 --> 01:20:02,229
dimensional vector what have you and I'm
going to have a rotation matrix

3642
01:20:02,229 --> 01:20:02,239
going to have a rotation matrix
 

3643
01:20:02,239 --> 01:20:04,149
going to have a rotation matrix
with with a specific omega for each of

3644
01:20:04,149 --> 01:20:04,159
with with a specific omega for each of
 

3645
01:20:04,159 --> 01:20:06,790
with with a specific omega for each of
these. And now that I and I think about

3646
01:20:06,790 --> 01:20:06,800
these. And now that I and I think about
 

3647
01:20:06,800 --> 01:20:10,149
these. And now that I and I think about
different channels encoding different

3648
01:20:10,149 --> 01:20:10,159
different channels encoding different
 

3649
01:20:10,159 --> 01:20:11,910
different channels encoding different
um

3650
01:20:11,910 --> 01:20:11,920
um
 

3651
01:20:11,920 --> 01:20:13,430
um
different parts of information that's

3652
01:20:13,430 --> 01:20:13,440
different parts of information that's
 

3653
01:20:13,440 --> 01:20:16,229
different parts of information that's
relevant, I can have certain omegas that

3654
01:20:16,229 --> 01:20:16,239
relevant, I can have certain omegas that
 

3655
01:20:16,239 --> 01:20:19,590
relevant, I can have certain omegas that
are high frequencies be the ones that,

3656
01:20:19,590 --> 01:20:19,600
are high frequencies be the ones that,
 

3657
01:20:19,600 --> 01:20:21,430
are high frequencies be the ones that,
you know,

3658
01:20:21,430 --> 01:20:21,440
you know,
 

3659
01:20:21,440 --> 01:20:24,229
you know,
uh only are going to care about like

3660
01:20:24,229 --> 01:20:24,239
uh only are going to care about like
 

3661
01:20:24,239 --> 01:20:27,110
uh only are going to care about like
very short-term things and otherwise are

3662
01:20:27,110 --> 01:20:27,120
very short-term things and otherwise are
 

3663
01:20:27,120 --> 01:20:28,470
very short-term things and otherwise are
going to decoher. And I'm going to have

3664
01:20:28,470 --> 01:20:28,480
going to decoher. And I'm going to have
 

3665
01:20:28,480 --> 01:20:30,550
going to decoher. And I'm going to have
other omegas that are going to be lower

3666
01:20:30,550 --> 01:20:30,560
other omegas that are going to be lower
 

3667
01:20:30,560 --> 01:20:32,470
other omegas that are going to be lower
frequencies that are like varying very

3668
01:20:32,470 --> 01:20:32,480
frequencies that are like varying very
 

3669
01:20:32,480 --> 01:20:34,790
frequencies that are like varying very
very slowly. And therefore I can put

3670
01:20:34,790 --> 01:20:34,800
very slowly. And therefore I can put
 

3671
01:20:34,800 --> 01:20:39,030
very slowly. And therefore I can put
information into those channels that are

3672
01:20:39,030 --> 01:20:39,040
information into those channels that are
 

3673
01:20:39,040 --> 01:20:41,430
information into those channels that are
uh that I want to look at longer term

3674
01:20:41,430 --> 01:20:41,440
uh that I want to look at longer term
 

3675
01:20:41,440 --> 01:20:43,830
uh that I want to look at longer term
correlations. Okay. So I feel like I'm

3676
01:20:43,830 --> 01:20:43,840
correlations. Okay. So I feel like I'm
 

3677
01:20:43,840 --> 01:20:45,910
correlations. Okay. So I feel like I'm
running out of time to go through this

3678
01:20:45,910 --> 01:20:45,920
running out of time to go through this
 

3679
01:20:45,920 --> 01:20:48,550
running out of time to go through this
full thing. So I will do it again uh in

3680
01:20:48,550 --> 01:20:48,560
full thing. So I will do it again uh in
 

3681
01:20:48,560 --> 01:20:49,910
full thing. So I will do it again uh in
a little bit more detail and write out

3682
01:20:49,910 --> 01:20:49,920
a little bit more detail and write out
 

3683
01:20:49,920 --> 01:20:52,709
a little bit more detail and write out
some equations for you next class. But

3684
01:20:52,709 --> 01:20:52,719
some equations for you next class. But
 

3685
01:20:52,719 --> 01:20:54,310
some equations for you next class. But
the key thing I want you to take away

3686
01:20:54,310 --> 01:20:54,320
the key thing I want you to take away
 

3687
01:20:54,320 --> 01:20:56,709
the key thing I want you to take away
is, and maybe it'll be helpful for you

3688
01:20:56,709 --> 01:20:56,719
is, and maybe it'll be helpful for you
 

3689
01:20:56,719 --> 01:20:58,390
is, and maybe it'll be helpful for you
for those of you who are like, I forgot

3690
01:20:58,390 --> 01:20:58,400
for those of you who are like, I forgot
 

3691
01:20:58,400 --> 01:21:01,189
for those of you who are like, I forgot
complex numbers. Think about them before

3692
01:21:01,189 --> 01:21:01,199
complex numbers. Think about them before
 

3693
01:21:01,199 --> 01:21:11,270
complex numbers. Think about them before
class next time and it'll help us.

3694
01:21:11,270 --> 01:21:11,280

 

3695
01:21:11,280 --> 01:21:11,910

>> Yes.

3696
01:21:11,910 --> 01:21:11,920
>> Yes.
 

3697
01:21:11,920 --> 01:21:16,070
>> Yes.
>> Say like um so when you're decoding

3698
01:21:16,070 --> 01:21:16,080
>> Say like um so when you're decoding
 

3699
01:21:16,080 --> 01:21:19,910
>> Say like um so when you're decoding
this, right? Um I the star token comes

3700
01:21:19,910 --> 01:21:19,920
this, right? Um I the star token comes
 

3701
01:21:19,920 --> 01:21:21,750
this, right? Um I the star token comes
through here, right? And okay, it gets

3702
01:21:21,750 --> 01:21:21,760
through here, right? And okay, it gets
 

3703
01:21:21,760 --> 01:21:23,350
through here, right? And okay, it gets
embedded. It does the norm. You get all

3704
01:21:23,350 --> 01:21:23,360
embedded. It does the norm. You get all
 

3705
01:21:23,360 --> 01:21:24,790
embedded. It does the norm. You get all
the information. You do the cross

3706
01:21:24,790 --> 01:21:24,800
the information. You do the cross
 

3707
01:21:24,800 --> 01:21:28,870
the information. You do the cross
attention. It comes out here, right?

3708
01:21:28,870 --> 01:21:28,880
attention. It comes out here, right?
 

3709
01:21:28,880 --> 01:21:31,189
attention. It comes out here, right?
>> And then this

3710
01:21:31,189 --> 01:21:31,199
>> And then this
 

3711
01:21:31,199 --> 01:21:34,229
>> And then this
gets like where does there's six of

3712
01:21:34,229 --> 01:21:34,239
gets like where does there's six of
 

3713
01:21:34,239 --> 01:21:36,470
gets like where does there's six of
these layers, right? So that gets fed

3714
01:21:36,470 --> 01:21:36,480
these layers, right? So that gets fed
 

3715
01:21:36,480 --> 01:21:38,149
these layers, right? So that gets fed
back into the next layer.

3716
01:21:38,149 --> 01:21:38,159
back into the next layer.
 

3717
01:21:38,159 --> 01:21:39,510
back into the next layer.
>> No, no, this goes Yeah. Yeah. Yeah. So

3718
01:21:39,510 --> 01:21:39,520
>> No, no, this goes Yeah. Yeah. Yeah. So
 

3719
01:21:39,520 --> 01:21:41,270
>> No, no, this goes Yeah. Yeah. Yeah. So
this is like this the output of this

3720
01:21:41,270 --> 01:21:41,280
this is like this the output of this
 

3721
01:21:41,280 --> 01:21:43,030
this is like this the output of this
goes to the next layer. Okay. This is

3722
01:21:43,030 --> 01:21:43,040
goes to the next layer. Okay. This is
 

3723
01:21:43,040 --> 01:21:44,630
goes to the next layer. Okay. This is
only at the end. These are not

3724
01:21:44,630 --> 01:21:44,640
only at the end. These are not
 

3725
01:21:44,640 --> 01:21:45,830
only at the end. These are not
>> Yeah. Yeah. That's I'm just No, I'm just

3726
01:21:45,830 --> 01:21:45,840
>> Yeah. Yeah. That's I'm just No, I'm just
 

3727
01:21:45,840 --> 01:21:47,270
>> Yeah. Yeah. That's I'm just No, I'm just
making sure that this if that is what

3728
01:21:47,270 --> 01:21:47,280
making sure that this if that is what
 

3729
01:21:47,280 --> 01:21:51,360
making sure that this if that is what
you that is what they're like.

