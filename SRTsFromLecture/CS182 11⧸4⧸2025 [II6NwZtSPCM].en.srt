1
00:01:16,960 --> 00:01:19,190

Okay, tell everyone who was watches the

2
00:01:19,190 --> 00:01:19,200
Okay, tell everyone who was watches the
 

3
00:01:19,200 --> 00:01:25,109
Okay, tell everyone who was watches the
recording what I just said. [snorts]

4
00:01:25,109 --> 00:01:25,119

 

5
00:01:25,119 --> 00:01:27,350

>> So, sign up for postp proposal meetings

6
00:01:27,350 --> 00:01:27,360
>> So, sign up for postp proposal meetings
 

7
00:01:27,360 --> 00:01:29,350
>> So, sign up for postp proposal meetings
with uh staff members. Again, there's

8
00:01:29,350 --> 00:01:29,360
with uh staff members. Again, there's
 

9
00:01:29,360 --> 00:01:32,550
with uh staff members. Again, there's
signup slots. So, uh make sure you all

10
00:01:32,550 --> 00:01:32,560
signup slots. So, uh make sure you all
 

11
00:01:32,560 --> 00:01:35,030
signup slots. So, uh make sure you all
sign up. Only one slot per group is

12
00:01:35,030 --> 00:01:35,040
sign up. Only one slot per group is
 

13
00:01:35,040 --> 00:01:38,870
sign up. Only one slot per group is
sufficient. And uh you know don't

14
00:01:38,870 --> 00:01:38,880
sufficient. And uh you know don't
 

15
00:01:38,880 --> 00:01:40,630
sufficient. And uh you know don't
necessarily take up multiple slots for

16
00:01:40,630 --> 00:01:40,640
necessarily take up multiple slots for
 

17
00:01:40,640 --> 00:01:42,149
necessarily take up multiple slots for
your group because that's not really

18
00:01:42,149 --> 00:01:42,159
your group because that's not really
 

19
00:01:42,159 --> 00:01:43,830
your group because that's not really
fair to everyone else around. So one

20
00:01:43,830 --> 00:01:43,840
fair to everyone else around. So one
 

21
00:01:43,840 --> 00:01:45,350
fair to everyone else around. So one
slot per group is kind of the budgeting

22
00:01:45,350 --> 00:01:45,360
slot per group is kind of the budgeting
 

23
00:01:45,360 --> 00:01:47,749
slot per group is kind of the budgeting
that we have. Okay. I know that the last

24
00:01:47,749 --> 00:01:47,759
that we have. Okay. I know that the last
 

25
00:01:47,759 --> 00:01:49,109
that we have. Okay. I know that the last
time around there were a couple of

26
00:01:49,109 --> 00:01:49,119
time around there were a couple of
 

27
00:01:49,119 --> 00:01:51,190
time around there were a couple of
straggler groups who struggled to find

28
00:01:51,190 --> 00:01:51,200
straggler groups who struggled to find
 

29
00:01:51,200 --> 00:01:53,510
straggler groups who struggled to find
uh meeting slots. So make sure that that

30
00:01:53,510 --> 00:01:53,520
uh meeting slots. So make sure that that
 

31
00:01:53,520 --> 00:01:56,710
uh meeting slots. So make sure that that
is not your group. Good. Any burning

32
00:01:56,710 --> 00:01:56,720
is not your group. Good. Any burning
 

33
00:01:56,720 --> 00:02:02,230
is not your group. Good. Any burning
questions about projects before I start?

34
00:02:02,230 --> 00:02:02,240

 

35
00:02:02,240 --> 00:02:04,870

Wonderful. Okay. So what we're going to

36
00:02:04,870 --> 00:02:04,880
Wonderful. Okay. So what we're going to
 

37
00:02:04,880 --> 00:02:06,709
Wonderful. Okay. So what we're going to
do in today's lecture is pick up where

38
00:02:06,709 --> 00:02:06,719
do in today's lecture is pick up where
 

39
00:02:06,719 --> 00:02:09,109
do in today's lecture is pick up where
we left off last time with positioning

40
00:02:09,109 --> 00:02:09,119
we left off last time with positioning
 

41
00:02:09,119 --> 00:02:11,990
we left off last time with positioning
and coding. And my agenda is a little

42
00:02:11,990 --> 00:02:12,000
and coding. And my agenda is a little
 

43
00:02:12,000 --> 00:02:14,390
and coding. And my agenda is a little
ambitious. What I want to try and do is

44
00:02:14,390 --> 00:02:14,400
ambitious. What I want to try and do is
 

45
00:02:14,400 --> 00:02:18,150
ambitious. What I want to try and do is
if you recall we at the very beginning

46
00:02:18,150 --> 00:02:18,160
if you recall we at the very beginning
 

47
00:02:18,160 --> 00:02:20,309
if you recall we at the very beginning
of

48
00:02:20,309 --> 00:02:20,319
of
 

49
00:02:20,319 --> 00:02:23,430
of
this uh kind of module on attention and

50
00:02:23,430 --> 00:02:23,440
this uh kind of module on attention and
 

51
00:02:23,440 --> 00:02:25,510
this uh kind of module on attention and
transformers. We showed this quen next

52
00:02:25,510 --> 00:02:25,520
transformers. We showed this quen next
 

53
00:02:25,520 --> 00:02:27,510
transformers. We showed this quen next
architecture and there's a collective

54
00:02:27,510 --> 00:02:27,520
architecture and there's a collective
 

55
00:02:27,520 --> 00:02:31,510
architecture and there's a collective
who came from the class when uh this was

56
00:02:31,510 --> 00:02:31,520
who came from the class when uh this was
 

57
00:02:31,520 --> 00:02:33,270
who came from the class when uh this was
shown. My goal is by the end of the

58
00:02:33,270 --> 00:02:33,280
shown. My goal is by the end of the
 

59
00:02:33,280 --> 00:02:35,190
shown. My goal is by the end of the
lecture you should have some

60
00:02:35,190 --> 00:02:35,200
lecture you should have some
 

61
00:02:35,200 --> 00:02:36,550
lecture you should have some
understanding of every component of

62
00:02:36,550 --> 00:02:36,560
understanding of every component of
 

63
00:02:36,560 --> 00:02:37,830
understanding of every component of
this. Nothing should be mystery

64
00:02:37,830 --> 00:02:37,840
this. Nothing should be mystery
 

65
00:02:37,840 --> 00:02:40,630
this. Nothing should be mystery
mysterious. Okay? So you will be able to

66
00:02:40,630 --> 00:02:40,640
mysterious. Okay? So you will be able to
 

67
00:02:40,640 --> 00:02:43,830
mysterious. Okay? So you will be able to
understand kind of at some level

68
00:02:43,830 --> 00:02:43,840
understand kind of at some level
 

69
00:02:43,840 --> 00:02:46,070
understand kind of at some level
everything that is going on here as well

70
00:02:46,070 --> 00:02:46,080
everything that is going on here as well
 

71
00:02:46,080 --> 00:02:50,710
everything that is going on here as well
as in some of the most recent 2025

72
00:02:50,710 --> 00:02:50,720
as in some of the most recent 2025
 

73
00:02:50,720 --> 00:02:52,630
as in some of the most recent 2025
uh architectures. Okay. So we're going

74
00:02:52,630 --> 00:02:52,640
uh architectures. Okay. So we're going
 

75
00:02:52,640 --> 00:02:55,910
uh architectures. Okay. So we're going
to try and take you to the absolute uh

76
00:02:55,910 --> 00:02:55,920
to try and take you to the absolute uh
 

77
00:02:55,920 --> 00:02:57,750
to try and take you to the absolute uh
latest models and give you some idea of

78
00:02:57,750 --> 00:02:57,760
latest models and give you some idea of
 

79
00:02:57,760 --> 00:03:00,229
latest models and give you some idea of
what is going on there. But we still

80
00:03:00,229 --> 00:03:00,239
what is going on there. But we still
 

81
00:03:00,239 --> 00:03:01,750
what is going on there. But we still
have some buildup to do. We still have

82
00:03:01,750 --> 00:03:01,760
have some buildup to do. We still have
 

83
00:03:01,760 --> 00:03:03,350
have some buildup to do. We still have
some history to cover before we get to

84
00:03:03,350 --> 00:03:03,360
some history to cover before we get to
 

85
00:03:03,360 --> 00:03:06,229
some history to cover before we get to
that. And we started out last time

86
00:03:06,229 --> 00:03:06,239
that. And we started out last time
 

87
00:03:06,239 --> 00:03:08,229
that. And we started out last time
talking about rope and I ran out of

88
00:03:08,229 --> 00:03:08,239
talking about rope and I ran out of
 

89
00:03:08,239 --> 00:03:10,390
talking about rope and I ran out of
time. So if you remember, we had this

90
00:03:10,390 --> 00:03:10,400
time. So if you remember, we had this
 

91
00:03:10,400 --> 00:03:13,509
time. So if you remember, we had this
idea of position encoding. And why was

92
00:03:13,509 --> 00:03:13,519
idea of position encoding. And why was
 

93
00:03:13,519 --> 00:03:15,589
idea of position encoding. And why was
position encoding important for

94
00:03:15,589 --> 00:03:15,599
position encoding important for
 

95
00:03:15,599 --> 00:03:17,830
position encoding important for
attentionbased transformers? Well,

96
00:03:17,830 --> 00:03:17,840
attentionbased transformers? Well,
 

97
00:03:17,840 --> 00:03:20,869
attentionbased transformers? Well,
attention has a symmetry to it. And so

98
00:03:20,869 --> 00:03:20,879
attention has a symmetry to it. And so
 

99
00:03:20,879 --> 00:03:22,550
attention has a symmetry to it. And so
the thought was originally that we need

100
00:03:22,550 --> 00:03:22,560
the thought was originally that we need
 

101
00:03:22,560 --> 00:03:25,670
the thought was originally that we need
to somehow be able to give the model

102
00:03:25,670 --> 00:03:25,680
to somehow be able to give the model
 

103
00:03:25,680 --> 00:03:27,509
to somehow be able to give the model
information about which tomogen came

104
00:03:27,509 --> 00:03:27,519
information about which tomogen came
 

105
00:03:27,519 --> 00:03:29,030
information about which tomogen came
first, which token came second, which

106
00:03:29,030 --> 00:03:29,040
first, which token came second, which
 

107
00:03:29,040 --> 00:03:32,229
first, which token came second, which
token came third, uh so on and so forth.

108
00:03:32,229 --> 00:03:32,239
token came third, uh so on and so forth.
 

109
00:03:32,239 --> 00:03:34,390
token came third, uh so on and so forth.
And so there was this idea of absolute

110
00:03:34,390 --> 00:03:34,400
And so there was this idea of absolute
 

111
00:03:34,400 --> 00:03:36,710
And so there was this idea of absolute
position encoding where you add an

112
00:03:36,710 --> 00:03:36,720
position encoding where you add an
 

113
00:03:36,720 --> 00:03:41,750
position encoding where you add an
absolute position encoding vector to um

114
00:03:41,750 --> 00:03:41,760
absolute position encoding vector to um
 

115
00:03:41,760 --> 00:03:44,229
absolute position encoding vector to um
your attention matrix and therefore you

116
00:03:44,229 --> 00:03:44,239
your attention matrix and therefore you
 

117
00:03:44,239 --> 00:03:46,229
your attention matrix and therefore you
will uh sorry to your embeddings and

118
00:03:46,229 --> 00:03:46,239
will uh sorry to your embeddings and
 

119
00:03:46,239 --> 00:03:49,430
will uh sorry to your embeddings and
that will allow you to get um this

120
00:03:49,430 --> 00:03:49,440
that will allow you to get um this
 

121
00:03:49,440 --> 00:03:51,750
that will allow you to get um this
position encoding.

122
00:03:51,750 --> 00:03:51,760
position encoding.
 

123
00:03:51,760 --> 00:03:53,270
position encoding.
turned out that that was not such a

124
00:03:53,270 --> 00:03:53,280
turned out that that was not such a
 

125
00:03:53,280 --> 00:03:55,270
turned out that that was not such a
great idea. And then subsequently came

126
00:03:55,270 --> 00:03:55,280
great idea. And then subsequently came
 

127
00:03:55,280 --> 00:03:57,350
great idea. And then subsequently came
this idea of nope, which is no position

128
00:03:57,350 --> 00:03:57,360
this idea of nope, which is no position
 

129
00:03:57,360 --> 00:03:59,750
this idea of nope, which is no position
encoding. And so there was just, you

130
00:03:59,750 --> 00:03:59,760
encoding. And so there was just, you
 

131
00:03:59,760 --> 00:04:01,110
encoding. And so there was just, you
know, adding nothing in actually

132
00:04:01,110 --> 00:04:01,120
know, adding nothing in actually
 

133
00:04:01,120 --> 00:04:02,789
know, adding nothing in actually
outperformed these absolute position

134
00:04:02,789 --> 00:04:02,799
outperformed these absolute position
 

135
00:04:02,799 --> 00:04:04,789
outperformed these absolute position
encodings.

136
00:04:04,789 --> 00:04:04,799
encodings.
 

137
00:04:04,799 --> 00:04:06,789
encodings.
The next idea was to say, well, can we

138
00:04:06,789 --> 00:04:06,799
The next idea was to say, well, can we
 

139
00:04:06,799 --> 00:04:09,750
The next idea was to say, well, can we
do learned relative position encoding?

140
00:04:09,750 --> 00:04:09,760
do learned relative position encoding?
 

141
00:04:09,760 --> 00:04:12,070
do learned relative position encoding?
And we said, well, what we want to do is

142
00:04:12,070 --> 00:04:12,080
And we said, well, what we want to do is
 

143
00:04:12,080 --> 00:04:13,990
And we said, well, what we want to do is
we care about not the I don't care if

144
00:04:13,990 --> 00:04:14,000
we care about not the I don't care if
 

145
00:04:14,000 --> 00:04:16,150
we care about not the I don't care if
you're the fifth symbol or the 25th

146
00:04:16,150 --> 00:04:16,160
you're the fifth symbol or the 25th
 

147
00:04:16,160 --> 00:04:18,550
you're the fifth symbol or the 25th
symbol or the 23rd symbol. What I care

148
00:04:18,550 --> 00:04:18,560
symbol or the 23rd symbol. What I care
 

149
00:04:18,560 --> 00:04:20,789
symbol or the 23rd symbol. What I care
about is where are you relative to the

150
00:04:20,789 --> 00:04:20,799
about is where are you relative to the
 

151
00:04:20,799 --> 00:04:22,950
about is where are you relative to the
other people other other s other tokens

152
00:04:22,950 --> 00:04:22,960
other people other other s other tokens
 

153
00:04:22,960 --> 00:04:25,510
other people other other s other tokens
in the in the mix. And so I care about

154
00:04:25,510 --> 00:04:25,520
in the in the mix. And so I care about
 

155
00:04:25,520 --> 00:04:27,670
in the in the mix. And so I care about
the differences between the different

156
00:04:27,670 --> 00:04:27,680
the differences between the different
 

157
00:04:27,680 --> 00:04:30,390
the differences between the different
tokens. And so he said, well, let's

158
00:04:30,390 --> 00:04:30,400
tokens. And so he said, well, let's
 

159
00:04:30,400 --> 00:04:33,350
tokens. And so he said, well, let's
learn something that actually modifies

160
00:04:33,350 --> 00:04:33,360
learn something that actually modifies
 

161
00:04:33,360 --> 00:04:37,110
learn something that actually modifies
the attention value itself based on the

162
00:04:37,110 --> 00:04:37,120
the attention value itself based on the
 

163
00:04:37,120 --> 00:04:39,270
the attention value itself based on the
relative position between the query and

164
00:04:39,270 --> 00:04:39,280
relative position between the query and
 

165
00:04:39,280 --> 00:04:42,310
relative position between the query and
the key. Does everyone remember that?

166
00:04:42,310 --> 00:04:42,320
the key. Does everyone remember that?
 

167
00:04:42,320 --> 00:04:45,350
the key. Does everyone remember that?
And we learned this particular parameter

168
00:04:45,350 --> 00:04:45,360
And we learned this particular parameter
 

169
00:04:45,360 --> 00:04:48,469
And we learned this particular parameter
that that depended on the relative

170
00:04:48,469 --> 00:04:48,479
that that depended on the relative
 

171
00:04:48,479 --> 00:04:51,110
that that depended on the relative
positions and used that as a relative

172
00:04:51,110 --> 00:04:51,120
positions and used that as a relative
 

173
00:04:51,120 --> 00:04:54,150
positions and used that as a relative
position encoding and that beat nope and

174
00:04:54,150 --> 00:04:54,160
position encoding and that beat nope and
 

175
00:04:54,160 --> 00:04:56,230
position encoding and that beat nope and
absolute position encoding in multiple

176
00:04:56,230 --> 00:04:56,240
absolute position encoding in multiple
 

177
00:04:56,240 --> 00:04:59,270
absolute position encoding in multiple
cases. However, that also turned out not

178
00:04:59,270 --> 00:04:59,280
cases. However, that also turned out not
 

179
00:04:59,280 --> 00:05:01,110
cases. However, that also turned out not
to be that great and so the

180
00:05:01,110 --> 00:05:01,120
to be that great and so the
 

181
00:05:01,120 --> 00:05:03,189
to be that great and so the
state-of-the-art and what almost

182
00:05:03,189 --> 00:05:03,199
state-of-the-art and what almost
 

183
00:05:03,199 --> 00:05:06,550
state-of-the-art and what almost
everything now uses is rope or some

184
00:05:06,550 --> 00:05:06,560
everything now uses is rope or some
 

185
00:05:06,560 --> 00:05:09,029
everything now uses is rope or some
variation of rope. and we kind of

186
00:05:09,029 --> 00:05:09,039
variation of rope. and we kind of
 

187
00:05:09,039 --> 00:05:10,469
variation of rope. and we kind of
started talking about it last time but

188
00:05:10,469 --> 00:05:10,479
started talking about it last time but
 

189
00:05:10,479 --> 00:05:12,230
started talking about it last time but
didn't have enough time to go through

190
00:05:12,230 --> 00:05:12,240
didn't have enough time to go through
 

191
00:05:12,240 --> 00:05:13,749
didn't have enough time to go through
it. So I'm going to pick up and talk

192
00:05:13,749 --> 00:05:13,759
it. So I'm going to pick up and talk
 

193
00:05:13,759 --> 00:05:18,710
it. So I'm going to pick up and talk
about rope now. Okay. So the key idea

194
00:05:18,710 --> 00:05:18,720
about rope now. Okay. So the key idea
 

195
00:05:18,720 --> 00:05:22,870
about rope now. Okay. So the key idea
behind rope is that we want to basically

196
00:05:22,870 --> 00:05:22,880
behind rope is that we want to basically
 

197
00:05:22,880 --> 00:05:27,510
behind rope is that we want to basically
um modify

198
00:05:27,510 --> 00:05:27,520

 

199
00:05:27,520 --> 00:05:29,350

the key

200
00:05:29,350 --> 00:05:29,360
the key
 

201
00:05:29,360 --> 00:05:31,749
the key
and the query

202
00:05:31,749 --> 00:05:31,759
and the query
 

203
00:05:31,759 --> 00:05:34,870
and the query
based on

204
00:05:34,870 --> 00:05:34,880
based on
 

205
00:05:34,880 --> 00:05:38,950
based on
their

206
00:05:38,950 --> 00:05:38,960

 

207
00:05:38,960 --> 00:05:42,950

absolute position.

208
00:05:42,950 --> 00:05:42,960
absolute position.
 

209
00:05:42,960 --> 00:05:50,150
absolute position.
So that the score that they generate

210
00:05:50,150 --> 00:05:50,160

 

211
00:05:50,160 --> 00:05:52,950

depends

212
00:05:52,950 --> 00:05:52,960
depends
 

213
00:05:52,960 --> 00:05:55,909
depends
on the

214
00:05:55,909 --> 00:05:55,919
on the
 

215
00:05:55,919 --> 00:05:58,950
on the
relative

216
00:05:58,950 --> 00:05:58,960

 

217
00:05:58,960 --> 00:06:01,909

position, right?

218
00:06:01,909 --> 00:06:01,919
position, right?
 

219
00:06:01,919 --> 00:06:05,350
position, right?
And how are we going to do that? Well,

220
00:06:05,350 --> 00:06:05,360
And how are we going to do that? Well,
 

221
00:06:05,360 --> 00:06:07,670
And how are we going to do that? Well,
our score we're basically computing as

222
00:06:07,670 --> 00:06:07,680
our score we're basically computing as
 

223
00:06:07,680 --> 00:06:11,430
our score we're basically computing as
this inner product between the key and

224
00:06:11,430 --> 00:06:11,440
this inner product between the key and
 

225
00:06:11,440 --> 00:06:16,710
this inner product between the key and
the query, right?

226
00:06:16,710 --> 00:06:16,720

 

227
00:06:16,720 --> 00:06:18,390

And what do we know? We know about inner

228
00:06:18,390 --> 00:06:18,400
And what do we know? We know about inner
 

229
00:06:18,400 --> 00:06:19,909
And what do we know? We know about inner
products. Well, we know that inner

230
00:06:19,909 --> 00:06:19,919
products. Well, we know that inner
 

231
00:06:19,919 --> 00:06:22,309
products. Well, we know that inner
products are basically a function of two

232
00:06:22,309 --> 00:06:22,319
products are basically a function of two
 

233
00:06:22,319 --> 00:06:23,830
products are basically a function of two
things, right? If I think about the

234
00:06:23,830 --> 00:06:23,840
things, right? If I think about the
 

235
00:06:23,840 --> 00:06:27,749
things, right? If I think about the
inner product between this K and this Q,

236
00:06:27,749 --> 00:06:27,759
inner product between this K and this Q,
 

237
00:06:27,759 --> 00:06:31,510
inner product between this K and this Q,
I can write this as

238
00:06:31,510 --> 00:06:31,520
I can write this as
 

239
00:06:31,520 --> 00:06:36,550
I can write this as
the magnitude of K. Let's say it two

240
00:06:36,550 --> 00:06:36,560
the magnitude of K. Let's say it two
 

241
00:06:36,560 --> 00:06:38,790
the magnitude of K. Let's say it two
magnitude of Q

242
00:06:38,790 --> 00:06:38,800
magnitude of Q
 

243
00:06:38,800 --> 00:06:42,390
magnitude of Q
times the cosine of the angle between

244
00:06:42,390 --> 00:06:42,400
times the cosine of the angle between
 

245
00:06:42,400 --> 00:06:45,510
times the cosine of the angle between
these two, right? And so the inner

246
00:06:45,510 --> 00:06:45,520
these two, right? And so the inner
 

247
00:06:45,520 --> 00:06:47,909
these two, right? And so the inner
product is maximized when your vectors

248
00:06:47,909 --> 00:06:47,919
product is maximized when your vectors
 

249
00:06:47,919 --> 00:06:50,309
product is maximized when your vectors
are aligned to each other and it is

250
00:06:50,309 --> 00:06:50,319
are aligned to each other and it is
 

251
00:06:50,319 --> 00:06:51,990
are aligned to each other and it is
minimized when they're orthogonal to

252
00:06:51,990 --> 00:06:52,000
minimized when they're orthogonal to
 

253
00:06:52,000 --> 00:06:53,909
minimized when they're orthogonal to
each other. Right? If the angle between

254
00:06:53,909 --> 00:06:53,919
each other. Right? If the angle between
 

255
00:06:53,919 --> 00:06:57,189
each other. Right? If the angle between
them is 90°, then you're going to have a

256
00:06:57,189 --> 00:06:57,199
them is 90°, then you're going to have a
 

257
00:06:57,199 --> 00:06:59,990
them is 90°, then you're going to have a
uh cosine 90 is going to be zero and

258
00:06:59,990 --> 00:07:00,000
uh cosine 90 is going to be zero and
 

259
00:07:00,000 --> 00:07:02,150
uh cosine 90 is going to be zero and
therefore your inner product is zero.

260
00:07:02,150 --> 00:07:02,160
therefore your inner product is zero.
 

261
00:07:02,160 --> 00:07:05,749
therefore your inner product is zero.
Orthogonal is the worst. Okay.

262
00:07:05,749 --> 00:07:05,759
Orthogonal is the worst. Okay.
 

263
00:07:05,759 --> 00:07:08,790
Orthogonal is the worst. Okay.
So what if we can modulate where these

264
00:07:08,790 --> 00:07:08,800
So what if we can modulate where these
 

265
00:07:08,800 --> 00:07:11,270
So what if we can modulate where these
key and query vectors are with respect

266
00:07:11,270 --> 00:07:11,280
key and query vectors are with respect
 

267
00:07:11,280 --> 00:07:15,990
key and query vectors are with respect
to each other based on their

268
00:07:15,990 --> 00:07:16,000
to each other based on their
 

269
00:07:16,000 --> 00:07:17,510
to each other based on their
position.

270
00:07:17,510 --> 00:07:17,520
position.
 

271
00:07:17,520 --> 00:07:20,390
position.
Okay, so every key is coming from a

272
00:07:20,390 --> 00:07:20,400
Okay, so every key is coming from a
 

273
00:07:20,400 --> 00:07:22,309
Okay, so every key is coming from a
token at a certain position. Every query

274
00:07:22,309 --> 00:07:22,319
token at a certain position. Every query
 

275
00:07:22,319 --> 00:07:23,830
token at a certain position. Every query
is coming from a token at a certain

276
00:07:23,830 --> 00:07:23,840
is coming from a token at a certain
 

277
00:07:23,840 --> 00:07:27,430
is coming from a token at a certain
position. If we can modulate the angle

278
00:07:27,430 --> 00:07:27,440
position. If we can modulate the angle
 

279
00:07:27,440 --> 00:07:29,749
position. If we can modulate the angle
between these vectors,

280
00:07:29,749 --> 00:07:29,759
between these vectors,
 

281
00:07:29,759 --> 00:07:33,270
between these vectors,
then maybe we can use that to somehow

282
00:07:33,270 --> 00:07:33,280
then maybe we can use that to somehow
 

283
00:07:33,280 --> 00:07:35,270
then maybe we can use that to somehow
capture

284
00:07:35,270 --> 00:07:35,280
capture
 

285
00:07:35,280 --> 00:07:38,150
capture
this relative position. Okay, that's the

286
00:07:38,150 --> 00:07:38,160
this relative position. Okay, that's the
 

287
00:07:38,160 --> 00:07:41,189
this relative position. Okay, that's the
key idea behind rope. We're not going to

288
00:07:41,189 --> 00:07:41,199
key idea behind rope. We're not going to
 

289
00:07:41,199 --> 00:07:44,870
key idea behind rope. We're not going to
use exactly that idea, but in two

290
00:07:44,870 --> 00:07:44,880
use exactly that idea, but in two
 

291
00:07:44,880 --> 00:07:47,749
use exactly that idea, but in two
dimensions that kind of maybe makes

292
00:07:47,749 --> 00:07:47,759
dimensions that kind of maybe makes
 

293
00:07:47,759 --> 00:07:49,350
dimensions that kind of maybe makes
sense to you, right? So for example, if

294
00:07:49,350 --> 00:07:49,360
sense to you, right? So for example, if
 

295
00:07:49,360 --> 00:07:52,550
sense to you, right? So for example, if
I have a rotation matrix,

296
00:07:52,550 --> 00:07:52,560
I have a rotation matrix,
 

297
00:07:52,560 --> 00:07:57,749
I have a rotation matrix,
so

298
00:07:57,749 --> 00:07:57,759

 

299
00:07:57,759 --> 00:08:00,309

those of you who took 16A or 16B with me

300
00:08:00,309 --> 00:08:00,319
those of you who took 16A or 16B with me
 

301
00:08:00,319 --> 00:08:02,390
those of you who took 16A or 16B with me
might have seen me talk about this. Uh

302
00:08:02,390 --> 00:08:02,400
might have seen me talk about this. Uh
 

303
00:08:02,400 --> 00:08:05,749
might have seen me talk about this. Uh
do people still Yeah. Yeah. Yeah. So

304
00:08:05,749 --> 00:08:05,759
do people still Yeah. Yeah. Yeah. So
 

305
00:08:05,759 --> 00:08:08,309
do people still Yeah. Yeah. Yeah. So
anyways

306
00:08:08,309 --> 00:08:08,319
anyways
 

307
00:08:08,319 --> 00:08:10,790
anyways
um

308
00:08:10,790 --> 00:08:10,800
um
 

309
00:08:10,800 --> 00:08:15,270
um
RT let's call this let me call this um

310
00:08:15,270 --> 00:08:15,280
RT let's call this let me call this um
 

311
00:08:15,280 --> 00:08:17,029
RT let's call this let me call this um
cosine

312
00:08:17,029 --> 00:08:17,039
cosine
 

313
00:08:17,039 --> 00:08:21,670
cosine
let's see um

314
00:08:21,670 --> 00:08:21,680

 

315
00:08:21,680 --> 00:08:25,189

omega t

316
00:08:25,189 --> 00:08:25,199

 

317
00:08:25,199 --> 00:08:32,550

maybe I should

318
00:08:32,550 --> 00:08:32,560

 

319
00:08:32,560 --> 00:08:34,790

actually I'll substitute that in later

320
00:08:34,790 --> 00:08:34,800
actually I'll substitute that in later
 

321
00:08:34,800 --> 00:08:37,670
actually I'll substitute that in later
let me Just call this omega t

322
00:08:37,670 --> 00:08:37,680
let me Just call this omega t
 

323
00:08:37,680 --> 00:08:41,350
let me Just call this omega t
minus sin omega t

324
00:08:41,350 --> 00:08:41,360
minus sin omega t
 

325
00:08:41,360 --> 00:08:44,310
minus sin omega t
sin omega t

326
00:08:44,310 --> 00:08:44,320
sin omega t
 

327
00:08:44,320 --> 00:08:47,269
sin omega t
cosine omega t.

328
00:08:47,269 --> 00:08:47,279
cosine omega t.
 

329
00:08:47,279 --> 00:08:50,310
cosine omega t.
Okay. And what does this rotation matrix

330
00:08:50,310 --> 00:08:50,320
Okay. And what does this rotation matrix
 

331
00:08:50,320 --> 00:08:53,190
Okay. And what does this rotation matrix
do? Well, when I multiply a vector by

332
00:08:53,190 --> 00:08:53,200
do? Well, when I multiply a vector by
 

333
00:08:53,200 --> 00:08:58,230
do? Well, when I multiply a vector by
this rotation matrix, we rotate by um

334
00:08:58,230 --> 00:08:58,240
this rotation matrix, we rotate by um
 

335
00:08:58,240 --> 00:08:59,750
this rotation matrix, we rotate by um
omega t, right? That's what this

336
00:08:59,750 --> 00:08:59,760
omega t, right? That's what this
 

337
00:08:59,760 --> 00:09:03,350
omega t, right? That's what this
rotation matrix does. Okay. So, RQ

338
00:09:03,350 --> 00:09:03,360
rotation matrix does. Okay. So, RQ
 

339
00:09:03,360 --> 00:09:07,590
rotation matrix does. Okay. So, RQ
basically rotates

340
00:09:07,590 --> 00:09:07,600

 

341
00:09:07,600 --> 00:09:10,949

Q by

342
00:09:10,949 --> 00:09:10,959
Q by
 

343
00:09:10,959 --> 00:09:18,870
Q by
omega T.

344
00:09:18,870 --> 00:09:18,880

 

345
00:09:18,880 --> 00:09:21,750

So now we want to use this idea to

346
00:09:21,750 --> 00:09:21,760
So now we want to use this idea to
 

347
00:09:21,760 --> 00:09:25,350
So now we want to use this idea to
basically influence the inner product.

348
00:09:25,350 --> 00:09:25,360
basically influence the inner product.
 

349
00:09:25,360 --> 00:09:27,670
basically influence the inner product.
So instead of considering the inner

350
00:09:27,670 --> 00:09:27,680
So instead of considering the inner
 

351
00:09:27,680 --> 00:09:29,990
So instead of considering the inner
product between K and Q, what if I

352
00:09:29,990 --> 00:09:30,000
product between K and Q, what if I
 

353
00:09:30,000 --> 00:09:33,430
product between K and Q, what if I
instead instead considered

354
00:09:33,430 --> 00:09:33,440
instead instead considered
 

355
00:09:33,440 --> 00:09:35,990
instead instead considered
the inner product

356
00:09:35,990 --> 00:09:36,000
the inner product
 

357
00:09:36,000 --> 00:09:38,870
the inner product
let's say RT

358
00:09:38,870 --> 00:09:38,880
let's say RT
 

359
00:09:38,880 --> 00:09:40,981
let's say RT
qt

360
00:09:40,981 --> 00:09:40,991
qt
 

361
00:09:40,991 --> 00:09:41,590
qt
[snorts]

362
00:09:41,590 --> 00:09:41,600
[snorts]
 

363
00:09:41,600 --> 00:09:46,389
[snorts]
and r i ki. Okay. So my query is coming

364
00:09:46,389 --> 00:09:46,399
and r i ki. Okay. So my query is coming
 

365
00:09:46,399 --> 00:09:49,829
and r i ki. Okay. So my query is coming
at time t and I'm considering the inner

366
00:09:49,829 --> 00:09:49,839
at time t and I'm considering the inner
 

367
00:09:49,839 --> 00:09:52,070
at time t and I'm considering the inner
product with the key that was generated

368
00:09:52,070 --> 00:09:52,080
product with the key that was generated
 

369
00:09:52,080 --> 00:09:58,310
product with the key that was generated
at time i or position i. This gives me

370
00:09:58,310 --> 00:09:58,320
at time i or position i. This gives me
 

371
00:09:58,320 --> 00:10:00,230
at time i or position i. This gives me
qt

372
00:10:00,230 --> 00:10:00,240
qt
 

373
00:10:00,240 --> 00:10:02,550
qt
transpose

374
00:10:02,550 --> 00:10:02,560
transpose
 

375
00:10:02,560 --> 00:10:05,350
transpose
rtpose

376
00:10:05,350 --> 00:10:05,360
rtpose
 

377
00:10:05,360 --> 00:10:07,269
rtpose
r i

378
00:10:07,269 --> 00:10:07,279
r i
 

379
00:10:07,279 --> 00:10:12,710
r i
ki. Okay.

380
00:10:12,710 --> 00:10:12,720

 

381
00:10:12,720 --> 00:10:18,230

And so now this thing is a rotation

382
00:10:18,230 --> 00:10:18,240
And so now this thing is a rotation
 

383
00:10:18,240 --> 00:10:22,630
And so now this thing is a rotation
by negative omega t and this is a

384
00:10:22,630 --> 00:10:22,640
by negative omega t and this is a
 

385
00:10:22,640 --> 00:10:25,750
by negative omega t and this is a
rotation

386
00:10:25,750 --> 00:10:25,760

 

387
00:10:25,760 --> 00:10:27,350

by

388
00:10:27,350 --> 00:10:27,360
by
 

389
00:10:27,360 --> 00:10:29,990
by
omega i. Right?

390
00:10:29,990 --> 00:10:30,000
omega i. Right?
 

391
00:10:30,000 --> 00:10:31,910
omega i. Right?
So [snorts] now when I put these two

392
00:10:31,910 --> 00:10:31,920
So [snorts] now when I put these two
 

393
00:10:31,920 --> 00:10:34,870
So [snorts] now when I put these two
matrices here,

394
00:10:34,870 --> 00:10:34,880
matrices here,
 

395
00:10:34,880 --> 00:10:38,069
matrices here,
what have I done to my inner product?

396
00:10:38,069 --> 00:10:38,079
what have I done to my inner product?
 

397
00:10:38,079 --> 00:10:41,430
what have I done to my inner product?
Right? I've basically changed the angle

398
00:10:41,430 --> 00:10:41,440
Right? I've basically changed the angle
 

399
00:10:41,440 --> 00:10:43,750
Right? I've basically changed the angle
between the two vectors and this change

400
00:10:43,750 --> 00:10:43,760
between the two vectors and this change
 

401
00:10:43,760 --> 00:10:48,150
between the two vectors and this change
is now a function of basically t and I

402
00:10:48,150 --> 00:10:48,160
is now a function of basically t and I
 

403
00:10:48,160 --> 00:10:50,389
is now a function of basically t and I
the relative position between these two

404
00:10:50,389 --> 00:10:50,399
the relative position between these two
 

405
00:10:50,399 --> 00:10:51,990
the relative position between these two
things.

406
00:10:51,990 --> 00:10:52,000
things.
 

407
00:10:52,000 --> 00:10:56,230
things.
Make sense?

408
00:10:56,230 --> 00:10:56,240

 

409
00:10:56,240 --> 00:11:02,470

Questions?

410
00:11:02,470 --> 00:11:02,480

 

411
00:11:02,480 --> 00:11:05,829

Okay.

412
00:11:05,829 --> 00:11:05,839

 

413
00:11:05,839 --> 00:11:07,829

So this is great for two-dimensional

414
00:11:07,829 --> 00:11:07,839
So this is great for two-dimensional
 

415
00:11:07,839 --> 00:11:09,509
So this is great for two-dimensional
things, but you know if deep learning

416
00:11:09,509 --> 00:11:09,519
things, but you know if deep learning
 

417
00:11:09,519 --> 00:11:11,509
things, but you know if deep learning
worked with two-dimensional embedding

418
00:11:11,509 --> 00:11:11,519
worked with two-dimensional embedding
 

419
00:11:11,519 --> 00:11:13,030
worked with two-dimensional embedding
vectors, then things would be very

420
00:11:13,030 --> 00:11:13,040
vectors, then things would be very
 

421
00:11:13,040 --> 00:11:14,870
vectors, then things would be very
different. Our embedding dimensions are

422
00:11:14,870 --> 00:11:14,880
different. Our embedding dimensions are
 

423
00:11:14,880 --> 00:11:16,150
different. Our embedding dimensions are
never two dimensions, right? What we

424
00:11:16,150 --> 00:11:16,160
never two dimensions, right? What we
 

425
00:11:16,160 --> 00:11:17,670
never two dimensions, right? What we
have like a thousand dimensions, 2,000

426
00:11:17,670 --> 00:11:17,680
have like a thousand dimensions, 2,000
 

427
00:11:17,680 --> 00:11:18,870
have like a thousand dimensions, 2,000
dimensions. This is the kind of

428
00:11:18,870 --> 00:11:18,880
dimensions. This is the kind of
 

429
00:11:18,880 --> 00:11:21,670
dimensions. This is the kind of
embedding dimension we have. So how do

430
00:11:21,670 --> 00:11:21,680
embedding dimension we have. So how do
 

431
00:11:21,680 --> 00:11:25,430
embedding dimension we have. So how do
we extend this idea to work for larger

432
00:11:25,430 --> 00:11:25,440
we extend this idea to work for larger
 

433
00:11:25,440 --> 00:11:28,310
we extend this idea to work for larger
and larger vectors?

434
00:11:28,310 --> 00:11:28,320
and larger vectors?
 

435
00:11:28,320 --> 00:11:31,590
and larger vectors?
Let me add a page here. That is the key

436
00:11:31,590 --> 00:11:31,600
Let me add a page here. That is the key
 

437
00:11:31,600 --> 00:11:33,430
Let me add a page here. That is the key
innovation or one of the key innovations

438
00:11:33,430 --> 00:11:33,440
innovation or one of the key innovations
 

439
00:11:33,440 --> 00:11:35,670
innovation or one of the key innovations
of rope.

440
00:11:35,670 --> 00:11:35,680
of rope.
 

441
00:11:35,680 --> 00:11:39,430
of rope.
And so now suppose you have some

442
00:11:39,430 --> 00:11:39,440
And so now suppose you have some
 

443
00:11:39,440 --> 00:11:43,829
And so now suppose you have some
very long vector.

444
00:11:43,829 --> 00:11:43,839

 

445
00:11:43,839 --> 00:11:50,550

Okay. And I have here

446
00:11:50,550 --> 00:11:50,560

 

447
00:11:50,560 --> 00:11:53,590

multiple entries of this vector.

448
00:11:53,590 --> 00:11:53,600
multiple entries of this vector.
 

449
00:11:53,600 --> 00:11:55,750
multiple entries of this vector.
What I'm going to do is I'm going to

450
00:11:55,750 --> 00:11:55,760
What I'm going to do is I'm going to
 

451
00:11:55,760 --> 00:11:57,430
What I'm going to do is I'm going to
group

452
00:11:57,430 --> 00:11:57,440
group
 

453
00:11:57,440 --> 00:11:59,430
group
the country the entries of my vector. So

454
00:11:59,430 --> 00:11:59,440
the country the entries of my vector. So
 

455
00:11:59,440 --> 00:12:01,509
the country the entries of my vector. So
I'm going to put these two into one

456
00:12:01,509 --> 00:12:01,519
I'm going to put these two into one
 

457
00:12:01,519 --> 00:12:05,110
I'm going to put these two into one
group. these two into one group, these

458
00:12:05,110 --> 00:12:05,120
group. these two into one group, these
 

459
00:12:05,120 --> 00:12:06,949
group. these two into one group, these
two into one group, so on and so forth.

460
00:12:06,949 --> 00:12:06,959
two into one group, so on and so forth.
 

461
00:12:06,959 --> 00:12:08,310
two into one group, so on and so forth.
And I'm going to treat these essentially

462
00:12:08,310 --> 00:12:08,320
And I'm going to treat these essentially
 

463
00:12:08,320 --> 00:12:10,710
And I'm going to treat these essentially
as two-dimensional vectors or complex

464
00:12:10,710 --> 00:12:10,720
as two-dimensional vectors or complex
 

465
00:12:10,720 --> 00:12:12,870
as two-dimensional vectors or complex
numbers,

466
00:12:12,870 --> 00:12:12,880
numbers,
 

467
00:12:12,880 --> 00:12:14,949
numbers,
right? So there's a real part and an

468
00:12:14,949 --> 00:12:14,959
right? So there's a real part and an
 

469
00:12:14,959 --> 00:12:18,629
right? So there's a real part and an
imaginary part. Okay?

470
00:12:18,629 --> 00:12:18,639
imaginary part. Okay?
 

471
00:12:18,639 --> 00:12:21,670
imaginary part. Okay?
And I have now these a stack basically

472
00:12:21,670 --> 00:12:21,680
And I have now these a stack basically
 

473
00:12:21,680 --> 00:12:23,030
And I have now these a stack basically
of complex numbers. If I have a

474
00:12:23,030 --> 00:12:23,040
of complex numbers. If I have a
 

475
00:12:23,040 --> 00:12:26,230
of complex numbers. If I have a
d-dimensional vector, I have dx

476
00:12:26,230 --> 00:12:26,240
d-dimensional vector, I have dx
 

477
00:12:26,240 --> 00:12:27,829
d-dimensional vector, I have dx
two-dimensional

478
00:12:27,829 --> 00:12:27,839
two-dimensional
 

479
00:12:27,839 --> 00:12:31,670
two-dimensional
chunks in there. And I'm going to apply

480
00:12:31,670 --> 00:12:31,680
chunks in there. And I'm going to apply
 

481
00:12:31,680 --> 00:12:35,750
chunks in there. And I'm going to apply
this exact same rotation trick to each

482
00:12:35,750 --> 00:12:35,760
this exact same rotation trick to each
 

483
00:12:35,760 --> 00:12:39,670
this exact same rotation trick to each
of these two-dimensional chunks. Okay.

484
00:12:39,670 --> 00:12:39,680
of these two-dimensional chunks. Okay.
 

485
00:12:39,680 --> 00:12:41,269
of these two-dimensional chunks. Okay.
So, what I'm going to do is I'm going to

486
00:12:41,269 --> 00:12:41,279
So, what I'm going to do is I'm going to
 

487
00:12:41,279 --> 00:12:43,509
So, what I'm going to do is I'm going to
take this vector

488
00:12:43,509 --> 00:12:43,519
take this vector
 

489
00:12:43,519 --> 00:12:46,710
take this vector
and I'm going to multiply it by

490
00:12:46,710 --> 00:12:46,720
and I'm going to multiply it by
 

491
00:12:46,720 --> 00:12:50,870
and I'm going to multiply it by
an M which looks something like this.

492
00:12:50,870 --> 00:12:50,880
an M which looks something like this.
 

493
00:12:50,880 --> 00:12:53,590
an M which looks something like this.
This is m1,

494
00:12:53,590 --> 00:12:53,600
This is m1,
 

495
00:12:53,600 --> 00:12:56,069
This is m1,
m2,

496
00:12:56,069 --> 00:12:56,079
m2,
 

497
00:12:56,079 --> 00:13:01,350
m2,
m d /2.

498
00:13:01,350 --> 00:13:01,360

 

499
00:13:01,360 --> 00:13:06,150

And this is a block matrix where each mj

500
00:13:06,150 --> 00:13:06,160
And this is a block matrix where each mj
 

501
00:13:06,160 --> 00:13:09,509
And this is a block matrix where each mj
is basically

502
00:13:09,509 --> 00:13:09,519

 

503
00:13:09,519 --> 00:13:11,110

cossine

504
00:13:11,110 --> 00:13:11,120
cossine
 

505
00:13:11,120 --> 00:13:13,910
cossine
2 pi t

506
00:13:13,910 --> 00:13:13,920
2 pi t
 

507
00:13:13,920 --> 00:13:18,310
2 pi t
fj. So here I talked about I used omega

508
00:13:18,310 --> 00:13:18,320
fj. So here I talked about I used omega
 

509
00:13:18,320 --> 00:13:20,389
fj. So here I talked about I used omega
here but I really want to call out this

510
00:13:20,389 --> 00:13:20,399
here but I really want to call out this
 

511
00:13:20,399 --> 00:13:21,829
here but I really want to call out this
frequency in a bit. So I'm replacing

512
00:13:21,829 --> 00:13:21,839
frequency in a bit. So I'm replacing
 

513
00:13:21,839 --> 00:13:24,150
frequency in a bit. So I'm replacing
these omegas with uh the corresponding

514
00:13:24,150 --> 00:13:24,160
these omegas with uh the corresponding
 

515
00:13:24,160 --> 00:13:31,430
these omegas with uh the corresponding
frequencies.

516
00:13:31,430 --> 00:13:31,440

 

517
00:13:31,440 --> 00:13:33,670

Maybe it is better to write this in the

518
00:13:33,670 --> 00:13:33,680
Maybe it is better to write this in the
 

519
00:13:33,680 --> 00:13:37,750
Maybe it is better to write this in the
other order

520
00:13:37,750 --> 00:13:37,760

 

521
00:13:37,760 --> 00:14:01,110

and then times t

522
00:14:01,110 --> 00:14:01,120

 

523
00:14:01,120 --> 00:14:06,629

This is all inside the

524
00:14:06,629 --> 00:14:06,639

 

525
00:14:06,639 --> 00:14:12,389

Okay.

526
00:14:12,389 --> 00:14:12,399

 

527
00:14:12,399 --> 00:14:18,470

So now if I have this for every single

528
00:14:18,470 --> 00:14:18,480
So now if I have this for every single
 

529
00:14:18,480 --> 00:14:20,710
So now if I have this for every single
kind of pair,

530
00:14:20,710 --> 00:14:20,720
kind of pair,
 

531
00:14:20,720 --> 00:14:24,310
kind of pair,
each of these is being rotated

532
00:14:24,310 --> 00:14:24,320
each of these is being rotated
 

533
00:14:24,320 --> 00:14:27,030
each of these is being rotated
by

534
00:14:27,030 --> 00:14:27,040
by
 

535
00:14:27,040 --> 00:14:29,030
by
the appropriate angle given by this

536
00:14:29,030 --> 00:14:29,040
the appropriate angle given by this
 

537
00:14:29,040 --> 00:14:32,150
the appropriate angle given by this
matrix, right? And so now when I look at

538
00:14:32,150 --> 00:14:32,160
matrix, right? And so now when I look at
 

539
00:14:32,160 --> 00:14:34,069
matrix, right? And so now when I look at
my all of my different channels, it's

540
00:14:34,069 --> 00:14:34,079
my all of my different channels, it's
 

541
00:14:34,079 --> 00:14:35,430
my all of my different channels, it's
like I'm looking at these groups of

542
00:14:35,430 --> 00:14:35,440
like I'm looking at these groups of
 

543
00:14:35,440 --> 00:14:37,030
like I'm looking at these groups of
channels.

544
00:14:37,030 --> 00:14:37,040
channels.
 

545
00:14:37,040 --> 00:14:39,430
channels.
And these fs, I'm going to choose a

546
00:14:39,430 --> 00:14:39,440
And these fs, I'm going to choose a
 

547
00:14:39,440 --> 00:14:42,150
And these fs, I'm going to choose a
different f for each different pair of

548
00:14:42,150 --> 00:14:42,160
different f for each different pair of
 

549
00:14:42,160 --> 00:14:46,870
different f for each different pair of
channels. So these fi

550
00:14:46,870 --> 00:14:46,880

 

551
00:14:46,880 --> 00:14:49,350

these fi depend on whether I'm thinking

552
00:14:49,350 --> 00:14:49,360
these fi depend on whether I'm thinking
 

553
00:14:49,360 --> 00:14:50,629
these fi depend on whether I'm thinking
about the first two channels or the

554
00:14:50,629 --> 00:14:50,639
about the first two channels or the
 

555
00:14:50,639 --> 00:14:52,710
about the first two channels or the
second two channels or so on and so

556
00:14:52,710 --> 00:14:52,720
second two channels or so on and so
 

557
00:14:52,720 --> 00:14:56,230
second two channels or so on and so
forth, right? And I'm not learning these

558
00:14:56,230 --> 00:14:56,240
forth, right? And I'm not learning these
 

559
00:14:56,240 --> 00:14:59,189
forth, right? And I'm not learning these
fs. These fs are fixed. I pick them in

560
00:14:59,189 --> 00:14:59,199
fs. These fs are fixed. I pick them in
 

561
00:14:59,199 --> 00:15:01,829
fs. These fs are fixed. I pick them in
advance and they just are what they are.

562
00:15:01,829 --> 00:15:01,839
advance and they just are what they are.
 

563
00:15:01,839 --> 00:15:05,189
advance and they just are what they are.
I'm not doing any learning here. But now

564
00:15:05,189 --> 00:15:05,199
I'm not doing any learning here. But now
 

565
00:15:05,199 --> 00:15:08,949
I'm not doing any learning here. But now
if I pick an F that is a very low

566
00:15:08,949 --> 00:15:08,959
if I pick an F that is a very low
 

567
00:15:08,959 --> 00:15:12,069
if I pick an F that is a very low
frequency, what is that going to mean?

568
00:15:12,069 --> 00:15:12,079
frequency, what is that going to mean?
 

569
00:15:12,079 --> 00:15:13,430
frequency, what is that going to mean?
That means there's going to be very

570
00:15:13,430 --> 00:15:13,440
That means there's going to be very
 

571
00:15:13,440 --> 00:15:16,310
That means there's going to be very
little variation over time. And so even

572
00:15:16,310 --> 00:15:16,320
little variation over time. And so even
 

573
00:15:16,320 --> 00:15:20,470
little variation over time. And so even
if I have a lot of like if if the t

574
00:15:20,470 --> 00:15:20,480
if I have a lot of like if if the t
 

575
00:15:20,480 --> 00:15:22,470
if I have a lot of like if if the t
minus i is very large and I'm I'm

576
00:15:22,470 --> 00:15:22,480
minus i is very large and I'm I'm
 

577
00:15:22,480 --> 00:15:24,069
minus i is very large and I'm I'm
looking at the low frequency channel

578
00:15:24,069 --> 00:15:24,079
looking at the low frequency channel
 

579
00:15:24,079 --> 00:15:26,230
looking at the low frequency channel
corresponding to those those keys and

580
00:15:26,230 --> 00:15:26,240
corresponding to those those keys and
 

581
00:15:26,240 --> 00:15:29,269
corresponding to those those keys and
queries then I'm going to get a high

582
00:15:29,269 --> 00:15:29,279
queries then I'm going to get a high
 

583
00:15:29,279 --> 00:15:30,790
queries then I'm going to get a high
coherence. These are going to look very

584
00:15:30,790 --> 00:15:30,800
coherence. These are going to look very
 

585
00:15:30,800 --> 00:15:32,550
coherence. These are going to look very
similar to each that the inner product

586
00:15:32,550 --> 00:15:32,560
similar to each that the inner product
 

587
00:15:32,560 --> 00:15:35,350
similar to each that the inner product
is going to be high. Whereas if I'm

588
00:15:35,350 --> 00:15:35,360
is going to be high. Whereas if I'm
 

589
00:15:35,360 --> 00:15:38,629
is going to be high. Whereas if I'm
looking at a high frequency channel then

590
00:15:38,629 --> 00:15:38,639
looking at a high frequency channel then
 

591
00:15:38,639 --> 00:15:39,829
looking at a high frequency channel then
I'm going to have a lot of

592
00:15:39,829 --> 00:15:39,839
I'm going to have a lot of
 

593
00:15:39,839 --> 00:15:41,750
I'm going to have a lot of
non-coherence. A lot of these times

594
00:15:41,750 --> 00:15:41,760
non-coherence. A lot of these times
 

595
00:15:41,760 --> 00:15:43,189
non-coherence. A lot of these times
these inner products are going to end up

596
00:15:43,189 --> 00:15:43,199
these inner products are going to end up
 

597
00:15:43,199 --> 00:15:45,750
these inner products are going to end up
being zeros and things are going to be

598
00:15:45,750 --> 00:15:45,760
being zeros and things are going to be
 

599
00:15:45,760 --> 00:15:47,189
being zeros and things are going to be
out of phase and therefore I'm not going

600
00:15:47,189 --> 00:15:47,199
out of phase and therefore I'm not going
 

601
00:15:47,199 --> 00:15:48,870
out of phase and therefore I'm not going
not going to get high inner products or

602
00:15:48,870 --> 00:15:48,880
not going to get high inner products or
 

603
00:15:48,880 --> 00:15:52,470
not going to get high inner products or
high scores. Okay. So on a channel by

604
00:15:52,470 --> 00:15:52,480
high scores. Okay. So on a channel by
 

605
00:15:52,480 --> 00:15:56,230
high scores. Okay. So on a channel by
channel basis I can modulate when I care

606
00:15:56,230 --> 00:15:56,240
channel basis I can modulate when I care
 

607
00:15:56,240 --> 00:15:59,749
channel basis I can modulate when I care
about the long time range dependency and

608
00:15:59,749 --> 00:15:59,759
about the long time range dependency and
 

609
00:15:59,759 --> 00:16:01,749
about the long time range dependency and
when I care about only local information

610
00:16:01,749 --> 00:16:01,759
when I care about only local information
 

611
00:16:01,759 --> 00:16:04,389
when I care about only local information
or short uh short time scale

612
00:16:04,389 --> 00:16:04,399
or short uh short time scale
 

613
00:16:04,399 --> 00:16:07,030
or short uh short time scale
information. Okay, here I'm using time

614
00:16:07,030 --> 00:16:07,040
information. Okay, here I'm using time
 

615
00:16:07,040 --> 00:16:09,430
information. Okay, here I'm using time
and position interchangeably. Okay. When

616
00:16:09,430 --> 00:16:09,440
and position interchangeably. Okay. When
 

617
00:16:09,440 --> 00:16:12,069
and position interchangeably. Okay. When
I say time, I really mean position in

618
00:16:12,069 --> 00:16:12,079
I say time, I really mean position in
 

619
00:16:12,079 --> 00:16:13,670
I say time, I really mean position in
the sequence because these are

620
00:16:13,670 --> 00:16:13,680
the sequence because these are
 

621
00:16:13,680 --> 00:16:15,430
the sequence because these are
sequential tokens that are coming in one

622
00:16:15,430 --> 00:16:15,440
sequential tokens that are coming in one
 

623
00:16:15,440 --> 00:16:17,990
sequential tokens that are coming in one
after the other.

624
00:16:17,990 --> 00:16:18,000
after the other.
 

625
00:16:18,000 --> 00:16:23,749
after the other.
Okay.

626
00:16:23,749 --> 00:16:23,759

 

627
00:16:23,759 --> 00:16:26,069

So, questions here.

628
00:16:26,069 --> 00:16:26,079
So, questions here.
 

629
00:16:26,079 --> 00:16:27,030
So, questions here.
Yes.

630
00:16:27,030 --> 00:16:27,040
Yes.
 

631
00:16:27,040 --> 00:16:28,550
Yes.
>> Could you repeat that part of the

632
00:16:28,550 --> 00:16:28,560
>> Could you repeat that part of the
 

633
00:16:28,560 --> 00:16:29,590
>> Could you repeat that part of the
frequency?

634
00:16:29,590 --> 00:16:29,600
frequency?
 

635
00:16:29,600 --> 00:16:31,350
frequency?
>> Okay. I will repeat that part. Do you

636
00:16:31,350 --> 00:16:31,360
>> Okay. I will repeat that part. Do you
 

637
00:16:31,360 --> 00:16:32,470
>> Okay. I will repeat that part. Do you
have a different question?

638
00:16:32,470 --> 00:16:32,480
have a different question?
 

639
00:16:32,480 --> 00:16:34,550
have a different question?
>> Uh, yeah. I was wondering about whether

640
00:16:34,550 --> 00:16:34,560
>> Uh, yeah. I was wondering about whether
 

641
00:16:34,560 --> 00:16:37,030
>> Uh, yeah. I was wondering about whether
this is applied after the learned K and

642
00:16:37,030 --> 00:16:37,040
this is applied after the learned K and
 

643
00:16:37,040 --> 00:16:39,509
this is applied after the learned K and
Q. Is this separate or

644
00:16:39,509 --> 00:16:39,519
Q. Is this separate or
 

645
00:16:39,519 --> 00:16:42,389
Q. Is this separate or
>> this is applied every time while you're

646
00:16:42,389 --> 00:16:42,399
>> this is applied every time while you're
 

647
00:16:42,399 --> 00:16:45,110
>> this is applied every time while you're
learning K and Q. So like you it's not

648
00:16:45,110 --> 00:16:45,120
learning K and Q. So like you it's not
 

649
00:16:45,120 --> 00:16:46,949
learning K and Q. So like you it's not
like you learn K and Q and then you

650
00:16:46,949 --> 00:16:46,959
like you learn K and Q and then you
 

651
00:16:46,959 --> 00:16:49,030
like you learn K and Q and then you
apply this. This is

652
00:16:49,030 --> 00:16:49,040
apply this. This is
 

653
00:16:49,040 --> 00:16:51,110
apply this. This is
>> in the mix.

654
00:16:51,110 --> 00:16:51,120
>> in the mix.
 

655
00:16:51,120 --> 00:16:52,949
>> in the mix.
>> So

656
00:16:52,949 --> 00:16:52,959
>> So
 

657
00:16:52,959 --> 00:16:54,470
>> So
mediates the inner product, right?

658
00:16:54,470 --> 00:16:54,480
mediates the inner product, right?
 

659
00:16:54,480 --> 00:16:55,189
mediates the inner product, right?
>> I'm sorry.

660
00:16:55,189 --> 00:16:55,199
>> I'm sorry.
 

661
00:16:55,199 --> 00:16:56,470
>> I'm sorry.
>> Is that what this is saying? Like you're

662
00:16:56,470 --> 00:16:56,480
>> Is that what this is saying? Like you're
 

663
00:16:56,480 --> 00:16:58,389
>> Is that what this is saying? Like you're
using it to mediate your So instead of

664
00:16:58,389 --> 00:16:58,399
using it to mediate your So instead of
 

665
00:16:58,399 --> 00:17:00,150
using it to mediate your So instead of
using J, you're using this as your inner

666
00:17:00,150 --> 00:17:00,160
using J, you're using this as your inner
 

667
00:17:00,160 --> 00:17:00,470
using J, you're using this as your inner
product.

668
00:17:00,470 --> 00:17:00,480
product.
 

669
00:17:00,480 --> 00:17:02,470
product.
>> Yes. Exactly.

670
00:17:02,470 --> 00:17:02,480
>> Yes. Exactly.
 

671
00:17:02,480 --> 00:17:03,430
>> Yes. Exactly.
>> Exactly.

672
00:17:03,430 --> 00:17:03,440
>> Exactly.
 

673
00:17:03,440 --> 00:17:04,390
>> Exactly.
So it's still

674
00:17:04,390 --> 00:17:04,400
So it's still
 

675
00:17:04,400 --> 00:17:06,150
So it's still
>> so K and Q are still learned in the

676
00:17:06,150 --> 00:17:06,160
>> so K and Q are still learned in the
 

677
00:17:06,160 --> 00:17:09,829
>> so K and Q are still learned in the
exact same way as they always are.

678
00:17:09,829 --> 00:17:09,839
exact same way as they always are.
 

679
00:17:09,839 --> 00:17:12,789
exact same way as they always are.
>> Okay. So let's let's let's do this one

680
00:17:12,789 --> 00:17:12,799
>> Okay. So let's let's let's do this one
 

681
00:17:12,799 --> 00:17:16,470
>> Okay. So let's let's let's do this one
more time.

682
00:17:16,470 --> 00:17:16,480

 

683
00:17:16,480 --> 00:17:20,549

Um

684
00:17:20,549 --> 00:17:20,559

 

685
00:17:20,559 --> 00:17:22,150

okay is the two-dimensional picture

686
00:17:22,150 --> 00:17:22,160
okay is the two-dimensional picture
 

687
00:17:22,160 --> 00:17:24,150
okay is the two-dimensional picture
clear? Everyone any questions about the

688
00:17:24,150 --> 00:17:24,160
clear? Everyone any questions about the
 

689
00:17:24,160 --> 00:17:27,110
clear? Everyone any questions about the
two dimensional picture? Okay. So when

690
00:17:27,110 --> 00:17:27,120
two dimensional picture? Okay. So when
 

691
00:17:27,120 --> 00:17:31,350
two dimensional picture? Okay. So when
I'm thinking about this vector here,

692
00:17:31,350 --> 00:17:31,360
I'm thinking about this vector here,
 

693
00:17:31,360 --> 00:17:33,029
I'm thinking about this vector here,
okay,

694
00:17:33,029 --> 00:17:33,039
okay,
 

695
00:17:33,039 --> 00:17:36,390
okay,
I want to be able to say so, so why do I

696
00:17:36,390 --> 00:17:36,400
I want to be able to say so, so why do I
 

697
00:17:36,400 --> 00:17:38,230
I want to be able to say so, so why do I
care about doing these rotations? I want

698
00:17:38,230 --> 00:17:38,240
care about doing these rotations? I want
 

699
00:17:38,240 --> 00:17:41,029
care about doing these rotations? I want
to somehow be able to encode the

700
00:17:41,029 --> 00:17:41,039
to somehow be able to encode the
 

701
00:17:41,039 --> 00:17:43,590
to somehow be able to encode the
relative position. And I'm choosing to

702
00:17:43,590 --> 00:17:43,600
relative position. And I'm choosing to
 

703
00:17:43,600 --> 00:17:47,110
relative position. And I'm choosing to
use

704
00:17:47,110 --> 00:17:47,120

 

705
00:17:47,120 --> 00:17:50,549

these frequencies to encode this

706
00:17:50,549 --> 00:17:50,559
these frequencies to encode this
 

707
00:17:50,559 --> 00:17:53,669
these frequencies to encode this
positional information in some sense.

708
00:17:53,669 --> 00:17:53,679
positional information in some sense.
 

709
00:17:53,679 --> 00:17:56,710
positional information in some sense.
What do I mean by that? I'm saying that

710
00:17:56,710 --> 00:17:56,720
What do I mean by that? I'm saying that
 

711
00:17:56,720 --> 00:17:59,669
What do I mean by that? I'm saying that
if I choose for example

712
00:17:59,669 --> 00:17:59,679
if I choose for example
 

713
00:17:59,679 --> 00:18:03,510
if I choose for example
um

714
00:18:03,510 --> 00:18:03,520

 

715
00:18:03,520 --> 00:18:04,549

I don't want to say the same thing

716
00:18:04,549 --> 00:18:04,559
I don't want to say the same thing
 

717
00:18:04,559 --> 00:18:05,990
I don't want to say the same thing
again. So I'm trying to figure out a new

718
00:18:05,990 --> 00:18:06,000
again. So I'm trying to figure out a new
 

719
00:18:06,000 --> 00:18:10,070
again. So I'm trying to figure out a new
way of saying the uh the same same thing

720
00:18:10,070 --> 00:18:10,080
way of saying the uh the same same thing
 

721
00:18:10,080 --> 00:18:11,750
way of saying the uh the same same thing
but okay does everyone see that here

722
00:18:11,750 --> 00:18:11,760
but okay does everyone see that here
 

723
00:18:11,760 --> 00:18:13,990
but okay does everyone see that here
there's two things that this this ro how

724
00:18:13,990 --> 00:18:14,000
there's two things that this this ro how
 

725
00:18:14,000 --> 00:18:15,510
there's two things that this this ro how
much you rotate depends on two things.

726
00:18:15,510 --> 00:18:15,520
much you rotate depends on two things.
 

727
00:18:15,520 --> 00:18:17,830
much you rotate depends on two things.
One, it depends on t, which is your

728
00:18:17,830 --> 00:18:17,840
One, it depends on t, which is your
 

729
00:18:17,840 --> 00:18:21,190
One, it depends on t, which is your
position in the sequence.

730
00:18:21,190 --> 00:18:21,200
position in the sequence.
 

731
00:18:21,200 --> 00:18:24,390
position in the sequence.
And B, different channels get different

732
00:18:24,390 --> 00:18:24,400
And B, different channels get different
 

733
00:18:24,400 --> 00:18:25,909
And B, different channels get different
frequencies.

734
00:18:25,909 --> 00:18:25,919
frequencies.
 

735
00:18:25,919 --> 00:18:28,070
frequencies.
Okay,

736
00:18:28,070 --> 00:18:28,080
Okay,
 

737
00:18:28,080 --> 00:18:29,750
Okay,
that's one thing that's clear. Okay,

738
00:18:29,750 --> 00:18:29,760
that's one thing that's clear. Okay,
 

739
00:18:29,760 --> 00:18:32,150
that's one thing that's clear. Okay,
two, it's clear that to everyone that

740
00:18:32,150 --> 00:18:32,160
two, it's clear that to everyone that
 

741
00:18:32,160 --> 00:18:35,029
two, it's clear that to everyone that
low frequencies change less and high

742
00:18:35,029 --> 00:18:35,039
low frequencies change less and high
 

743
00:18:35,039 --> 00:18:39,909
low frequencies change less and high
frequencies will change more. Okay. So

744
00:18:39,909 --> 00:18:39,919
frequencies will change more. Okay. So
 

745
00:18:39,919 --> 00:18:41,750
frequencies will change more. Okay. So
therefore is it clear to everyone that

746
00:18:41,750 --> 00:18:41,760
therefore is it clear to everyone that
 

747
00:18:41,760 --> 00:18:45,830
therefore is it clear to everyone that
different channels will behave

748
00:18:45,830 --> 00:18:45,840
different channels will behave
 

749
00:18:45,840 --> 00:18:47,350
different channels will behave
differently.

750
00:18:47,350 --> 00:18:47,360
differently.
 

751
00:18:47,360 --> 00:18:51,110
differently.
So for example for if I have a very low

752
00:18:51,110 --> 00:18:51,120
So for example for if I have a very low
 

753
00:18:51,120 --> 00:18:54,630
So for example for if I have a very low
frequency here then as t changes cosine

754
00:18:54,630 --> 00:18:54,640
frequency here then as t changes cosine
 

755
00:18:54,640 --> 00:18:58,230
frequency here then as t changes cosine
t will change very little. Whereas if uh

756
00:18:58,230 --> 00:18:58,240
t will change very little. Whereas if uh
 

757
00:18:58,240 --> 00:19:00,549
t will change very little. Whereas if uh
I have a very uh high frequency here

758
00:19:00,549 --> 00:19:00,559
I have a very uh high frequency here
 

759
00:19:00,559 --> 00:19:03,430
I have a very uh high frequency here
then as t changes cosine t will change

760
00:19:03,430 --> 00:19:03,440
then as t changes cosine t will change
 

761
00:19:03,440 --> 00:19:05,270
then as t changes cosine t will change
rapidly. Therefore I will move I will

762
00:19:05,270 --> 00:19:05,280
rapidly. Therefore I will move I will
 

763
00:19:05,280 --> 00:19:08,310
rapidly. Therefore I will move I will
rotate my vector a lot.

764
00:19:08,310 --> 00:19:08,320
rotate my vector a lot.
 

765
00:19:08,320 --> 00:19:12,470
rotate my vector a lot.
Okay.

766
00:19:12,470 --> 00:19:12,480

 

767
00:19:12,480 --> 00:19:15,110

So if I have if I'm if I'm rotating my

768
00:19:15,110 --> 00:19:15,120
So if I have if I'm if I'm rotating my
 

769
00:19:15,120 --> 00:19:16,630
So if I have if I'm if I'm rotating my
vector a lot, let's say I have these

770
00:19:16,630 --> 00:19:16,640
vector a lot, let's say I have these
 

771
00:19:16,640 --> 00:19:18,950
vector a lot, let's say I have these
high frequency things, basically I'm

772
00:19:18,950 --> 00:19:18,960
high frequency things, basically I'm
 

773
00:19:18,960 --> 00:19:21,990
high frequency things, basically I'm
making big jumps. Therefore, I'm two

774
00:19:21,990 --> 00:19:22,000
making big jumps. Therefore, I'm two
 

775
00:19:22,000 --> 00:19:23,750
making big jumps. Therefore, I'm two
vectors that might be initially close to

776
00:19:23,750 --> 00:19:23,760
vectors that might be initially close to
 

777
00:19:23,760 --> 00:19:25,750
vectors that might be initially close to
each other. much I'm going to move them

778
00:19:25,750 --> 00:19:25,760
each other. much I'm going to move them
 

779
00:19:25,760 --> 00:19:27,990
each other. much I'm going to move them
into orthogonal positions relative to

780
00:19:27,990 --> 00:19:28,000
into orthogonal positions relative to
 

781
00:19:28,000 --> 00:19:29,669
into orthogonal positions relative to
each other much more quickly and much

782
00:19:29,669 --> 00:19:29,679
each other much more quickly and much
 

783
00:19:29,679 --> 00:19:34,150
each other much more quickly and much
more often than if I had a channel that

784
00:19:34,150 --> 00:19:34,160
more often than if I had a channel that
 

785
00:19:34,160 --> 00:19:36,390
more often than if I had a channel that
was associated with a low frequency

786
00:19:36,390 --> 00:19:36,400
was associated with a low frequency
 

787
00:19:36,400 --> 00:19:38,710
was associated with a low frequency
where you know like I'm it's been a lot

788
00:19:38,710 --> 00:19:38,720
where you know like I'm it's been a lot
 

789
00:19:38,720 --> 00:19:41,110
where you know like I'm it's been a lot
of time but I've only changed my inner

790
00:19:41,110 --> 00:19:41,120
of time but I've only changed my inner
 

791
00:19:41,120 --> 00:19:43,590
of time but I've only changed my inner
product by very small amounts because

792
00:19:43,590 --> 00:19:43,600
product by very small amounts because
 

793
00:19:43,600 --> 00:19:45,430
product by very small amounts because
the angle has changed between the

794
00:19:45,430 --> 00:19:45,440
the angle has changed between the
 

795
00:19:45,440 --> 00:19:47,270
the angle has changed between the
vectors has only changed by very small

796
00:19:47,270 --> 00:19:47,280
vectors has only changed by very small
 

797
00:19:47,280 --> 00:19:48,789
vectors has only changed by very small
amounts.

798
00:19:48,789 --> 00:19:48,799
amounts.
 

799
00:19:48,799 --> 00:19:51,669
amounts.
Okay. So therefore I can specialize and

800
00:19:51,669 --> 00:19:51,679
Okay. So therefore I can specialize and
 

801
00:19:51,679 --> 00:19:55,350
Okay. So therefore I can specialize and
I will have some groups of channels that

802
00:19:55,350 --> 00:19:55,360
I will have some groups of channels that
 

803
00:19:55,360 --> 00:20:01,750
I will have some groups of channels that
will be very sensitive to the T minus I

804
00:20:01,750 --> 00:20:01,760
will be very sensitive to the T minus I
 

805
00:20:01,760 --> 00:20:04,230
will be very sensitive to the T minus I
because of the uh high frequency

806
00:20:04,230 --> 00:20:04,240
because of the uh high frequency
 

807
00:20:04,240 --> 00:20:06,549
because of the uh high frequency
component and I will have other groups

808
00:20:06,549 --> 00:20:06,559
component and I will have other groups
 

809
00:20:06,559 --> 00:20:09,110
component and I will have other groups
of channels that will be much less

810
00:20:09,110 --> 00:20:09,120
of channels that will be much less
 

811
00:20:09,120 --> 00:20:10,710
of channels that will be much less
sensitive and even if you're quite far

812
00:20:10,710 --> 00:20:10,720
sensitive and even if you're quite far
 

813
00:20:10,720 --> 00:20:12,950
sensitive and even if you're quite far
away you it will be almost as though you

814
00:20:12,950 --> 00:20:12,960
away you it will be almost as though you
 

815
00:20:12,960 --> 00:20:15,590
away you it will be almost as though you
haven't changed.

816
00:20:15,590 --> 00:20:15,600
haven't changed.
 

817
00:20:15,600 --> 00:20:19,909
haven't changed.
Okay. Does that does that help in that

818
00:20:19,909 --> 00:20:19,919
Okay. Does that does that help in that
 

819
00:20:19,919 --> 00:20:22,310
Okay. Does that does that help in that
make things clearer? Yes.

820
00:20:22,310 --> 00:20:22,320
make things clearer? Yes.
 

821
00:20:22,320 --> 00:20:26,630
make things clearer? Yes.
>> So then the scale of the FJS is has to

822
00:20:26,630 --> 00:20:26,640
>> So then the scale of the FJS is has to
 

823
00:20:26,640 --> 00:20:28,070
>> So then the scale of the FJS is has to
cover like a long range of

824
00:20:28,070 --> 00:20:28,080
cover like a long range of
 

825
00:20:28,080 --> 00:20:29,590
cover like a long range of
>> Yes. So you're you're choosing a you're

826
00:20:29,590 --> 00:20:29,600
>> Yes. So you're you're choosing a you're
 

827
00:20:29,600 --> 00:20:31,669
>> Yes. So you're you're choosing a you're
choosing a many different frequencies

828
00:20:31,669 --> 00:20:31,679
choosing a many different frequencies
 

829
00:20:31,679 --> 00:20:33,350
choosing a many different frequencies
and you're pre-choosing them. You're not

830
00:20:33,350 --> 00:20:33,360
and you're pre-choosing them. You're not
 

831
00:20:33,360 --> 00:20:34,230
and you're pre-choosing them. You're not
learning them.

832
00:20:34,230 --> 00:20:34,240
learning them.
 

833
00:20:34,240 --> 00:20:36,549
learning them.
>> And in the literature it seems like they

834
00:20:36,549 --> 00:20:36,559
>> And in the literature it seems like they
 

835
00:20:36,559 --> 00:20:39,590
>> And in the literature it seems like they
use a log scale. Is there or like yeah

836
00:20:39,590 --> 00:20:39,600
use a log scale. Is there or like yeah
 

837
00:20:39,600 --> 00:20:41,110
use a log scale. Is there or like yeah
it's like they cover many orders of

838
00:20:41,110 --> 00:20:41,120
it's like they cover many orders of
 

839
00:20:41,120 --> 00:20:43,909
it's like they cover many orders of
magnitude. Is there a rationale behind

840
00:20:43,909 --> 00:20:43,919
magnitude. Is there a rationale behind
 

841
00:20:43,919 --> 00:20:45,990
magnitude. Is there a rationale behind
like what that scale you said it's

842
00:20:45,990 --> 00:20:46,000
like what that scale you said it's
 

843
00:20:46,000 --> 00:20:48,310
like what that scale you said it's
chosen a priori like how do they know

844
00:20:48,310 --> 00:20:48,320
chosen a priori like how do they know
 

845
00:20:48,320 --> 00:20:51,350
chosen a priori like how do they know
how much of a scale to use like between

846
00:20:51,350 --> 00:20:51,360
how much of a scale to use like between
 

847
00:20:51,360 --> 00:20:52,870
how much of a scale to use like between
how many orders of magnitude are you

848
00:20:52,870 --> 00:20:52,880
how many orders of magnitude are you
 

849
00:20:52,880 --> 00:20:54,230
how many orders of magnitude are you
choosing here and what is the rationale

850
00:20:54,230 --> 00:20:54,240
choosing here and what is the rationale
 

851
00:20:54,240 --> 00:20:55,110
choosing here and what is the rationale
for that

852
00:20:55,110 --> 00:20:55,120
for that
 

853
00:20:55,120 --> 00:20:56,789
for that
>> um I think this is one of those things

854
00:20:56,789 --> 00:20:56,799
>> um I think this is one of those things
 

855
00:20:56,799 --> 00:20:58,950
>> um I think this is one of those things
that's you you try things and you and

856
00:20:58,950 --> 00:20:58,960
that's you you try things and you and
 

857
00:20:58,960 --> 00:21:00,390
that's you you try things and you and
you figure out what what happens but

858
00:21:00,390 --> 00:21:00,400
you figure out what what happens but
 

859
00:21:00,400 --> 00:21:01,830
you figure out what what happens but
you're also you're you're trying to make

860
00:21:01,830 --> 00:21:01,840
you're also you're you're trying to make
 

861
00:21:01,840 --> 00:21:04,470
you're also you're you're trying to make
sure that you can capture

862
00:21:04,470 --> 00:21:04,480
sure that you can capture
 

863
00:21:04,480 --> 00:21:05,990
sure that you can capture
different

864
00:21:05,990 --> 00:21:06,000
different
 

865
00:21:06,000 --> 00:21:09,110
different
uh time scales of information

866
00:21:09,110 --> 00:21:09,120
uh time scales of information
 

867
00:21:09,120 --> 00:21:09,430
uh time scales of information
>> right

868
00:21:09,430 --> 00:21:09,440
>> right
 

869
00:21:09,440 --> 00:21:13,510
>> right
>> right so if you uh you basically and you

870
00:21:13,510 --> 00:21:13,520
>> right so if you uh you basically and you
 

871
00:21:13,520 --> 00:21:15,510
>> right so if you uh you basically and you
want to be able to so so if you chose

872
00:21:15,510 --> 00:21:15,520
want to be able to so so if you chose
 

873
00:21:15,520 --> 00:21:17,510
want to be able to so so if you chose
things on the linear scale you might not

874
00:21:17,510 --> 00:21:17,520
things on the linear scale you might not
 

875
00:21:17,520 --> 00:21:20,549
things on the linear scale you might not
be able to do that as easily.

876
00:21:20,549 --> 00:21:20,559
be able to do that as easily.
 

877
00:21:20,559 --> 00:21:21,750
be able to do that as easily.
>> Yes.

878
00:21:21,750 --> 00:21:21,760
>> Yes.
 

879
00:21:21,760 --> 00:21:24,149
>> Yes.
>> How do you know like whether you should

880
00:21:24,149 --> 00:21:24,159
>> How do you know like whether you should
 

881
00:21:24,159 --> 00:21:26,549
>> How do you know like whether you should
choose a high frequency for a specific

882
00:21:26,549 --> 00:21:26,559
choose a high frequency for a specific
 

883
00:21:26,559 --> 00:21:28,630
choose a high frequency for a specific
channel or do you kind of assume that

884
00:21:28,630 --> 00:21:28,640
channel or do you kind of assume that
 

885
00:21:28,640 --> 00:21:31,669
channel or do you kind of assume that
you just fix these FJs and then the

886
00:21:31,669 --> 00:21:31,679
you just fix these FJs and then the
 

887
00:21:31,679 --> 00:21:32,950
you just fix these FJs and then the
model will somehow learn?

888
00:21:32,950 --> 00:21:32,960
model will somehow learn?
 

889
00:21:32,960 --> 00:21:34,630
model will somehow learn?
>> Exactly. You fix these FJs and then the

890
00:21:34,630 --> 00:21:34,640
>> Exactly. You fix these FJs and then the
 

891
00:21:34,640 --> 00:21:36,070
>> Exactly. You fix these FJs and then the
model will learn because the model is

892
00:21:36,070 --> 00:21:36,080
model will learn because the model is
 

893
00:21:36,080 --> 00:21:38,390
model will learn because the model is
learning the queries and the keys and

894
00:21:38,390 --> 00:21:38,400
learning the queries and the keys and
 

895
00:21:38,400 --> 00:21:41,110
learning the queries and the keys and
the values. Right. So by fixing these

896
00:21:41,110 --> 00:21:41,120
the values. Right. So by fixing these
 

897
00:21:41,120 --> 00:21:42,470
the values. Right. So by fixing these
you're saying well these channels are

898
00:21:42,470 --> 00:21:42,480
you're saying well these channels are
 

899
00:21:42,480 --> 00:21:43,590
you're saying well these channels are
going to capture the low frequency

900
00:21:43,590 --> 00:21:43,600
going to capture the low frequency
 

901
00:21:43,600 --> 00:21:44,710
going to capture the low frequency
information these channels are going to

902
00:21:44,710 --> 00:21:44,720
information these channels are going to
 

903
00:21:44,720 --> 00:21:46,789
information these channels are going to
capture the high frequency information.

904
00:21:46,789 --> 00:21:46,799
capture the high frequency information.
 

905
00:21:46,799 --> 00:21:49,350
capture the high frequency information.
That part is being fixed by your choice

906
00:21:49,350 --> 00:21:49,360
That part is being fixed by your choice
 

907
00:21:49,360 --> 00:21:52,470
That part is being fixed by your choice
of FJ and then the model is learning

908
00:21:52,470 --> 00:21:52,480
of FJ and then the model is learning
 

909
00:21:52,480 --> 00:21:54,789
of FJ and then the model is learning
where to put what information.

910
00:21:54,789 --> 00:21:54,799
where to put what information.
 

911
00:21:54,799 --> 00:21:55,830
where to put what information.
>> Got it.

912
00:21:55,830 --> 00:21:55,840
>> Got it.
 

913
00:21:55,840 --> 00:21:56,870
>> Got it.
>> Yes.

914
00:21:56,870 --> 00:21:56,880
>> Yes.
 

915
00:21:56,880 --> 00:21:59,190
>> Yes.
>> Is there a specific like computational

916
00:21:59,190 --> 00:21:59,200
>> Is there a specific like computational
 

917
00:21:59,200 --> 00:22:01,190
>> Is there a specific like computational
benefit to breaking these up into real

918
00:22:01,190 --> 00:22:01,200
benefit to breaking these up into real
 

919
00:22:01,200 --> 00:22:02,950
benefit to breaking these up into real
and imaginary components instead of just

920
00:22:02,950 --> 00:22:02,960
and imaginary components instead of just
 

921
00:22:02,960 --> 00:22:04,470
and imaginary components instead of just
taking them as complex numbers and

922
00:22:04,470 --> 00:22:04,480
taking them as complex numbers and
 

923
00:22:04,480 --> 00:22:07,110
taking them as complex numbers and
applying a complex exponential to them?

924
00:22:07,110 --> 00:22:07,120
applying a complex exponential to them?
 

925
00:22:07,120 --> 00:22:10,070
applying a complex exponential to them?
Um the advantage is simply that then you

926
00:22:10,070 --> 00:22:10,080
Um the advantage is simply that then you
 

927
00:22:10,080 --> 00:22:12,950
Um the advantage is simply that then you
can just do all of the algebra with real

928
00:22:12,950 --> 00:22:12,960
can just do all of the algebra with real
 

929
00:22:12,960 --> 00:22:15,990
can just do all of the algebra with real
numbers because neural networks are not

930
00:22:15,990 --> 00:22:16,000
numbers because neural networks are not
 

931
00:22:16,000 --> 00:22:18,789
numbers because neural networks are not
that good at dealing with complex

932
00:22:18,789 --> 00:22:18,799
that good at dealing with complex
 

933
00:22:18,799 --> 00:22:19,990
that good at dealing with complex
numbers though I think that there is

934
00:22:19,990 --> 00:22:20,000
numbers though I think that there is
 

935
00:22:20,000 --> 00:22:21,909
numbers though I think that there is
some work in getting this to work with

936
00:22:21,909 --> 00:22:21,919
some work in getting this to work with
 

937
00:22:21,919 --> 00:22:24,950
some work in getting this to work with
complex numbers but I think it's just a

938
00:22:24,950 --> 00:22:24,960
complex numbers but I think it's just a
 

939
00:22:24,960 --> 00:22:26,950
complex numbers but I think it's just a
mechanistic like matrix multiplies are

940
00:22:26,950 --> 00:22:26,960
mechanistic like matrix multiplies are
 

941
00:22:26,960 --> 00:22:28,549
mechanistic like matrix multiplies are
easy so just do matrix multiplies kind

942
00:22:28,549 --> 00:22:28,559
easy so just do matrix multiplies kind
 

943
00:22:28,559 --> 00:22:28,789
easy so just do matrix multiplies kind
of

944
00:22:28,789 --> 00:22:28,799
of
 

945
00:22:28,799 --> 00:22:30,230
of
>> I know we talked about complex numbers

946
00:22:30,230 --> 00:22:30,240
>> I know we talked about complex numbers
 

947
00:22:30,240 --> 00:22:32,149
>> I know we talked about complex numbers
earlier yes that architecture involved

948
00:22:32,149 --> 00:22:32,159
earlier yes that architecture involved
 

949
00:22:32,159 --> 00:22:33,430
earlier yes that architecture involved
that dependency so I wasn't sure if

950
00:22:33,430 --> 00:22:33,440
that dependency so I wasn't sure if
 

951
00:22:33,440 --> 00:22:35,110
that dependency so I wasn't sure if
there was already

952
00:22:35,110 --> 00:22:35,120
there was already
 

953
00:22:35,120 --> 00:22:38,630
there was already
>> uh I know that there is work in terms of

954
00:22:38,630 --> 00:22:38,640
>> uh I know that there is work in terms of
 

955
00:22:38,640 --> 00:22:40,950
>> uh I know that there is work in terms of
getting complex numbers to work nicely

956
00:22:40,950 --> 00:22:40,960
getting complex numbers to work nicely
 

957
00:22:40,960 --> 00:22:42,549
getting complex numbers to work nicely
with neural networks but I don't know

958
00:22:42,549 --> 00:22:42,559
with neural networks but I don't know
 

959
00:22:42,559 --> 00:22:45,270
with neural networks but I don't know
that any of it is so sophisticated that

960
00:22:45,270 --> 00:22:45,280
that any of it is so sophisticated that
 

961
00:22:45,280 --> 00:22:48,390
that any of it is so sophisticated that
it has become part of the mainstream

962
00:22:48,390 --> 00:22:48,400
it has become part of the mainstream
 

963
00:22:48,400 --> 00:22:50,070
it has become part of the mainstream
uh yeah

964
00:22:50,070 --> 00:22:50,080
uh yeah
 

965
00:22:50,080 --> 00:22:52,390
uh yeah
>> just to confirm are you saying that FJ

966
00:22:52,390 --> 00:22:52,400
>> just to confirm are you saying that FJ
 

967
00:22:52,400 --> 00:22:53,750
>> just to confirm are you saying that FJ
is a hyperparameter

968
00:22:53,750 --> 00:22:53,760
is a hyperparameter
 

969
00:22:53,760 --> 00:22:56,470
is a hyperparameter
>> fj is not a hyperparameter

970
00:22:56,470 --> 00:22:56,480
>> fj is not a hyperparameter
 

971
00:22:56,480 --> 00:23:00,710
>> fj is not a hyperparameter
um it is

972
00:23:00,710 --> 00:23:00,720

 

973
00:23:00,720 --> 00:23:07,190

okay I see what you're asking Um,

974
00:23:07,190 --> 00:23:07,200

 

975
00:23:07,200 --> 00:23:10,070

one could think of FJ the this the

976
00:23:10,070 --> 00:23:10,080
one could think of FJ the this the
 

977
00:23:10,080 --> 00:23:12,149
one could think of FJ the this the
choice of FJS as a hyperparameter in the

978
00:23:12,149 --> 00:23:12,159
choice of FJS as a hyperparameter in the
 

979
00:23:12,159 --> 00:23:15,270
choice of FJS as a hyperparameter in the
sense that you can try out different FJs

980
00:23:15,270 --> 00:23:15,280
sense that you can try out different FJs
 

981
00:23:15,280 --> 00:23:17,750
sense that you can try out different FJs
and uh or different groups of FJS. Maybe

982
00:23:17,750 --> 00:23:17,760
and uh or different groups of FJS. Maybe
 

983
00:23:17,760 --> 00:23:19,990
and uh or different groups of FJS. Maybe
I wouldn't say FJ is a hyperparameter,

984
00:23:19,990 --> 00:23:20,000
I wouldn't say FJ is a hyperparameter,
 

985
00:23:20,000 --> 00:23:21,990
I wouldn't say FJ is a hyperparameter,
but the

986
00:23:21,990 --> 00:23:22,000
but the
 

987
00:23:22,000 --> 00:23:23,990
but the
set of FJS

988
00:23:23,990 --> 00:23:24,000
set of FJS
 

989
00:23:24,000 --> 00:23:26,149
set of FJS
is maybe a hyperparameter in the sense

990
00:23:26,149 --> 00:23:26,159
is maybe a hyperparameter in the sense
 

991
00:23:26,159 --> 00:23:27,510
is maybe a hyperparameter in the sense
that you're you're going to see which

992
00:23:27,510 --> 00:23:27,520
that you're you're going to see which
 

993
00:23:27,520 --> 00:23:30,789
that you're you're going to see which
ones work well for you.

994
00:23:30,789 --> 00:23:30,799
ones work well for you.
 

995
00:23:30,799 --> 00:23:32,230
ones work well for you.
And there are there are common

996
00:23:32,230 --> 00:23:32,240
And there are there are common
 

997
00:23:32,240 --> 00:23:34,630
And there are there are common
conventions of what works well and

998
00:23:34,630 --> 00:23:34,640
conventions of what works well and
 

999
00:23:34,640 --> 00:23:38,230
conventions of what works well and
that's what is ends up being used.

1000
00:23:38,230 --> 00:23:38,240
that's what is ends up being used.
 

1001
00:23:38,240 --> 00:23:40,950
that's what is ends up being used.
But you're just to be very clear it is

1002
00:23:40,950 --> 00:23:40,960
But you're just to be very clear it is
 

1003
00:23:40,960 --> 00:23:43,110
But you're just to be very clear it is
not learned when you are training the

1004
00:23:43,110 --> 00:23:43,120
not learned when you are training the
 

1005
00:23:43,120 --> 00:23:46,230
not learned when you are training the
model. It is chosen beforehand and so in

1006
00:23:46,230 --> 00:23:46,240
model. It is chosen beforehand and so in
 

1007
00:23:46,240 --> 00:23:49,029
model. It is chosen beforehand and so in
that sense it is like a hyperparameter.

1008
00:23:49,029 --> 00:23:49,039
that sense it is like a hyperparameter.
 

1009
00:23:49,039 --> 00:23:49,669
that sense it is like a hyperparameter.
>> Yes.

1010
00:23:49,669 --> 00:23:49,679
>> Yes.
 

1011
00:23:49,679 --> 00:23:52,390
>> Yes.
>> Um can you explain again why we're

1012
00:23:52,390 --> 00:23:52,400
>> Um can you explain again why we're
 

1013
00:23:52,400 --> 00:23:54,549
>> Um can you explain again why we're
splitting them into real and complex

1014
00:23:54,549 --> 00:23:54,559
splitting them into real and complex
 

1015
00:23:54,559 --> 00:23:56,549
splitting them into real and complex
part? We're splitting into real and

1016
00:23:56,549 --> 00:23:56,559
part? We're splitting into real and
 

1017
00:23:56,559 --> 00:23:57,750
part? We're splitting into real and
complex part because simply it's

1018
00:23:57,750 --> 00:23:57,760
complex part because simply it's
 

1019
00:23:57,760 --> 00:23:59,510
complex part because simply it's
conceptually easy to think about complex

1020
00:23:59,510 --> 00:23:59,520
conceptually easy to think about complex
 

1021
00:23:59,520 --> 00:24:01,350
conceptually easy to think about complex
numbers and we know how they behave when

1022
00:24:01,350 --> 00:24:01,360
numbers and we know how they behave when
 

1023
00:24:01,360 --> 00:24:03,110
numbers and we know how they behave when
they're hit with a complex exponential

1024
00:24:03,110 --> 00:24:03,120
they're hit with a complex exponential
 

1025
00:24:03,120 --> 00:24:04,470
they're hit with a complex exponential
or with a rotation matrix.

1026
00:24:04,470 --> 00:24:04,480
or with a rotation matrix.
 

1027
00:24:04,480 --> 00:24:06,870
or with a rotation matrix.
>> And how are we representing them using

1028
00:24:06,870 --> 00:24:06,880
>> And how are we representing them using
 

1029
00:24:06,880 --> 00:24:09,990
>> And how are we representing them using
the M matrix?

1030
00:24:09,990 --> 00:24:10,000
the M matrix?
 

1031
00:24:10,000 --> 00:24:11,750
the M matrix?
>> So the M matrix is just a rotation

1032
00:24:11,750 --> 00:24:11,760
>> So the M matrix is just a rotation
 

1033
00:24:11,760 --> 00:24:13,590
>> So the M matrix is just a rotation
matrix. One could alternatively talk

1034
00:24:13,590 --> 00:24:13,600
matrix. One could alternatively talk
 

1035
00:24:13,600 --> 00:24:15,750
matrix. One could alternatively talk
think about it as multiplying a complex

1036
00:24:15,750 --> 00:24:15,760
think about it as multiplying a complex
 

1037
00:24:15,760 --> 00:24:19,350
think about it as multiplying a complex
number by a complex exponential.

1038
00:24:19,350 --> 00:24:19,360
number by a complex exponential.
 

1039
00:24:19,360 --> 00:24:21,190
number by a complex exponential.
They're equivalent ways of thinking

1040
00:24:21,190 --> 00:24:21,200
They're equivalent ways of thinking
 

1041
00:24:21,200 --> 00:24:27,990
They're equivalent ways of thinking
about it. It makes no difference.

1042
00:24:27,990 --> 00:24:28,000

 

1043
00:24:28,000 --> 00:24:29,590

This is just the way that makes it easy

1044
00:24:29,590 --> 00:24:29,600
This is just the way that makes it easy
 

1045
00:24:29,600 --> 00:24:30,870
This is just the way that makes it easy
to implement everything with real

1046
00:24:30,870 --> 00:24:30,880
to implement everything with real
 

1047
00:24:30,880 --> 00:24:35,909
to implement everything with real
numbers.

1048
00:24:35,909 --> 00:24:35,919

 

1049
00:24:35,919 --> 00:24:37,669

Okay.

1050
00:24:37,669 --> 00:24:37,679
Okay.
 

1051
00:24:37,679 --> 00:24:39,350
Okay.
Any questions about this? This part is

1052
00:24:39,350 --> 00:24:39,360
Any questions about this? This part is
 

1053
00:24:39,360 --> 00:24:42,310
Any questions about this? This part is
clear.

1054
00:24:42,310 --> 00:24:42,320
clear.
 

1055
00:24:42,320 --> 00:24:45,590
clear.
Good. Okay. So, this is rope. Basically,

1056
00:24:45,590 --> 00:24:45,600
Good. Okay. So, this is rope. Basically,
 

1057
00:24:45,600 --> 00:24:47,830
Good. Okay. So, this is rope. Basically,
this is uh rotary position position

1058
00:24:47,830 --> 00:24:47,840
this is uh rotary position position
 

1059
00:24:47,840 --> 00:24:50,390
this is uh rotary position position
encoding. I guess I should write that

1060
00:24:50,390 --> 00:24:50,400
encoding. I guess I should write that
 

1061
00:24:50,400 --> 00:24:52,950
encoding. I guess I should write that
FJS

1062
00:24:52,950 --> 00:24:52,960
FJS
 

1063
00:24:52,960 --> 00:24:55,990
FJS
are fixed

1064
00:24:55,990 --> 00:24:56,000
are fixed
 

1065
00:24:56,000 --> 00:25:01,350
are fixed
not learned.

1066
00:25:01,350 --> 00:25:01,360

 

1067
00:25:01,360 --> 00:25:04,070

Um and

1068
00:25:04,070 --> 00:25:04,080
Um and
 

1069
00:25:04,080 --> 00:25:08,070
Um and
different

1070
00:25:08,070 --> 00:25:08,080

 

1071
00:25:08,080 --> 00:25:11,510

channels

1072
00:25:11,510 --> 00:25:11,520

 

1073
00:25:11,520 --> 00:25:13,110

will

1074
00:25:13,110 --> 00:25:13,120
will
 

1075
00:25:13,120 --> 00:25:15,750
will
have

1076
00:25:15,750 --> 00:25:15,760
have
 

1077
00:25:15,760 --> 00:25:29,432
have
Different

1078
00:25:29,432 --> 00:25:29,442

 

1079
00:25:29,442 --> 00:25:31,430

[snorts]

1080
00:25:31,430 --> 00:25:31,440
[snorts]
 

1081
00:25:31,440 --> 00:25:36,870
[snorts]
time scales can be captured

1082
00:25:36,870 --> 00:25:36,880

 

1083
00:25:36,880 --> 00:25:43,669

by

1084
00:25:43,669 --> 00:25:43,679

 

1085
00:25:43,679 --> 00:25:45,350

Okay,

1086
00:25:45,350 --> 00:25:45,360
Okay,
 

1087
00:25:45,360 --> 00:25:46,470
Okay,
so that's what I want to say about

1088
00:25:46,470 --> 00:25:46,480
so that's what I want to say about
 

1089
00:25:46,480 --> 00:25:49,430
so that's what I want to say about
position and coding.

1090
00:25:49,430 --> 00:25:49,440
position and coding.
 

1091
00:25:49,440 --> 00:25:51,590
position and coding.
Assuming no more questions, I want to

1092
00:25:51,590 --> 00:25:51,600
Assuming no more questions, I want to
 

1093
00:25:51,600 --> 00:25:53,029
Assuming no more questions, I want to
now come back to thinking about

1094
00:25:53,029 --> 00:25:53,039
now come back to thinking about
 

1095
00:25:53,039 --> 00:25:56,310
now come back to thinking about
architectures. Okay, and the first

1096
00:25:56,310 --> 00:25:56,320
architectures. Okay, and the first
 

1097
00:25:56,320 --> 00:25:58,230
architectures. Okay, and the first
architecture that I want to talk about

1098
00:25:58,230 --> 00:25:58,240
architecture that I want to talk about
 

1099
00:25:58,240 --> 00:26:02,789
architecture that I want to talk about
is the GPT3 architecture. GPT stands for

1100
00:26:02,789 --> 00:26:02,799
is the GPT3 architecture. GPT stands for
 

1101
00:26:02,799 --> 00:26:05,909
is the GPT3 architecture. GPT stands for
generative pre-trained transformer.

1102
00:26:05,909 --> 00:26:05,919
generative pre-trained transformer.
 

1103
00:26:05,919 --> 00:26:09,909
generative pre-trained transformer.
There was GPT1, GPT2, GPT3. Now we're on

1104
00:26:09,909 --> 00:26:09,919
There was GPT1, GPT2, GPT3. Now we're on
 

1105
00:26:09,919 --> 00:26:12,470
There was GPT1, GPT2, GPT3. Now we're on
there was GPT4. GPT5

1106
00:26:12,470 --> 00:26:12,480
there was GPT4. GPT5
 

1107
00:26:12,480 --> 00:26:14,870
there was GPT4. GPT5
is the I guess most recent version of

1108
00:26:14,870 --> 00:26:14,880
is the I guess most recent version of
 

1109
00:26:14,880 --> 00:26:18,390
is the I guess most recent version of
this. We're going to talk about GPT3.

1110
00:26:18,390 --> 00:26:18,400
this. We're going to talk about GPT3.
 

1111
00:26:18,400 --> 00:26:19,909
this. We're going to talk about GPT3.
Okay.

1112
00:26:19,909 --> 00:26:19,919
Okay.
 

1113
00:26:19,919 --> 00:26:23,510
Okay.
So the key heart of these GP of this GPT

1114
00:26:23,510 --> 00:26:23,520
So the key heart of these GP of this GPT
 

1115
00:26:23,520 --> 00:26:27,269
So the key heart of these GP of this GPT
style architecture is basically this

1116
00:26:27,269 --> 00:26:27,279
style architecture is basically this
 

1117
00:26:27,279 --> 00:26:30,789
style architecture is basically this
transformer block with masked attention.

1118
00:26:30,789 --> 00:26:30,799
transformer block with masked attention.
 

1119
00:26:30,799 --> 00:26:32,710
transformer block with masked attention.
And if you remember when we started

1120
00:26:32,710 --> 00:26:32,720
And if you remember when we started
 

1121
00:26:32,720 --> 00:26:37,830
And if you remember when we started
talking about uh attention and

1122
00:26:37,830 --> 00:26:37,840
talking about uh attention and
 

1123
00:26:37,840 --> 00:26:41,110
talking about uh attention and
uh this translation example that we kind

1124
00:26:41,110 --> 00:26:41,120
uh this translation example that we kind
 

1125
00:26:41,120 --> 00:26:45,430
uh this translation example that we kind
of started this whole uh module with. We

1126
00:26:45,430 --> 00:26:45,440
of started this whole uh module with. We
 

1127
00:26:45,440 --> 00:26:49,269
of started this whole uh module with. We
said we had an encoder and then we had a

1128
00:26:49,269 --> 00:26:49,279
said we had an encoder and then we had a
 

1129
00:26:49,279 --> 00:26:51,269
said we had an encoder and then we had a
decoder. Right? If you remember the

1130
00:26:51,269 --> 00:26:51,279
decoder. Right? If you remember the
 

1131
00:26:51,279 --> 00:26:53,350
decoder. Right? If you remember the
attention is all you need paper. They

1132
00:26:53,350 --> 00:26:53,360
attention is all you need paper. They
 

1133
00:26:53,360 --> 00:26:56,630
attention is all you need paper. They
had this encoder block where you did

1134
00:26:56,630 --> 00:26:56,640
had this encoder block where you did
 

1135
00:26:56,640 --> 00:26:59,430
had this encoder block where you did
only self attention and then they used

1136
00:26:59,430 --> 00:26:59,440
only self attention and then they used
 

1137
00:26:59,440 --> 00:27:02,470
only self attention and then they used
that And you had cross attention with a

1138
00:27:02,470 --> 00:27:02,480
that And you had cross attention with a
 

1139
00:27:02,480 --> 00:27:05,430
that And you had cross attention with a
decoder block, right? Where you kind of

1140
00:27:05,430 --> 00:27:05,440
decoder block, right? Where you kind of
 

1141
00:27:05,440 --> 00:27:07,909
decoder block, right? Where you kind of
you fed in your English sentence to the

1142
00:27:07,909 --> 00:27:07,919
you fed in your English sentence to the
 

1143
00:27:07,919 --> 00:27:11,029
you fed in your English sentence to the
encoder. Then you had a decoder learning

1144
00:27:11,029 --> 00:27:11,039
encoder. Then you had a decoder learning
 

1145
00:27:11,039 --> 00:27:12,870
encoder. Then you had a decoder learning
basically your target language. You did

1146
00:27:12,870 --> 00:27:12,880
basically your target language. You did
 

1147
00:27:12,880 --> 00:27:14,549
basically your target language. You did
cross attention between the encoder and

1148
00:27:14,549 --> 00:27:14,559
cross attention between the encoder and
 

1149
00:27:14,559 --> 00:27:16,549
cross attention between the encoder and
the decoder to get the decoder to be

1150
00:27:16,549 --> 00:27:16,559
the decoder to get the decoder to be
 

1151
00:27:16,559 --> 00:27:18,549
the decoder to get the decoder to be
able to predict a correct translation.

1152
00:27:18,549 --> 00:27:18,559
able to predict a correct translation.
 

1153
00:27:18,559 --> 00:27:20,870
able to predict a correct translation.
Okay? So the encoder was encoding your

1154
00:27:20,870 --> 00:27:20,880
Okay? So the encoder was encoding your
 

1155
00:27:20,880 --> 00:27:23,110
Okay? So the encoder was encoding your
inputs in some sense. The decoder was

1156
00:27:23,110 --> 00:27:23,120
inputs in some sense. The decoder was
 

1157
00:27:23,120 --> 00:27:25,990
inputs in some sense. The decoder was
somehow representing your outputs.

1158
00:27:25,990 --> 00:27:26,000
somehow representing your outputs.
 

1159
00:27:26,000 --> 00:27:29,430
somehow representing your outputs.
So the question was how do we take this

1160
00:27:29,430 --> 00:27:29,440
So the question was how do we take this
 

1161
00:27:29,440 --> 00:27:32,870
So the question was how do we take this
and make this into a

1162
00:27:32,870 --> 00:27:32,880
and make this into a
 

1163
00:27:32,880 --> 00:27:35,190
and make this into a
generative only model in some sense

1164
00:27:35,190 --> 00:27:35,200
generative only model in some sense
 

1165
00:27:35,200 --> 00:27:37,590
generative only model in some sense
right if all I want to do if I want to

1166
00:27:37,590 --> 00:27:37,600
right if all I want to do if I want to
 

1167
00:27:37,600 --> 00:27:40,470
right if all I want to do if I want to
have a model that can produce strings

1168
00:27:40,470 --> 00:27:40,480
have a model that can produce strings
 

1169
00:27:40,480 --> 00:27:44,390
have a model that can produce strings
and streams of text how do I do that and

1170
00:27:44,390 --> 00:27:44,400
and streams of text how do I do that and
 

1171
00:27:44,400 --> 00:27:46,630
and streams of text how do I do that and
the idea was well let's focus just on

1172
00:27:46,630 --> 00:27:46,640
the idea was well let's focus just on
 

1173
00:27:46,640 --> 00:27:49,990
the idea was well let's focus just on
the decoder so GPT3 is thought of as a

1174
00:27:49,990 --> 00:27:50,000
the decoder so GPT3 is thought of as a
 

1175
00:27:50,000 --> 00:27:53,990
the decoder so GPT3 is thought of as a
decoder only model okay and it's kind of

1176
00:27:53,990 --> 00:27:54,000
decoder only model okay and it's kind of
 

1177
00:27:54,000 --> 00:27:56,870
decoder only model okay and it's kind of
the or one of the first generative style

1178
00:27:56,870 --> 00:27:56,880
the or one of the first generative style
 

1179
00:27:56,880 --> 00:27:59,430
the or one of the first generative style
models that we're going to talk about.

1180
00:27:59,430 --> 00:27:59,440
models that we're going to talk about.
 

1181
00:27:59,440 --> 00:28:02,630
models that we're going to talk about.
So, GPT3 is again it is an auto

1182
00:28:02,630 --> 00:28:02,640
So, GPT3 is again it is an auto
 

1183
00:28:02,640 --> 00:28:04,310
So, GPT3 is again it is an auto
reggressive style model in the sense

1184
00:28:04,310 --> 00:28:04,320
reggressive style model in the sense
 

1185
00:28:04,320 --> 00:28:06,710
reggressive style model in the sense
that it is it generates a token and that

1186
00:28:06,710 --> 00:28:06,720
that it is it generates a token and that
 

1187
00:28:06,720 --> 00:28:09,430
that it is it generates a token and that
is fed back into it that then generates

1188
00:28:09,430 --> 00:28:09,440
is fed back into it that then generates
 

1189
00:28:09,440 --> 00:28:11,350
is fed back into it that then generates
the next token. So, we talked about this

1190
00:28:11,350 --> 00:28:11,360
the next token. So, we talked about this
 

1191
00:28:11,360 --> 00:28:13,590
the next token. So, we talked about this
uh a couple of lectures ago, right? So,

1192
00:28:13,590 --> 00:28:13,600
uh a couple of lectures ago, right? So,
 

1193
00:28:13,600 --> 00:28:16,070
uh a couple of lectures ago, right? So,
you you um uh how these kind of auto

1194
00:28:16,070 --> 00:28:16,080
you you um uh how these kind of auto
 

1195
00:28:16,080 --> 00:28:19,350
you you um uh how these kind of auto
reggressive models work. So, how does

1196
00:28:19,350 --> 00:28:19,360
reggressive models work. So, how does
 

1197
00:28:19,360 --> 00:28:21,430
reggressive models work. So, how does
this let's just walk through this

1198
00:28:21,430 --> 00:28:21,440
this let's just walk through this
 

1199
00:28:21,440 --> 00:28:24,149
this let's just walk through this
particular architecture, right? So I

1200
00:28:24,149 --> 00:28:24,159
particular architecture, right? So I
 

1201
00:28:24,159 --> 00:28:27,830
particular architecture, right? So I
have let's say some input sentence. It

1202
00:28:27,830 --> 00:28:27,840
have let's say some input sentence. It
 

1203
00:28:27,840 --> 00:28:30,710
have let's say some input sentence. It
always starts with a start token. That's

1204
00:28:30,710 --> 00:28:30,720
always starts with a start token. That's
 

1205
00:28:30,720 --> 00:28:33,269
always starts with a start token. That's
always the first thing. And so your

1206
00:28:33,269 --> 00:28:33,279
always the first thing. And so your
 

1207
00:28:33,279 --> 00:28:35,590
always the first thing. And so your
sentence is it takes great courage to

1208
00:28:35,590 --> 00:28:35,600
sentence is it takes great courage to
 

1209
00:28:35,600 --> 00:28:38,389
sentence is it takes great courage to
let So I take my start token. I compute

1210
00:28:38,389 --> 00:28:38,399
let So I take my start token. I compute
 

1211
00:28:38,399 --> 00:28:40,789
let So I take my start token. I compute
the embedding. I compute the embedding

1212
00:28:40,789 --> 00:28:40,799
the embedding. I compute the embedding
 

1213
00:28:40,799 --> 00:28:43,750
the embedding. I compute the embedding
basically of every single word.

1214
00:28:43,750 --> 00:28:43,760
basically of every single word.
 

1215
00:28:43,760 --> 00:28:45,510
basically of every single word.
Here we're just saying let's assume that

1216
00:28:45,510 --> 00:28:45,520
Here we're just saying let's assume that
 

1217
00:28:45,520 --> 00:28:47,110
Here we're just saying let's assume that
all of the tokens are words. But you

1218
00:28:47,110 --> 00:28:47,120
all of the tokens are words. But you
 

1219
00:28:47,120 --> 00:28:48,549
all of the tokens are words. But you
know that might that won't usually be

1220
00:28:48,549 --> 00:28:48,559
know that might that won't usually be
 

1221
00:28:48,559 --> 00:28:49,669
know that might that won't usually be
the case. But this is just for

1222
00:28:49,669 --> 00:28:49,679
the case. But this is just for
 

1223
00:28:49,679 --> 00:28:53,350
the case. But this is just for
simplicity. Then you have this attention

1224
00:28:53,350 --> 00:28:53,360
simplicity. Then you have this attention
 

1225
00:28:53,360 --> 00:28:54,870
simplicity. Then you have this attention
layer. That's what this orange layer is

1226
00:28:54,870 --> 00:28:54,880
layer. That's what this orange layer is
 

1227
00:28:54,880 --> 00:28:56,470
layer. That's what this orange layer is
showing.

1228
00:28:56,470 --> 00:28:56,480
showing.
 

1229
00:28:56,480 --> 00:28:58,630
showing.
And this is now masked attention. Right?

1230
00:28:58,630 --> 00:28:58,640
And this is now masked attention. Right?
 

1231
00:28:58,640 --> 00:29:00,230
And this is now masked attention. Right?
So it's important in this auto

1232
00:29:00,230 --> 00:29:00,240
So it's important in this auto
 

1233
00:29:00,240 --> 00:29:03,750
So it's important in this auto
reggressive style model that you are not

1234
00:29:03,750 --> 00:29:03,760
reggressive style model that you are not
 

1235
00:29:03,760 --> 00:29:05,990
reggressive style model that you are not
looking at the future. Otherwise, how

1236
00:29:05,990 --> 00:29:06,000
looking at the future. Otherwise, how
 

1237
00:29:06,000 --> 00:29:08,070
looking at the future. Otherwise, how
can you possibly learn to predict the

1238
00:29:08,070 --> 00:29:08,080
can you possibly learn to predict the
 

1239
00:29:08,080 --> 00:29:09,669
can you possibly learn to predict the
next token if you already have access to

1240
00:29:09,669 --> 00:29:09,679
next token if you already have access to
 

1241
00:29:09,679 --> 00:29:11,909
next token if you already have access to
it? You're just going to copy it. Right?

1242
00:29:11,909 --> 00:29:11,919
it? You're just going to copy it. Right?
 

1243
00:29:11,919 --> 00:29:14,950
it? You're just going to copy it. Right?
So that's why every token can only look

1244
00:29:14,950 --> 00:29:14,960
So that's why every token can only look
 

1245
00:29:14,960 --> 00:29:18,230
So that's why every token can only look
at the path itself and the past token.

1246
00:29:18,230 --> 00:29:18,240
at the path itself and the past token.
 

1247
00:29:18,240 --> 00:29:20,230
at the path itself and the past token.
So this token can only look at the token

1248
00:29:20,230 --> 00:29:20,240
So this token can only look at the token
 

1249
00:29:20,240 --> 00:29:21,830
So this token can only look at the token
here. This token only looks at the

1250
00:29:21,830 --> 00:29:21,840
here. This token only looks at the
 

1251
00:29:21,840 --> 00:29:23,990
here. This token only looks at the
previous two. This token only looks at

1252
00:29:23,990 --> 00:29:24,000
previous two. This token only looks at
 

1253
00:29:24,000 --> 00:29:26,149
previous two. This token only looks at
the previous three. So on and so forth.

1254
00:29:26,149 --> 00:29:26,159
the previous three. So on and so forth.
 

1255
00:29:26,159 --> 00:29:28,070
the previous three. So on and so forth.
That's what these uh this is this is

1256
00:29:28,070 --> 00:29:28,080
That's what these uh this is this is
 

1257
00:29:28,080 --> 00:29:31,590
That's what these uh this is this is
showing. Then after this

1258
00:29:31,590 --> 00:29:31,600
showing. Then after this
 

1259
00:29:31,600 --> 00:29:33,669
showing. Then after this
you have this uh you have a

1260
00:29:33,669 --> 00:29:33,679
you have this uh you have a
 

1261
00:29:33,679 --> 00:29:36,389
you have this uh you have a
normalization layer here.

1262
00:29:36,389 --> 00:29:36,399
normalization layer here.
 

1263
00:29:36,399 --> 00:29:38,549
normalization layer here.
And then you have basically a feed

1264
00:29:38,549 --> 00:29:38,559
And then you have basically a feed
 

1265
00:29:38,559 --> 00:29:41,269
And then you have basically a feed
forward MLP.

1266
00:29:41,269 --> 00:29:41,279
forward MLP.
 

1267
00:29:41,279 --> 00:29:43,990
forward MLP.
Then again you have a normalization.

1268
00:29:43,990 --> 00:29:44,000
Then again you have a normalization.
 

1269
00:29:44,000 --> 00:29:46,310
Then again you have a normalization.
This is a transformer block. You have K

1270
00:29:46,310 --> 00:29:46,320
This is a transformer block. You have K
 

1271
00:29:46,320 --> 00:29:49,750
This is a transformer block. You have K
of these blocks. Okay.

1272
00:29:49,750 --> 00:29:49,760
of these blocks. Okay.
 

1273
00:29:49,760 --> 00:29:52,549
of these blocks. Okay.
Here note that this normalization is

1274
00:29:52,549 --> 00:29:52,559
Here note that this normalization is
 

1275
00:29:52,559 --> 00:29:54,710
Here note that this normalization is
being shown after the residual

1276
00:29:54,710 --> 00:29:54,720
being shown after the residual
 

1277
00:29:54,720 --> 00:29:57,029
being shown after the residual
connection. Modern architectures which

1278
00:29:57,029 --> 00:29:57,039
connection. Modern architectures which
 

1279
00:29:57,039 --> 00:29:59,669
connection. Modern architectures which
we're going to talk about later in class

1280
00:29:59,669 --> 00:29:59,679
we're going to talk about later in class
 

1281
00:29:59,679 --> 00:30:01,830
we're going to talk about later in class
do not no longer use this. And now the

1282
00:30:01,830 --> 00:30:01,840
do not no longer use this. And now the
 

1283
00:30:01,840 --> 00:30:04,230
do not no longer use this. And now the
convention is to normalize first then go

1284
00:30:04,230 --> 00:30:04,240
convention is to normalize first then go
 

1285
00:30:04,240 --> 00:30:05,909
convention is to normalize first then go
through the attention layer or then go

1286
00:30:05,909 --> 00:30:05,919
through the attention layer or then go
 

1287
00:30:05,919 --> 00:30:07,669
through the attention layer or then go
through the feed forward layer. So you

1288
00:30:07,669 --> 00:30:07,679
through the feed forward layer. So you
 

1289
00:30:07,679 --> 00:30:09,830
through the feed forward layer. So you
have k of these blocks after which each

1290
00:30:09,830 --> 00:30:09,840
have k of these blocks after which each
 

1291
00:30:09,840 --> 00:30:11,830
have k of these blocks after which each
of them goes through a linear plus soft

1292
00:30:11,830 --> 00:30:11,840
of them goes through a linear plus soft
 

1293
00:30:11,840 --> 00:30:15,510
of them goes through a linear plus soft
max and then you get basically uh a

1294
00:30:15,510 --> 00:30:15,520
max and then you get basically uh a
 

1295
00:30:15,520 --> 00:30:18,389
max and then you get basically uh a
probability of the next token for

1296
00:30:18,389 --> 00:30:18,399
probability of the next token for
 

1297
00:30:18,399 --> 00:30:23,269
probability of the next token for
everything in your vocabulary. Okay

1298
00:30:23,269 --> 00:30:23,279
everything in your vocabulary. Okay
 

1299
00:30:23,279 --> 00:30:28,389
everything in your vocabulary. Okay
this is the kind of key um

1300
00:30:28,389 --> 00:30:28,399

 

1301
00:30:28,399 --> 00:30:30,230

key thing. So for training basically

1302
00:30:30,230 --> 00:30:30,240
key thing. So for training basically
 

1303
00:30:30,240 --> 00:30:33,110
key thing. So for training basically
what you want to do is that you want to

1304
00:30:33,110 --> 00:30:33,120
what you want to do is that you want to
 

1305
00:30:33,120 --> 00:30:35,909
what you want to do is that you want to
be able to maximize that here you want

1306
00:30:35,909 --> 00:30:35,919
be able to maximize that here you want
 

1307
00:30:35,919 --> 00:30:38,870
be able to maximize that here you want
to maximize the probability of the word

1308
00:30:38,870 --> 00:30:38,880
to maximize the probability of the word
 

1309
00:30:38,880 --> 00:30:40,950
to maximize the probability of the word
it because you know that that's what the

1310
00:30:40,950 --> 00:30:40,960
it because you know that that's what the
 

1311
00:30:40,960 --> 00:30:43,269
it because you know that that's what the
next word is here you want to maximize

1312
00:30:43,269 --> 00:30:43,279
next word is here you want to maximize
 

1313
00:30:43,279 --> 00:30:46,230
next word is here you want to maximize
the probability of the word takes here

1314
00:30:46,230 --> 00:30:46,240
the probability of the word takes here
 

1315
00:30:46,240 --> 00:30:47,590
the probability of the word takes here
you want to maximize the probability of

1316
00:30:47,590 --> 00:30:47,600
you want to maximize the probability of
 

1317
00:30:47,600 --> 00:30:49,350
you want to maximize the probability of
the word great so on and so forth so

1318
00:30:49,350 --> 00:30:49,360
the word great so on and so forth so
 

1319
00:30:49,360 --> 00:30:51,590
the word great so on and so forth so
it's basically your input shifted by one

1320
00:30:51,590 --> 00:30:51,600
it's basically your input shifted by one
 

1321
00:30:51,600 --> 00:30:53,590
it's basically your input shifted by one
and now you're using that to compute

1322
00:30:53,590 --> 00:30:53,600
and now you're using that to compute
 

1323
00:30:53,600 --> 00:30:57,269
and now you're using that to compute
your losses to then go back uh to pass

1324
00:30:57,269 --> 00:30:57,279
your losses to then go back uh to pass
 

1325
00:30:57,279 --> 00:31:03,269
your losses to then go back uh to pass
gradients through the whole

1326
00:31:03,269 --> 00:31:03,279

 

1327
00:31:03,279 --> 00:31:04,950

The other advantage that I wanted to

1328
00:31:04,950 --> 00:31:04,960
The other advantage that I wanted to
 

1329
00:31:04,960 --> 00:31:07,350
The other advantage that I wanted to
point out is that basically because of

1330
00:31:07,350 --> 00:31:07,360
point out is that basically because of
 

1331
00:31:07,360 --> 00:31:10,070
point out is that basically because of
the uh

1332
00:31:10,070 --> 00:31:10,080
the uh
 

1333
00:31:10,080 --> 00:31:12,230
the uh
the way this is set up and you're

1334
00:31:12,230 --> 00:31:12,240
the way this is set up and you're
 

1335
00:31:12,240 --> 00:31:14,950
the way this is set up and you're
training on next token prediction, every

1336
00:31:14,950 --> 00:31:14,960
training on next token prediction, every
 

1337
00:31:14,960 --> 00:31:17,750
training on next token prediction, every
single token that is going into your

1338
00:31:17,750 --> 00:31:17,760
single token that is going into your
 

1339
00:31:17,760 --> 00:31:20,070
single token that is going into your
transformer network is contributing a

1340
00:31:20,070 --> 00:31:20,080
transformer network is contributing a
 

1341
00:31:20,080 --> 00:31:22,549
transformer network is contributing a
term to the loss, right? Every

1342
00:31:22,549 --> 00:31:22,559
term to the loss, right? Every
 

1343
00:31:22,559 --> 00:31:24,310
term to the loss, right? Every
everything is doing a prediction and

1344
00:31:24,310 --> 00:31:24,320
everything is doing a prediction and
 

1345
00:31:24,320 --> 00:31:25,990
everything is doing a prediction and
everything is being used to compute a

1346
00:31:25,990 --> 00:31:26,000
everything is being used to compute a
 

1347
00:31:26,000 --> 00:31:28,630
everything is being used to compute a
loss. And so you're not wasting any

1348
00:31:28,630 --> 00:31:28,640
loss. And so you're not wasting any
 

1349
00:31:28,640 --> 00:31:30,630
loss. And so you're not wasting any
data. You're basically making use of

1350
00:31:30,630 --> 00:31:30,640
data. You're basically making use of
 

1351
00:31:30,640 --> 00:31:32,149
data. You're basically making use of
every single piece of information and

1352
00:31:32,149 --> 00:31:32,159
every single piece of information and
 

1353
00:31:32,159 --> 00:31:35,750
every single piece of information and
data that you actually have.

1354
00:31:35,750 --> 00:31:35,760
data that you actually have.
 

1355
00:31:35,760 --> 00:31:37,590
data that you actually have.
So there's no encoder here. There's no

1356
00:31:37,590 --> 00:31:37,600
So there's no encoder here. There's no
 

1357
00:31:37,600 --> 00:31:40,630
So there's no encoder here. There's no
kind of English to French or Chinese or

1358
00:31:40,630 --> 00:31:40,640
kind of English to French or Chinese or
 

1359
00:31:40,640 --> 00:31:43,269
kind of English to French or Chinese or
whatever. This is just you're training

1360
00:31:43,269 --> 00:31:43,279
whatever. This is just you're training
 

1361
00:31:43,279 --> 00:31:47,590
whatever. This is just you're training
in a self-supervised way to uh get uh

1362
00:31:47,590 --> 00:31:47,600
in a self-supervised way to uh get uh
 

1363
00:31:47,600 --> 00:31:50,870
in a self-supervised way to uh get uh
the next token that you want. This is

1364
00:31:50,870 --> 00:31:50,880
the next token that you want. This is
 

1365
00:31:50,880 --> 00:31:53,990
the next token that you want. This is
the basics of the GPT architecture.

1366
00:31:53,990 --> 00:31:54,000
the basics of the GPT architecture.
 

1367
00:31:54,000 --> 00:31:56,950
the basics of the GPT architecture.
questions about this.

1368
00:31:56,950 --> 00:31:56,960
questions about this.
 

1369
00:31:56,960 --> 00:31:57,669
questions about this.
>> Yes.

1370
00:31:57,669 --> 00:31:57,679
>> Yes.
 

1371
00:31:57,679 --> 00:32:00,630
>> Yes.
>> So you just shifting by one to get your

1372
00:32:00,630 --> 00:32:00,640
>> So you just shifting by one to get your
 

1373
00:32:00,640 --> 00:32:04,710
>> So you just shifting by one to get your
supposed uh values or sort of like the

1374
00:32:04,710 --> 00:32:04,720
supposed uh values or sort of like the
 

1375
00:32:04,720 --> 00:32:05,750
supposed uh values or sort of like the
>> Mhm.

1376
00:32:05,750 --> 00:32:05,760
>> Mhm.
 

1377
00:32:05,760 --> 00:32:09,110
>> Mhm.
>> Yeah. So basically after start you

1378
00:32:09,110 --> 00:32:09,120
>> Yeah. So basically after start you
 

1379
00:32:09,120 --> 00:32:13,269
>> Yeah. So basically after start you
expect to see it after it you you you

1380
00:32:13,269 --> 00:32:13,279
expect to see it after it you you you
 

1381
00:32:13,279 --> 00:32:15,990
expect to see it after it you you you
compute the loss on take so on and so

1382
00:32:15,990 --> 00:32:16,000
compute the loss on take so on and so
 

1383
00:32:16,000 --> 00:32:17,590
compute the loss on take so on and so
forth and you're just doing a cross

1384
00:32:17,590 --> 00:32:17,600
forth and you're just doing a cross
 

1385
00:32:17,600 --> 00:32:20,470
forth and you're just doing a cross
entropy loss on these.

1386
00:32:20,470 --> 00:32:20,480
entropy loss on these.
 

1387
00:32:20,480 --> 00:32:21,190
entropy loss on these.
>> Yes.

1388
00:32:21,190 --> 00:32:21,200
>> Yes.
 

1389
00:32:21,200 --> 00:32:24,070
>> Yes.
>> How do you know which K

1390
00:32:24,070 --> 00:32:24,080
>> How do you know which K
 

1391
00:32:24,080 --> 00:32:26,470
>> How do you know which K
How do you know which K to use? So that

1392
00:32:26,470 --> 00:32:26,480
How do you know which K to use? So that
 

1393
00:32:26,480 --> 00:32:29,190
How do you know which K to use? So that
is again like a hyperparameter and as we

1394
00:32:29,190 --> 00:32:29,200
is again like a hyperparameter and as we
 

1395
00:32:29,200 --> 00:32:32,070
is again like a hyperparameter and as we
will see there are so many different

1396
00:32:32,070 --> 00:32:32,080
will see there are so many different
 

1397
00:32:32,080 --> 00:32:36,230
will see there are so many different
ways to choose. Um what did GPT

1398
00:32:36,230 --> 00:32:36,240
ways to choose. Um what did GPT
 

1399
00:32:36,240 --> 00:32:42,070
ways to choose. Um what did GPT
um use? GPT used. Let me see.

1400
00:32:42,070 --> 00:32:42,080
um use? GPT used. Let me see.
 

1401
00:32:42,080 --> 00:32:44,549
um use? GPT used. Let me see.
I thought I wrote this down. They had 96

1402
00:32:44,549 --> 00:32:44,559
I thought I wrote this down. They had 96
 

1403
00:32:44,559 --> 00:32:48,470
I thought I wrote this down. They had 96
layers. GPD3 in particular. Uh GP3 I

1404
00:32:48,470 --> 00:32:48,480
layers. GPD3 in particular. Uh GP3 I
 

1405
00:32:48,480 --> 00:32:49,909
layers. GPD3 in particular. Uh GP3 I
think this. So these are all parameters

1406
00:32:49,909 --> 00:32:49,919
think this. So these are all parameters
 

1407
00:32:49,919 --> 00:32:53,269
think this. So these are all parameters
for the GPT3 huge I think it was called

1408
00:32:53,269 --> 00:32:53,279
for the GPT3 huge I think it was called
 

1409
00:32:53,279 --> 00:32:58,549
for the GPT3 huge I think it was called
it was their largest one. Uh yes

1410
00:32:58,549 --> 00:32:58,559
it was their largest one. Uh yes
 

1411
00:32:58,559 --> 00:33:00,630
it was their largest one. Uh yes
>> um yes I had a question about the

1412
00:33:00,630 --> 00:33:00,640
>> um yes I had a question about the
 

1413
00:33:00,640 --> 00:33:03,750
>> um yes I had a question about the
architecture. So the block is every

1414
00:33:03,750 --> 00:33:03,760
architecture. So the block is every
 

1415
00:33:03,760 --> 00:33:05,990
architecture. So the block is every
block is mass attention. There's no

1416
00:33:05,990 --> 00:33:06,000
block is mass attention. There's no
 

1417
00:33:06,000 --> 00:33:07,669
block is mass attention. There's no
there's no unmasked attention. there is

1418
00:33:07,669 --> 00:33:07,679
there's no unmasked attention. there is
 

1419
00:33:07,679 --> 00:33:09,350
there's no unmasked attention. there is
no unmasked attention ever because if

1420
00:33:09,350 --> 00:33:09,360
no unmasked attention ever because if
 

1421
00:33:09,360 --> 00:33:11,029
no unmasked attention ever because if
you allowed it to have a block of

1422
00:33:11,029 --> 00:33:11,039
you allowed it to have a block of
 

1423
00:33:11,039 --> 00:33:13,669
you allowed it to have a block of
unmasked attention that particular block

1424
00:33:13,669 --> 00:33:13,679
unmasked attention that particular block
 

1425
00:33:13,679 --> 00:33:17,190
unmasked attention that particular block
would just you know uh see the next

1426
00:33:17,190 --> 00:33:17,200
would just you know uh see the next
 

1427
00:33:17,200 --> 00:33:18,710
would just you know uh see the next
token and then either it would become

1428
00:33:18,710 --> 00:33:18,720
token and then either it would become
 

1429
00:33:18,720 --> 00:33:21,350
token and then either it would become
useless or it would learn to cheat.

1430
00:33:21,350 --> 00:33:21,360
useless or it would learn to cheat.
 

1431
00:33:21,360 --> 00:33:24,549
useless or it would learn to cheat.
So it is required to have mass attention

1432
00:33:24,549 --> 00:33:24,559
So it is required to have mass attention
 

1433
00:33:24,559 --> 00:33:30,950
So it is required to have mass attention
for these decoder only models.

1434
00:33:30,950 --> 00:33:30,960

 

1435
00:33:30,960 --> 00:33:34,230

Okay.

1436
00:33:34,230 --> 00:33:34,240

 

1437
00:33:34,240 --> 00:33:36,389

So basically for all these decoder only

1438
00:33:36,389 --> 00:33:36,399
So basically for all these decoder only
 

1439
00:33:36,399 --> 00:33:38,230
So basically for all these decoder only
models, our focus is to generate always

1440
00:33:38,230 --> 00:33:38,240
models, our focus is to generate always
 

1441
00:33:38,240 --> 00:33:40,230
models, our focus is to generate always
the next token in a sequence. We're

1442
00:33:40,230 --> 00:33:40,240
the next token in a sequence. We're
 

1443
00:33:40,240 --> 00:33:41,990
the next token in a sequence. We're
always going to use this master causal

1444
00:33:41,990 --> 00:33:42,000
always going to use this master causal
 

1445
00:33:42,000 --> 00:33:44,710
always going to use this master causal
self- attention uh self self attention

1446
00:33:44,710 --> 00:33:44,720
self- attention uh self self attention
 

1447
00:33:44,720 --> 00:33:47,029
self- attention uh self self attention
training. So you're only looking at

1448
00:33:47,029 --> 00:33:47,039
training. So you're only looking at
 

1449
00:33:47,039 --> 00:33:50,310
training. So you're only looking at
basically yourself and the past.

1450
00:33:50,310 --> 00:33:50,320
basically yourself and the past.
 

1451
00:33:50,320 --> 00:33:51,990
basically yourself and the past.
I already talked about the cross entropy

1452
00:33:51,990 --> 00:33:52,000
I already talked about the cross entropy
 

1453
00:33:52,000 --> 00:33:56,070
I already talked about the cross entropy
loss. Um

1454
00:33:56,070 --> 00:33:56,080
loss. Um
 

1455
00:33:56,080 --> 00:33:57,830
loss. Um
and then so how does inference work?

1456
00:33:57,830 --> 00:33:57,840
and then so how does inference work?
 

1457
00:33:57,840 --> 00:33:59,669
and then so how does inference work?
Basically at inference time you're going

1458
00:33:59,669 --> 00:33:59,679
Basically at inference time you're going
 

1459
00:33:59,679 --> 00:34:01,190
Basically at inference time you're going
to sample a token from your output

1460
00:34:01,190 --> 00:34:01,200
to sample a token from your output
 

1461
00:34:01,200 --> 00:34:03,350
to sample a token from your output
probabilities, right? Then you're going

1462
00:34:03,350 --> 00:34:03,360
probabilities, right? Then you're going
 

1463
00:34:03,360 --> 00:34:05,029
probabilities, right? Then you're going
to take that sample token, you're going

1464
00:34:05,029 --> 00:34:05,039
to take that sample token, you're going
 

1465
00:34:05,039 --> 00:34:07,350
to take that sample token, you're going
to stick it back into your input and

1466
00:34:07,350 --> 00:34:07,360
to stick it back into your input and
 

1467
00:34:07,360 --> 00:34:09,990
to stick it back into your input and
then use that to predict the next token.

1468
00:34:09,990 --> 00:34:10,000
then use that to predict the next token.
 

1469
00:34:10,000 --> 00:34:12,310
then use that to predict the next token.
And you're just going to keep going uh

1470
00:34:12,310 --> 00:34:12,320
And you're just going to keep going uh
 

1471
00:34:12,320 --> 00:34:15,030
And you're just going to keep going uh
on and on. One of the advantages of this

1472
00:34:15,030 --> 00:34:15,040
on and on. One of the advantages of this
 

1473
00:34:15,040 --> 00:34:17,829
on and on. One of the advantages of this
is that at inference time, let's say

1474
00:34:17,829 --> 00:34:17,839
is that at inference time, let's say
 

1475
00:34:17,839 --> 00:34:19,510
is that at inference time, let's say
I've already computed the keys and

1476
00:34:19,510 --> 00:34:19,520
I've already computed the keys and
 

1477
00:34:19,520 --> 00:34:22,710
I've already computed the keys and
values for a bunch of tokens. I can just

1478
00:34:22,710 --> 00:34:22,720
values for a bunch of tokens. I can just
 

1479
00:34:22,720 --> 00:34:24,790
values for a bunch of tokens. I can just
cache these, store these, and then when

1480
00:34:24,790 --> 00:34:24,800
cache these, store these, and then when
 

1481
00:34:24,800 --> 00:34:26,149
cache these, store these, and then when
I'm doing my auto reggressive

1482
00:34:26,149 --> 00:34:26,159
I'm doing my auto reggressive
 

1483
00:34:26,159 --> 00:34:27,750
I'm doing my auto reggressive
generation, I can use them again. I

1484
00:34:27,750 --> 00:34:27,760
generation, I can use them again. I
 

1485
00:34:27,760 --> 00:34:30,230
generation, I can use them again. I
don't have to compute them again. So

1486
00:34:30,230 --> 00:34:30,240
don't have to compute them again. So
 

1487
00:34:30,240 --> 00:34:31,750
don't have to compute them again. So
there's a lot of tricks around

1488
00:34:31,750 --> 00:34:31,760
there's a lot of tricks around
 

1489
00:34:31,760 --> 00:34:34,149
there's a lot of tricks around
efficiently caching these key value

1490
00:34:34,149 --> 00:34:34,159
efficiently caching these key value
 

1491
00:34:34,159 --> 00:34:38,230
efficiently caching these key value
pairs to make uh inference time

1492
00:34:38,230 --> 00:34:38,240
pairs to make uh inference time
 

1493
00:34:38,240 --> 00:34:40,389
pairs to make uh inference time
efficient in terms of compute when

1494
00:34:40,389 --> 00:34:40,399
efficient in terms of compute when
 

1495
00:34:40,399 --> 00:34:41,829
efficient in terms of compute when
transformers are being used. That's one

1496
00:34:41,829 --> 00:34:41,839
transformers are being used. That's one
 

1497
00:34:41,839 --> 00:34:43,510
transformers are being used. That's one
of the big advantages of transformers.

1498
00:34:43,510 --> 00:34:43,520
of the big advantages of transformers.
 

1499
00:34:43,520 --> 00:34:45,109
of the big advantages of transformers.
Okay.

1500
00:34:45,109 --> 00:34:45,119
Okay.
 

1501
00:34:45,119 --> 00:34:48,149
Okay.
So this is important

1502
00:34:48,149 --> 00:34:48,159
So this is important
 

1503
00:34:48,159 --> 00:35:01,109
So this is important
from a computational perspective.

1504
00:35:01,109 --> 00:35:01,119

 

1505
00:35:01,119 --> 00:35:03,190

And then in terms of sampling, how do

1506
00:35:03,190 --> 00:35:03,200
And then in terms of sampling, how do
 

1507
00:35:03,200 --> 00:35:05,750
And then in terms of sampling, how do
you you know at the end all I get out is

1508
00:35:05,750 --> 00:35:05,760
you you know at the end all I get out is
 

1509
00:35:05,760 --> 00:35:07,750
you you know at the end all I get out is
a is a is a vector of probabilities,

1510
00:35:07,750 --> 00:35:07,760
a is a is a vector of probabilities,
 

1511
00:35:07,760 --> 00:35:09,990
a is a is a vector of probabilities,
right? I need to somehow use that vector

1512
00:35:09,990 --> 00:35:10,000
right? I need to somehow use that vector
 

1513
00:35:10,000 --> 00:35:12,550
right? I need to somehow use that vector
of probabilities to generate an actual

1514
00:35:12,550 --> 00:35:12,560
of probabilities to generate an actual
 

1515
00:35:12,560 --> 00:35:15,270
of probabilities to generate an actual
token that I'm going to feed back in. So

1516
00:35:15,270 --> 00:35:15,280
token that I'm going to feed back in. So
 

1517
00:35:15,280 --> 00:35:17,270
token that I'm going to feed back in. So
there are I think a couple of different

1518
00:35:17,270 --> 00:35:17,280
there are I think a couple of different
 

1519
00:35:17,280 --> 00:35:20,470
there are I think a couple of different
strategies that you can use. One is

1520
00:35:20,470 --> 00:35:20,480
strategies that you can use. One is
 

1521
00:35:20,480 --> 00:35:23,349
strategies that you can use. One is
simply looking at the uh you know

1522
00:35:23,349 --> 00:35:23,359
simply looking at the uh you know
 

1523
00:35:23,359 --> 00:35:25,030
simply looking at the uh you know
sampling only from the top k

1524
00:35:25,030 --> 00:35:25,040
sampling only from the top k
 

1525
00:35:25,040 --> 00:35:27,349
sampling only from the top k
probabilities. And the advantage of

1526
00:35:27,349 --> 00:35:27,359
probabilities. And the advantage of
 

1527
00:35:27,359 --> 00:35:28,550
probabilities. And the advantage of
doing this is that, you know, there

1528
00:35:28,550 --> 00:35:28,560
doing this is that, you know, there
 

1529
00:35:28,560 --> 00:35:30,710
doing this is that, you know, there
might be some really obscure words out

1530
00:35:30,710 --> 00:35:30,720
might be some really obscure words out
 

1531
00:35:30,720 --> 00:35:33,430
might be some really obscure words out
there that yes, technically have some

1532
00:35:33,430 --> 00:35:33,440
there that yes, technically have some
 

1533
00:35:33,440 --> 00:35:34,950
there that yes, technically have some
probability of being generated, but

1534
00:35:34,950 --> 00:35:34,960
probability of being generated, but
 

1535
00:35:34,960 --> 00:35:36,950
probability of being generated, but
they're very unlikely. And if you

1536
00:35:36,950 --> 00:35:36,960
they're very unlikely. And if you
 

1537
00:35:36,960 --> 00:35:38,790
they're very unlikely. And if you
generate that, then it's kind of really

1538
00:35:38,790 --> 00:35:38,800
generate that, then it's kind of really
 

1539
00:35:38,800 --> 00:35:41,349
generate that, then it's kind of really
hard to generate the next

1540
00:35:41,349 --> 00:35:41,359
hard to generate the next
 

1541
00:35:41,359 --> 00:35:44,950
hard to generate the next
token. Um, or you might have so you

1542
00:35:44,950 --> 00:35:44,960
token. Um, or you might have so you
 

1543
00:35:44,960 --> 00:35:46,470
token. Um, or you might have so you
restrict yourself say I'm going to only

1544
00:35:46,470 --> 00:35:46,480
restrict yourself say I'm going to only
 

1545
00:35:46,480 --> 00:35:51,109
restrict yourself say I'm going to only
sample from the top whatever K uh

1546
00:35:51,109 --> 00:35:51,119
sample from the top whatever K uh
 

1547
00:35:51,119 --> 00:35:53,349
sample from the top whatever K uh
probabilities in my uh in my probability

1548
00:35:53,349 --> 00:35:53,359
probabilities in my uh in my probability
 

1549
00:35:53,359 --> 00:35:54,790
probabilities in my uh in my probability
vector. not going to sample actually

1550
00:35:54,790 --> 00:35:54,800
vector. not going to sample actually
 

1551
00:35:54,800 --> 00:35:56,230
vector. not going to sample actually
from the entire distribution on my

1552
00:35:56,230 --> 00:35:56,240
from the entire distribution on my
 

1553
00:35:56,240 --> 00:35:58,310
from the entire distribution on my
vocabulary because your vocabulary can

1554
00:35:58,310 --> 00:35:58,320
vocabulary because your vocabulary can
 

1555
00:35:58,320 --> 00:36:00,630
vocabulary because your vocabulary can
be huge 50,000 something uh pretty

1556
00:36:00,630 --> 00:36:00,640
be huge 50,000 something uh pretty
 

1557
00:36:00,640 --> 00:36:02,150
be huge 50,000 something uh pretty
large.

1558
00:36:02,150 --> 00:36:02,160
large.
 

1559
00:36:02,160 --> 00:36:05,030
large.
The other uh key idea that is used is

1560
00:36:05,030 --> 00:36:05,040
The other uh key idea that is used is
 

1561
00:36:05,040 --> 00:36:07,109
The other uh key idea that is used is
called beam search and variations

1562
00:36:07,109 --> 00:36:07,119
called beam search and variations
 

1563
00:36:07,119 --> 00:36:09,829
called beam search and variations
thereof. So beam search is basically a

1564
00:36:09,829 --> 00:36:09,839
thereof. So beam search is basically a
 

1565
00:36:09,839 --> 00:36:13,270
thereof. So beam search is basically a
variation of best first search. So what

1566
00:36:13,270 --> 00:36:13,280
variation of best first search. So what
 

1567
00:36:13,280 --> 00:36:15,109
variation of best first search. So what
you do is you basically say that look

1568
00:36:15,109 --> 00:36:15,119
you do is you basically say that look
 

1569
00:36:15,119 --> 00:36:17,430
you do is you basically say that look
I'm trying to complete sentences right

1570
00:36:17,430 --> 00:36:17,440
I'm trying to complete sentences right
 

1571
00:36:17,440 --> 00:36:20,390
I'm trying to complete sentences right
and so you know so if I have this

1572
00:36:20,390 --> 00:36:20,400
and so you know so if I have this
 

1573
00:36:20,400 --> 00:36:22,950
and so you know so if I have this
sentence for example it takes great

1574
00:36:22,950 --> 00:36:22,960
sentence for example it takes great
 

1575
00:36:22,960 --> 00:36:25,750
sentence for example it takes great
courage after it there's some

1576
00:36:25,750 --> 00:36:25,760
courage after it there's some
 

1577
00:36:25,760 --> 00:36:27,190
courage after it there's some
probability the next word is takes

1578
00:36:27,190 --> 00:36:27,200
probability the next word is takes
 

1579
00:36:27,200 --> 00:36:28,630
probability the next word is takes
there's some probability that the next

1580
00:36:28,630 --> 00:36:28,640
there's some probability that the next
 

1581
00:36:28,640 --> 00:36:31,030
there's some probability that the next
word is it was there's some other

1582
00:36:31,030 --> 00:36:31,040
word is it was there's some other
 

1583
00:36:31,040 --> 00:36:32,550
word is it was there's some other
probability that the next word will be

1584
00:36:32,550 --> 00:36:32,560
probability that the next word will be
 

1585
00:36:32,560 --> 00:36:35,270
probability that the next word will be
it will there's some other probability

1586
00:36:35,270 --> 00:36:35,280
it will there's some other probability
 

1587
00:36:35,280 --> 00:36:37,190
it will there's some other probability
the next word could be it could you know

1588
00:36:37,190 --> 00:36:37,200
the next word could be it could you know
 

1589
00:36:37,200 --> 00:36:38,630
the next word could be it could you know
there's so many different words that

1590
00:36:38,630 --> 00:36:38,640
there's so many different words that
 

1591
00:36:38,640 --> 00:36:42,069
there's so many different words that
could come after it. So you say, well,

1592
00:36:42,069 --> 00:36:42,079
could come after it. So you say, well,
 

1593
00:36:42,079 --> 00:36:44,470
could come after it. So you say, well,
okay, let me look at, you know, some k

1594
00:36:44,470 --> 00:36:44,480
okay, let me look at, you know, some k
 

1595
00:36:44,480 --> 00:36:45,990
okay, let me look at, you know, some k
different options for what is the word

1596
00:36:45,990 --> 00:36:46,000
different options for what is the word
 

1597
00:36:46,000 --> 00:36:48,310
different options for what is the word
that could come after it. Then I say,

1598
00:36:48,310 --> 00:36:48,320
that could come after it. Then I say,
 

1599
00:36:48,320 --> 00:36:50,950
that could come after it. Then I say,
okay, for each of these words, I'm going

1600
00:36:50,950 --> 00:36:50,960
okay, for each of these words, I'm going
 

1601
00:36:50,960 --> 00:36:54,870
okay, for each of these words, I'm going
to now kind of grow my tree. Okay, so I

1602
00:36:54,870 --> 00:36:54,880
to now kind of grow my tree. Okay, so I
 

1603
00:36:54,880 --> 00:36:59,589
to now kind of grow my tree. Okay, so I
have

1604
00:36:59,589 --> 00:36:59,599

 

1605
00:36:59,599 --> 00:37:02,710

a word and then I kind of grow my tree

1606
00:37:02,710 --> 00:37:02,720
a word and then I kind of grow my tree
 

1607
00:37:02,720 --> 00:37:04,630
a word and then I kind of grow my tree
and then I have these next words and

1608
00:37:04,630 --> 00:37:04,640
and then I have these next words and
 

1609
00:37:04,640 --> 00:37:09,829
and then I have these next words and
then I have I can have potentially trees

1610
00:37:09,829 --> 00:37:09,839

 

1611
00:37:09,839 --> 00:37:13,990

going um

1612
00:37:13,990 --> 00:37:14,000

 

1613
00:37:14,000 --> 00:37:15,510

for for each of these subsequent things.

1614
00:37:15,510 --> 00:37:15,520
for for each of these subsequent things.
 

1615
00:37:15,520 --> 00:37:17,829
for for each of these subsequent things.
Does everyone see how I can look look at

1616
00:37:17,829 --> 00:37:17,839
Does everyone see how I can look look at
 

1617
00:37:17,839 --> 00:37:20,550
Does everyone see how I can look look at
this best first search will basically

1618
00:37:20,550 --> 00:37:20,560
this best first search will basically
 

1619
00:37:20,560 --> 00:37:22,390
this best first search will basically
say okay let me somehow come up with a

1620
00:37:22,390 --> 00:37:22,400
say okay let me somehow come up with a
 

1621
00:37:22,400 --> 00:37:24,550
say okay let me somehow come up with a
heristic some way of saying which of

1622
00:37:24,550 --> 00:37:24,560
heristic some way of saying which of
 

1623
00:37:24,560 --> 00:37:27,270
heristic some way of saying which of
these do I think is the best one and I

1624
00:37:27,270 --> 00:37:27,280
these do I think is the best one and I
 

1625
00:37:27,280 --> 00:37:29,589
these do I think is the best one and I
will expand that branch of the tree

1626
00:37:29,589 --> 00:37:29,599
will expand that branch of the tree
 

1627
00:37:29,599 --> 00:37:32,470
will expand that branch of the tree
first okay but I don't want to be doing

1628
00:37:32,470 --> 00:37:32,480
first okay but I don't want to be doing
 

1629
00:37:32,480 --> 00:37:35,750
first okay but I don't want to be doing
this too far down and so beam search is

1630
00:37:35,750 --> 00:37:35,760
this too far down and so beam search is
 

1631
00:37:35,760 --> 00:37:37,990
this too far down and so beam search is
basically truncating this to say okay

1632
00:37:37,990 --> 00:37:38,000
basically truncating this to say okay
 

1633
00:37:38,000 --> 00:37:41,430
basically truncating this to say okay
I'm going to look at some number of top

1634
00:37:41,430 --> 00:37:41,440
I'm going to look at some number of top
 

1635
00:37:41,440 --> 00:37:45,349
I'm going to look at some number of top
things so that I can balance my search

1636
00:37:45,349 --> 00:37:45,359
things so that I can balance my search
 

1637
00:37:45,359 --> 00:37:47,750
things so that I can balance my search
in a way that I'm not just looking at

1638
00:37:47,750 --> 00:37:47,760
in a way that I'm not just looking at
 

1639
00:37:47,760 --> 00:37:50,710
in a way that I'm not just looking at
the most likely thing. I'm not randomly

1640
00:37:50,710 --> 00:37:50,720
the most likely thing. I'm not randomly
 

1641
00:37:50,720 --> 00:37:52,870
the most likely thing. I'm not randomly
sampling every time and I'm keeping some

1642
00:37:52,870 --> 00:37:52,880
sampling every time and I'm keeping some
 

1643
00:37:52,880 --> 00:37:54,390
sampling every time and I'm keeping some
running track of what my different

1644
00:37:54,390 --> 00:37:54,400
running track of what my different
 

1645
00:37:54,400 --> 00:37:57,109
running track of what my different
options are. That allows me to, you

1646
00:37:57,109 --> 00:37:57,119
options are. That allows me to, you
 

1647
00:37:57,119 --> 00:38:00,310
options are. That allows me to, you
know, look at, well, maybe this second

1648
00:38:00,310 --> 00:38:00,320
know, look at, well, maybe this second
 

1649
00:38:00,320 --> 00:38:02,470
know, look at, well, maybe this second
word was really likely, but it led to me

1650
00:38:02,470 --> 00:38:02,480
word was really likely, but it led to me
 

1651
00:38:02,480 --> 00:38:04,150
word was really likely, but it led to me
down a really bad path. So, I want to in

1652
00:38:04,150 --> 00:38:04,160
down a really bad path. So, I want to in
 

1653
00:38:04,160 --> 00:38:05,750
down a really bad path. So, I want to in
some sense backtrack and say, no, I

1654
00:38:05,750 --> 00:38:05,760
some sense backtrack and say, no, I
 

1655
00:38:05,760 --> 00:38:07,750
some sense backtrack and say, no, I
don't want to choose it will. I would

1656
00:38:07,750 --> 00:38:07,760
don't want to choose it will. I would
 

1657
00:38:07,760 --> 00:38:09,910
don't want to choose it will. I would
much rather choose it takes and go down

1658
00:38:09,910 --> 00:38:09,920
much rather choose it takes and go down
 

1659
00:38:09,920 --> 00:38:11,670
much rather choose it takes and go down
this other path. And that's what beam

1660
00:38:11,670 --> 00:38:11,680
this other path. And that's what beam
 

1661
00:38:11,680 --> 00:38:13,670
this other path. And that's what beam
search allows you to do. Basically, just

1662
00:38:13,670 --> 00:38:13,680
search allows you to do. Basically, just
 

1663
00:38:13,680 --> 00:38:15,829
search allows you to do. Basically, just
think of it as a variation on uh best

1664
00:38:15,829 --> 00:38:15,839
think of it as a variation on uh best
 

1665
00:38:15,839 --> 00:38:17,670
think of it as a variation on uh best
first search that basically truncates

1666
00:38:17,670 --> 00:38:17,680
first search that basically truncates
 

1667
00:38:17,680 --> 00:38:19,109
first search that basically truncates
your search that you're not looking too

1668
00:38:19,109 --> 00:38:19,119
your search that you're not looking too
 

1669
00:38:19,119 --> 00:38:21,510
your search that you're not looking too
far. You're looking in a particular beam

1670
00:38:21,510 --> 00:38:21,520
far. You're looking in a particular beam
 

1671
00:38:21,520 --> 00:38:24,630
far. You're looking in a particular beam
direction. Okay.

1672
00:38:24,630 --> 00:38:24,640
direction. Okay.
 

1673
00:38:24,640 --> 00:38:26,630
direction. Okay.
So, these are two commonly used sampling

1674
00:38:26,630 --> 00:38:26,640
So, these are two commonly used sampling
 

1675
00:38:26,640 --> 00:38:27,829
So, these are two commonly used sampling
strategies and then there's many

1676
00:38:27,829 --> 00:38:27,839
strategies and then there's many
 

1677
00:38:27,839 --> 00:38:29,750
strategies and then there's many
variations thereof that you can possibly

1678
00:38:29,750 --> 00:38:29,760
variations thereof that you can possibly
 

1679
00:38:29,760 --> 00:38:31,589
variations thereof that you can possibly
use.

1680
00:38:31,589 --> 00:38:31,599
use.
 

1681
00:38:31,599 --> 00:38:34,710
use.
So, just to give you a sense of scale

1682
00:38:34,710 --> 00:38:34,720
So, just to give you a sense of scale
 

1683
00:38:34,720 --> 00:38:37,270
So, just to give you a sense of scale
for GBT there were the question is how

1684
00:38:37,270 --> 00:38:37,280
for GBT there were the question is how
 

1685
00:38:37,280 --> 00:38:39,589
for GBT there were the question is how
many what is K? There were 96

1686
00:38:39,589 --> 00:38:39,599
many what is K? There were 96
 

1687
00:38:39,599 --> 00:38:42,630
many what is K? There were 96
transformer layers, 96 heads in the self

1688
00:38:42,630 --> 00:38:42,640
transformer layers, 96 heads in the self
 

1689
00:38:42,640 --> 00:38:45,589
transformer layers, 96 heads in the self
attention layers. The dimensions of your

1690
00:38:45,589 --> 00:38:45,599
attention layers. The dimensions of your
 

1691
00:38:45,599 --> 00:38:48,550
attention layers. The dimensions of your
key value and value and query were all

1692
00:38:48,550 --> 00:38:48,560
key value and value and query were all
 

1693
00:38:48,560 --> 00:38:52,150
key value and value and query were all
128. The embedding dimension was very

1694
00:38:52,150 --> 00:38:52,160
128. The embedding dimension was very
 

1695
00:38:52,160 --> 00:38:55,750
128. The embedding dimension was very
large um

1696
00:38:55,750 --> 00:38:55,760
large um
 

1697
00:38:55,760 --> 00:38:57,750
large um
close to 12,000

1698
00:38:57,750 --> 00:38:57,760
close to 12,000
 

1699
00:38:57,760 --> 00:39:00,230
close to 12,000
and I believe subsequent models have

1700
00:39:00,230 --> 00:39:00,240
and I believe subsequent models have
 

1701
00:39:00,240 --> 00:39:02,790
and I believe subsequent models have
since moved to smaller dimensions of

1702
00:39:02,790 --> 00:39:02,800
since moved to smaller dimensions of
 

1703
00:39:02,800 --> 00:39:04,069
since moved to smaller dimensions of
embedding. This is like a little bit of

1704
00:39:04,069 --> 00:39:04,079
embedding. This is like a little bit of
 

1705
00:39:04,079 --> 00:39:05,750
embedding. This is like a little bit of
an outlier in terms of how big that

1706
00:39:05,750 --> 00:39:05,760
an outlier in terms of how big that
 

1707
00:39:05,760 --> 00:39:08,230
an outlier in terms of how big that
embedding dimension was.

1708
00:39:08,230 --> 00:39:08,240
embedding dimension was.
 

1709
00:39:08,240 --> 00:39:10,310
embedding dimension was.
um it could handle input sequences that

1710
00:39:10,310 --> 00:39:10,320
um it could handle input sequences that
 

1711
00:39:10,320 --> 00:39:15,109
um it could handle input sequences that
were uh 248 tokens long and in total it

1712
00:39:15,109 --> 00:39:15,119
were uh 248 tokens long and in total it
 

1713
00:39:15,119 --> 00:39:18,069
were uh 248 tokens long and in total it
had about 175 billion parameters and it

1714
00:39:18,069 --> 00:39:18,079
had about 175 billion parameters and it
 

1715
00:39:18,079 --> 00:39:21,190
had about 175 billion parameters and it
was trained with 300 billion tokens.

1716
00:39:21,190 --> 00:39:21,200
was trained with 300 billion tokens.
 

1717
00:39:21,200 --> 00:39:23,670
was trained with 300 billion tokens.
Okay, so

1718
00:39:23,670 --> 00:39:23,680
Okay, so
 

1719
00:39:23,680 --> 00:39:26,550
Okay, so
it was big and things only got bigger

1720
00:39:26,550 --> 00:39:26,560
it was big and things only got bigger
 

1721
00:39:26,560 --> 00:39:28,710
it was big and things only got bigger
from there on.

1722
00:39:28,710 --> 00:39:28,720
from there on.
 

1723
00:39:28,720 --> 00:39:30,790
from there on.
So this is the thing about GPT. Yes,

1724
00:39:30,790 --> 00:39:30,800
So this is the thing about GPT. Yes,
 

1725
00:39:30,800 --> 00:39:32,310
So this is the thing about GPT. Yes,
question. I might have missed this part

1726
00:39:32,310 --> 00:39:32,320
question. I might have missed this part
 

1727
00:39:32,320 --> 00:39:33,589
question. I might have missed this part
but when we're talking about like

1728
00:39:33,589 --> 00:39:33,599
but when we're talking about like
 

1729
00:39:33,599 --> 00:39:36,390
but when we're talking about like
sampling is this like the when we're

1730
00:39:36,390 --> 00:39:36,400
sampling is this like the when we're
 

1731
00:39:36,400 --> 00:39:37,750
sampling is this like the when we're
picking like what we're trying to input

1732
00:39:37,750 --> 00:39:37,760
picking like what we're trying to input
 

1733
00:39:37,760 --> 00:39:39,349
picking like what we're trying to input
or in terms of like

1734
00:39:39,349 --> 00:39:39,359
or in terms of like
 

1735
00:39:39,359 --> 00:39:40,630
or in terms of like
>> sorry so when I was talking about

1736
00:39:40,630 --> 00:39:40,640
>> sorry so when I was talking about
 

1737
00:39:40,640 --> 00:39:42,710
>> sorry so when I was talking about
sampling I was talking about how to do

1738
00:39:42,710 --> 00:39:42,720
sampling I was talking about how to do
 

1739
00:39:42,720 --> 00:39:45,190
sampling I was talking about how to do
the auto reggressive generation so what

1740
00:39:45,190 --> 00:39:45,200
the auto reggressive generation so what
 

1741
00:39:45,200 --> 00:39:48,870
the auto reggressive generation so what
GPT will give me out here

1742
00:39:48,870 --> 00:39:48,880
GPT will give me out here
 

1743
00:39:48,880 --> 00:39:51,430
GPT will give me out here
>> it will give me a it will so I have

1744
00:39:51,430 --> 00:39:51,440
>> it will give me a it will so I have
 

1745
00:39:51,440 --> 00:39:56,310
>> it will give me a it will so I have
50,000 things in my vocabulary whoops

1746
00:39:56,310 --> 00:39:56,320
50,000 things in my vocabulary whoops
 

1747
00:39:56,320 --> 00:40:00,710
50,000 things in my vocabulary whoops
so here I have a

1748
00:40:00,710 --> 00:40:00,720

 

1749
00:40:00,720 --> 00:40:02,870

50,000 length vector. So I have 50,000

1750
00:40:02,870 --> 00:40:02,880
50,000 length vector. So I have 50,000
 

1751
00:40:02,880 --> 00:40:04,790
50,000 length vector. So I have 50,000
probabilities that are generated and I

1752
00:40:04,790 --> 00:40:04,800
probabilities that are generated and I
 

1753
00:40:04,800 --> 00:40:07,750
probabilities that are generated and I
have to pick from that one thing to put

1754
00:40:07,750 --> 00:40:07,760
have to pick from that one thing to put
 

1755
00:40:07,760 --> 00:40:10,790
have to pick from that one thing to put
back in to generate the next token. So

1756
00:40:10,790 --> 00:40:10,800
back in to generate the next token. So
 

1757
00:40:10,800 --> 00:40:13,109
back in to generate the next token. So
how do I do that?

1758
00:40:13,109 --> 00:40:13,119
how do I do that?
 

1759
00:40:13,119 --> 00:40:16,470
how do I do that?
And so one way is to say I'm going to

1760
00:40:16,470 --> 00:40:16,480
And so one way is to say I'm going to
 

1761
00:40:16,480 --> 00:40:19,109
And so one way is to say I'm going to
pick from the top K like choose the

1762
00:40:19,109 --> 00:40:19,119
pick from the top K like choose the
 

1763
00:40:19,119 --> 00:40:21,190
pick from the top K like choose the
things with the largest K. But the other

1764
00:40:21,190 --> 00:40:21,200
things with the largest K. But the other
 

1765
00:40:21,200 --> 00:40:23,589
things with the largest K. But the other
strategy is to do it not just for one

1766
00:40:23,589 --> 00:40:23,599
strategy is to do it not just for one
 

1767
00:40:23,599 --> 00:40:25,510
strategy is to do it not just for one
token but for a few tokens, right? And

1768
00:40:25,510 --> 00:40:25,520
token but for a few tokens, right? And
 

1769
00:40:25,520 --> 00:40:27,109
token but for a few tokens, right? And
how do I choose those? I choose those

1770
00:40:27,109 --> 00:40:27,119
how do I choose those? I choose those
 

1771
00:40:27,119 --> 00:40:29,109
how do I choose those? I choose those
based on beam search. So I don't just

1772
00:40:29,109 --> 00:40:29,119
based on beam search. So I don't just
 

1773
00:40:29,119 --> 00:40:32,870
based on beam search. So I don't just
pick one immediate next best token. I

1774
00:40:32,870 --> 00:40:32,880
pick one immediate next best token. I
 

1775
00:40:32,880 --> 00:40:35,270
pick one immediate next best token. I
say let me pick some things. Let me

1776
00:40:35,270 --> 00:40:35,280
say let me pick some things. Let me
 

1777
00:40:35,280 --> 00:40:38,710
say let me pick some things. Let me
explore these trees out a little bit and

1778
00:40:38,710 --> 00:40:38,720
explore these trees out a little bit and
 

1779
00:40:38,720 --> 00:40:40,550
explore these trees out a little bit and
then commit to which path I'm going to

1780
00:40:40,550 --> 00:40:40,560
then commit to which path I'm going to
 

1781
00:40:40,560 --> 00:40:43,349
then commit to which path I'm going to
go down. So this is about what happens

1782
00:40:43,349 --> 00:40:43,359
go down. So this is about what happens
 

1783
00:40:43,359 --> 00:40:46,230
go down. So this is about what happens
at uh inference time, not at the input

1784
00:40:46,230 --> 00:40:46,240
at uh inference time, not at the input
 

1785
00:40:46,240 --> 00:40:47,750
at uh inference time, not at the input
time. Not Yeah.

1786
00:40:47,750 --> 00:40:47,760
time. Not Yeah.
 

1787
00:40:47,760 --> 00:40:49,829
time. Not Yeah.
>> So if you could construct the beam, you

1788
00:40:49,829 --> 00:40:49,839
>> So if you could construct the beam, you
 

1789
00:40:49,839 --> 00:40:51,750
>> So if you could construct the beam, you
would actually have to take each of the

1790
00:40:51,750 --> 00:40:51,760
would actually have to take each of the
 

1791
00:40:51,760 --> 00:40:54,069
would actually have to take each of the
the best candidates and then put all of

1792
00:40:54,069 --> 00:40:54,079
the best candidates and then put all of
 

1793
00:40:54,079 --> 00:40:55,670
the best candidates and then put all of
>> and put them back in. Yes. So you're

1794
00:40:55,670 --> 00:40:55,680
>> and put them back in. Yes. So you're
 

1795
00:40:55,680 --> 00:40:56,950
>> and put them back in. Yes. So you're
doing some generations. You're doing

1796
00:40:56,950 --> 00:40:56,960
doing some generations. You're doing
 

1797
00:40:56,960 --> 00:40:59,190
doing some generations. You're doing
multiple generations for a small amount

1798
00:40:59,190 --> 00:40:59,200
multiple generations for a small amount
 

1799
00:40:59,200 --> 00:40:59,829
multiple generations for a small amount
of time

1800
00:40:59,829 --> 00:40:59,839
of time
 

1801
00:40:59,839 --> 00:41:01,430
of time
>> and once you've explored the kind of

1802
00:41:01,430 --> 00:41:01,440
>> and once you've explored the kind of
 

1803
00:41:01,440 --> 00:41:02,470
>> and once you've explored the kind of
little range then

1804
00:41:02,470 --> 00:41:02,480
little range then
 

1805
00:41:02,480 --> 00:41:03,829
little range then
>> then you pick one and you commit to it

1806
00:41:03,829 --> 00:41:03,839
>> then you pick one and you commit to it
 

1807
00:41:03,839 --> 00:41:07,109
>> then you pick one and you commit to it
and you move forward.

1808
00:41:07,109 --> 00:41:07,119
and you move forward.
 

1809
00:41:07,119 --> 00:41:07,910
and you move forward.
>> Yes.

1810
00:41:07,910 --> 00:41:07,920
>> Yes.
 

1811
00:41:07,920 --> 00:41:10,069
>> Yes.
>> Wait, I don't know if I'm messing up my

1812
00:41:10,069 --> 00:41:10,079
>> Wait, I don't know if I'm messing up my
 

1813
00:41:10,079 --> 00:41:14,230
>> Wait, I don't know if I'm messing up my
arithmetic, but there were 98

1814
00:41:14,230 --> 00:41:14,240
arithmetic, but there were 98
 

1815
00:41:14,240 --> 00:41:19,990
arithmetic, but there were 98
attention heads and hidden size was 128.

1816
00:41:19,990 --> 00:41:20,000
attention heads and hidden size was 128.
 

1817
00:41:20,000 --> 00:41:25,990
attention heads and hidden size was 128.
How do they divide?

1818
00:41:25,990 --> 00:41:26,000

 

1819
00:41:26,000 --> 00:41:28,309

So I think so this is there were 96

1820
00:41:28,309 --> 00:41:28,319
So I think so this is there were 96
 

1821
00:41:28,319 --> 00:41:33,510
So I think so this is there were 96
attention heads each of which had a key

1822
00:41:33,510 --> 00:41:33,520
attention heads each of which had a key
 

1823
00:41:33,520 --> 00:41:35,750
attention heads each of which had a key
value query dimension 128. So this is

1824
00:41:35,750 --> 00:41:35,760
value query dimension 128. So this is
 

1825
00:41:35,760 --> 00:41:38,550
value query dimension 128. So this is
not the this is the after division

1826
00:41:38,550 --> 00:41:38,560
not the this is the after division
 

1827
00:41:38,560 --> 00:41:46,390
not the this is the after division
>> it was 128 not before division.

1828
00:41:46,390 --> 00:41:46,400

 

1829
00:41:46,400 --> 00:41:46,870

>> Yes.

1830
00:41:46,870 --> 00:41:46,880
>> Yes.
 

1831
00:41:46,880 --> 00:41:48,550
>> Yes.
>> So at this moment it does not really

1832
00:41:48,550 --> 00:41:48,560
>> So at this moment it does not really
 

1833
00:41:48,560 --> 00:41:50,950
>> So at this moment it does not really
answer to any problem. Correct.

1834
00:41:50,950 --> 00:41:50,960
answer to any problem. Correct.
 

1835
00:41:50,960 --> 00:41:53,109
answer to any problem. Correct.
>> Uh this is not yes we have not talked

1836
00:41:53,109 --> 00:41:53,119
>> Uh this is not yes we have not talked
 

1837
00:41:53,119 --> 00:41:56,069
>> Uh this is not yes we have not talked
about instruction tuning yet.

1838
00:41:56,069 --> 00:41:56,079
about instruction tuning yet.
 

1839
00:41:56,079 --> 00:41:57,990
about instruction tuning yet.
We will probably talk a little about it

1840
00:41:57,990 --> 00:41:58,000
We will probably talk a little about it
 

1841
00:41:58,000 --> 00:41:59,829
We will probably talk a little about it
a little bit about it when we get to the

1842
00:41:59,829 --> 00:41:59,839
a little bit about it when we get to the
 

1843
00:41:59,839 --> 00:42:03,030
a little bit about it when we get to the
finetuning part.

1844
00:42:03,030 --> 00:42:03,040
finetuning part.
 

1845
00:42:03,040 --> 00:42:03,589
finetuning part.
>> Yes,

1846
00:42:03,589 --> 00:42:03,599
>> Yes,
 

1847
00:42:03,599 --> 00:42:05,190
>> Yes,
>> it can still answer prompts, right? It

1848
00:42:05,190 --> 00:42:05,200
>> it can still answer prompts, right? It
 

1849
00:42:05,200 --> 00:42:06,870
>> it can still answer prompts, right? It
just wasn't super trained.

1850
00:42:06,870 --> 00:42:06,880
just wasn't super trained.
 

1851
00:42:06,880 --> 00:42:08,790
just wasn't super trained.
>> Yes. Okay. It can I mean it can still it

1852
00:42:08,790 --> 00:42:08,800
>> Yes. Okay. It can I mean it can still it
 

1853
00:42:08,800 --> 00:42:09,990
>> Yes. Okay. It can I mean it can still it
can still answer prompts in the sense

1854
00:42:09,990 --> 00:42:10,000
can still answer prompts in the sense
 

1855
00:42:10,000 --> 00:42:11,990
can still answer prompts in the sense
that you can put in whatever input you

1856
00:42:11,990 --> 00:42:12,000
that you can put in whatever input you
 

1857
00:42:12,000 --> 00:42:14,069
that you can put in whatever input you
want, right? And it'll continue that

1858
00:42:14,069 --> 00:42:14,079
want, right? And it'll continue that
 

1859
00:42:14,079 --> 00:42:17,670
want, right? And it'll continue that
input, but it's not trained to

1860
00:42:17,670 --> 00:42:17,680
input, but it's not trained to
 

1861
00:42:17,680 --> 00:42:21,270
input, but it's not trained to
specifically answer questions,

1862
00:42:21,270 --> 00:42:21,280
specifically answer questions,
 

1863
00:42:21,280 --> 00:42:23,510
specifically answer questions,
right? It's only trained on next token

1864
00:42:23,510 --> 00:42:23,520
right? It's only trained on next token
 

1865
00:42:23,520 --> 00:42:24,870
right? It's only trained on next token
prediction. Whereas if you're going to

1866
00:42:24,870 --> 00:42:24,880
prediction. Whereas if you're going to
 

1867
00:42:24,880 --> 00:42:27,030
prediction. Whereas if you're going to
do some kind of instruction tuning, you

1868
00:42:27,030 --> 00:42:27,040
do some kind of instruction tuning, you
 

1869
00:42:27,040 --> 00:42:29,030
do some kind of instruction tuning, you
want to mask certain parts of like here,

1870
00:42:29,030 --> 00:42:29,040
want to mask certain parts of like here,
 

1871
00:42:29,040 --> 00:42:32,470
want to mask certain parts of like here,
every token is part of the loss.

1872
00:42:32,470 --> 00:42:32,480
every token is part of the loss.
 

1873
00:42:32,480 --> 00:42:33,670
every token is part of the loss.
Whereas when you're doing instruction

1874
00:42:33,670 --> 00:42:33,680
Whereas when you're doing instruction
 

1875
00:42:33,680 --> 00:42:35,910
Whereas when you're doing instruction
tuning, you will change where what you

1876
00:42:35,910 --> 00:42:35,920
tuning, you will change where what you
 

1877
00:42:35,920 --> 00:42:38,870
tuning, you will change where what you
care about in your loss.

1878
00:42:38,870 --> 00:42:38,880
care about in your loss.
 

1879
00:42:38,880 --> 00:42:41,750
care about in your loss.
>> And uh I from the sampling you get the K

1880
00:42:41,750 --> 00:42:41,760
>> And uh I from the sampling you get the K
 

1881
00:42:41,760 --> 00:42:44,870
>> And uh I from the sampling you get the K
of match and how do you is there any

1882
00:42:44,870 --> 00:42:44,880
of match and how do you is there any
 

1883
00:42:44,880 --> 00:42:47,430
of match and how do you is there any
like human supervised learning when you

1884
00:42:47,430 --> 00:42:47,440
like human supervised learning when you
 

1885
00:42:47,440 --> 00:42:49,270
like human supervised learning when you
pick the last one like what is the best

1886
00:42:49,270 --> 00:42:49,280
pick the last one like what is the best
 

1887
00:42:49,280 --> 00:42:53,430
pick the last one like what is the best
like answer from these collections?

1888
00:42:53,430 --> 00:42:53,440
like answer from these collections?
 

1889
00:42:53,440 --> 00:42:56,870
like answer from these collections?
Um so the way this was done was you just

1890
00:42:56,870 --> 00:42:56,880
Um so the way this was done was you just
 

1891
00:42:56,880 --> 00:43:02,069
Um so the way this was done was you just
picked then um uh no was there oh I see

1892
00:43:02,069 --> 00:43:02,079
picked then um uh no was there oh I see
 

1893
00:43:02,079 --> 00:43:05,589
picked then um uh no was there oh I see
was there any human supervision on the

1894
00:43:05,589 --> 00:43:05,599
was there any human supervision on the
 

1895
00:43:05,599 --> 00:43:06,870
was there any human supervision on the
beam search?

1896
00:43:06,870 --> 00:43:06,880
beam search?
 

1897
00:43:06,880 --> 00:43:09,234
beam search?
>> Yeah yeah

1898
00:43:09,234 --> 00:43:09,244
>> Yeah yeah
 

1899
00:43:09,244 --> 00:43:10,470
>> Yeah yeah
[sighs]

1900
00:43:10,470 --> 00:43:10,480
[sighs]
 

1901
00:43:10,480 --> 00:43:13,109
[sighs]
>> I am not sure of the answer to that. Are

1902
00:43:13,109 --> 00:43:13,119
>> I am not sure of the answer to that. Are
 

1903
00:43:13,119 --> 00:43:14,790
>> I am not sure of the answer to that. Are
you sure of the answer to that?

1904
00:43:14,790 --> 00:43:14,800
you sure of the answer to that?
 

1905
00:43:14,800 --> 00:43:17,030
you sure of the answer to that?
>> Typically the issues are probabilities.

1906
00:43:17,030 --> 00:43:17,040
>> Typically the issues are probabilities.
 

1907
00:43:17,040 --> 00:43:19,270
>> Typically the issues are probabilities.
>> Yeah but I I don't know exactly for GPT3

1908
00:43:19,270 --> 00:43:19,280
>> Yeah but I I don't know exactly for GPT3
 

1909
00:43:19,280 --> 00:43:20,950
>> Yeah but I I don't know exactly for GPT3
I think that

1910
00:43:20,950 --> 00:43:20,960
I think that
 

1911
00:43:20,960 --> 00:43:23,030
I think that
>> it's a regeneration. Yeah, just for

1912
00:43:23,030 --> 00:43:23,040
>> it's a regeneration. Yeah, just for
 

1913
00:43:23,040 --> 00:43:27,910
>> it's a regeneration. Yeah, just for
generation

1914
00:43:27,910 --> 00:43:27,920

 

1915
00:43:27,920 --> 00:43:30,230

model didn't have a committed sampler.

1916
00:43:30,230 --> 00:43:30,240
model didn't have a committed sampler.
 

1917
00:43:30,240 --> 00:43:33,430
model didn't have a committed sampler.
Use whatever you want.

1918
00:43:33,430 --> 00:43:33,440
Use whatever you want.
 

1919
00:43:33,440 --> 00:43:36,470
Use whatever you want.
>> Okay.

1920
00:43:36,470 --> 00:43:36,480

 

1921
00:43:36,480 --> 00:43:39,190

>> Oh, so I don't think basically the uh my

1922
00:43:39,190 --> 00:43:39,200
>> Oh, so I don't think basically the uh my
 

1923
00:43:39,200 --> 00:43:40,390
>> Oh, so I don't think basically the uh my
understanding is that there was no

1924
00:43:40,390 --> 00:43:40,400
understanding is that there was no
 

1925
00:43:40,400 --> 00:43:44,630
understanding is that there was no
dedicated like human feedback in uh in

1926
00:43:44,630 --> 00:43:44,640
dedicated like human feedback in uh in
 

1927
00:43:44,640 --> 00:43:45,829
dedicated like human feedback in uh in
this. You just picked the things with

1928
00:43:45,829 --> 00:43:45,839
this. You just picked the things with
 

1929
00:43:45,839 --> 00:43:47,510
this. You just picked the things with
the with the largest probabilities and

1930
00:43:47,510 --> 00:43:47,520
the with the largest probabilities and
 

1931
00:43:47,520 --> 00:43:49,349
the with the largest probabilities and
then you could do things on top of that.

1932
00:43:49,349 --> 00:43:49,359
then you could do things on top of that.
 

1933
00:43:49,359 --> 00:43:51,750
then you could do things on top of that.
But the core GPD3 architecture didn't

1934
00:43:51,750 --> 00:43:51,760
But the core GPD3 architecture didn't
 

1935
00:43:51,760 --> 00:43:54,950
But the core GPD3 architecture didn't
use any of that.

1936
00:43:54,950 --> 00:43:54,960
use any of that.
 

1937
00:43:54,960 --> 00:43:55,589
use any of that.
>> Yeah.

1938
00:43:55,589 --> 00:43:55,599
>> Yeah.
 

1939
00:43:55,599 --> 00:43:57,750
>> Yeah.
>> So during the training time you just use

1940
00:43:57,750 --> 00:43:57,760
>> So during the training time you just use
 

1941
00:43:57,760 --> 00:44:00,550
>> So during the training time you just use
like the sentences like the words um

1942
00:44:00,550 --> 00:44:00,560
like the sentences like the words um
 

1943
00:44:00,560 --> 00:44:02,550
like the sentences like the words um
spoken by human beings and we just feed

1944
00:44:02,550 --> 00:44:02,560
spoken by human beings and we just feed
 

1945
00:44:02,560 --> 00:44:04,470
spoken by human beings and we just feed
it into the marketing models and then

1946
00:44:04,470 --> 00:44:04,480
it into the marketing models and then
 

1947
00:44:04,480 --> 00:44:07,430
it into the marketing models and then
they do guess like tokens by tokens.

1948
00:44:07,430 --> 00:44:07,440
they do guess like tokens by tokens.
 

1949
00:44:07,440 --> 00:44:08,790
they do guess like tokens by tokens.
>> Sorry I'm I'm not understanding your

1950
00:44:08,790 --> 00:44:08,800
>> Sorry I'm I'm not understanding your
 

1951
00:44:08,800 --> 00:44:09,109
>> Sorry I'm I'm not understanding your
question.

1952
00:44:09,109 --> 00:44:09,119
question.
 

1953
00:44:09,119 --> 00:44:10,870
question.
>> I'm just curious about like how it is

1954
00:44:10,870 --> 00:44:10,880
>> I'm just curious about like how it is
 

1955
00:44:10,880 --> 00:44:13,510
>> I'm just curious about like how it is
trained. Um we just feed them with some

1956
00:44:13,510 --> 00:44:13,520
trained. Um we just feed them with some
 

1957
00:44:13,520 --> 00:44:14,309
trained. Um we just feed them with some
sentences.

1958
00:44:14,309 --> 00:44:14,319
sentences.
 

1959
00:44:14,319 --> 00:44:15,990
sentences.
>> Yeah. So these are these the this was

1960
00:44:15,990 --> 00:44:16,000
>> Yeah. So these are these the this was
 

1961
00:44:16,000 --> 00:44:17,750
>> Yeah. So these are these the this was
fed with some like massive internet

1962
00:44:17,750 --> 00:44:17,760
fed with some like massive internet
 

1963
00:44:17,760 --> 00:44:19,510
fed with some like massive internet
crawl. Basically every sentence on the

1964
00:44:19,510 --> 00:44:19,520
crawl. Basically every sentence on the
 

1965
00:44:19,520 --> 00:44:21,589
crawl. Basically every sentence on the
internet was put into it in some

1966
00:44:21,589 --> 00:44:21,599
internet was put into it in some
 

1967
00:44:21,599 --> 00:44:24,150
internet was put into it in some
>> you just like guess token by token to

1968
00:44:24,150 --> 00:44:24,160
>> you just like guess token by token to
 

1969
00:44:24,160 --> 00:44:27,750
>> you just like guess token by token to
get the maximum entropy.

1970
00:44:27,750 --> 00:44:27,760
get the maximum entropy.
 

1971
00:44:27,760 --> 00:44:30,870
get the maximum entropy.
>> It it gets token by token to minimize

1972
00:44:30,870 --> 00:44:30,880
>> It it gets token by token to minimize
 

1973
00:44:30,880 --> 00:44:32,069
>> It it gets token by token to minimize
the cross entropy loss.

1974
00:44:32,069 --> 00:44:32,079
the cross entropy loss.
 

1975
00:44:32,079 --> 00:44:37,349
the cross entropy loss.
>> Oh okay. Thank you.

1976
00:44:37,349 --> 00:44:37,359

 

1977
00:44:37,359 --> 00:44:37,990

>> Yes.

1978
00:44:37,990 --> 00:44:38,000
>> Yes.
 

1979
00:44:38,000 --> 00:44:41,190
>> Yes.
>> Just let me try the size. So is that K

1980
00:44:41,190 --> 00:44:41,200
>> Just let me try the size. So is that K
 

1981
00:44:41,200 --> 00:44:44,309
>> Just let me try the size. So is that K
the same thing as like the 96 layers or

1982
00:44:44,309 --> 00:44:44,319
the same thing as like the 96 layers or
 

1983
00:44:44,319 --> 00:44:46,069
the same thing as like the 96 layers or
>> that K is the same as the 96 layers.

1984
00:44:46,069 --> 00:44:46,079
>> that K is the same as the 96 layers.
 

1985
00:44:46,079 --> 00:44:47,670
>> that K is the same as the 96 layers.
Yes. Correct. This is 96.

1986
00:44:47,670 --> 00:44:47,680
Yes. Correct. This is 96.
 

1987
00:44:47,680 --> 00:44:49,589
Yes. Correct. This is 96.
>> I know of each within each block. You're

1988
00:44:49,589 --> 00:44:49,599
>> I know of each within each block. You're
 

1989
00:44:49,599 --> 00:44:51,910
>> I know of each within each block. You're
saying there's also 96 attention heads.

1990
00:44:51,910 --> 00:44:51,920
saying there's also 96 attention heads.
 

1991
00:44:51,920 --> 00:44:53,750
saying there's also 96 attention heads.
>> Within each block, there were also 96

1992
00:44:53,750 --> 00:44:53,760
>> Within each block, there were also 96
 

1993
00:44:53,760 --> 00:45:02,230
>> Within each block, there were also 96
attention heads. Yes.

1994
00:45:02,230 --> 00:45:02,240

 

1995
00:45:02,240 --> 00:45:04,390

>> Yes. Okay.

1996
00:45:04,390 --> 00:45:04,400
>> Yes. Okay.
 

1997
00:45:04,400 --> 00:45:06,710
>> Yes. Okay.
Great.

1998
00:45:06,710 --> 00:45:06,720
Great.
 

1999
00:45:06,720 --> 00:45:08,309
Great.
If there's no more questions about GBT,

2000
00:45:08,309 --> 00:45:08,319
If there's no more questions about GBT,
 

2001
00:45:08,319 --> 00:45:10,470
If there's no more questions about GBT,
I'm going to move to now our next I'm

2002
00:45:10,470 --> 00:45:10,480
I'm going to move to now our next I'm
 

2003
00:45:10,480 --> 00:45:13,349
I'm going to move to now our next I'm
like running out of time. Bad.

2004
00:45:13,349 --> 00:45:13,359
like running out of time. Bad.
 

2005
00:45:13,359 --> 00:45:17,030
like running out of time. Bad.
Um, okay. I'm going to now move to Bert.

2006
00:45:17,030 --> 00:45:17,040
Um, okay. I'm going to now move to Bert.
 

2007
00:45:17,040 --> 00:45:19,109
Um, okay. I'm going to now move to Bert.
BERT. So we talked about GPT which was

2008
00:45:19,109 --> 00:45:19,119
BERT. So we talked about GPT which was
 

2009
00:45:19,119 --> 00:45:22,309
BERT. So we talked about GPT which was
the decoder only model but BERT is the

2010
00:45:22,309 --> 00:45:22,319
the decoder only model but BERT is the
 

2011
00:45:22,319 --> 00:45:24,390
the decoder only model but BERT is the
other side which is the encoder only

2012
00:45:24,390 --> 00:45:24,400
other side which is the encoder only
 

2013
00:45:24,400 --> 00:45:26,309
other side which is the encoder only
model. What if you wanted to train

2014
00:45:26,309 --> 00:45:26,319
model. What if you wanted to train
 

2015
00:45:26,319 --> 00:45:29,750
model. What if you wanted to train
something to get really good embeddings

2016
00:45:29,750 --> 00:45:29,760
something to get really good embeddings
 

2017
00:45:29,760 --> 00:45:32,150
something to get really good embeddings
so that you could then fine-tune this to

2018
00:45:32,150 --> 00:45:32,160
so that you could then fine-tune this to
 

2019
00:45:32,160 --> 00:45:34,069
so that you could then fine-tune this to
do some many different kinds of language

2020
00:45:34,069 --> 00:45:34,079
do some many different kinds of language
 

2021
00:45:34,079 --> 00:45:37,750
do some many different kinds of language
tasks, right? And that's what led to uh

2022
00:45:37,750 --> 00:45:37,760
tasks, right? And that's what led to uh
 

2023
00:45:37,760 --> 00:45:39,270
tasks, right? And that's what led to uh
BERT.

2024
00:45:39,270 --> 00:45:39,280
BERT.
 

2025
00:45:39,280 --> 00:45:40,710
BERT.
So you want to basically learn this kind

2026
00:45:40,710 --> 00:45:40,720
So you want to basically learn this kind
 

2027
00:45:40,720 --> 00:45:42,230
So you want to basically learn this kind
of general information about the

2028
00:45:42,230 --> 00:45:42,240
of general information about the
 

2029
00:45:42,240 --> 00:45:44,390
of general information about the
statistics of language and then use

2030
00:45:44,390 --> 00:45:44,400
statistics of language and then use
 

2031
00:45:44,400 --> 00:45:46,790
statistics of language and then use
fine-tuning to adapt this to solve a

2032
00:45:46,790 --> 00:45:46,800
fine-tuning to adapt this to solve a
 

2033
00:45:46,800 --> 00:45:50,950
fine-tuning to adapt this to solve a
specific task. And so this is basically

2034
00:45:50,950 --> 00:45:50,960
specific task. And so this is basically
 

2035
00:45:50,960 --> 00:45:53,990
specific task. And so this is basically
the encoder part of the encoder decoder

2036
00:45:53,990 --> 00:45:54,000
the encoder part of the encoder decoder
 

2037
00:45:54,000 --> 00:45:56,630
the encoder part of the encoder decoder
architecture that we talked about first.

2038
00:45:56,630 --> 00:45:56,640
architecture that we talked about first.
 

2039
00:45:56,640 --> 00:45:59,750
architecture that we talked about first.
And so how am I going to uh think about

2040
00:45:59,750 --> 00:45:59,760
And so how am I going to uh think about
 

2041
00:45:59,760 --> 00:46:01,990
And so how am I going to uh think about
this? I'm going to think about basically

2042
00:46:01,990 --> 00:46:02,000
this? I'm going to think about basically
 

2043
00:46:02,000 --> 00:46:05,910
this? I'm going to think about basically
you you you pre-train this thing and you

2044
00:46:05,910 --> 00:46:05,920
you you you pre-train this thing and you
 

2045
00:46:05,920 --> 00:46:08,710
you you you pre-train this thing and you
do um

2046
00:46:08,710 --> 00:46:08,720
do um
 

2047
00:46:08,720 --> 00:46:12,950
do um
masking of the words in your input

2048
00:46:12,950 --> 00:46:12,960
masking of the words in your input
 

2049
00:46:12,960 --> 00:46:15,510
masking of the words in your input
sentences for training this. You're not

2050
00:46:15,510 --> 00:46:15,520
sentences for training this. You're not
 

2051
00:46:15,520 --> 00:46:17,910
sentences for training this. You're not
training this to do next token

2052
00:46:17,910 --> 00:46:17,920
training this to do next token
 

2053
00:46:17,920 --> 00:46:20,710
training this to do next token
prediction. You're training this to

2054
00:46:20,710 --> 00:46:20,720
prediction. You're training this to
 

2055
00:46:20,720 --> 00:46:24,550
prediction. You're training this to
predict masked sentences within

2056
00:46:24,550 --> 00:46:24,560
predict masked sentences within
 

2057
00:46:24,560 --> 00:46:27,750
predict masked sentences within
the input itself. So here you're not

2058
00:46:27,750 --> 00:46:27,760
the input itself. So here you're not
 

2059
00:46:27,760 --> 00:46:31,349
the input itself. So here you're not
going to be using uh causal or mass self

2060
00:46:31,349 --> 00:46:31,359
going to be using uh causal or mass self
 

2061
00:46:31,359 --> 00:46:33,190
going to be using uh causal or mass self
attention. Here you're using full self

2062
00:46:33,190 --> 00:46:33,200
attention. Here you're using full self
 

2063
00:46:33,200 --> 00:46:34,550
attention. Here you're using full self
attention just like you would in an

2064
00:46:34,550 --> 00:46:34,560
attention just like you would in an
 

2065
00:46:34,560 --> 00:46:37,270
attention just like you would in an
encoder in the encoder decoder

2066
00:46:37,270 --> 00:46:37,280
encoder in the encoder decoder
 

2067
00:46:37,280 --> 00:46:39,589
encoder in the encoder decoder
architecture. Right

2068
00:46:39,589 --> 00:46:39,599
architecture. Right
 

2069
00:46:39,599 --> 00:46:41,589
architecture. Right
here you're allowed to look at the past

2070
00:46:41,589 --> 00:46:41,599
here you're allowed to look at the past
 

2071
00:46:41,599 --> 00:46:44,950
here you're allowed to look at the past
and the future. Okay. So for example

2072
00:46:44,950 --> 00:46:44,960
and the future. Okay. So for example
 

2073
00:46:44,960 --> 00:46:48,710
and the future. Okay. So for example
here my input is something like

2074
00:46:48,710 --> 00:46:48,720
here my input is something like
 

2075
00:46:48,720 --> 00:46:52,470
here my input is something like
the and then I mask this pulled into

2076
00:46:52,470 --> 00:46:52,480
the and then I mask this pulled into
 

2077
00:46:52,480 --> 00:46:55,190
the and then I mask this pulled into
mask station.

2078
00:46:55,190 --> 00:46:55,200
mask station.
 

2079
00:46:55,200 --> 00:46:59,750
mask station.
This goes into a transformer layer

2080
00:46:59,750 --> 00:46:59,760
This goes into a transformer layer
 

2081
00:46:59,760 --> 00:47:03,030
This goes into a transformer layer
and then basically now this token was

2082
00:47:03,030 --> 00:47:03,040
and then basically now this token was
 

2083
00:47:03,040 --> 00:47:05,910
and then basically now this token was
the one that was masked

2084
00:47:05,910 --> 00:47:05,920
the one that was masked
 

2085
00:47:05,920 --> 00:47:08,069
the one that was masked
and here I'm going to have a cross

2086
00:47:08,069 --> 00:47:08,079
and here I'm going to have a cross
 

2087
00:47:08,079 --> 00:47:11,430
and here I'm going to have a cross
entropy loss that is going to uh on the

2088
00:47:11,430 --> 00:47:11,440
entropy loss that is going to uh on the
 

2089
00:47:11,440 --> 00:47:14,710
entropy loss that is going to uh on the
value of what this mask token is.

2090
00:47:14,710 --> 00:47:14,720
value of what this mask token is.
 

2091
00:47:14,720 --> 00:47:17,030
value of what this mask token is.
Similarly here

2092
00:47:17,030 --> 00:47:17,040
Similarly here
 

2093
00:47:17,040 --> 00:47:19,510
Similarly here
on top of this mask token I'm going to

2094
00:47:19,510 --> 00:47:19,520
on top of this mask token I'm going to
 

2095
00:47:19,520 --> 00:47:22,230
on top of this mask token I'm going to
try and predict what the next what what

2096
00:47:22,230 --> 00:47:22,240
try and predict what the next what what
 

2097
00:47:22,240 --> 00:47:24,150
try and predict what the next what what
the word that should be in uh filling

2098
00:47:24,150 --> 00:47:24,160
the word that should be in uh filling
 

2099
00:47:24,160 --> 00:47:27,349
the word that should be in uh filling
that blank. Okay.

2100
00:47:27,349 --> 00:47:27,359
that blank. Okay.
 

2101
00:47:27,359 --> 00:47:29,990
that blank. Okay.
Typically I think it's like 15% of the

2102
00:47:29,990 --> 00:47:30,000
Typically I think it's like 15% of the
 

2103
00:47:30,000 --> 00:47:32,069
Typically I think it's like 15% of the
of the tokens in your input are masked

2104
00:47:32,069 --> 00:47:32,079
of the tokens in your input are masked
 

2105
00:47:32,079 --> 00:47:33,510
of the tokens in your input are masked
like some something like that. It's a

2106
00:47:33,510 --> 00:47:33,520
like some something like that. It's a
 

2107
00:47:33,520 --> 00:47:35,190
like some something like that. It's a
small it's a small fraction. It's not

2108
00:47:35,190 --> 00:47:35,200
small it's a small fraction. It's not
 

2109
00:47:35,200 --> 00:47:40,150
small it's a small fraction. It's not
very large.

2110
00:47:40,150 --> 00:47:40,160

 

2111
00:47:40,160 --> 00:47:42,630

this the important thing is that you

2112
00:47:42,630 --> 00:47:42,640
this the important thing is that you
 

2113
00:47:42,640 --> 00:47:44,550
this the important thing is that you
always use this what is the convention

2114
00:47:44,550 --> 00:47:44,560
always use this what is the convention
 

2115
00:47:44,560 --> 00:47:47,349
always use this what is the convention
is to call this a CLS

2116
00:47:47,349 --> 00:47:47,359
is to call this a CLS
 

2117
00:47:47,359 --> 00:47:49,349
is to call this a CLS
uh and that's kind of that's the token

2118
00:47:49,349 --> 00:47:49,359
uh and that's kind of that's the token
 

2119
00:47:49,359 --> 00:47:51,990
uh and that's kind of that's the token
that's the parallel to the start token

2120
00:47:51,990 --> 00:47:52,000
that's the parallel to the start token
 

2121
00:47:52,000 --> 00:47:54,390
that's the parallel to the start token
but in BERT

2122
00:47:54,390 --> 00:47:54,400
but in BERT
 

2123
00:47:54,400 --> 00:47:56,309
but in BERT
uh the start token is not always just

2124
00:47:56,309 --> 00:47:56,319
uh the start token is not always just
 

2125
00:47:56,319 --> 00:47:58,790
uh the start token is not always just
for a sentence it's kind of it could a

2126
00:47:58,790 --> 00:47:58,800
for a sentence it's kind of it could a
 

2127
00:47:58,800 --> 00:48:00,790
for a sentence it's kind of it could a
sentence could be a a group of sentences

2128
00:48:00,790 --> 00:48:00,800
sentence could be a a group of sentences
 

2129
00:48:00,800 --> 00:48:02,309
sentence could be a a group of sentences
you could have a CLS and then several

2130
00:48:02,309 --> 00:48:02,319
you could have a CLS and then several
 

2131
00:48:02,319 --> 00:48:03,910
you could have a CLS and then several
sentences and then a CLS and then

2132
00:48:03,910 --> 00:48:03,920
sentences and then a CLS and then
 

2133
00:48:03,920 --> 00:48:07,349
sentences and then a CLS and then
several sentences and in BERT two

2134
00:48:07,349 --> 00:48:07,359
several sentences and in BERT two
 

2135
00:48:07,359 --> 00:48:08,870
several sentences and in BERT two
different sentences basically anything

2136
00:48:08,870 --> 00:48:08,880
different sentences basically anything
 

2137
00:48:08,880 --> 00:48:10,870
different sentences basically anything
that in English we would separate with a

2138
00:48:10,870 --> 00:48:10,880
that in English we would separate with a
 

2139
00:48:10,880 --> 00:48:14,309
that in English we would separate with a
period or a full stop is separated with

2140
00:48:14,309 --> 00:48:14,319
period or a full stop is separated with
 

2141
00:48:14,319 --> 00:48:17,670
period or a full stop is separated with
this se token. Okay, it's separated to

2142
00:48:17,670 --> 00:48:17,680
this se token. Okay, it's separated to
 

2143
00:48:17,680 --> 00:48:20,630
this se token. Okay, it's separated to
separate sentences.

2144
00:48:20,630 --> 00:48:20,640
separate sentences.
 

2145
00:48:20,640 --> 00:48:22,870
separate sentences.
And this is important because in

2146
00:48:22,870 --> 00:48:22,880
And this is important because in
 

2147
00:48:22,880 --> 00:48:25,270
And this is important because in
addition to the cross entropy loss on

2148
00:48:25,270 --> 00:48:25,280
addition to the cross entropy loss on
 

2149
00:48:25,280 --> 00:48:27,510
addition to the cross entropy loss on
the masked tokens,

2150
00:48:27,510 --> 00:48:27,520
the masked tokens,
 

2151
00:48:27,520 --> 00:48:29,910
the masked tokens,
there is a secondary loss that BERT is

2152
00:48:29,910 --> 00:48:29,920
there is a secondary loss that BERT is
 

2153
00:48:29,920 --> 00:48:32,790
there is a secondary loss that BERT is
trained on. And this B this secondary

2154
00:48:32,790 --> 00:48:32,800
trained on. And this B this secondary
 

2155
00:48:32,800 --> 00:48:35,910
trained on. And this B this secondary
loss is called uh is is is about is next

2156
00:48:35,910 --> 00:48:35,920
loss is called uh is is is about is next
 

2157
00:48:35,920 --> 00:48:37,270
loss is called uh is is is about is next
sentence prediction or sentence

2158
00:48:37,270 --> 00:48:37,280
sentence prediction or sentence
 

2159
00:48:37,280 --> 00:48:40,150
sentence prediction or sentence
adjacency prediction. So what bird does

2160
00:48:40,150 --> 00:48:40,160
adjacency prediction. So what bird does
 

2161
00:48:40,160 --> 00:48:42,630
adjacency prediction. So what bird does
or what bird did is that you have your

2162
00:48:42,630 --> 00:48:42,640
or what bird did is that you have your
 

2163
00:48:42,640 --> 00:48:45,349
or what bird did is that you have your
you have your training data and I have

2164
00:48:45,349 --> 00:48:45,359
you have your training data and I have
 

2165
00:48:45,359 --> 00:48:48,150
you have your training data and I have
my stacks and stacks of sentences. I

2166
00:48:48,150 --> 00:48:48,160
my stacks and stacks of sentences. I
 

2167
00:48:48,160 --> 00:48:51,750
my stacks and stacks of sentences. I
take them and I mask 15% of the words in

2168
00:48:51,750 --> 00:48:51,760
take them and I mask 15% of the words in
 

2169
00:48:51,760 --> 00:48:55,430
take them and I mask 15% of the words in
this. Then what I do is for some other

2170
00:48:55,430 --> 00:48:55,440
this. Then what I do is for some other
 

2171
00:48:55,440 --> 00:48:59,030
this. Then what I do is for some other
small fraction of sentences I swap the

2172
00:48:59,030 --> 00:48:59,040
small fraction of sentences I swap the
 

2173
00:48:59,040 --> 00:49:02,710
small fraction of sentences I swap the
order of the sentences. Okay? Because

2174
00:49:02,710 --> 00:49:02,720
order of the sentences. Okay? Because
 

2175
00:49:02,720 --> 00:49:05,510
order of the sentences. Okay? Because
what I want Bert to learn is I also want

2176
00:49:05,510 --> 00:49:05,520
what I want Bert to learn is I also want
 

2177
00:49:05,520 --> 00:49:08,870
what I want Bert to learn is I also want
Bert to learn that there is a natural

2178
00:49:08,870 --> 00:49:08,880
Bert to learn that there is a natural
 

2179
00:49:08,880 --> 00:49:11,109
Bert to learn that there is a natural
order to sentences you know like some

2180
00:49:11,109 --> 00:49:11,119
order to sentences you know like some
 

2181
00:49:11,119 --> 00:49:15,270
order to sentences you know like some
things you know uh some things come

2182
00:49:15,270 --> 00:49:15,280
things you know uh some things come
 

2183
00:49:15,280 --> 00:49:16,870
things you know uh some things come
after

2184
00:49:16,870 --> 00:49:16,880
after
 

2185
00:49:16,880 --> 00:49:20,150
after
other kinds of things you know

2186
00:49:20,150 --> 00:49:20,160
other kinds of things you know
 

2187
00:49:20,160 --> 00:49:22,309
other kinds of things you know
so for example

2188
00:49:22,309 --> 00:49:22,319
so for example
 

2189
00:49:22,319 --> 00:49:24,150
so for example
um what what we'll do is that there's

2190
00:49:24,150 --> 00:49:24,160
um what what we'll do is that there's
 

2191
00:49:24,160 --> 00:49:26,950
um what what we'll do is that there's
sentence A sep

2192
00:49:26,950 --> 00:49:26,960
sentence A sep
 

2193
00:49:26,960 --> 00:49:29,670
sentence A sep
might be the natural the real order of

2194
00:49:29,670 --> 00:49:29,680
might be the natural the real order of
 

2195
00:49:29,680 --> 00:49:32,549
might be the natural the real order of
how the text is written but Instead,

2196
00:49:32,549 --> 00:49:32,559
how the text is written but Instead,
 

2197
00:49:32,559 --> 00:49:34,390
how the text is written but Instead,
what we will have is we will swap the

2198
00:49:34,390 --> 00:49:34,400
what we will have is we will swap the
 

2199
00:49:34,400 --> 00:49:37,349
what we will have is we will swap the
order and then what BERT or what the

2200
00:49:37,349 --> 00:49:37,359
order and then what BERT or what the
 

2201
00:49:37,359 --> 00:49:39,510
order and then what BERT or what the
model is trained to do is on that

2202
00:49:39,510 --> 00:49:39,520
model is trained to do is on that
 

2203
00:49:39,520 --> 00:49:41,829
model is trained to do is on that
separator token, it predicts if these

2204
00:49:41,829 --> 00:49:41,839
separator token, it predicts if these
 

2205
00:49:41,839 --> 00:49:44,069
separator token, it predicts if these
sentences are in the correct order or if

2206
00:49:44,069 --> 00:49:44,079
sentences are in the correct order or if
 

2207
00:49:44,079 --> 00:49:46,710
sentences are in the correct order or if
they're in the wrong order.

2208
00:49:46,710 --> 00:49:46,720
they're in the wrong order.
 

2209
00:49:46,720 --> 00:49:48,870
they're in the wrong order.
Okay,

2210
00:49:48,870 --> 00:49:48,880
Okay,
 

2211
00:49:48,880 --> 00:49:51,829
Okay,
it turns out that this that's how BERT

2212
00:49:51,829 --> 00:49:51,839
it turns out that this that's how BERT
 

2213
00:49:51,839 --> 00:49:53,430
it turns out that this that's how BERT
was trained. It turns out that this

2214
00:49:53,430 --> 00:49:53,440
was trained. It turns out that this
 

2215
00:49:53,440 --> 00:49:55,190
was trained. It turns out that this
sentence order doesn't seem to actually

2216
00:49:55,190 --> 00:49:55,200
sentence order doesn't seem to actually
 

2217
00:49:55,200 --> 00:49:57,430
sentence order doesn't seem to actually
matter and subsequent versions uh of

2218
00:49:57,430 --> 00:49:57,440
matter and subsequent versions uh of
 

2219
00:49:57,440 --> 00:49:59,430
matter and subsequent versions uh of
these encoder only models don't

2220
00:49:59,430 --> 00:49:59,440
these encoder only models don't
 

2221
00:49:59,440 --> 00:50:01,670
these encoder only models don't
necessarily always use this loss but

2222
00:50:01,670 --> 00:50:01,680
necessarily always use this loss but
 

2223
00:50:01,680 --> 00:50:03,430
necessarily always use this loss but
that is how it was historically trained

2224
00:50:03,430 --> 00:50:03,440
that is how it was historically trained
 

2225
00:50:03,440 --> 00:50:05,430
that is how it was historically trained
because they saw in that model it

2226
00:50:05,430 --> 00:50:05,440
because they saw in that model it
 

2227
00:50:05,440 --> 00:50:07,270
because they saw in that model it
actually did make a difference.

2228
00:50:07,270 --> 00:50:07,280
actually did make a difference.
 

2229
00:50:07,280 --> 00:50:08,710
actually did make a difference.
>> Yes.

2230
00:50:08,710 --> 00:50:08,720
>> Yes.
 

2231
00:50:08,720 --> 00:50:11,829
>> Yes.
>> Do they predict like all the mass tokens

2232
00:50:11,829 --> 00:50:11,839
>> Do they predict like all the mass tokens
 

2233
00:50:11,839 --> 00:50:14,230
>> Do they predict like all the mass tokens
in one shot or they predict them mass

2234
00:50:14,230 --> 00:50:14,240
in one shot or they predict them mass
 

2235
00:50:14,240 --> 00:50:16,950
in one shot or they predict them mass
tokens like token by token?

2236
00:50:16,950 --> 00:50:16,960
tokens like token by token?
 

2237
00:50:16,960 --> 00:50:19,430
tokens like token by token?
um you predict them in one shot

2238
00:50:19,430 --> 00:50:19,440
um you predict them in one shot
 

2239
00:50:19,440 --> 00:50:21,750
um you predict them in one shot
essentially you because this is all

2240
00:50:21,750 --> 00:50:21,760
essentially you because this is all
 

2241
00:50:21,760 --> 00:50:24,950
essentially you because this is all
happening in parallel.

2242
00:50:24,950 --> 00:50:24,960
happening in parallel.
 

2243
00:50:24,960 --> 00:50:28,069
happening in parallel.
Yeah. So on the mask tokens basically

2244
00:50:28,069 --> 00:50:28,079
Yeah. So on the mask tokens basically
 

2245
00:50:28,079 --> 00:50:30,630
Yeah. So on the mask tokens basically
everywhere here where there's a mask

2246
00:50:30,630 --> 00:50:30,640
everywhere here where there's a mask
 

2247
00:50:30,640 --> 00:50:32,150
everywhere here where there's a mask
you're predicting the probability of the

2248
00:50:32,150 --> 00:50:32,160
you're predicting the probability of the
 

2249
00:50:32,160 --> 00:50:34,630
you're predicting the probability of the
mask token. But let's say one of these

2250
00:50:34,630 --> 00:50:34,640
mask token. But let's say one of these
 

2251
00:50:34,640 --> 00:50:37,990
mask token. But let's say one of these
inputs was a

2252
00:50:37,990 --> 00:50:38,000
inputs was a
 

2253
00:50:38,000 --> 00:50:40,470
inputs was a
se right this ended the station. The

2254
00:50:40,470 --> 00:50:40,480
se right this ended the station. The
 

2255
00:50:40,480 --> 00:50:41,910
se right this ended the station. The
mass pulled into the station and then

2256
00:50:41,910 --> 00:50:41,920
mass pulled into the station and then
 

2257
00:50:41,920 --> 00:50:43,510
mass pulled into the station and then
there was a period. So there was a se

2258
00:50:43,510 --> 00:50:43,520
there was a period. So there was a se
 

2259
00:50:43,520 --> 00:50:46,069
there was a period. So there was a se
here and then a next new sentence

2260
00:50:46,069 --> 00:50:46,079
here and then a next new sentence
 

2261
00:50:46,079 --> 00:50:48,870
here and then a next new sentence
started here. On top of this separator

2262
00:50:48,870 --> 00:50:48,880
started here. On top of this separator
 

2263
00:50:48,880 --> 00:50:52,790
started here. On top of this separator
you would look at um this sentence and

2264
00:50:52,790 --> 00:50:52,800
you would look at um this sentence and
 

2265
00:50:52,800 --> 00:50:54,390
you would look at um this sentence and
the next sentence and you would say are

2266
00:50:54,390 --> 00:50:54,400
the next sentence and you would say are
 

2267
00:50:54,400 --> 00:50:55,910
the next sentence and you would say are
these in the correct order or have these

2268
00:50:55,910 --> 00:50:55,920
these in the correct order or have these
 

2269
00:50:55,920 --> 00:50:58,549
these in the correct order or have these
been swapped?

2270
00:50:58,549 --> 00:50:58,559
been swapped?
 

2271
00:50:58,559 --> 00:50:59,750
been swapped?
Make sense?

2272
00:50:59,750 --> 00:50:59,760
Make sense?
 

2273
00:50:59,760 --> 00:51:02,950
Make sense?
>> Can we only just understand like as a

2274
00:51:02,950 --> 00:51:02,960
>> Can we only just understand like as a
 

2275
00:51:02,960 --> 00:51:07,829
>> Can we only just understand like as a
data version of GBT?

2276
00:51:07,829 --> 00:51:07,839
data version of GBT?
 

2277
00:51:07,839 --> 00:51:09,990
data version of GBT?
>> No it is not. It is fundamentally

2278
00:51:09,990 --> 00:51:10,000
>> No it is not. It is fundamentally
 

2279
00:51:10,000 --> 00:51:13,270
>> No it is not. It is fundamentally
different in two ways. One is that there

2280
00:51:13,270 --> 00:51:13,280
different in two ways. One is that there
 

2281
00:51:13,280 --> 00:51:17,349
different in two ways. One is that there
is no auto reggressiveness here. Second,

2282
00:51:17,349 --> 00:51:17,359
is no auto reggressiveness here. Second,
 

2283
00:51:17,359 --> 00:51:20,630
is no auto reggressiveness here. Second,
it is not using causal self attention.

2284
00:51:20,630 --> 00:51:20,640
it is not using causal self attention.
 

2285
00:51:20,640 --> 00:51:23,270
it is not using causal self attention.
It is using necessarily

2286
00:51:23,270 --> 00:51:23,280
It is using necessarily
 

2287
00:51:23,280 --> 00:51:25,030
It is using necessarily
like full self attention, right? It's

2288
00:51:25,030 --> 00:51:25,040
like full self attention, right? It's
 

2289
00:51:25,040 --> 00:51:28,790
like full self attention, right? It's
looking at the past and the future.

2290
00:51:28,790 --> 00:51:28,800
looking at the past and the future.
 

2291
00:51:28,800 --> 00:51:30,230
looking at the past and the future.
>> So yes, there's a transformer

2292
00:51:30,230 --> 00:51:30,240
>> So yes, there's a transformer
 

2293
00:51:30,240 --> 00:51:32,390
>> So yes, there's a transformer
architecture, but

2294
00:51:32,390 --> 00:51:32,400
architecture, but
 

2295
00:51:32,400 --> 00:51:33,190
architecture, but
>> yes,

2296
00:51:33,190 --> 00:51:33,200
>> yes,
 

2297
00:51:33,200 --> 00:51:36,309
>> yes,
>> uh you say we predict the masks all at

2298
00:51:36,309 --> 00:51:36,319
>> uh you say we predict the masks all at
 

2299
00:51:36,319 --> 00:51:39,349
>> uh you say we predict the masks all at
the same time, right? So would it how

2300
00:51:39,349 --> 00:51:39,359
the same time, right? So would it how
 

2301
00:51:39,359 --> 00:51:41,349
the same time, right? So would it how
different would it be if we predict some

2302
00:51:41,349 --> 00:51:41,359
different would it be if we predict some
 

2303
00:51:41,359 --> 00:51:44,470
different would it be if we predict some
of the mask and use it as input again so

2304
00:51:44,470 --> 00:51:44,480
of the mask and use it as input again so
 

2305
00:51:44,480 --> 00:51:46,470
of the mask and use it as input again so
we have a more complete synthesis and

2306
00:51:46,470 --> 00:51:46,480
we have a more complete synthesis and
 

2307
00:51:46,480 --> 00:51:49,270
we have a more complete synthesis and
then predict the rest of the mass

2308
00:51:49,270 --> 00:51:49,280
then predict the rest of the mass
 

2309
00:51:49,280 --> 00:51:50,790
then predict the rest of the mass
>> you could you could do that and that

2310
00:51:50,790 --> 00:51:50,800
>> you could you could do that and that
 

2311
00:51:50,800 --> 00:51:53,270
>> you could you could do that and that
would be more like a decoder style uh

2312
00:51:53,270 --> 00:51:53,280
would be more like a decoder style uh
 

2313
00:51:53,280 --> 00:51:57,589
would be more like a decoder style uh
architecture that is not what BERT did.

2314
00:51:57,589 --> 00:51:57,599
architecture that is not what BERT did.
 

2315
00:51:57,599 --> 00:51:58,230
architecture that is not what BERT did.
>> Yes.

2316
00:51:58,230 --> 00:51:58,240
>> Yes.
 

2317
00:51:58,240 --> 00:52:01,589
>> Yes.
>> So how exactly do you test bird whether

2318
00:52:01,589 --> 00:52:01,599
>> So how exactly do you test bird whether
 

2319
00:52:01,599 --> 00:52:03,349
>> So how exactly do you test bird whether
or not the next sentence was the same or

2320
00:52:03,349 --> 00:52:03,359
or not the next sentence was the same or
 

2321
00:52:03,359 --> 00:52:04,870
or not the next sentence was the same or
not? Like does it have a token that it

2322
00:52:04,870 --> 00:52:04,880
not? Like does it have a token that it
 

2323
00:52:04,880 --> 00:52:07,109
not? Like does it have a token that it
sets to one or zero? So you basically

2324
00:52:07,109 --> 00:52:07,119
sets to one or zero? So you basically
 

2325
00:52:07,119 --> 00:52:09,190
sets to one or zero? So you basically
have you have the ground truth, right? I

2326
00:52:09,190 --> 00:52:09,200
have you have the ground truth, right? I
 

2327
00:52:09,200 --> 00:52:11,030
have you have the ground truth, right? I
have I'm looking at Shakespeare. I know

2328
00:52:11,030 --> 00:52:11,040
have I'm looking at Shakespeare. I know
 

2329
00:52:11,040 --> 00:52:14,549
have I'm looking at Shakespeare. I know
which sentence came first. Just in my it

2330
00:52:14,549 --> 00:52:14,559
which sentence came first. Just in my it
 

2331
00:52:14,559 --> 00:52:17,510
which sentence came first. Just in my it
uh in my input to the to BERT, I have

2332
00:52:17,510 --> 00:52:17,520
uh in my input to the to BERT, I have
 

2333
00:52:17,520 --> 00:52:19,430
uh in my input to the to BERT, I have
switched them. So then I can I can

2334
00:52:19,430 --> 00:52:19,440
switched them. So then I can I can
 

2335
00:52:19,440 --> 00:52:21,510
switched them. So then I can I can
compute the loss on that token.

2336
00:52:21,510 --> 00:52:21,520
compute the loss on that token.
 

2337
00:52:21,520 --> 00:52:23,270
compute the loss on that token.
>> Does BERT have like a token that it

2338
00:52:23,270 --> 00:52:23,280
>> Does BERT have like a token that it
 

2339
00:52:23,280 --> 00:52:25,109
>> Does BERT have like a token that it
outputs then that says whether or not it

2340
00:52:25,109 --> 00:52:25,119
outputs then that says whether or not it
 

2341
00:52:25,119 --> 00:52:26,790
outputs then that says whether or not it
can switch or what does it output?

2342
00:52:26,790 --> 00:52:26,800
can switch or what does it output?
 

2343
00:52:26,800 --> 00:52:28,390
can switch or what does it output?
>> No, you're just computing a loss on that

2344
00:52:28,390 --> 00:52:28,400
>> No, you're just computing a loss on that
 

2345
00:52:28,400 --> 00:52:31,109
>> No, you're just computing a loss on that
SE sept token. So you know you know what

2346
00:52:31,109 --> 00:52:31,119
SE sept token. So you know you know what
 

2347
00:52:31,119 --> 00:52:33,270
SE sept token. So you know you know what
the like you say zero if it's in the

2348
00:52:33,270 --> 00:52:33,280
the like you say zero if it's in the
 

2349
00:52:33,280 --> 00:52:34,710
the like you say zero if it's in the
correct order and one if it's flipped

2350
00:52:34,710 --> 00:52:34,720
correct order and one if it's flipped
 

2351
00:52:34,720 --> 00:52:36,230
correct order and one if it's flipped
and so you know whether what what it

2352
00:52:36,230 --> 00:52:36,240
and so you know whether what what it
 

2353
00:52:36,240 --> 00:52:38,390
and so you know whether what what it
should be and so you again you can

2354
00:52:38,390 --> 00:52:38,400
should be and so you again you can
 

2355
00:52:38,400 --> 00:52:42,710
should be and so you again you can
comput a cross entropy loss on that.

2356
00:52:42,710 --> 00:52:42,720
comput a cross entropy loss on that.
 

2357
00:52:42,720 --> 00:52:44,630
comput a cross entropy loss on that.
>> Yes. I'm not sure if the question really

2358
00:52:44,630 --> 00:52:44,640
>> Yes. I'm not sure if the question really
 

2359
00:52:44,640 --> 00:52:47,109
>> Yes. I'm not sure if the question really
makes sense, but like when we have like

2360
00:52:47,109 --> 00:52:47,119
makes sense, but like when we have like
 

2361
00:52:47,119 --> 00:52:49,349
makes sense, but like when we have like
with the auto encoder of having both

2362
00:52:49,349 --> 00:52:49,359
with the auto encoder of having both
 

2363
00:52:49,359 --> 00:52:51,430
with the auto encoder of having both
encoding and decoding, but now we're

2364
00:52:51,430 --> 00:52:51,440
encoding and decoding, but now we're
 

2365
00:52:51,440 --> 00:52:53,349
encoding and decoding, but now we're
kind of like separating it, right? Like

2366
00:52:53,349 --> 00:52:53,359
kind of like separating it, right? Like
 

2367
00:52:53,359 --> 00:52:55,349
kind of like separating it, right? Like
is I was wondering if you could explain

2368
00:52:55,349 --> 00:52:55,359
is I was wondering if you could explain
 

2369
00:52:55,359 --> 00:52:56,630
is I was wondering if you could explain
more about the difference of talking

2370
00:52:56,630 --> 00:52:56,640
more about the difference of talking
 

2371
00:52:56,640 --> 00:52:58,710
more about the difference of talking
about training loss based on both the

2372
00:52:58,710 --> 00:52:58,720
about training loss based on both the
 

2373
00:52:58,720 --> 00:53:00,470
about training loss based on both the
encoding and decoding which is like one

2374
00:53:00,470 --> 00:53:00,480
encoding and decoding which is like one
 

2375
00:53:00,480 --> 00:53:01,349
encoding and decoding which is like one
at a time.

2376
00:53:01,349 --> 00:53:01,359
at a time.
 

2377
00:53:01,359 --> 00:53:03,109
at a time.
>> So these are all different kinds of

2378
00:53:03,109 --> 00:53:03,119
>> So these are all different kinds of
 

2379
00:53:03,119 --> 00:53:05,589
>> So these are all different kinds of
tasks, right? The encoder decoder

2380
00:53:05,589 --> 00:53:05,599
tasks, right? The encoder decoder
 

2381
00:53:05,599 --> 00:53:09,190
tasks, right? The encoder decoder
architecture was for a translation task.

2382
00:53:09,190 --> 00:53:09,200
architecture was for a translation task.
 

2383
00:53:09,200 --> 00:53:12,790
architecture was for a translation task.
BERT is used for just understanding

2384
00:53:12,790 --> 00:53:12,800
BERT is used for just understanding
 

2385
00:53:12,800 --> 00:53:14,630
BERT is used for just understanding
something about language so that we can

2386
00:53:14,630 --> 00:53:14,640
something about language so that we can
 

2387
00:53:14,640 --> 00:53:16,309
something about language so that we can
take language convert it into these

2388
00:53:16,309 --> 00:53:16,319
take language convert it into these
 

2389
00:53:16,319 --> 00:53:18,549
take language convert it into these
useful vectors and then use these

2390
00:53:18,549 --> 00:53:18,559
useful vectors and then use these
 

2391
00:53:18,559 --> 00:53:20,309
useful vectors and then use these
embeddings for doing some other

2392
00:53:20,309 --> 00:53:20,319
embeddings for doing some other
 

2393
00:53:20,319 --> 00:53:23,109
embeddings for doing some other
downstream task. So for example, so

2394
00:53:23,109 --> 00:53:23,119
downstream task. So for example, so
 

2395
00:53:23,119 --> 00:53:25,030
downstream task. So for example, so
BERT, what they call it BERT, you don't

2396
00:53:25,030 --> 00:53:25,040
BERT, what they call it BERT, you don't
 

2397
00:53:25,040 --> 00:53:25,990
BERT, what they call it BERT, you don't
say you're training Bert, you're

2398
00:53:25,990 --> 00:53:26,000
say you're training Bert, you're
 

2399
00:53:26,000 --> 00:53:27,829
say you're training Bert, you're
pre-training BERT and then you fine-tune

2400
00:53:27,829 --> 00:53:27,839
pre-training BERT and then you fine-tune
 

2401
00:53:27,839 --> 00:53:32,069
pre-training BERT and then you fine-tune
BERT to do your particular task. And for

2402
00:53:32,069 --> 00:53:32,079
BERT to do your particular task. And for
 

2403
00:53:32,079 --> 00:53:33,430
BERT to do your particular task. And for
that fine-tuning, you will take

2404
00:53:33,430 --> 00:53:33,440
that fine-tuning, you will take
 

2405
00:53:33,440 --> 00:53:36,470
that fine-tuning, you will take
embeddings that BERT has generated. And

2406
00:53:36,470 --> 00:53:36,480
embeddings that BERT has generated. And
 

2407
00:53:36,480 --> 00:53:37,910
embeddings that BERT has generated. And
you could take the embeddings from the

2408
00:53:37,910 --> 00:53:37,920
you could take the embeddings from the
 

2409
00:53:37,920 --> 00:53:38,870
you could take the embeddings from the
last layer. Sometimes you take

2410
00:53:38,870 --> 00:53:38,880
last layer. Sometimes you take
 

2411
00:53:38,880 --> 00:53:41,190
last layer. Sometimes you take
embeddings from some other layer. But

2412
00:53:41,190 --> 00:53:41,200
embeddings from some other layer. But
 

2413
00:53:41,200 --> 00:53:42,549
embeddings from some other layer. But
what you're doing is you're saying like,

2414
00:53:42,549 --> 00:53:42,559
what you're doing is you're saying like,
 

2415
00:53:42,559 --> 00:53:44,470
what you're doing is you're saying like,
okay, now I have let's say I want to do

2416
00:53:44,470 --> 00:53:44,480
okay, now I have let's say I want to do
 

2417
00:53:44,480 --> 00:53:48,470
okay, now I have let's say I want to do
a sentiment analysis kind of task. Okay.

2418
00:53:48,470 --> 00:53:48,480
a sentiment analysis kind of task. Okay.
 

2419
00:53:48,480 --> 00:53:50,069
a sentiment analysis kind of task. Okay.
So here the example, this is all from

2420
00:53:50,069 --> 00:53:50,079
So here the example, this is all from
 

2421
00:53:50,079 --> 00:53:54,069
So here the example, this is all from
Prince. I have the sentence here.

2422
00:53:54,069 --> 00:53:54,079
Prince. I have the sentence here.
 

2423
00:53:54,079 --> 00:53:56,549
Prince. I have the sentence here.
The soup tasted like socks. Okay. And I

2424
00:53:56,549 --> 00:53:56,559
The soup tasted like socks. Okay. And I
 

2425
00:53:56,559 --> 00:53:58,470
The soup tasted like socks. Okay. And I
want to now understand is this a

2426
00:53:58,470 --> 00:53:58,480
want to now understand is this a
 

2427
00:53:58,480 --> 00:54:00,230
want to now understand is this a
positive restaurant review or is this a

2428
00:54:00,230 --> 00:54:00,240
positive restaurant review or is this a
 

2429
00:54:00,240 --> 00:54:04,309
positive restaurant review or is this a
negative restaurant review. Okay. So the

2430
00:54:04,309 --> 00:54:04,319
negative restaurant review. Okay. So the
 

2431
00:54:04,319 --> 00:54:06,390
negative restaurant review. Okay. So the
way that this will be done is that you

2432
00:54:06,390 --> 00:54:06,400
way that this will be done is that you
 

2433
00:54:06,400 --> 00:54:10,870
way that this will be done is that you
will use this CLS token and on this CLS

2434
00:54:10,870 --> 00:54:10,880
will use this CLS token and on this CLS
 

2435
00:54:10,880 --> 00:54:14,710
will use this CLS token and on this CLS
token you will predict whether or the

2436
00:54:14,710 --> 00:54:14,720
token you will predict whether or the
 

2437
00:54:14,720 --> 00:54:16,230
token you will predict whether or the
review is positive or you'll predict the

2438
00:54:16,230 --> 00:54:16,240
review is positive or you'll predict the
 

2439
00:54:16,240 --> 00:54:17,910
review is positive or you'll predict the
probability of whether this review is a

2440
00:54:17,910 --> 00:54:17,920
probability of whether this review is a
 

2441
00:54:17,920 --> 00:54:20,069
probability of whether this review is a
positive review or a negative review.

2442
00:54:20,069 --> 00:54:20,079
positive review or a negative review.
 

2443
00:54:20,079 --> 00:54:23,910
positive review or a negative review.
And so you will take the embeddings from

2444
00:54:23,910 --> 00:54:23,920
And so you will take the embeddings from
 

2445
00:54:23,920 --> 00:54:30,230
And so you will take the embeddings from
BERT and then further you know add a um

2446
00:54:30,230 --> 00:54:30,240
BERT and then further you know add a um
 

2447
00:54:30,240 --> 00:54:31,829
BERT and then further you know add a um
maybe it's a feed forward layer forward

2448
00:54:31,829 --> 00:54:31,839
maybe it's a feed forward layer forward
 

2449
00:54:31,839 --> 00:54:33,750
maybe it's a feed forward layer forward
layer maybe it's a linear layer whatever

2450
00:54:33,750 --> 00:54:33,760
layer maybe it's a linear layer whatever
 

2451
00:54:33,760 --> 00:54:36,710
layer maybe it's a linear layer whatever
you want and train that to use those

2452
00:54:36,710 --> 00:54:36,720
you want and train that to use those
 

2453
00:54:36,720 --> 00:54:38,230
you want and train that to use those
embeddings

2454
00:54:38,230 --> 00:54:38,240
embeddings
 

2455
00:54:38,240 --> 00:54:41,430
embeddings
and learn whatever task you want to do.

2456
00:54:41,430 --> 00:54:41,440
and learn whatever task you want to do.
 

2457
00:54:41,440 --> 00:54:44,710
and learn whatever task you want to do.
So, another example of uh a task that

2458
00:54:44,710 --> 00:54:44,720
So, another example of uh a task that
 

2459
00:54:44,720 --> 00:54:46,630
So, another example of uh a task that
you might want to use bird embeddings to

2460
00:54:46,630 --> 00:54:46,640
you might want to use bird embeddings to
 

2461
00:54:46,640 --> 00:54:48,950
you might want to use bird embeddings to
do is something like,

2462
00:54:48,950 --> 00:54:48,960
do is something like,
 

2463
00:54:48,960 --> 00:54:52,069
do is something like,
you know, here uh Zara works at uh

2464
00:54:52,069 --> 00:54:52,079
you know, here uh Zara works at uh
 

2465
00:54:52,079 --> 00:54:54,390
you know, here uh Zara works at uh
Chanel in Victoria.

2466
00:54:54,390 --> 00:54:54,400
Chanel in Victoria.
 

2467
00:54:54,400 --> 00:54:56,950
Chanel in Victoria.
So, I want to figure out what type of

2468
00:54:56,950 --> 00:54:56,960
So, I want to figure out what type of
 

2469
00:54:56,960 --> 00:54:58,309
So, I want to figure out what type of
word this is. I want to understand this

2470
00:54:58,309 --> 00:54:58,319
word this is. I want to understand this
 

2471
00:54:58,319 --> 00:55:01,589
word this is. I want to understand this
is a proper noun. This is a verb. Um and

2472
00:55:01,589 --> 00:55:01,599
is a proper noun. This is a verb. Um and
 

2473
00:55:01,599 --> 00:55:03,750
is a proper noun. This is a verb. Um and
I want to understand what entity this

2474
00:55:03,750 --> 00:55:03,760
I want to understand what entity this
 

2475
00:55:03,760 --> 00:55:05,190
I want to understand what entity this
is. I want to understand that this is a

2476
00:55:05,190 --> 00:55:05,200
is. I want to understand that this is a
 

2477
00:55:05,200 --> 00:55:08,230
is. I want to understand that this is a
city or this is a place. And so what I

2478
00:55:08,230 --> 00:55:08,240
city or this is a place. And so what I
 

2479
00:55:08,240 --> 00:55:10,630
city or this is a place. And so what I
can do is again I can fine-tune this so

2480
00:55:10,630 --> 00:55:10,640
can do is again I can fine-tune this so
 

2481
00:55:10,640 --> 00:55:13,910
can do is again I can fine-tune this so
that on each of these I learn to predict

2482
00:55:13,910 --> 00:55:13,920
that on each of these I learn to predict
 

2483
00:55:13,920 --> 00:55:16,069
that on each of these I learn to predict
the probability of the entity type.

2484
00:55:16,069 --> 00:55:16,079
the probability of the entity type.
 

2485
00:55:16,079 --> 00:55:18,150
the probability of the entity type.
Okay. So these are just two examples of

2486
00:55:18,150 --> 00:55:18,160
Okay. So these are just two examples of
 

2487
00:55:18,160 --> 00:55:19,589
Okay. So these are just two examples of
many different things that you can do

2488
00:55:19,589 --> 00:55:19,599
many different things that you can do
 

2489
00:55:19,599 --> 00:55:22,950
many different things that you can do
downstream from the BERT encodings.

2490
00:55:22,950 --> 00:55:22,960
downstream from the BERT encodings.
 

2491
00:55:22,960 --> 00:55:25,190
downstream from the BERT encodings.
That's why it's an encoder only. It's

2492
00:55:25,190 --> 00:55:25,200
That's why it's an encoder only. It's
 

2493
00:55:25,200 --> 00:55:27,910
That's why it's an encoder only. It's
not meant for it's giving you an

2494
00:55:27,910 --> 00:55:27,920
not meant for it's giving you an
 

2495
00:55:27,920 --> 00:55:29,589
not meant for it's giving you an
encoding that is useful for you to then

2496
00:55:29,589 --> 00:55:29,599
encoding that is useful for you to then
 

2497
00:55:29,599 --> 00:55:31,750
encoding that is useful for you to then
do other things.

2498
00:55:31,750 --> 00:55:31,760
do other things.
 

2499
00:55:31,760 --> 00:55:36,870
do other things.
Does that help?

2500
00:55:36,870 --> 00:55:36,880

 

2501
00:55:36,880 --> 00:55:40,390

Whereas GPT kind of will it just

2502
00:55:40,390 --> 00:55:40,400
Whereas GPT kind of will it just
 

2503
00:55:40,400 --> 00:55:43,990
Whereas GPT kind of will it just
generates stuff for you. There's no

2504
00:55:43,990 --> 00:55:44,000
generates stuff for you. There's no
 

2505
00:55:44,000 --> 00:55:45,430
generates stuff for you. There's no
add-on that you're going to add on to

2506
00:55:45,430 --> 00:55:45,440
add-on that you're going to add on to
 

2507
00:55:45,440 --> 00:55:51,990
add-on that you're going to add on to
it. It is complete in one in that sense.

2508
00:55:51,990 --> 00:55:52,000

 

2509
00:55:52,000 --> 00:55:55,990

Okay.

2510
00:55:55,990 --> 00:55:56,000

 

2511
00:55:56,000 --> 00:56:00,150

Other questions?

2512
00:56:00,150 --> 00:56:00,160

 

2513
00:56:00,160 --> 00:56:03,270

>> Yes. Uh so the star token is uh I think

2514
00:56:03,270 --> 00:56:03,280
>> Yes. Uh so the star token is uh I think
 

2515
00:56:03,280 --> 00:56:06,069
>> Yes. Uh so the star token is uh I think
it's it's wrong because in the class

2516
00:56:06,069 --> 00:56:06,079
it's it's wrong because in the class
 

2517
00:56:06,079 --> 00:56:10,789
it's it's wrong because in the class
token it contains the information.

2518
00:56:10,789 --> 00:56:10,799
token it contains the information.
 

2519
00:56:10,799 --> 00:56:12,470
token it contains the information.
>> I'm not sure I understand.

2520
00:56:12,470 --> 00:56:12,480
>> I'm not sure I understand.
 

2521
00:56:12,480 --> 00:56:15,829
>> I'm not sure I understand.
>> Oh I mean the last slide you said the

2522
00:56:15,829 --> 00:56:15,839
>> Oh I mean the last slide you said the
 

2523
00:56:15,839 --> 00:56:19,030
>> Oh I mean the last slide you said the
class token is the start token. I mean

2524
00:56:19,030 --> 00:56:19,040
class token is the start token. I mean
 

2525
00:56:19,040 --> 00:56:20,630
class token is the start token. I mean
it's it's saying that this is the start

2526
00:56:20,630 --> 00:56:20,640
it's it's saying that this is the start
 

2527
00:56:20,640 --> 00:56:23,670
it's it's saying that this is the start
of a new like you know if I'm if I'm

2528
00:56:23,670 --> 00:56:23,680
of a new like you know if I'm if I'm
 

2529
00:56:23,680 --> 00:56:27,030
of a new like you know if I'm if I'm
somehow chunking my

2530
00:56:27,030 --> 00:56:27,040
somehow chunking my
 

2531
00:56:27,040 --> 00:56:29,190
somehow chunking my
input into this is one group of things

2532
00:56:29,190 --> 00:56:29,200
input into this is one group of things
 

2533
00:56:29,200 --> 00:56:30,150
input into this is one group of things
next group of things next group of

2534
00:56:30,150 --> 00:56:30,160
next group of things next group of
 

2535
00:56:30,160 --> 00:56:31,829
next group of things next group of
things each of these so for example if

2536
00:56:31,829 --> 00:56:31,839
things each of these so for example if
 

2537
00:56:31,839 --> 00:56:33,270
things each of these so for example if
I'm going to do a downstream

2538
00:56:33,270 --> 00:56:33,280
I'm going to do a downstream
 

2539
00:56:33,280 --> 00:56:37,109
I'm going to do a downstream
classification task um these clss are

2540
00:56:37,109 --> 00:56:37,119
classification task um these clss are
 

2541
00:56:37,119 --> 00:56:40,630
classification task um these clss are
telling me what is my sentence

2542
00:56:40,630 --> 00:56:40,640
telling me what is my sentence
 

2543
00:56:40,640 --> 00:56:43,190
telling me what is my sentence
so clss are can can be between things

2544
00:56:43,190 --> 00:56:43,200
so clss are can can be between things
 

2545
00:56:43,200 --> 00:56:45,750
so clss are can can be between things
that are bigger than sentences they may

2546
00:56:45,750 --> 00:56:45,760
that are bigger than sentences they may
 

2547
00:56:45,760 --> 00:56:47,349
that are bigger than sentences they may
not be bigger than sentences but they

2548
00:56:47,349 --> 00:56:47,359
not be bigger than sentences but they
 

2549
00:56:47,359 --> 00:56:50,390
not be bigger than sentences but they
could be bigger than sentences.

2550
00:56:50,390 --> 00:56:50,400
could be bigger than sentences.
 

2551
00:56:50,400 --> 00:56:50,789
could be bigger than sentences.
>> Yes,

2552
00:56:50,789 --> 00:56:50,799
>> Yes,
 

2553
00:56:50,799 --> 00:56:52,150
>> Yes,
>> we're talking about CLS is we're not

2554
00:56:52,150 --> 00:56:52,160
>> we're talking about CLS is we're not
 

2555
00:56:52,160 --> 00:56:53,910
>> we're talking about CLS is we're not
referring to the input character. We're

2556
00:56:53,910 --> 00:56:53,920
referring to the input character. We're
 

2557
00:56:53,920 --> 00:56:55,589
referring to the input character. We're
referring to like the embedding of the

2558
00:56:55,589 --> 00:56:55,599
referring to like the embedding of the
 

2559
00:56:55,599 --> 00:56:57,589
referring to like the embedding of the
CLS character.

2560
00:56:57,589 --> 00:56:57,599
CLS character.
 

2561
00:56:57,599 --> 00:56:59,190
CLS character.
>> Is that what it's giving us our actual

2562
00:56:59,190 --> 00:56:59,200
>> Is that what it's giving us our actual
 

2563
00:56:59,200 --> 00:57:01,750
>> Is that what it's giving us our actual
like classification or decision

2564
00:57:01,750 --> 00:57:01,760
like classification or decision
 

2565
00:57:01,760 --> 00:57:02,710
like classification or decision
information?

2566
00:57:02,710 --> 00:57:02,720
information?
 

2567
00:57:02,720 --> 00:57:04,630
information?
>> So we will have the input embedding of

2568
00:57:04,630 --> 00:57:04,640
>> So we will have the input embedding of
 

2569
00:57:04,640 --> 00:57:05,990
>> So we will have the input embedding of
the CLS character which will just be

2570
00:57:05,990 --> 00:57:06,000
the CLS character which will just be
 

2571
00:57:06,000 --> 00:57:08,230
the CLS character which will just be
some learned embedding of that CLS

2572
00:57:08,230 --> 00:57:08,240
some learned embedding of that CLS
 

2573
00:57:08,240 --> 00:57:10,069
some learned embedding of that CLS
token.

2574
00:57:10,069 --> 00:57:10,079
token.
 

2575
00:57:10,079 --> 00:57:14,150
token.
But then when we are training the loss

2576
00:57:14,150 --> 00:57:14,160
But then when we are training the loss
 

2577
00:57:14,160 --> 00:57:15,510
But then when we are training the loss
we will look at if we're trying to

2578
00:57:15,510 --> 00:57:15,520
we will look at if we're trying to
 

2579
00:57:15,520 --> 00:57:17,430
we will look at if we're trying to
predict like if we're sorry when we're

2580
00:57:17,430 --> 00:57:17,440
predict like if we're sorry when we're
 

2581
00:57:17,440 --> 00:57:19,589
predict like if we're sorry when we're
fine-tuning if we're trying to predict

2582
00:57:19,589 --> 00:57:19,599
fine-tuning if we're trying to predict
 

2583
00:57:19,599 --> 00:57:22,950
fine-tuning if we're trying to predict
whether this is positive or negative we

2584
00:57:22,950 --> 00:57:22,960
whether this is positive or negative we
 

2585
00:57:22,960 --> 00:57:26,710
whether this is positive or negative we
will compute a loss on the

2586
00:57:26,710 --> 00:57:26,720
will compute a loss on the
 

2587
00:57:26,720 --> 00:57:31,109
will compute a loss on the
output corresponding to the CLS token

2588
00:57:31,109 --> 00:57:31,119
output corresponding to the CLS token
 

2589
00:57:31,119 --> 00:57:33,750
output corresponding to the CLS token
on whether the probability of the review

2590
00:57:33,750 --> 00:57:33,760
on whether the probability of the review
 

2591
00:57:33,760 --> 00:57:36,470
on whether the probability of the review
or was the review positive or negative

2592
00:57:36,470 --> 00:57:36,480
or was the review positive or negative
 

2593
00:57:36,480 --> 00:57:38,870
or was the review positive or negative
make sense?

2594
00:57:38,870 --> 00:57:38,880
make sense?
 

2595
00:57:38,880 --> 00:57:39,829
make sense?
Yes.

2596
00:57:39,829 --> 00:57:39,839
Yes.
 

2597
00:57:39,839 --> 00:57:42,870
Yes.
>> Generally, do we train BERT like one for

2598
00:57:42,870 --> 00:57:42,880
>> Generally, do we train BERT like one for
 

2599
00:57:42,880 --> 00:57:45,510
>> Generally, do we train BERT like one for
the class level prediction, one for the

2600
00:57:45,510 --> 00:57:45,520
the class level prediction, one for the
 

2601
00:57:45,520 --> 00:57:47,430
the class level prediction, one for the
word level prediction or do we just

2602
00:57:47,430 --> 00:57:47,440
word level prediction or do we just
 

2603
00:57:47,440 --> 00:57:49,030
word level prediction or do we just
train B once and we use it for

2604
00:57:49,030 --> 00:57:49,040
train B once and we use it for
 

2605
00:57:49,040 --> 00:57:51,510
train B once and we use it for
>> So, you train BERT once and you don't

2606
00:57:51,510 --> 00:57:51,520
>> So, you train BERT once and you don't
 

2607
00:57:51,520 --> 00:57:54,390
>> So, you train BERT once and you don't
use the CLS token when you're training,

2608
00:57:54,390 --> 00:57:54,400
use the CLS token when you're training,
 

2609
00:57:54,400 --> 00:57:57,430
use the CLS token when you're training,
right? When you're fine-tuning, you will

2610
00:57:57,430 --> 00:57:57,440
right? When you're fine-tuning, you will
 

2611
00:57:57,440 --> 00:58:00,549
right? When you're fine-tuning, you will
then fine-tune it to do

2612
00:58:00,549 --> 00:58:00,559
then fine-tune it to do
 

2613
00:58:00,559 --> 00:58:04,950
then fine-tune it to do
sentiment analysis or to do uh entity

2614
00:58:04,950 --> 00:58:04,960
sentiment analysis or to do uh entity
 

2615
00:58:04,960 --> 00:58:06,870
sentiment analysis or to do uh entity
type prediction and so on and so forth.

2616
00:58:06,870 --> 00:58:06,880
type prediction and so on and so forth.
 

2617
00:58:06,880 --> 00:58:10,710
type prediction and so on and so forth.
I guess maybe clarif

2618
00:58:10,710 --> 00:58:10,720

 

2619
00:58:10,720 --> 00:58:12,789

do we tend to fine-tune two separate

2620
00:58:12,789 --> 00:58:12,799
do we tend to fine-tune two separate
 

2621
00:58:12,799 --> 00:58:16,069
do we tend to fine-tune two separate
models or does fine-tuning to make a

2622
00:58:16,069 --> 00:58:16,079
models or does fine-tuning to make a
 

2623
00:58:16,079 --> 00:58:17,990
models or does fine-tuning to make a
good prediction on the sentence level

2624
00:58:17,990 --> 00:58:18,000
good prediction on the sentence level
 

2625
00:58:18,000 --> 00:58:19,750
good prediction on the sentence level
for a positive review generally also

2626
00:58:19,750 --> 00:58:19,760
for a positive review generally also
 

2627
00:58:19,760 --> 00:58:21,910
for a positive review generally also
mean it also does a good job um

2628
00:58:21,910 --> 00:58:21,920
mean it also does a good job um
 

2629
00:58:21,920 --> 00:58:23,750
mean it also does a good job um
producing like word level

2630
00:58:23,750 --> 00:58:23,760
producing like word level
 

2631
00:58:23,760 --> 00:58:25,030
producing like word level
>> no you would do separate these are

2632
00:58:25,030 --> 00:58:25,040
>> no you would do separate these are
 

2633
00:58:25,040 --> 00:58:26,470
>> no you would do separate these are
separate fine tunes you will not do them

2634
00:58:26,470 --> 00:58:26,480
separate fine tunes you will not do them
 

2635
00:58:26,480 --> 00:58:32,230
separate fine tunes you will not do them
together that you yeah

2636
00:58:32,230 --> 00:58:32,240

 

2637
00:58:32,240 --> 00:58:33,030

>> yes

2638
00:58:33,030 --> 00:58:33,040
>> yes
 

2639
00:58:33,040 --> 00:58:35,829
>> yes
>> so the set token isn't actually is it

2640
00:58:35,829 --> 00:58:35,839
>> so the set token isn't actually is it
 

2641
00:58:35,839 --> 00:58:37,990
>> so the set token isn't actually is it
replacing punctuation or is the

2642
00:58:37,990 --> 00:58:38,000
replacing punctuation or is the
 

2643
00:58:38,000 --> 00:58:39,510
replacing punctuation or is the
punctuation remain in the tokens

2644
00:58:39,510 --> 00:58:39,520
punctuation remain in the tokens
 

2645
00:58:39,520 --> 00:58:40,069
punctuation remain in the tokens
themselves?

2646
00:58:40,069 --> 00:58:40,079
themselves?
 

2647
00:58:40,079 --> 00:58:42,390
themselves?
>> Punctuation remains in the tokens. This

2648
00:58:42,390 --> 00:58:42,400
>> Punctuation remains in the tokens. This
 

2649
00:58:42,400 --> 00:58:43,510
>> Punctuation remains in the tokens. This
is in addition.

2650
00:58:43,510 --> 00:58:43,520
is in addition.
 

2651
00:58:43,520 --> 00:58:46,870
is in addition.
>> Okay.

2652
00:58:46,870 --> 00:58:46,880

 

2653
00:58:46,880 --> 00:58:49,270

>> Yeah. Because punctuation could like

2654
00:58:49,270 --> 00:58:49,280
>> Yeah. Because punctuation could like
 

2655
00:58:49,280 --> 00:58:50,230
>> Yeah. Because punctuation could like
there could be a question mark that

2656
00:58:50,230 --> 00:58:50,240
there could be a question mark that
 

2657
00:58:50,240 --> 00:58:51,510
there could be a question mark that
could appear. You can't replace all of

2658
00:58:51,510 --> 00:58:51,520
could appear. You can't replace all of
 

2659
00:58:51,520 --> 00:58:53,349
could appear. You can't replace all of
that with

2660
00:58:53,349 --> 00:58:53,359
that with
 

2661
00:58:53,359 --> 00:58:55,670
that with
sets.

2662
00:58:55,670 --> 00:58:55,680
sets.
 

2663
00:58:55,680 --> 00:58:59,750
sets.
Okay. Okay. So now

2664
00:58:59,750 --> 00:58:59,760
Okay. Okay. So now
 

2665
00:58:59,760 --> 00:59:02,069
Okay. Okay. So now
um I want to tell you about one more

2666
00:59:02,069 --> 00:59:02,079
um I want to tell you about one more
 

2667
00:59:02,079 --> 00:59:03,349
um I want to tell you about one more
thing that's different. Now this is

2668
00:59:03,349 --> 00:59:03,359
thing that's different. Now this is
 

2669
00:59:03,359 --> 00:59:04,950
thing that's different. Now this is
completely switching gears. not talking

2670
00:59:04,950 --> 00:59:04,960
completely switching gears. not talking
 

2671
00:59:04,960 --> 00:59:08,789
completely switching gears. not talking
about um

2672
00:59:08,789 --> 00:59:08,799

 

2673
00:59:08,799 --> 00:59:10,870

transformers

2674
00:59:10,870 --> 00:59:10,880
transformers
 

2675
00:59:10,880 --> 00:59:14,069
transformers
for a little bit but if you remember

2676
00:59:14,069 --> 00:59:14,079
for a little bit but if you remember
 

2677
00:59:14,079 --> 00:59:16,390
for a little bit but if you remember
when we talked about mamba right and

2678
00:59:16,390 --> 00:59:16,400
when we talked about mamba right and
 

2679
00:59:16,400 --> 00:59:19,270
when we talked about mamba right and
state space models I showed this picture

2680
00:59:19,270 --> 00:59:19,280
state space models I showed this picture
 

2681
00:59:19,280 --> 00:59:23,190
state space models I showed this picture
everyone remember that and um I wanted

2682
00:59:23,190 --> 00:59:23,200
everyone remember that and um I wanted
 

2683
00:59:23,200 --> 00:59:25,109
everyone remember that and um I wanted
you to ignore this part of it then and I

2684
00:59:25,109 --> 00:59:25,119
you to ignore this part of it then and I
 

2685
00:59:25,119 --> 00:59:26,470
you to ignore this part of it then and I
still want you to ignore this but now

2686
00:59:26,470 --> 00:59:26,480
still want you to ignore this but now
 

2687
00:59:26,480 --> 00:59:33,711
still want you to ignore this but now
what I want to focus on is this chunk

2688
00:59:33,711 --> 00:59:33,721

 

2689
00:59:33,721 --> 00:59:36,549

>> [snorts]

2690
00:59:36,549 --> 00:59:36,559

 

2691
00:59:36,559 --> 00:59:40,789

>> Okay, this block and what is this gated

2692
00:59:40,789 --> 00:59:40,799
>> Okay, this block and what is this gated
 

2693
00:59:40,799 --> 00:59:44,150
>> Okay, this block and what is this gated
uh linear unit? Okay, so gated linear

2694
00:59:44,150 --> 00:59:44,160
uh linear unit? Okay, so gated linear
 

2695
00:59:44,160 --> 00:59:46,630
uh linear unit? Okay, so gated linear
units are things that are often now

2696
00:59:46,630 --> 00:59:46,640
units are things that are often now
 

2697
00:59:46,640 --> 00:59:51,670
units are things that are often now
being used to replace or instead of the

2698
00:59:51,670 --> 00:59:51,680
being used to replace or instead of the
 

2699
00:59:51,680 --> 00:59:54,789
being used to replace or instead of the
MLP feed forward layer that comes after

2700
00:59:54,789 --> 00:59:54,799
MLP feed forward layer that comes after
 

2701
00:59:54,799 --> 00:59:59,030
MLP feed forward layer that comes after
attention. Okay. And it's a simple idea.

2702
00:59:59,030 --> 00:59:59,040
attention. Okay. And it's a simple idea.
 

2703
00:59:59,040 --> 01:00:02,150
attention. Okay. And it's a simple idea.
It's basically saying

2704
01:00:02,150 --> 01:00:02,160
It's basically saying
 

2705
01:00:02,160 --> 01:00:04,950
It's basically saying
that whatever your input is, put it

2706
01:00:04,950 --> 01:00:04,960
that whatever your input is, put it
 

2707
01:00:04,960 --> 01:00:09,430
that whatever your input is, put it
through two linear layers. Okay?

2708
01:00:09,430 --> 01:00:09,440
through two linear layers. Okay?
 

2709
01:00:09,440 --> 01:00:11,589
through two linear layers. Okay?
Then put one of those through a

2710
01:00:11,589 --> 01:00:11,599
Then put one of those through a
 

2711
01:00:11,599 --> 01:00:14,069
Then put one of those through a
nonlinearity.

2712
01:00:14,069 --> 01:00:14,079
nonlinearity.
 

2713
01:00:14,079 --> 01:00:16,549
nonlinearity.
Take the product of them and then put

2714
01:00:16,549 --> 01:00:16,559
Take the product of them and then put
 

2715
01:00:16,559 --> 01:00:18,789
Take the product of them and then put
that through a linear layer. And because

2716
01:00:18,789 --> 01:00:18,799
that through a linear layer. And because
 

2717
01:00:18,799 --> 01:00:20,870
that through a linear layer. And because
you're taking the product of two things,

2718
01:00:20,870 --> 01:00:20,880
you're taking the product of two things,
 

2719
01:00:20,880 --> 01:00:21,990
you're taking the product of two things,
one of which you're putting through a

2720
01:00:21,990 --> 01:00:22,000
one of which you're putting through a
 

2721
01:00:22,000 --> 01:00:24,789
one of which you're putting through a
nonlinearity, it's called a gating

2722
01:00:24,789 --> 01:00:24,799
nonlinearity, it's called a gating
 

2723
01:00:24,799 --> 01:00:27,670
nonlinearity, it's called a gating
because this is gating. Basically this

2724
01:00:27,670 --> 01:00:27,680
because this is gating. Basically this
 

2725
01:00:27,680 --> 01:00:29,190
because this is gating. Basically this
might set a bunch of things to zero for

2726
01:00:29,190 --> 01:00:29,200
might set a bunch of things to zero for
 

2727
01:00:29,200 --> 01:00:31,109
might set a bunch of things to zero for
example if it was irrelevant right so

2728
01:00:31,109 --> 01:00:31,119
example if it was irrelevant right so
 

2729
01:00:31,119 --> 01:00:34,390
example if it was irrelevant right so
this multiplication is this gating and

2730
01:00:34,390 --> 01:00:34,400
this multiplication is this gating and
 

2731
01:00:34,400 --> 01:00:37,589
this multiplication is this gating and
so this is called a gated MLP okay so

2732
01:00:37,589 --> 01:00:37,599
so this is called a gated MLP okay so
 

2733
01:00:37,599 --> 01:00:40,309
so this is called a gated MLP okay so
this is instead of a fully connected

2734
01:00:40,309 --> 01:00:40,319
this is instead of a fully connected
 

2735
01:00:40,319 --> 01:00:43,750
this is instead of a fully connected
feed forward layer and so in mamba for

2736
01:00:43,750 --> 01:00:43,760
feed forward layer and so in mamba for
 

2737
01:00:43,760 --> 01:00:47,430
feed forward layer and so in mamba for
example we had this uh linear layer then

2738
01:00:47,430 --> 01:00:47,440
example we had this uh linear layer then
 

2739
01:00:47,440 --> 01:00:49,990
example we had this uh linear layer then
there was a small convolution then there

2740
01:00:49,990 --> 01:00:50,000
there was a small convolution then there
 

2741
01:00:50,000 --> 01:00:52,230
there was a small convolution then there
was nonlinearity then you had your uh

2742
01:00:52,230 --> 01:00:52,240
was nonlinearity then you had your uh
 

2743
01:00:52,240 --> 01:00:56,230
was nonlinearity then you had your uh
state space model and there was this

2744
01:00:56,230 --> 01:00:56,240
state space model and there was this
 

2745
01:00:56,240 --> 01:00:58,230
state space model and there was this
gating ing essentially where you had

2746
01:00:58,230 --> 01:00:58,240
gating ing essentially where you had
 

2747
01:00:58,240 --> 01:01:00,150
gating ing essentially where you had
this the same input going through

2748
01:01:00,150 --> 01:01:00,160
this the same input going through
 

2749
01:01:00,160 --> 01:01:01,990
this the same input going through
another linear layer going through a

2750
01:01:01,990 --> 01:01:02,000
another linear layer going through a
 

2751
01:01:02,000 --> 01:01:04,069
another linear layer going through a
nonlinearity and then you take the

2752
01:01:04,069 --> 01:01:04,079
nonlinearity and then you take the
 

2753
01:01:04,079 --> 01:01:07,030
nonlinearity and then you take the
product of these two things before going

2754
01:01:07,030 --> 01:01:07,040
product of these two things before going
 

2755
01:01:07,040 --> 01:01:09,829
product of these two things before going
to the output. Okay. So, and you notice

2756
01:01:09,829 --> 01:01:09,839
to the output. Okay. So, and you notice
 

2757
01:01:09,839 --> 01:01:13,109
to the output. Okay. So, and you notice
here there's no uh I don't have an MLP

2758
01:01:13,109 --> 01:01:13,119
here there's no uh I don't have an MLP
 

2759
01:01:13,119 --> 01:01:14,789
here there's no uh I don't have an MLP
that the output of this SSM is going

2760
01:01:14,789 --> 01:01:14,799
that the output of this SSM is going
 

2761
01:01:14,799 --> 01:01:17,910
that the output of this SSM is going
into. Instead, I have this connection

2762
01:01:17,910 --> 01:01:17,920
into. Instead, I have this connection
 

2763
01:01:17,920 --> 01:01:22,789
into. Instead, I have this connection
here. Okay? And this is what is called a

2764
01:01:22,789 --> 01:01:22,799
here. Okay? And this is what is called a
 

2765
01:01:22,799 --> 01:01:26,390
here. Okay? And this is what is called a
uh a gating

2766
01:01:26,390 --> 01:01:26,400
uh a gating
 

2767
01:01:26,400 --> 01:01:27,750
uh a gating
And so there's many different

2768
01:01:27,750 --> 01:01:27,760
And so there's many different
 

2769
01:01:27,760 --> 01:01:29,910
And so there's many different
nonlinearities that that can be used

2770
01:01:29,910 --> 01:01:29,920
nonlinearities that that can be used
 

2771
01:01:29,920 --> 01:01:31,829
nonlinearities that that can be used
here. You can use your favorite

2772
01:01:31,829 --> 01:01:31,839
here. You can use your favorite
 

2773
01:01:31,839 --> 01:01:33,510
here. You can use your favorite
nonlinearity, but there's a couple of

2774
01:01:33,510 --> 01:01:33,520
nonlinearity, but there's a couple of
 

2775
01:01:33,520 --> 01:01:36,630
nonlinearity, but there's a couple of
different ones that have kind of

2776
01:01:36,630 --> 01:01:36,640
different ones that have kind of
 

2777
01:01:36,640 --> 01:01:38,309
different ones that have kind of
um

2778
01:01:38,309 --> 01:01:38,319
um
 

2779
01:01:38,319 --> 01:01:41,109
um
become popular or useful. So a gated

2780
01:01:41,109 --> 01:01:41,119
become popular or useful. So a gated
 

2781
01:01:41,119 --> 01:01:43,190
become popular or useful. So a gated
linear unit when it was the kind of when

2782
01:01:43,190 --> 01:01:43,200
linear unit when it was the kind of when
 

2783
01:01:43,200 --> 01:01:44,710
linear unit when it was the kind of when
you think of gated linear unit, it's

2784
01:01:44,710 --> 01:01:44,720
you think of gated linear unit, it's
 

2785
01:01:44,720 --> 01:01:46,549
you think of gated linear unit, it's
classically defined as the following. So

2786
01:01:46,549 --> 01:01:46,559
classically defined as the following. So
 

2787
01:01:46,559 --> 01:01:48,549
classically defined as the following. So
I have this linear layer. So x is my

2788
01:01:48,549 --> 01:01:48,559
I have this linear layer. So x is my
 

2789
01:01:48,559 --> 01:01:51,030
I have this linear layer. So x is my
input and so I take a linear layer which

2790
01:01:51,030 --> 01:01:51,040
input and so I take a linear layer which
 

2791
01:01:51,040 --> 01:01:54,309
input and so I take a linear layer which
is just wx plus b. And I have this other

2792
01:01:54,309 --> 01:01:54,319
is just wx plus b. And I have this other
 

2793
01:01:54,319 --> 01:01:58,230
is just wx plus b. And I have this other
linear layer which is just vx plus c.

2794
01:01:58,230 --> 01:01:58,240
linear layer which is just vx plus c.
 

2795
01:01:58,240 --> 01:01:59,589
linear layer which is just vx plus c.
One of them I pass through a

2796
01:01:59,589 --> 01:01:59,599
One of them I pass through a
 

2797
01:01:59,599 --> 01:02:01,990
One of them I pass through a
nonlinearity for a gated linear unit.

2798
01:02:01,990 --> 01:02:02,000
nonlinearity for a gated linear unit.
 

2799
01:02:02,000 --> 01:02:03,589
nonlinearity for a gated linear unit.
That nonlinearity happens to be a

2800
01:02:03,589 --> 01:02:03,599
That nonlinearity happens to be a
 

2801
01:02:03,599 --> 01:02:05,190
That nonlinearity happens to be a
sigmoid. And then I take a product of

2802
01:02:05,190 --> 01:02:05,200
sigmoid. And then I take a product of
 

2803
01:02:05,200 --> 01:02:08,710
sigmoid. And then I take a product of
these two things. Right? So

2804
01:02:08,710 --> 01:02:08,720
these two things. Right? So
 

2805
01:02:08,720 --> 01:02:11,670
these two things. Right? So
this is one path. This is the other path

2806
01:02:11,670 --> 01:02:11,680
this is one path. This is the other path
 

2807
01:02:11,680 --> 01:02:13,190
this is one path. This is the other path
and then I take this product here. And

2808
01:02:13,190 --> 01:02:13,200
and then I take this product here. And
 

2809
01:02:13,200 --> 01:02:16,789
and then I take this product here. And
that is what a gated linear unit is.

2810
01:02:16,789 --> 01:02:16,799
that is what a gated linear unit is.
 

2811
01:02:16,799 --> 01:02:17,990
that is what a gated linear unit is.
Since then there have been many

2812
01:02:17,990 --> 01:02:18,000
Since then there have been many
 

2813
01:02:18,000 --> 01:02:19,829
Since then there have been many
evolutions on kind of how to choose

2814
01:02:19,829 --> 01:02:19,839
evolutions on kind of how to choose
 

2815
01:02:19,839 --> 01:02:22,069
evolutions on kind of how to choose
which nonlinearity this is. One

2816
01:02:22,069 --> 01:02:22,079
which nonlinearity this is. One
 

2817
01:02:22,079 --> 01:02:24,630
which nonlinearity this is. One
nonlinearity that is popular these days

2818
01:02:24,630 --> 01:02:24,640
nonlinearity that is popular these days
 

2819
01:02:24,640 --> 01:02:28,630
nonlinearity that is popular these days
is what is called the u swish

2820
01:02:28,630 --> 01:02:28,640
is what is called the u swish
 

2821
01:02:28,640 --> 01:02:31,990
is what is called the u swish
nonlinearity which leads to the swigloo

2822
01:02:31,990 --> 01:02:32,000
nonlinearity which leads to the swigloo
 

2823
01:02:32,000 --> 01:02:35,109
nonlinearity which leads to the swigloo
unit. Okay. So it's swish plus glu is

2824
01:02:35,109 --> 01:02:35,119
unit. Okay. So it's swish plus glu is
 

2825
01:02:35,119 --> 01:02:37,349
unit. Okay. So it's swish plus glu is
swigloo.

2826
01:02:37,349 --> 01:02:37,359
swigloo.
 

2827
01:02:37,359 --> 01:02:41,030
swigloo.
Swish is basically saying let me take x

2828
01:02:41,030 --> 01:02:41,040
Swish is basically saying let me take x
 

2829
01:02:41,040 --> 01:02:44,230
Swish is basically saying let me take x
time sigmoid of beta x where this beta

2830
01:02:44,230 --> 01:02:44,240
time sigmoid of beta x where this beta
 

2831
01:02:44,240 --> 01:02:46,950
time sigmoid of beta x where this beta
is now a learnable parameter.

2832
01:02:46,950 --> 01:02:46,960
is now a learnable parameter.
 

2833
01:02:46,960 --> 01:02:49,750
is now a learnable parameter.
Okay. Um,

2834
01:02:49,750 --> 01:02:49,760
Okay. Um,
 

2835
01:02:49,760 --> 01:02:51,510
Okay. Um,
and one of the nice things about this

2836
01:02:51,510 --> 01:02:51,520
and one of the nice things about this
 

2837
01:02:51,520 --> 01:02:53,349
and one of the nice things about this
swish is that it looks kind of like a

2838
01:02:53,349 --> 01:02:53,359
swish is that it looks kind of like a
 

2839
01:02:53,359 --> 01:02:57,030
swish is that it looks kind of like a
relu, but it doesn't have the sharp

2840
01:02:57,030 --> 01:02:57,040
relu, but it doesn't have the sharp
 

2841
01:02:57,040 --> 01:02:59,589
relu, but it doesn't have the sharp
elbow at zero. And so it looks kind of

2842
01:02:59,589 --> 01:02:59,599
elbow at zero. And so it looks kind of
 

2843
01:02:59,599 --> 01:03:02,549
elbow at zero. And so it looks kind of
like

2844
01:03:02,549 --> 01:03:02,559
like
 

2845
01:03:02,559 --> 01:03:11,589
like
um

2846
01:03:11,589 --> 01:03:11,599

 

2847
01:03:11,599 --> 01:03:17,589

and it looks something like this.

2848
01:03:17,589 --> 01:03:17,599

 

2849
01:03:17,599 --> 01:03:21,670

My drawing is not so good. Um, sorry, I

2850
01:03:21,670 --> 01:03:21,680
My drawing is not so good. Um, sorry, I
 

2851
01:03:21,680 --> 01:03:24,390
My drawing is not so good. Um, sorry, I
forgot to put a picture of this up, but

2852
01:03:24,390 --> 01:03:24,400
forgot to put a picture of this up, but
 

2853
01:03:24,400 --> 01:03:26,309
forgot to put a picture of this up, but
if we have time at the end, I'll pull

2854
01:03:26,309 --> 01:03:26,319
if we have time at the end, I'll pull
 

2855
01:03:26,319 --> 01:03:27,750
if we have time at the end, I'll pull
up. There's this really nice blog post

2856
01:03:27,750 --> 01:03:27,760
up. There's this really nice blog post
 

2857
01:03:27,760 --> 01:03:29,589
up. There's this really nice blog post
about this that actually I can show if

2858
01:03:29,589 --> 01:03:29,599
about this that actually I can show if
 

2859
01:03:29,599 --> 01:03:31,910
about this that actually I can show if
we if we have time at the end. But so

2860
01:03:31,910 --> 01:03:31,920
we if we have time at the end. But so
 

2861
01:03:31,920 --> 01:03:33,990
we if we have time at the end. But so
it's like it's kind of like a relu. Um,

2862
01:03:33,990 --> 01:03:34,000
it's like it's kind of like a relu. Um,
 

2863
01:03:34,000 --> 01:03:36,069
it's like it's kind of like a relu. Um,
you know, it's it still has the x as x

2864
01:03:36,069 --> 01:03:36,079
you know, it's it still has the x as x
 

2865
01:03:36,079 --> 01:03:38,630
you know, it's it still has the x as x
goes to infinity, this goes to uh

2866
01:03:38,630 --> 01:03:38,640
goes to infinity, this goes to uh
 

2867
01:03:38,640 --> 01:03:40,150
goes to infinity, this goes to uh
infinity.

2868
01:03:40,150 --> 01:03:40,160
infinity.
 

2869
01:03:40,160 --> 01:03:44,950
infinity.
And this beta here, this is learnable.

2870
01:03:44,950 --> 01:03:44,960
And this beta here, this is learnable.
 

2871
01:03:44,960 --> 01:03:47,430
And this beta here, this is learnable.
And as beta changes basically if you

2872
01:03:47,430 --> 01:03:47,440
And as beta changes basically if you
 

2873
01:03:47,440 --> 01:03:50,789
And as beta changes basically if you
choose beta to be equal to u zero you're

2874
01:03:50,789 --> 01:03:50,799
choose beta to be equal to u zero you're
 

2875
01:03:50,799 --> 01:03:53,109
choose beta to be equal to u zero you're
just going to get a linear function

2876
01:03:53,109 --> 01:03:53,119
just going to get a linear function
 

2877
01:03:53,119 --> 01:03:56,390
just going to get a linear function
right and as beta grows uh you can make

2878
01:03:56,390 --> 01:03:56,400
right and as beta grows uh you can make
 

2879
01:03:56,400 --> 01:04:00,789
right and as beta grows uh you can make
this look like different shapes okay

2880
01:04:00,789 --> 01:04:00,799
this look like different shapes okay
 

2881
01:04:00,799 --> 01:04:03,270
this look like different shapes okay
so this is just a simp this is the idea

2882
01:04:03,270 --> 01:04:03,280
so this is just a simp this is the idea
 

2883
01:04:03,280 --> 01:04:05,349
so this is just a simp this is the idea
of a gated linear unit that I wanted to

2884
01:04:05,349 --> 01:04:05,359
of a gated linear unit that I wanted to
 

2885
01:04:05,359 --> 01:04:08,309
of a gated linear unit that I wanted to
bring up why do people well not people

2886
01:04:08,309 --> 01:04:08,319
bring up why do people well not people
 

2887
01:04:08,319 --> 01:04:12,710
bring up why do people well not people
but why do um

2888
01:04:12,710 --> 01:04:12,720
but why do um
 

2889
01:04:12,720 --> 01:04:16,309
but why do um
why do these work there's this paper uh

2890
01:04:16,309 --> 01:04:16,319
why do these work there's this paper uh
 

2891
01:04:16,319 --> 01:04:18,309
why do these work there's this paper uh
on exploring some of these

2892
01:04:18,309 --> 01:04:18,319
on exploring some of these
 

2893
01:04:18,319 --> 01:04:19,829
on exploring some of these
nonlinearities.

2894
01:04:19,829 --> 01:04:19,839
nonlinearities.
 

2895
01:04:19,839 --> 01:04:21,510
nonlinearities.
And actually, I think it's worth pulling

2896
01:04:21,510 --> 01:04:21,520
And actually, I think it's worth pulling
 

2897
01:04:21,520 --> 01:04:24,630
And actually, I think it's worth pulling
up this uh quote. Let me give me just

2898
01:04:24,630 --> 01:04:24,640
up this uh quote. Let me give me just
 

2899
01:04:24,640 --> 01:04:34,150
up this uh quote. Let me give me just
one minute to do this.

2900
01:04:34,150 --> 01:04:34,160

 

2901
01:04:34,160 --> 01:04:42,710

Uh I meant to copy it and I forgot.

2902
01:04:42,710 --> 01:04:42,720

 

2903
01:04:42,720 --> 01:04:44,230

Okay, so this is the last this is a

2904
01:04:44,230 --> 01:04:44,240
Okay, so this is the last this is a
 

2905
01:04:44,240 --> 01:04:48,470
Okay, so this is the last this is a
paper by Noam Shazir from Google

2906
01:04:48,470 --> 01:04:48,480
paper by Noam Shazir from Google
 

2907
01:04:48,480 --> 01:04:52,150
paper by Noam Shazir from Google
and the conclusions of this paper say

2908
01:04:52,150 --> 01:04:52,160
and the conclusions of this paper say
 

2909
01:04:52,160 --> 01:04:54,309
and the conclusions of this paper say
we offer no explanation as to why these

2910
01:04:54,309 --> 01:04:54,319
we offer no explanation as to why these
 

2911
01:04:54,319 --> 01:04:56,549
we offer no explanation as to why these
architectures seem to work. We attribute

2912
01:04:56,549 --> 01:04:56,559
architectures seem to work. We attribute
 

2913
01:04:56,559 --> 01:04:59,109
architectures seem to work. We attribute
their success as all else to divine

2914
01:04:59,109 --> 01:04:59,119
their success as all else to divine
 

2915
01:04:59,119 --> 01:05:01,829
their success as all else to divine
benevolence. [laughter]

2916
01:05:01,829 --> 01:05:01,839
benevolence. [laughter]
 

2917
01:05:01,839 --> 01:05:03,750
benevolence. [laughter]
Um

2918
01:05:03,750 --> 01:05:03,760
Um
 

2919
01:05:03,760 --> 01:05:05,910
Um
so that's just this is it's the last

2920
01:05:05,910 --> 01:05:05,920
so that's just this is it's the last
 

2921
01:05:05,920 --> 01:05:07,349
so that's just this is it's the last
sentence in the paper. It's a very

2922
01:05:07,349 --> 01:05:07,359
sentence in the paper. It's a very
 

2923
01:05:07,359 --> 01:05:09,430
sentence in the paper. It's a very
short, sweet, four-page paper that kind

2924
01:05:09,430 --> 01:05:09,440
short, sweet, four-page paper that kind
 

2925
01:05:09,440 --> 01:05:11,670
short, sweet, four-page paper that kind
of explores many different variations of

2926
01:05:11,670 --> 01:05:11,680
of explores many different variations of
 

2927
01:05:11,680 --> 01:05:13,270
of explores many different variations of
the nonlinearities on these and

2928
01:05:13,270 --> 01:05:13,280
the nonlinearities on these and
 

2929
01:05:13,280 --> 01:05:16,630
the nonlinearities on these and
concludes that the swigloop kind of

2930
01:05:16,630 --> 01:05:16,640
concludes that the swigloop kind of
 

2931
01:05:16,640 --> 01:05:19,430
concludes that the swigloop kind of
works the nicest.

2932
01:05:19,430 --> 01:05:19,440
works the nicest.
 

2933
01:05:19,440 --> 01:05:20,950
works the nicest.
Uh, and this has kind of become it's

2934
01:05:20,950 --> 01:05:20,960
Uh, and this has kind of become it's
 

2935
01:05:20,960 --> 01:05:23,510
Uh, and this has kind of become it's
become a sort of a meme uh within the

2936
01:05:23,510 --> 01:05:23,520
become a sort of a meme uh within the
 

2937
01:05:23,520 --> 01:05:25,349
become a sort of a meme uh within the
within the community. For example, I

2938
01:05:25,349 --> 01:05:25,359
within the community. For example, I
 

2939
01:05:25,359 --> 01:05:28,230
within the community. For example, I
think if you remember Muan

2940
01:05:28,230 --> 01:05:28,240
think if you remember Muan
 

2941
01:05:28,240 --> 01:05:31,349
think if you remember Muan
and the blog post of Muan that kind of

2942
01:05:31,349 --> 01:05:31,359
and the blog post of Muan that kind of
 

2943
01:05:31,359 --> 01:05:34,470
and the blog post of Muan that kind of
launched Muan quotes this article as

2944
01:05:34,470 --> 01:05:34,480
launched Muan quotes this article as
 

2945
01:05:34,480 --> 01:05:37,109
launched Muan quotes this article as
saying, you know, hey, I

2946
01:05:37,109 --> 01:05:37,119
saying, you know, hey, I
 

2947
01:05:37,119 --> 01:05:38,630
saying, you know, hey, I
yes, you came to this blog post to

2948
01:05:38,630 --> 01:05:38,640
yes, you came to this blog post to
 

2949
01:05:38,640 --> 01:05:41,190
yes, you came to this blog post to
understand why Muan works. But again,

2950
01:05:41,190 --> 01:05:41,200
understand why Muan works. But again,
 

2951
01:05:41,200 --> 01:05:43,029
understand why Muan works. But again,
remember that a sufficient explanation

2952
01:05:43,029 --> 01:05:43,039
remember that a sufficient explanation
 

2953
01:05:43,039 --> 01:05:46,150
remember that a sufficient explanation
would also be divine benevolence. Um, if

2954
01:05:46,150 --> 01:05:46,160
would also be divine benevolence. Um, if
 

2955
01:05:46,160 --> 01:05:47,750
would also be divine benevolence. Um, if
you if you go look up Keller Jordan's

2956
01:05:47,750 --> 01:05:47,760
you if you go look up Keller Jordan's
 

2957
01:05:47,760 --> 01:05:49,829
you if you go look up Keller Jordan's
blog post, he also he also quotes this.

2958
01:05:49,829 --> 01:05:49,839
blog post, he also he also quotes this.
 

2959
01:05:49,839 --> 01:05:52,150
blog post, he also he also quotes this.
So anyways, I thought that was worth u

2960
01:05:52,150 --> 01:05:52,160
So anyways, I thought that was worth u
 

2961
01:05:52,160 --> 01:05:53,750
So anyways, I thought that was worth u
worth reading out. So these work,

2962
01:05:53,750 --> 01:05:53,760
worth reading out. So these work,
 

2963
01:05:53,760 --> 01:05:55,910
worth reading out. So these work,
they're nice. But there is one intuition

2964
01:05:55,910 --> 01:05:55,920
they're nice. But there is one intuition
 

2965
01:05:55,920 --> 01:05:58,390
they're nice. But there is one intuition
for why they work. And a subsequent

2966
01:05:58,390 --> 01:05:58,400
for why they work. And a subsequent
 

2967
01:05:58,400 --> 01:06:00,870
for why they work. And a subsequent
paper found that actually instead of

2968
01:06:00,870 --> 01:06:00,880
paper found that actually instead of
 

2969
01:06:00,880 --> 01:06:03,829
paper found that actually instead of
looking at this gated linear unit, if

2970
01:06:03,829 --> 01:06:03,839
looking at this gated linear unit, if
 

2971
01:06:03,839 --> 01:06:07,270
looking at this gated linear unit, if
you look at a squared relu that allowed

2972
01:06:07,270 --> 01:06:07,280
you look at a squared relu that allowed
 

2973
01:06:07,280 --> 01:06:09,510
you look at a squared relu that allowed
you to do a basically peace-wise

2974
01:06:09,510 --> 01:06:09,520
you to do a basically peace-wise
 

2975
01:06:09,520 --> 01:06:11,990
you to do a basically peace-wise
quadratic interpolation instead of

2976
01:06:11,990 --> 01:06:12,000
quadratic interpolation instead of
 

2977
01:06:12,000 --> 01:06:14,710
quadratic interpolation instead of
peacewise linear interpolation

2978
01:06:14,710 --> 01:06:14,720
peacewise linear interpolation
 

2979
01:06:14,720 --> 01:06:17,670
peacewise linear interpolation
that can often perform just as well as

2980
01:06:17,670 --> 01:06:17,680
that can often perform just as well as
 

2981
01:06:17,680 --> 01:06:19,589
that can often perform just as well as
uh some of these things. One of the

2982
01:06:19,589 --> 01:06:19,599
uh some of these things. One of the
 

2983
01:06:19,599 --> 01:06:20,870
uh some of these things. One of the
things that you see with these gated

2984
01:06:20,870 --> 01:06:20,880
things that you see with these gated
 

2985
01:06:20,880 --> 01:06:22,630
things that you see with these gated
linear units is that they make doing

2986
01:06:22,630 --> 01:06:22,640
linear units is that they make doing
 

2987
01:06:22,640 --> 01:06:24,950
linear units is that they make doing
things like multiplication much easier

2988
01:06:24,950 --> 01:06:24,960
things like multiplication much easier
 

2989
01:06:24,960 --> 01:06:27,829
things like multiplication much easier
to do than with just simple values. And

2990
01:06:27,829 --> 01:06:27,839
to do than with just simple values. And
 

2991
01:06:27,839 --> 01:06:29,029
to do than with just simple values. And
so if you look at some of these papers,

2992
01:06:29,029 --> 01:06:29,039
so if you look at some of these papers,
 

2993
01:06:29,039 --> 01:06:31,829
so if you look at some of these papers,
there's some nice examples of how uh you

2994
01:06:31,829 --> 01:06:31,839
there's some nice examples of how uh you
 

2995
01:06:31,839 --> 01:06:35,109
there's some nice examples of how uh you
can easily get or more easily get

2996
01:06:35,109 --> 01:06:35,119
can easily get or more easily get
 

2997
01:06:35,119 --> 01:06:37,910
can easily get or more easily get
multiplication out of uh things like the

2998
01:06:37,910 --> 01:06:37,920
multiplication out of uh things like the
 

2999
01:06:37,920 --> 01:06:42,309
multiplication out of uh things like the
swigloop than you can with uh just

3000
01:06:42,309 --> 01:06:42,319
swigloop than you can with uh just
 

3001
01:06:42,319 --> 01:06:44,470
swigloop than you can with uh just
straight relu based nonlinearity uh

3002
01:06:44,470 --> 01:06:44,480
straight relu based nonlinearity uh
 

3003
01:06:44,480 --> 01:06:47,190
straight relu based nonlinearity uh
MLPS. Okay. So this peacewise

3004
01:06:47,190 --> 01:06:47,200
MLPS. Okay. So this peacewise
 

3005
01:06:47,200 --> 01:06:50,390
MLPS. Okay. So this peacewise
quadraticness offers some advantages and

3006
01:06:50,390 --> 01:06:50,400
quadraticness offers some advantages and
 

3007
01:06:50,400 --> 01:06:52,390
quadraticness offers some advantages and
that's one intuition for why these seem

3008
01:06:52,390 --> 01:06:52,400
that's one intuition for why these seem
 

3009
01:06:52,400 --> 01:06:54,230
that's one intuition for why these seem
to work better.

3010
01:06:54,230 --> 01:06:54,240
to work better.
 

3011
01:06:54,240 --> 01:06:57,270
to work better.
Okay, the last thing I want to touch

3012
01:06:57,270 --> 01:06:57,280
Okay, the last thing I want to touch
 

3013
01:06:57,280 --> 01:06:59,829
Okay, the last thing I want to touch
upon before we can get to understanding

3014
01:06:59,829 --> 01:06:59,839
upon before we can get to understanding
 

3015
01:06:59,839 --> 01:07:03,270
upon before we can get to understanding
this quen is

3016
01:07:03,270 --> 01:07:03,280
this quen is
 

3017
01:07:03,280 --> 01:07:05,750
this quen is
yet another architecture for what are

3018
01:07:05,750 --> 01:07:05,760
yet another architecture for what are
 

3019
01:07:05,760 --> 01:07:09,910
yet another architecture for what are
called mixture of experts models. Okay,

3020
01:07:09,910 --> 01:07:09,920
called mixture of experts models. Okay,
 

3021
01:07:09,920 --> 01:07:12,390
called mixture of experts models. Okay,
so the challenge is that you know MLPS

3022
01:07:12,390 --> 01:07:12,400
so the challenge is that you know MLPS
 

3023
01:07:12,400 --> 01:07:14,789
so the challenge is that you know MLPS
are great but they use a lot of

3024
01:07:14,789 --> 01:07:14,799
are great but they use a lot of
 

3025
01:07:14,799 --> 01:07:17,190
are great but they use a lot of
parameters and compute at inference time

3026
01:07:17,190 --> 01:07:17,200
parameters and compute at inference time
 

3027
01:07:17,200 --> 01:07:19,029
parameters and compute at inference time
right if I have these wide networks they

3028
01:07:19,029 --> 01:07:19,039
right if I have these wide networks they
 

3029
01:07:19,039 --> 01:07:21,510
right if I have these wide networks they
often like you go to 512 then you expand

3030
01:07:21,510 --> 01:07:21,520
often like you go to 512 then you expand
 

3031
01:07:21,520 --> 01:07:23,829
often like you go to 512 then you expand
by four then the number of hidden units

3032
01:07:23,829 --> 01:07:23,839
by four then the number of hidden units
 

3033
01:07:23,839 --> 01:07:25,190
by four then the number of hidden units
then you come back down so there's a

3034
01:07:25,190 --> 01:07:25,200
then you come back down so there's a
 

3035
01:07:25,200 --> 01:07:28,470
then you come back down so there's a
there's a lot of parameters uh a lot of

3036
01:07:28,470 --> 01:07:28,480
there's a lot of parameters uh a lot of
 

3037
01:07:28,480 --> 01:07:30,950
there's a lot of parameters uh a lot of
the parameters in the models are hidden

3038
01:07:30,950 --> 01:07:30,960
the parameters in the models are hidden
 

3039
01:07:30,960 --> 01:07:36,390
the parameters in the models are hidden
inside the MLP feed forward layers okay

3040
01:07:36,390 --> 01:07:36,400
inside the MLP feed forward layers okay
 

3041
01:07:36,400 --> 01:07:38,549
inside the MLP feed forward layers okay
so can we somehow

3042
01:07:38,549 --> 01:07:38,559
so can we somehow
 

3043
01:07:38,559 --> 01:07:43,270
so can we somehow
you know, do better by specialization is

3044
01:07:43,270 --> 01:07:43,280
you know, do better by specialization is
 

3045
01:07:43,280 --> 01:07:45,670
you know, do better by specialization is
the key idea of the mixture of experts

3046
01:07:45,670 --> 01:07:45,680
the key idea of the mixture of experts
 

3047
01:07:45,680 --> 01:07:48,309
the key idea of the mixture of experts
type of models. And these ideas have

3048
01:07:48,309 --> 01:07:48,319
type of models. And these ideas have
 

3049
01:07:48,319 --> 01:07:51,029
type of models. And these ideas have
been around in the community for quite a

3050
01:07:51,029 --> 01:07:51,039
been around in the community for quite a
 

3051
01:07:51,039 --> 01:07:55,029
been around in the community for quite a
while, but only recently have there been

3052
01:07:55,029 --> 01:07:55,039
while, but only recently have there been
 

3053
01:07:55,039 --> 01:07:58,230
while, but only recently have there been
tricks and optimizations for training

3054
01:07:58,230 --> 01:07:58,240
tricks and optimizations for training
 

3055
01:07:58,240 --> 01:08:01,430
tricks and optimizations for training
these mixture of expert models that make

3056
01:08:01,430 --> 01:08:01,440
these mixture of expert models that make
 

3057
01:08:01,440 --> 01:08:04,630
these mixture of expert models that make
them competitive with the standard dense

3058
01:08:04,630 --> 01:08:04,640
them competitive with the standard dense
 

3059
01:08:04,640 --> 01:08:06,789
them competitive with the standard dense
MLP models.

3060
01:08:06,789 --> 01:08:06,799
MLP models.
 

3061
01:08:06,799 --> 01:08:08,950
MLP models.
So the key idea of mixture of experts

3062
01:08:08,950 --> 01:08:08,960
So the key idea of mixture of experts
 

3063
01:08:08,960 --> 01:08:11,990
So the key idea of mixture of experts
models is to say that look for every

3064
01:08:11,990 --> 01:08:12,000
models is to say that look for every
 

3065
01:08:12,000 --> 01:08:15,430
models is to say that look for every
single token maybe I don't need to go

3066
01:08:15,430 --> 01:08:15,440
single token maybe I don't need to go
 

3067
01:08:15,440 --> 01:08:20,149
single token maybe I don't need to go
through activations for every single

3068
01:08:20,149 --> 01:08:20,159
through activations for every single
 

3069
01:08:20,159 --> 01:08:23,910
through activations for every single
uh unit in my MLP right maybe some

3070
01:08:23,910 --> 01:08:23,920
uh unit in my MLP right maybe some
 

3071
01:08:23,920 --> 01:08:26,390
uh unit in my MLP right maybe some
tokens can be processed some way and

3072
01:08:26,390 --> 01:08:26,400
tokens can be processed some way and
 

3073
01:08:26,400 --> 01:08:28,470
tokens can be processed some way and
other tokens can be processed other ways

3074
01:08:28,470 --> 01:08:28,480
other tokens can be processed other ways
 

3075
01:08:28,480 --> 01:08:31,430
other tokens can be processed other ways
and I can just keep parts huge parts of

3076
01:08:31,430 --> 01:08:31,440
and I can just keep parts huge parts of
 

3077
01:08:31,440 --> 01:08:34,950
and I can just keep parts huge parts of
my network quiet when processing certain

3078
01:08:34,950 --> 01:08:34,960
my network quiet when processing certain
 

3079
01:08:34,960 --> 01:08:37,030
my network quiet when processing certain
tokens right so there's the idea that

3080
01:08:37,030 --> 01:08:37,040
tokens right so there's the idea that
 

3081
01:08:37,040 --> 01:08:38,789
tokens right so there's the idea that
there might be some experts that can

3082
01:08:38,789 --> 01:08:38,799
there might be some experts that can
 

3083
01:08:38,799 --> 01:08:40,630
there might be some experts that can
deal with some tokens and other experts

3084
01:08:40,630 --> 01:08:40,640
deal with some tokens and other experts
 

3085
01:08:40,640 --> 01:08:43,510
deal with some tokens and other experts
that can deal with other tokens so that

3086
01:08:43,510 --> 01:08:43,520
that can deal with other tokens so that
 

3087
01:08:43,520 --> 01:08:47,510
that can deal with other tokens so that
I can not have to use all of my network

3088
01:08:47,510 --> 01:08:47,520
I can not have to use all of my network
 

3089
01:08:47,520 --> 01:08:49,829
I can not have to use all of my network
for processing every single token. Can I

3090
01:08:49,829 --> 01:08:49,839
for processing every single token. Can I
 

3091
01:08:49,839 --> 01:08:53,510
for processing every single token. Can I
somehow efficiently route my tokens to

3092
01:08:53,510 --> 01:08:53,520
somehow efficiently route my tokens to
 

3093
01:08:53,520 --> 01:08:56,229
somehow efficiently route my tokens to
the right part of the network? And these

3094
01:08:56,229 --> 01:08:56,239
the right part of the network? And these
 

3095
01:08:56,239 --> 01:08:57,910
the right part of the network? And these
right parts of the network were thought

3096
01:08:57,910 --> 01:08:57,920
right parts of the network were thought
 

3097
01:08:57,920 --> 01:08:59,910
right parts of the network were thought
of as different experts. That's kind of

3098
01:08:59,910 --> 01:08:59,920
of as different experts. That's kind of
 

3099
01:08:59,920 --> 01:09:03,030
of as different experts. That's kind of
the key idea.

3100
01:09:03,030 --> 01:09:03,040
the key idea.
 

3101
01:09:03,040 --> 01:09:05,189
the key idea.
And so I'll show you pictures from kind

3102
01:09:05,189 --> 01:09:05,199
And so I'll show you pictures from kind
 

3103
01:09:05,199 --> 01:09:10,309
And so I'll show you pictures from kind
of two key papers in this in this space.

3104
01:09:10,309 --> 01:09:10,319
of two key papers in this in this space.
 

3105
01:09:10,319 --> 01:09:15,269
of two key papers in this in this space.
Uh so this is uh from this paper by uh I

3106
01:09:15,269 --> 01:09:15,279
Uh so this is uh from this paper by uh I
 

3107
01:09:15,279 --> 01:09:17,269
Uh so this is uh from this paper by uh I
think William Fedus and I think Noam

3108
01:09:17,269 --> 01:09:17,279
think William Fedus and I think Noam
 

3109
01:09:17,279 --> 01:09:18,789
think William Fedus and I think Noam
Shazir is also an author. This is also a

3110
01:09:18,789 --> 01:09:18,799
Shazir is also an author. This is also a
 

3111
01:09:18,799 --> 01:09:21,510
Shazir is also an author. This is also a
paper that came out of Google.

3112
01:09:21,510 --> 01:09:21,520
paper that came out of Google.
 

3113
01:09:21,520 --> 01:09:23,349
paper that came out of Google.
So this is this idea of a switching

3114
01:09:23,349 --> 01:09:23,359
So this is this idea of a switching
 

3115
01:09:23,359 --> 01:09:25,110
So this is this idea of a switching
transformer, right? Basically you want

3116
01:09:25,110 --> 01:09:25,120
transformer, right? Basically you want
 

3117
01:09:25,120 --> 01:09:28,470
transformer, right? Basically you want
to switch where your tokens are being

3118
01:09:28,470 --> 01:09:28,480
to switch where your tokens are being
 

3119
01:09:28,480 --> 01:09:31,910
to switch where your tokens are being
routed to. So I have a token and you can

3120
01:09:31,910 --> 01:09:31,920
routed to. So I have a token and you can
 

3121
01:09:31,920 --> 01:09:35,910
routed to. So I have a token and you can
tell need to be on who [laughter]

3122
01:09:35,910 --> 01:09:35,920

 

3123
01:09:35,920 --> 01:09:37,590

um I have a token and you can tell kind

3124
01:09:37,590 --> 01:09:37,600
um I have a token and you can tell kind
 

3125
01:09:37,600 --> 01:09:40,309
um I have a token and you can tell kind
of you can date this paper

3126
01:09:40,309 --> 01:09:40,319
of you can date this paper
 

3127
01:09:40,319 --> 01:09:41,829
of you can date this paper
uh in some sense because it's still

3128
01:09:41,829 --> 01:09:41,839
uh in some sense because it's still
 

3129
01:09:41,839 --> 01:09:44,390
uh in some sense because it's still
using this additive uh positional

3130
01:09:44,390 --> 01:09:44,400
using this additive uh positional
 

3131
01:09:44,400 --> 01:09:47,269
using this additive uh positional
encoding

3132
01:09:47,269 --> 01:09:47,279
encoding
 

3133
01:09:47,279 --> 01:09:48,709
encoding
you have a self attention layer you have

3134
01:09:48,709 --> 01:09:48,719
you have a self attention layer you have
 

3135
01:09:48,719 --> 01:09:50,950
you have a self attention layer you have
this normalization layer and then

3136
01:09:50,950 --> 01:09:50,960
this normalization layer and then
 

3137
01:09:50,960 --> 01:09:54,390
this normalization layer and then
instead of having an MLP layer here what

3138
01:09:54,390 --> 01:09:54,400
instead of having an MLP layer here what
 

3139
01:09:54,400 --> 01:09:58,149
instead of having an MLP layer here what
you have is you have many small

3140
01:09:58,149 --> 01:09:58,159
you have is you have many small
 

3141
01:09:58,159 --> 01:10:01,030
you have is you have many small
smaller MLPS which you call each of

3142
01:10:01,030 --> 01:10:01,040
smaller MLPS which you call each of
 

3143
01:10:01,040 --> 01:10:02,470
smaller MLPS which you call each of
which an expert

3144
01:10:02,470 --> 01:10:02,480
which an expert
 

3145
01:10:02,480 --> 01:10:05,270
which an expert
And you have a router network here that

3146
01:10:05,270 --> 01:10:05,280
And you have a router network here that
 

3147
01:10:05,280 --> 01:10:07,830
And you have a router network here that
decides, oh, should I go here or should

3148
01:10:07,830 --> 01:10:07,840
decides, oh, should I go here or should
 

3149
01:10:07,840 --> 01:10:09,669
decides, oh, should I go here or should
I go here or should I go here or should

3150
01:10:09,669 --> 01:10:09,679
I go here or should I go here or should
 

3151
01:10:09,679 --> 01:10:13,590
I go here or should I go here or should
I go here? Okay, so every token, so this

3152
01:10:13,590 --> 01:10:13,600
I go here? Okay, so every token, so this
 

3153
01:10:13,600 --> 01:10:15,990
I go here? Okay, so every token, so this
token gets a different routing compared

3154
01:10:15,990 --> 01:10:16,000
token gets a different routing compared
 

3155
01:10:16,000 --> 01:10:17,669
token gets a different routing compared
to this token which gets a different

3156
01:10:17,669 --> 01:10:17,679
to this token which gets a different
 

3157
01:10:17,679 --> 01:10:20,630
to this token which gets a different
routing. Okay,

3158
01:10:20,630 --> 01:10:20,640
routing. Okay,
 

3159
01:10:20,640 --> 01:10:23,110
routing. Okay,
so there are two key challenges here.

3160
01:10:23,110 --> 01:10:23,120
so there are two key challenges here.
 

3161
01:10:23,120 --> 01:10:24,709
so there are two key challenges here.
One is how do you figure out how to

3162
01:10:24,709 --> 01:10:24,719
One is how do you figure out how to
 

3163
01:10:24,719 --> 01:10:27,030
One is how do you figure out how to
route, right? Like that's the important

3164
01:10:27,030 --> 01:10:27,040
route, right? Like that's the important
 

3165
01:10:27,040 --> 01:10:31,669
route, right? Like that's the important
thing. Um and so this router is also a

3166
01:10:31,669 --> 01:10:31,679
thing. Um and so this router is also a
 

3167
01:10:31,679 --> 01:10:33,270
thing. Um and so this router is also a
trained layer and it's basically a

3168
01:10:33,270 --> 01:10:33,280
trained layer and it's basically a
 

3169
01:10:33,280 --> 01:10:36,390
trained layer and it's basically a
linear layer that produces uh

3170
01:10:36,390 --> 01:10:36,400
linear layer that produces uh
 

3171
01:10:36,400 --> 01:10:40,149
linear layer that produces uh
probabilities on which expert a

3172
01:10:40,149 --> 01:10:40,159
probabilities on which expert a
 

3173
01:10:40,159 --> 01:10:42,229
probabilities on which expert a
particular token should be routed to.

3174
01:10:42,229 --> 01:10:42,239
particular token should be routed to.
 

3175
01:10:42,239 --> 01:10:44,070
particular token should be routed to.
Okay. And this is also trained along

3176
01:10:44,070 --> 01:10:44,080
Okay. And this is also trained along
 

3177
01:10:44,080 --> 01:10:46,630
Okay. And this is also trained along
with everything else.

3178
01:10:46,630 --> 01:10:46,640
with everything else.
 

3179
01:10:46,640 --> 01:10:48,070
with everything else.
One thing that people noticed was

3180
01:10:48,070 --> 01:10:48,080
One thing that people noticed was
 

3181
01:10:48,080 --> 01:10:50,229
One thing that people noticed was
important was at initialization you want

3182
01:10:50,229 --> 01:10:50,239
important was at initialization you want
 

3183
01:10:50,239 --> 01:10:53,510
important was at initialization you want
to have the probabilities for each of

3184
01:10:53,510 --> 01:10:53,520
to have the probabilities for each of
 

3185
01:10:53,520 --> 01:10:57,110
to have the probabilities for each of
the uh experts to be kind of roughly

3186
01:10:57,110 --> 01:10:57,120
the uh experts to be kind of roughly
 

3187
01:10:57,120 --> 01:10:58,790
the uh experts to be kind of roughly
equal. You want to make sure that no one

3188
01:10:58,790 --> 01:10:58,800
equal. You want to make sure that no one
 

3189
01:10:58,800 --> 01:11:01,030
equal. You want to make sure that no one
expert is being chosen too often at

3190
01:11:01,030 --> 01:11:01,040
expert is being chosen too often at
 

3191
01:11:01,040 --> 01:11:02,470
expert is being chosen too often at
initialization. Otherwise, you're not

3192
01:11:02,470 --> 01:11:02,480
initialization. Otherwise, you're not
 

3193
01:11:02,480 --> 01:11:04,149
initialization. Otherwise, you're not
going to you might you might end up with

3194
01:11:04,149 --> 01:11:04,159
going to you might you might end up with
 

3195
01:11:04,159 --> 01:11:07,510
going to you might you might end up with
um bad training.

3196
01:11:07,510 --> 01:11:07,520
um bad training.
 

3197
01:11:07,520 --> 01:11:10,870
um bad training.
So there here this switch transformer um

3198
01:11:10,870 --> 01:11:10,880
So there here this switch transformer um
 

3199
01:11:10,880 --> 01:11:12,709
So there here this switch transformer um
there's a mixture of experts paper that

3200
01:11:12,709 --> 01:11:12,719
there's a mixture of experts paper that
 

3201
01:11:12,719 --> 01:11:14,390
there's a mixture of experts paper that
came before this. I'm skipping that kind

3202
01:11:14,390 --> 01:11:14,400
came before this. I'm skipping that kind
 

3203
01:11:14,400 --> 01:11:17,030
came before this. I'm skipping that kind
of but that said let me just route to

3204
01:11:17,030 --> 01:11:17,040
of but that said let me just route to
 

3205
01:11:17,040 --> 01:11:19,830
of but that said let me just route to
one expert at a time.

3206
01:11:19,830 --> 01:11:19,840
one expert at a time.
 

3207
01:11:19,840 --> 01:11:21,430
one expert at a time.
There's another important thing to see

3208
01:11:21,430 --> 01:11:21,440
There's another important thing to see
 

3209
01:11:21,440 --> 01:11:23,669
There's another important thing to see
here. So for example, if I generated

3210
01:11:23,669 --> 01:11:23,679
here. So for example, if I generated
 

3211
01:11:23,679 --> 01:11:25,990
here. So for example, if I generated
that this should go to expert 2 with

3212
01:11:25,990 --> 01:11:26,000
that this should go to expert 2 with
 

3213
01:11:26,000 --> 01:11:29,590
that this should go to expert 2 with
probability 65

3214
01:11:29,590 --> 01:11:29,600
probability 65
 

3215
01:11:29,600 --> 01:11:33,430
probability 65
my output here I'm multiplying by this

3216
01:11:33,430 --> 01:11:33,440
my output here I'm multiplying by this
 

3217
01:11:33,440 --> 01:11:36,950
my output here I'm multiplying by this
65 that allows gradients to come back to

3218
01:11:36,950 --> 01:11:36,960
65 that allows gradients to come back to
 

3219
01:11:36,960 --> 01:11:38,630
65 that allows gradients to come back to
this router network so that this can

3220
01:11:38,630 --> 01:11:38,640
this router network so that this can
 

3221
01:11:38,640 --> 01:11:42,149
this router network so that this can
actually be trained. Okay, so I'm

3222
01:11:42,149 --> 01:11:42,159
actually be trained. Okay, so I'm
 

3223
01:11:42,159 --> 01:11:43,590
actually be trained. Okay, so I'm
choosing one expert. The switch

3224
01:11:43,590 --> 01:11:43,600
choosing one expert. The switch
 

3225
01:11:43,600 --> 01:11:45,669
choosing one expert. The switch
transformer said choose one expert,

3226
01:11:45,669 --> 01:11:45,679
transformer said choose one expert,
 

3227
01:11:45,679 --> 01:11:48,550
transformer said choose one expert,
multiply whatever that expert says by

3228
01:11:48,550 --> 01:11:48,560
multiply whatever that expert says by
 

3229
01:11:48,560 --> 01:11:50,470
multiply whatever that expert says by
this probability and that's kind of your

3230
01:11:50,470 --> 01:11:50,480
this probability and that's kind of your
 

3231
01:11:50,480 --> 01:11:53,510
this probability and that's kind of your
your output.

3232
01:11:53,510 --> 01:11:53,520
your output.
 

3233
01:11:53,520 --> 01:11:54,870
your output.
Building on this and kind of there's

3234
01:11:54,870 --> 01:11:54,880
Building on this and kind of there's
 

3235
01:11:54,880 --> 01:11:58,070
Building on this and kind of there's
been a lot of work uh there's now this

3236
01:11:58,070 --> 01:11:58,080
been a lot of work uh there's now this
 

3237
01:11:58,080 --> 01:12:00,870
been a lot of work uh there's now this
open mixture of experts model that came

3238
01:12:00,870 --> 01:12:00,880
open mixture of experts model that came
 

3239
01:12:00,880 --> 01:12:03,669
open mixture of experts model that came
out of uh the Allen Institute I think.

3240
01:12:03,669 --> 01:12:03,679
out of uh the Allen Institute I think.
 

3241
01:12:03,679 --> 01:12:07,669
out of uh the Allen Institute I think.
Yeah. Almoe E. And so now there let's

3242
01:12:07,669 --> 01:12:07,679
Yeah. Almoe E. And so now there let's
 

3243
01:12:07,679 --> 01:12:11,030
Yeah. Almoe E. And so now there let's
look at kind of the uh this is a nice

3244
01:12:11,030 --> 01:12:11,040
look at kind of the uh this is a nice
 

3245
01:12:11,040 --> 01:12:13,110
look at kind of the uh this is a nice
figure I think. So here this is kind of

3246
01:12:13,110 --> 01:12:13,120
figure I think. So here this is kind of
 

3247
01:12:13,120 --> 01:12:16,070
figure I think. So here this is kind of
a standard dense language model

3248
01:12:16,070 --> 01:12:16,080
a standard dense language model
 

3249
01:12:16,080 --> 01:12:18,310
a standard dense language model
architecture. So I have an input now you

3250
01:12:18,310 --> 01:12:18,320
architecture. So I have an input now you
 

3251
01:12:18,320 --> 01:12:19,669
architecture. So I have an input now you
can see this is a newer paper because

3252
01:12:19,669 --> 01:12:19,679
can see this is a newer paper because
 

3253
01:12:19,679 --> 01:12:21,590
can see this is a newer paper because
the norm is coming before the multi head

3254
01:12:21,590 --> 01:12:21,600
the norm is coming before the multi head
 

3255
01:12:21,600 --> 01:12:23,669
the norm is coming before the multi head
attention whereas here the norm is

3256
01:12:23,669 --> 01:12:23,679
attention whereas here the norm is
 

3257
01:12:23,679 --> 01:12:27,750
attention whereas here the norm is
coming after the multi head attention.

3258
01:12:27,750 --> 01:12:27,760

 

3259
01:12:27,760 --> 01:12:30,630

I have this multi attention and then I

3260
01:12:30,630 --> 01:12:30,640
I have this multi attention and then I
 

3261
01:12:30,640 --> 01:12:32,390
I have this multi attention and then I
have basically this MLP or this feed

3262
01:12:32,390 --> 01:12:32,400
have basically this MLP or this feed
 

3263
01:12:32,400 --> 01:12:35,510
have basically this MLP or this feed
forward network right here. Here we

3264
01:12:35,510 --> 01:12:35,520
forward network right here. Here we
 

3265
01:12:35,520 --> 01:12:37,350
forward network right here. Here we
instead replace this with this mixture

3266
01:12:37,350 --> 01:12:37,360
instead replace this with this mixture
 

3267
01:12:37,360 --> 01:12:40,709
instead replace this with this mixture
of experts where I have this router.

3268
01:12:40,709 --> 01:12:40,719
of experts where I have this router.
 

3269
01:12:40,719 --> 01:12:43,830
of experts where I have this router.
This router then chooses which experts I

3270
01:12:43,830 --> 01:12:43,840
This router then chooses which experts I
 

3271
01:12:43,840 --> 01:12:47,669
This router then chooses which experts I
want to go to and then goes forward.

3272
01:12:47,669 --> 01:12:47,679
want to go to and then goes forward.
 

3273
01:12:47,679 --> 01:12:49,990
want to go to and then goes forward.
Unlike the switch transformer which

3274
01:12:49,990 --> 01:12:50,000
Unlike the switch transformer which
 

3275
01:12:50,000 --> 01:12:53,189
Unlike the switch transformer which
routed to one expert,

3276
01:12:53,189 --> 01:12:53,199
routed to one expert,
 

3277
01:12:53,199 --> 01:12:54,709
routed to one expert,
here

3278
01:12:54,709 --> 01:12:54,719
here
 

3279
01:12:54,719 --> 01:12:57,910
here
I'm choosing some top K experts and I'm

3280
01:12:57,910 --> 01:12:57,920
I'm choosing some top K experts and I'm
 

3281
01:12:57,920 --> 01:13:00,630
I'm choosing some top K experts and I'm
routing to all of them and then I'm

3282
01:13:00,630 --> 01:13:00,640
routing to all of them and then I'm
 

3283
01:13:00,640 --> 01:13:03,270
routing to all of them and then I'm
combining their inputs in a linear

3284
01:13:03,270 --> 01:13:03,280
combining their inputs in a linear
 

3285
01:13:03,280 --> 01:13:04,790
combining their inputs in a linear
combination

3286
01:13:04,790 --> 01:13:04,800
combination
 

3287
01:13:04,800 --> 01:13:06,470
combination
with the weights given by the

3288
01:13:06,470 --> 01:13:06,480
with the weights given by the
 

3289
01:13:06,480 --> 01:13:08,790
with the weights given by the
probabilities with which each expert was

3290
01:13:08,790 --> 01:13:08,800
probabilities with which each expert was
 

3291
01:13:08,800 --> 01:13:11,750
probabilities with which each expert was
chosen. Okay. So if if I think that I

3292
01:13:11,750 --> 01:13:11,760
chosen. Okay. So if if I think that I
 

3293
01:13:11,760 --> 01:13:13,110
chosen. Okay. So if if I think that I
should go to expert one with high

3294
01:13:13,110 --> 01:13:13,120
should go to expert one with high
 

3295
01:13:13,120 --> 01:13:16,070
should go to expert one with high
probability, I weight the output of that

3296
01:13:16,070 --> 01:13:16,080
probability, I weight the output of that
 

3297
01:13:16,080 --> 01:13:18,709
probability, I weight the output of that
expert with that high probability. But I

3298
01:13:18,709 --> 01:13:18,719
expert with that high probability. But I
 

3299
01:13:18,719 --> 01:13:20,229
expert with that high probability. But I
I also throw in some other experts that

3300
01:13:20,229 --> 01:13:20,239
I also throw in some other experts that
 

3301
01:13:20,239 --> 01:13:22,070
I also throw in some other experts that
I'm choosing with lower probability with

3302
01:13:22,070 --> 01:13:22,080
I'm choosing with lower probability with
 

3303
01:13:22,080 --> 01:13:24,709
I'm choosing with lower probability with
appropriately lower weights.

3304
01:13:24,709 --> 01:13:24,719
appropriately lower weights.
 

3305
01:13:24,719 --> 01:13:26,630
appropriately lower weights.
Make sense? Yeah.

3306
01:13:26,630 --> 01:13:26,640
Make sense? Yeah.
 

3307
01:13:26,640 --> 01:13:28,070
Make sense? Yeah.
>> If you choose to give an expert with

3308
01:13:28,070 --> 01:13:28,080
>> If you choose to give an expert with
 

3309
01:13:28,080 --> 01:13:30,070
>> If you choose to give an expert with
let's say probability P, do you always

3310
01:13:30,070 --> 01:13:30,080
let's say probability P, do you always
 

3311
01:13:30,080 --> 01:13:31,669
let's say probability P, do you always
choose it with probability P or is it

3312
01:13:31,669 --> 01:13:31,679
choose it with probability P or is it
 

3313
01:13:31,679 --> 01:13:33,590
choose it with probability P or is it
like sampling from a Bernoli with

3314
01:13:33,590 --> 01:13:33,600
like sampling from a Bernoli with
 

3315
01:13:33,600 --> 01:13:38,070
like sampling from a Bernoli with
probability P? Um

3316
01:13:38,070 --> 01:13:38,080
probability P? Um
 

3317
01:13:38,080 --> 01:13:41,750
probability P? Um
there are different options. Um this one

3318
01:13:41,750 --> 01:13:41,760
there are different options. Um this one
 

3319
01:13:41,760 --> 01:13:44,950
there are different options. Um this one
I believe just chooses the top K, but

3320
01:13:44,950 --> 01:13:44,960
I believe just chooses the top K, but
 

3321
01:13:44,960 --> 01:13:48,070
I believe just chooses the top K, but
there are many many many different ways

3322
01:13:48,070 --> 01:13:48,080
there are many many many different ways
 

3323
01:13:48,080 --> 01:13:49,669
there are many many many different ways
in which you could do this.

3324
01:13:49,669 --> 01:13:49,679
in which you could do this.
 

3325
01:13:49,679 --> 01:13:51,110
in which you could do this.
>> Okay.

3326
01:13:51,110 --> 01:13:51,120
>> Okay.
 

3327
01:13:51,120 --> 01:13:53,910
>> Okay.
>> Um I I'm I'm sure that there is a

3328
01:13:53,910 --> 01:13:53,920
>> Um I I'm I'm sure that there is a
 

3329
01:13:53,920 --> 01:13:55,669
>> Um I I'm I'm sure that there is a
version that does what you suggested,

3330
01:13:55,669 --> 01:13:55,679
version that does what you suggested,
 

3331
01:13:55,679 --> 01:13:57,030
version that does what you suggested,
but I don't know what it is off the top

3332
01:13:57,030 --> 01:13:57,040
but I don't know what it is off the top
 

3333
01:13:57,040 --> 01:13:58,390
but I don't know what it is off the top
of my head.

3334
01:13:58,390 --> 01:13:58,400
of my head.
 

3335
01:13:58,400 --> 01:14:01,270
of my head.
>> Yes. So is mix mature of experts really

3336
01:14:01,270 --> 01:14:01,280
>> Yes. So is mix mature of experts really
 

3337
01:14:01,280 --> 01:14:03,189
>> Yes. So is mix mature of experts really
like better than a normal key for

3338
01:14:03,189 --> 01:14:03,199
like better than a normal key for
 

3339
01:14:03,199 --> 01:14:05,110
like better than a normal key for
network or is it just to improve like

3340
01:14:05,110 --> 01:14:05,120
network or is it just to improve like
 

3341
01:14:05,120 --> 01:14:07,910
network or is it just to improve like
>> so so the advantage of m mixture of

3342
01:14:07,910 --> 01:14:07,920
>> so so the advantage of m mixture of
 

3343
01:14:07,920 --> 01:14:10,229
>> so so the advantage of m mixture of
experts is now there's huge parts of

3344
01:14:10,229 --> 01:14:10,239
experts is now there's huge parts of
 

3345
01:14:10,239 --> 01:14:11,590
experts is now there's huge parts of
your network that are not being

3346
01:14:11,590 --> 01:14:11,600
your network that are not being
 

3347
01:14:11,600 --> 01:14:14,709
your network that are not being
activated at inference time right and so

3348
01:14:14,709 --> 01:14:14,719
activated at inference time right and so
 

3349
01:14:14,719 --> 01:14:17,189
activated at inference time right and so
from a compute perspective it is

3350
01:14:17,189 --> 01:14:17,199
from a compute perspective it is
 

3351
01:14:17,199 --> 01:14:19,590
from a compute perspective it is
definitely better the challenge is that

3352
01:14:19,590 --> 01:14:19,600
definitely better the challenge is that
 

3353
01:14:19,600 --> 01:14:23,350
definitely better the challenge is that
there these things are trickier to train

3354
01:14:23,350 --> 01:14:23,360
there these things are trickier to train
 

3355
01:14:23,360 --> 01:14:25,110
there these things are trickier to train
um and training these routers and

3356
01:14:25,110 --> 01:14:25,120
um and training these routers and
 

3357
01:14:25,120 --> 01:14:27,430
um and training these routers and
getting all that correct can be can be

3358
01:14:27,430 --> 01:14:27,440
getting all that correct can be can be
 

3359
01:14:27,440 --> 01:14:29,590
getting all that correct can be can be
hard so there's for example example. I'm

3360
01:14:29,590 --> 01:14:29,600
hard so there's for example example. I'm
 

3361
01:14:29,600 --> 01:14:30,709
hard so there's for example example. I'm
not going to have time to go through

3362
01:14:30,709 --> 01:14:30,719
not going to have time to go through
 

3363
01:14:30,719 --> 01:14:32,709
not going to have time to go through
this, but there's kind of many different

3364
01:14:32,709 --> 01:14:32,719
this, but there's kind of many different
 

3365
01:14:32,719 --> 01:14:34,630
this, but there's kind of many different
options of which you can go through of

3366
01:14:34,630 --> 01:14:34,640
options of which you can go through of
 

3367
01:14:34,640 --> 01:14:36,070
options of which you can go through of
how to train this. Yes.

3368
01:14:36,070 --> 01:14:36,080
how to train this. Yes.
 

3369
01:14:36,080 --> 01:14:38,709
how to train this. Yes.
>> Is this like a low direct approximation

3370
01:14:38,709 --> 01:14:38,719
>> Is this like a low direct approximation
 

3371
01:14:38,719 --> 01:14:42,070
>> Is this like a low direct approximation
for like a very large V4 layer?

3372
01:14:42,070 --> 01:14:42,080
for like a very large V4 layer?
 

3373
01:14:42,080 --> 01:14:44,870
for like a very large V4 layer?
>> You could think of it that way. Yeah.

3374
01:14:44,870 --> 01:14:44,880
>> You could think of it that way. Yeah.
 

3375
01:14:44,880 --> 01:14:47,750
>> You could think of it that way. Yeah.
>> Yeah. In some sense. Yes. Are there also

3376
01:14:47,750 --> 01:14:47,760
>> Yeah. In some sense. Yes. Are there also
 

3377
01:14:47,760 --> 01:14:49,030
>> Yeah. In some sense. Yes. Are there also
potential benefits? Kind of like the way

3378
01:14:49,030 --> 01:14:49,040
potential benefits? Kind of like the way
 

3379
01:14:49,040 --> 01:14:50,709
potential benefits? Kind of like the way
we thought of like multi-headed tension

3380
01:14:50,709 --> 01:14:50,719
we thought of like multi-headed tension
 

3381
01:14:50,719 --> 01:14:51,990
we thought of like multi-headed tension
where you're like potentially breaking

3382
01:14:51,990 --> 01:14:52,000
where you're like potentially breaking
 

3383
01:14:52,000 --> 01:14:55,189
where you're like potentially breaking
it up to try to introduce specialization

3384
01:14:55,189 --> 01:14:55,199
it up to try to introduce specialization
 

3385
01:14:55,199 --> 01:14:57,750
it up to try to introduce specialization
or like mixture of experts actually is

3386
01:14:57,750 --> 01:14:57,760
or like mixture of experts actually is
 

3387
01:14:57,760 --> 01:14:59,750
or like mixture of experts actually is
better and not just like a cheaper

3388
01:14:59,750 --> 01:14:59,760
better and not just like a cheaper
 

3389
01:14:59,760 --> 01:15:00,870
better and not just like a cheaper
alternative.

3390
01:15:00,870 --> 01:15:00,880
alternative.
 

3391
01:15:00,880 --> 01:15:03,910
alternative.
>> I think that is a very possible

3392
01:15:03,910 --> 01:15:03,920
>> I think that is a very possible
 

3393
01:15:03,920 --> 01:15:05,830
>> I think that is a very possible
thing. I do not know that we as a

3394
01:15:05,830 --> 01:15:05,840
thing. I do not know that we as a
 

3395
01:15:05,840 --> 01:15:10,070
thing. I do not know that we as a
community know that yet but uh maybe we

3396
01:15:10,070 --> 01:15:10,080
community know that yet but uh maybe we
 

3397
01:15:10,080 --> 01:15:12,709
community know that yet but uh maybe we
do. I think basically 2025 is the year

3398
01:15:12,709 --> 01:15:12,719
do. I think basically 2025 is the year
 

3399
01:15:12,719 --> 01:15:15,430
do. I think basically 2025 is the year
that we are seeing mixture of experts

3400
01:15:15,430 --> 01:15:15,440
that we are seeing mixture of experts
 

3401
01:15:15,440 --> 01:15:19,830
that we are seeing mixture of experts
type models incorporated into the kind

3402
01:15:19,830 --> 01:15:19,840
type models incorporated into the kind
 

3403
01:15:19,840 --> 01:15:21,990
type models incorporated into the kind
of latest releases. Until this year, I

3404
01:15:21,990 --> 01:15:22,000
of latest releases. Until this year, I
 

3405
01:15:22,000 --> 01:15:23,270
of latest releases. Until this year, I
don't think that there were many models

3406
01:15:23,270 --> 01:15:23,280
don't think that there were many models
 

3407
01:15:23,280 --> 01:15:26,070
don't think that there were many models
that incorporated these kind of layers.

3408
01:15:26,070 --> 01:15:26,080
that incorporated these kind of layers.
 

3409
01:15:26,080 --> 01:15:28,070
that incorporated these kind of layers.
And so coming back to this for example

3410
01:15:28,070 --> 01:15:28,080
And so coming back to this for example
 

3411
01:15:28,080 --> 01:15:31,350
And so coming back to this for example
Quen picture.

3412
01:15:31,350 --> 01:15:31,360
Quen picture.
 

3413
01:15:31,360 --> 01:15:34,790
Quen picture.
So what you have here

3414
01:15:34,790 --> 01:15:34,800
So what you have here
 

3415
01:15:34,800 --> 01:15:39,830
So what you have here
is now a hybrid architecture, right?

3416
01:15:39,830 --> 01:15:39,840
is now a hybrid architecture, right?
 

3417
01:15:39,840 --> 01:15:43,669
is now a hybrid architecture, right?
So what this is is this gated delta net

3418
01:15:43,669 --> 01:15:43,679
So what this is is this gated delta net
 

3419
01:15:43,679 --> 01:15:45,030
So what this is is this gated delta net
which I'm not going to have time to talk

3420
01:15:45,030 --> 01:15:45,040
which I'm not going to have time to talk
 

3421
01:15:45,040 --> 01:15:46,630
which I'm not going to have time to talk
about but you have a homework problem

3422
01:15:46,630 --> 01:15:46,640
about but you have a homework problem
 

3423
01:15:46,640 --> 01:15:51,430
about but you have a homework problem
that talks about uh linear attention.

3424
01:15:51,430 --> 01:15:51,440
that talks about uh linear attention.
 

3425
01:15:51,440 --> 01:15:54,310
that talks about uh linear attention.
This is a variation on linear attention.

3426
01:15:54,310 --> 01:15:54,320
This is a variation on linear attention.
 

3427
01:15:54,320 --> 01:15:55,990
This is a variation on linear attention.
It's basically a state space style

3428
01:15:55,990 --> 01:15:56,000
It's basically a state space style
 

3429
01:15:56,000 --> 01:15:59,510
It's basically a state space style
model. Okay. So think of this as a state

3430
01:15:59,510 --> 01:15:59,520
model. Okay. So think of this as a state
 

3431
01:15:59,520 --> 01:16:03,990
model. Okay. So think of this as a state
space model with some tweaks on mamba.

3432
01:16:03,990 --> 01:16:04,000
space model with some tweaks on mamba.
 

3433
01:16:04,000 --> 01:16:05,990
space model with some tweaks on mamba.
It combines ideas from Mamba with ideas

3434
01:16:05,990 --> 01:16:06,000
It combines ideas from Mamba with ideas
 

3435
01:16:06,000 --> 01:16:07,910
It combines ideas from Mamba with ideas
from linear attention. Uh following in

3436
01:16:07,910 --> 01:16:07,920
from linear attention. Uh following in
 

3437
01:16:07,920 --> 01:16:10,070
from linear attention. Uh following in
that same philosophy of work that we

3438
01:16:10,070 --> 01:16:10,080
that same philosophy of work that we
 

3439
01:16:10,080 --> 01:16:11,270
that same philosophy of work that we
talked about before we talked about

3440
01:16:11,270 --> 01:16:11,280
talked about before we talked about
 

3441
01:16:11,280 --> 01:16:13,669
talked about before we talked about
transformers. And so there's three of

3442
01:16:13,669 --> 01:16:13,679
transformers. And so there's three of
 

3443
01:16:13,679 --> 01:16:16,470
transformers. And so there's three of
these. And then the fourth one is a

3444
01:16:16,470 --> 01:16:16,480
these. And then the fourth one is a
 

3445
01:16:16,480 --> 01:16:20,229
these. And then the fourth one is a
classic attention type layer. And both

3446
01:16:20,229 --> 01:16:20,239
classic attention type layer. And both
 

3447
01:16:20,239 --> 01:16:22,630
classic attention type layer. And both
of these instead of having a feed

3448
01:16:22,630 --> 01:16:22,640
of these instead of having a feed
 

3449
01:16:22,640 --> 01:16:24,310
of these instead of having a feed
forward layer here, they're putting a

3450
01:16:24,310 --> 01:16:24,320
forward layer here, they're putting a
 

3451
01:16:24,320 --> 01:16:27,830
forward layer here, they're putting a
mixture of experts layer here. Okay. And

3452
01:16:27,830 --> 01:16:27,840
mixture of experts layer here. Okay. And
 

3453
01:16:27,840 --> 01:16:29,750
mixture of experts layer here. Okay. And
so now if I look at this gated delta

3454
01:16:29,750 --> 01:16:29,760
so now if I look at this gated delta
 

3455
01:16:29,760 --> 01:16:31,830
so now if I look at this gated delta
like what is inside this gated delta

3456
01:16:31,830 --> 01:16:31,840
like what is inside this gated delta
 

3457
01:16:31,840 --> 01:16:35,350
like what is inside this gated delta
net? Well, I have I'm computing my keys

3458
01:16:35,350 --> 01:16:35,360
net? Well, I have I'm computing my keys
 

3459
01:16:35,360 --> 01:16:38,149
net? Well, I have I'm computing my keys
and values. I'm doing some small maybe

3460
01:16:38,149 --> 01:16:38,159
and values. I'm doing some small maybe
 

3461
01:16:38,159 --> 01:16:40,149
and values. I'm doing some small maybe
convolutions here. This is a

3462
01:16:40,149 --> 01:16:40,159
convolutions here. This is a
 

3463
01:16:40,159 --> 01:16:44,149
convolutions here. This is a
normalization layer. Um,

3464
01:16:44,149 --> 01:16:44,159
normalization layer. Um,
 

3465
01:16:44,159 --> 01:16:45,990
normalization layer. Um,
this goes into this. Think of this as a

3466
01:16:45,990 --> 01:16:46,000
this goes into this. Think of this as a
 

3467
01:16:46,000 --> 01:16:48,470
this goes into this. Think of this as a
state space model. And then I'm going

3468
01:16:48,470 --> 01:16:48,480
state space model. And then I'm going
 

3469
01:16:48,480 --> 01:16:52,149
state space model. And then I'm going
out and here what you see is this is my

3470
01:16:52,149 --> 01:16:52,159
out and here what you see is this is my
 

3471
01:16:52,159 --> 01:16:56,470
out and here what you see is this is my
here I would expect maybe to have a MLP,

3472
01:16:56,470 --> 01:16:56,480
here I would expect maybe to have a MLP,
 

3473
01:16:56,480 --> 01:16:58,149
here I would expect maybe to have a MLP,
right? If I had an attention layer

3474
01:16:58,149 --> 01:16:58,159
right? If I had an attention layer
 

3475
01:16:58,159 --> 01:17:00,790
right? If I had an attention layer
followed by an MLP like a a classic

3476
01:17:00,790 --> 01:17:00,800
followed by an MLP like a a classic
 

3477
01:17:00,800 --> 01:17:02,470
followed by an MLP like a a classic
transformer would have an attention

3478
01:17:02,470 --> 01:17:02,480
transformer would have an attention
 

3479
01:17:02,480 --> 01:17:03,910
transformer would have an attention
layer followed by an MLP. If I think

3480
01:17:03,910 --> 01:17:03,920
layer followed by an MLP. If I think
 

3481
01:17:03,920 --> 01:17:07,350
layer followed by an MLP. If I think
about the state space model as replacing

3482
01:17:07,350 --> 01:17:07,360
about the state space model as replacing
 

3483
01:17:07,360 --> 01:17:09,830
about the state space model as replacing
the attention layer I would expect to

3484
01:17:09,830 --> 01:17:09,840
the attention layer I would expect to
 

3485
01:17:09,840 --> 01:17:14,149
the attention layer I would expect to
have here a MLP but I don't have that.

3486
01:17:14,149 --> 01:17:14,159
have here a MLP but I don't have that.
 

3487
01:17:14,159 --> 01:17:16,470
have here a MLP but I don't have that.
Instead what I have is I'm going through

3488
01:17:16,470 --> 01:17:16,480
Instead what I have is I'm going through
 

3489
01:17:16,480 --> 01:17:17,910
Instead what I have is I'm going through
this linear layer followed by a

3490
01:17:17,910 --> 01:17:17,920
this linear layer followed by a
 

3491
01:17:17,920 --> 01:17:19,990
this linear layer followed by a
nonlinearity. I have a gated linear unit

3492
01:17:19,990 --> 01:17:20,000
nonlinearity. I have a gated linear unit
 

3493
01:17:20,000 --> 01:17:24,229
nonlinearity. I have a gated linear unit
here. Okay.

3494
01:17:24,229 --> 01:17:24,239
here. Okay.
 

3495
01:17:24,239 --> 01:17:25,910
here. Okay.
And now if I look at that attention

3496
01:17:25,910 --> 01:17:25,920
And now if I look at that attention
 

3497
01:17:25,920 --> 01:17:28,310
And now if I look at that attention
block up at top again you see I don't I

3498
01:17:28,310 --> 01:17:28,320
block up at top again you see I don't I
 

3499
01:17:28,320 --> 01:17:30,390
block up at top again you see I don't I
have my attention

3500
01:17:30,390 --> 01:17:30,400
have my attention
 

3501
01:17:30,400 --> 01:17:32,470
have my attention
over here

3502
01:17:32,470 --> 01:17:32,480
over here
 

3503
01:17:32,480 --> 01:17:34,790
over here
there's no way I can reach up there but

3504
01:17:34,790 --> 01:17:34,800
there's no way I can reach up there but
 

3505
01:17:34,800 --> 01:17:39,830
there's no way I can reach up there but
over here you see that

3506
01:17:39,830 --> 01:17:39,840
over here you see that
 

3507
01:17:39,840 --> 01:17:41,990
over here you see that
this is again now I'm using a gated

3508
01:17:41,990 --> 01:17:42,000
this is again now I'm using a gated
 

3509
01:17:42,000 --> 01:17:44,870
this is again now I'm using a gated
linear unit instead of having an MLP

3510
01:17:44,870 --> 01:17:44,880
linear unit instead of having an MLP
 

3511
01:17:44,880 --> 01:17:46,470
linear unit instead of having an MLP
which would be here in the traditional

3512
01:17:46,470 --> 01:17:46,480
which would be here in the traditional
 

3513
01:17:46,480 --> 01:17:47,990
which would be here in the traditional
transformer architecture. Does everyone

3514
01:17:47,990 --> 01:17:48,000
transformer architecture. Does everyone
 

3515
01:17:48,000 --> 01:17:49,910
transformer architecture. Does everyone
see that?

3516
01:17:49,910 --> 01:17:49,920
see that?
 

3517
01:17:49,920 --> 01:17:52,390
see that?
Okay. And this is just basically scaled

3518
01:17:52,390 --> 01:17:52,400
Okay. And this is just basically scaled
 

3519
01:17:52,400 --> 01:17:54,390
Okay. And this is just basically scaled
dotproduct tension. The other thing I

3520
01:17:54,390 --> 01:17:54,400
dotproduct tension. The other thing I
 

3521
01:17:54,400 --> 01:17:55,750
dotproduct tension. The other thing I
want to bring to your attention here is

3522
01:17:55,750 --> 01:17:55,760
want to bring to your attention here is
 

3523
01:17:55,760 --> 01:17:58,229
want to bring to your attention here is
these this is using now a position

3524
01:17:58,229 --> 01:17:58,239
these this is using now a position
 

3525
01:17:58,239 --> 01:18:01,350
these this is using now a position
embedding called partial rope. What it

3526
01:18:01,350 --> 01:18:01,360
embedding called partial rope. What it
 

3527
01:18:01,360 --> 01:18:05,110
embedding called partial rope. What it
is doing is it's saying that of my I

3528
01:18:05,110 --> 01:18:05,120
is doing is it's saying that of my I
 

3529
01:18:05,120 --> 01:18:07,990
is doing is it's saying that of my I
have a query vector of some size

3530
01:18:07,990 --> 01:18:08,000
have a query vector of some size
 

3531
01:18:08,000 --> 01:18:10,870
have a query vector of some size
the first 25%

3532
01:18:10,870 --> 01:18:10,880
the first 25%
 

3533
01:18:10,880 --> 01:18:13,430
the first 25%
of that vector I'm going to do rope on

3534
01:18:13,430 --> 01:18:13,440
of that vector I'm going to do rope on
 

3535
01:18:13,440 --> 01:18:16,310
of that vector I'm going to do rope on
and the rest is just nope.

3536
01:18:16,310 --> 01:18:16,320
and the rest is just nope.
 

3537
01:18:16,320 --> 01:18:18,310
and the rest is just nope.
So I'm doing a mix of these things.

3538
01:18:18,310 --> 01:18:18,320
So I'm doing a mix of these things.
 

3539
01:18:18,320 --> 01:18:20,630
So I'm doing a mix of these things.
Okay. And somehow this is what they see

3540
01:18:20,630 --> 01:18:20,640
Okay. And somehow this is what they see
 

3541
01:18:20,640 --> 01:18:22,470
Okay. And somehow this is what they see
worked best. So here they're using

3542
01:18:22,470 --> 01:18:22,480
worked best. So here they're using
 

3543
01:18:22,480 --> 01:18:25,669
worked best. So here they're using
partial rope. Okay. So there's it's yet

3544
01:18:25,669 --> 01:18:25,679
partial rope. Okay. So there's it's yet
 

3545
01:18:25,679 --> 01:18:29,990
partial rope. Okay. So there's it's yet
another variation on um

3546
01:18:29,990 --> 01:18:30,000
another variation on um
 

3547
01:18:30,000 --> 01:18:33,189
another variation on um
on this um

3548
01:18:33,189 --> 01:18:33,199
on this um
 

3549
01:18:33,199 --> 01:18:34,790
on this um
I guess I don't have enough time to go

3550
01:18:34,790 --> 01:18:34,800
I guess I don't have enough time to go
 

3551
01:18:34,800 --> 01:18:36,070
I guess I don't have enough time to go
into the delta rule to tell you but

3552
01:18:36,070 --> 01:18:36,080
into the delta rule to tell you but
 

3553
01:18:36,080 --> 01:18:37,990
into the delta rule to tell you but
these are this is basically like it's

3554
01:18:37,990 --> 01:18:38,000
these are this is basically like it's
 

3555
01:18:38,000 --> 01:18:39,750
these are this is basically like it's
like a momentum like memory parameter

3556
01:18:39,750 --> 01:18:39,760
like a momentum like memory parameter
 

3557
01:18:39,760 --> 01:18:41,189
like a momentum like memory parameter
alpha and beta that's telling you how

3558
01:18:41,189 --> 01:18:41,199
alpha and beta that's telling you how
 

3559
01:18:41,199 --> 01:18:43,030
alpha and beta that's telling you how
much I want to care about the past.

3560
01:18:43,030 --> 01:18:43,040
much I want to care about the past.
 

3561
01:18:43,040 --> 01:18:44,550
much I want to care about the past.
Think about it as a recurrent network

3562
01:18:44,550 --> 01:18:44,560
Think about it as a recurrent network
 

3563
01:18:44,560 --> 01:18:46,790
Think about it as a recurrent network
that's or a state that's being updated

3564
01:18:46,790 --> 01:18:46,800
that's or a state that's being updated
 

3565
01:18:46,800 --> 01:18:48,870
that's or a state that's being updated
constantly.

3566
01:18:48,870 --> 01:18:48,880
constantly.
 

3567
01:18:48,880 --> 01:18:50,709
constantly.
And then I definitely don't have time to

3568
01:18:50,709 --> 01:18:50,719
And then I definitely don't have time to
 

3569
01:18:50,719 --> 01:18:53,189
And then I definitely don't have time to
go through these but

3570
01:18:53,189 --> 01:18:53,199
go through these but
 

3571
01:18:53,199 --> 01:18:57,110
go through these but
these are basically the a series of

3572
01:18:57,110 --> 01:18:57,120
these are basically the a series of
 

3573
01:18:57,120 --> 01:18:59,590
these are basically the a series of
recent models that are coming out this

3574
01:18:59,590 --> 01:18:59,600
recent models that are coming out this
 

3575
01:18:59,600 --> 01:19:02,709
recent models that are coming out this
year. So we can just pick a couple. So

3576
01:19:02,709 --> 01:19:02,719
year. So we can just pick a couple. So
 

3577
01:19:02,719 --> 01:19:05,830
year. So we can just pick a couple. So
for example, if you look at llama 3.2 uh

3578
01:19:05,830 --> 01:19:05,840
for example, if you look at llama 3.2 uh
 

3579
01:19:05,840 --> 01:19:08,470
for example, if you look at llama 3.2 uh
1 billion parameters again you're seeing

3580
01:19:08,470 --> 01:19:08,480
1 billion parameters again you're seeing
 

3581
01:19:08,480 --> 01:19:11,590
1 billion parameters again you're seeing
rope, you're seeing the RMS norm. So

3582
01:19:11,590 --> 01:19:11,600
rope, you're seeing the RMS norm. So
 

3583
01:19:11,600 --> 01:19:16,630
rope, you're seeing the RMS norm. So
this is kind of a little bit uh standard

3584
01:19:16,630 --> 01:19:16,640
this is kind of a little bit uh standard
 

3585
01:19:16,640 --> 01:19:18,470
this is kind of a little bit uh standard
here though. You're seeing that in this

3586
01:19:18,470 --> 01:19:18,480
here though. You're seeing that in this
 

3587
01:19:18,480 --> 01:19:21,430
here though. You're seeing that in this
feed forward layer again you're seeing

3588
01:19:21,430 --> 01:19:21,440
feed forward layer again you're seeing
 

3589
01:19:21,440 --> 01:19:25,189
feed forward layer again you're seeing
this silo activation which is again a um

3590
01:19:25,189 --> 01:19:25,199
this silo activation which is again a um
 

3591
01:19:25,199 --> 01:19:28,550
this silo activation which is again a um
variation on the swigloo where you're

3592
01:19:28,550 --> 01:19:28,560
variation on the swigloo where you're
 

3593
01:19:28,560 --> 01:19:33,910
variation on the swigloo where you're
pegging beta to be exactly equal to one.

3594
01:19:33,910 --> 01:19:33,920

 

3595
01:19:33,920 --> 01:19:36,550

Uh what's another example to show you?

3596
01:19:36,550 --> 01:19:36,560
Uh what's another example to show you?
 

3597
01:19:36,560 --> 01:19:38,310
Uh what's another example to show you?
Here you're using rope. Here you're

3598
01:19:38,310 --> 01:19:38,320
Here you're using rope. Here you're
 

3599
01:19:38,320 --> 01:19:39,910
Here you're using rope. Here you're
using

3600
01:19:39,910 --> 01:19:39,920
using
 

3601
01:19:39,920 --> 01:19:41,910
using
you're using a combination of nope and

3602
01:19:41,910 --> 01:19:41,920
you're using a combination of nope and
 

3603
01:19:41,920 --> 01:19:43,669
you're using a combination of nope and
rope. Some layers you're using nope.

3604
01:19:43,669 --> 01:19:43,679
rope. Some layers you're using nope.
 

3605
01:19:43,679 --> 01:19:47,750
rope. Some layers you're using nope.
Some layers you're using rope.

3606
01:19:47,750 --> 01:19:47,760

 

3607
01:19:47,760 --> 01:19:53,189

This one is so this quen architecture uh

3608
01:19:53,189 --> 01:19:53,199
This one is so this quen architecture uh
 

3609
01:19:53,199 --> 01:19:55,270
This one is so this quen architecture uh
these larger trillion parameter models

3610
01:19:55,270 --> 01:19:55,280
these larger trillion parameter models
 

3611
01:19:55,280 --> 01:19:57,189
these larger trillion parameter models
or multi-billion parameter models. I

3612
01:19:57,189 --> 01:19:57,199
or multi-billion parameter models. I
 

3613
01:19:57,199 --> 01:20:01,669
or multi-billion parameter models. I
don't know why this isn't moving but

3614
01:20:01,669 --> 01:20:01,679

 

3615
01:20:01,679 --> 01:20:03,590

yeah

3616
01:20:03,590 --> 01:20:03,600
yeah
 

3617
01:20:03,600 --> 01:20:05,590
yeah
okay here I don't know if you can read

3618
01:20:05,590 --> 01:20:05,600
okay here I don't know if you can read
 

3619
01:20:05,600 --> 01:20:07,189
okay here I don't know if you can read
this but here now these this is now a

3620
01:20:07,189 --> 01:20:07,199
this but here now these this is now a
 

3621
01:20:07,199 --> 01:20:08,709
this but here now these this is now a
mixture of experts layer in both of

3622
01:20:08,709 --> 01:20:08,719
mixture of experts layer in both of
 

3623
01:20:08,719 --> 01:20:11,910
mixture of experts layer in both of
these the Kimmy and the Quen models.

3624
01:20:11,910 --> 01:20:11,920
these the Kimmy and the Quen models.
 

3625
01:20:11,920 --> 01:20:13,669
these the Kimmy and the Quen models.
So here you have a router. In both of

3626
01:20:13,669 --> 01:20:13,679
So here you have a router. In both of
 

3627
01:20:13,679 --> 01:20:16,470
So here you have a router. In both of
these cases, this is using multi head

3628
01:20:16,470 --> 01:20:16,480
these cases, this is using multi head
 

3629
01:20:16,480 --> 01:20:18,310
these cases, this is using multi head
latent attention which we haven't talked

3630
01:20:18,310 --> 01:20:18,320
latent attention which we haven't talked
 

3631
01:20:18,320 --> 01:20:20,149
latent attention which we haven't talked
about but maybe we will talk about. It's

3632
01:20:20,149 --> 01:20:20,159
about but maybe we will talk about. It's
 

3633
01:20:20,159 --> 01:20:23,830
about but maybe we will talk about. It's
another modification on uh multi head

3634
01:20:23,830 --> 01:20:23,840
another modification on uh multi head
 

3635
01:20:23,840 --> 01:20:25,270
another modification on uh multi head
attention where you're doing some smart

3636
01:20:25,270 --> 01:20:25,280
attention where you're doing some smart
 

3637
01:20:25,280 --> 01:20:28,149
attention where you're doing some smart
caching and you're not uh to make things

3638
01:20:28,149 --> 01:20:28,159
caching and you're not uh to make things
 

3639
01:20:28,159 --> 01:20:30,950
caching and you're not uh to make things
more efficient. But as you can see

3640
01:20:30,950 --> 01:20:30,960
more efficient. But as you can see
 

3641
01:20:30,960 --> 01:20:33,350
more efficient. But as you can see
there's no like specific there's no one

3642
01:20:33,350 --> 01:20:33,360
there's no like specific there's no one
 

3643
01:20:33,360 --> 01:20:34,870
there's no like specific there's no one
right way, right? There's so many

3644
01:20:34,870 --> 01:20:34,880
right way, right? There's so many
 

3645
01:20:34,880 --> 01:20:37,750
right way, right? There's so many
different choices and this parade or

3646
01:20:37,750 --> 01:20:37,760
different choices and this parade or
 

3647
01:20:37,760 --> 01:20:39,590
different choices and this parade or
frontier of what the models are is still

3648
01:20:39,590 --> 01:20:39,600
frontier of what the models are is still
 

3649
01:20:39,600 --> 01:20:41,910
frontier of what the models are is still
being investigated, understood, but at

3650
01:20:41,910 --> 01:20:41,920
being investigated, understood, but at
 

3651
01:20:41,920 --> 01:20:43,830
being investigated, understood, but at
least now when you look at this picture,

3652
01:20:43,830 --> 01:20:43,840
least now when you look at this picture,
 

3653
01:20:43,840 --> 01:20:46,709
least now when you look at this picture,
what I'm hoping is that you can figure

3654
01:20:46,709 --> 01:20:46,719
what I'm hoping is that you can figure
 

3655
01:20:46,719 --> 01:20:49,189
what I'm hoping is that you can figure
out what each of these particular things

3656
01:20:49,189 --> 01:20:49,199
out what each of these particular things
 

3657
01:20:49,199 --> 01:20:51,189
out what each of these particular things
is or if you if it's not something that

3658
01:20:51,189 --> 01:20:51,199
is or if you if it's not something that
 

3659
01:20:51,199 --> 01:20:53,830
is or if you if it's not something that
you've already seen, it's a variation on

3660
01:20:53,830 --> 01:20:53,840
you've already seen, it's a variation on
 

3661
01:20:53,840 --> 01:20:56,870
you've already seen, it's a variation on
something you have seen and it is not

3662
01:20:56,870 --> 01:20:56,880
something you have seen and it is not
 

3663
01:20:56,880 --> 01:20:59,350
something you have seen and it is not
impenetrable. Right? That's the goal of

3664
01:20:59,350 --> 01:20:59,360
impenetrable. Right? That's the goal of
 

3665
01:20:59,360 --> 01:21:01,270
impenetrable. Right? That's the goal of
what we're trying to do is like whatever

3666
01:21:01,270 --> 01:21:01,280
what we're trying to do is like whatever
 

3667
01:21:01,280 --> 01:21:03,110
what we're trying to do is like whatever
is the most recent stuff. I don't want

3668
01:21:03,110 --> 01:21:03,120
is the most recent stuff. I don't want
 

3669
01:21:03,120 --> 01:21:05,030
is the most recent stuff. I don't want
anyone snowing you with jargon, right?

3670
01:21:05,030 --> 01:21:05,040
anyone snowing you with jargon, right?
 

3671
01:21:05,040 --> 01:21:07,750
anyone snowing you with jargon, right?
Like this is all stuff that is

3672
01:21:07,750 --> 01:21:07,760
Like this is all stuff that is
 

3673
01:21:07,760 --> 01:21:09,750
Like this is all stuff that is
understandable.

3674
01:21:09,750 --> 01:21:09,760
understandable.
 

3675
01:21:09,760 --> 01:21:11,750
understandable.
Okay, so I'll stop there. Sorry, I'm a

3676
01:21:11,750 --> 01:21:11,760
Okay, so I'll stop there. Sorry, I'm a
 

3677
01:21:11,760 --> 01:21:17,669
Okay, so I'll stop there. Sorry, I'm a
few minutes over.

3678
01:21:17,669 --> 01:21:17,679

 

3679
01:21:17,679 --> 01:21:20,070

>> Just want to double check the experts

3680
01:21:20,070 --> 01:21:20,080
>> Just want to double check the experts
 

3681
01:21:20,080 --> 01:21:21,910
>> Just want to double check the experts
are they are they trained individually

3682
01:21:21,910 --> 01:21:21,920
are they are they trained individually
 

3683
01:21:21,920 --> 01:21:23,590
are they are they trained individually
for the downstream task and then we just

3684
01:21:23,590 --> 01:21:23,600
for the downstream task and then we just
 

3685
01:21:23,600 --> 01:21:26,550
for the downstream task and then we just
choose some of these.

3686
01:21:26,550 --> 01:21:26,560
choose some of these.
 

3687
01:21:26,560 --> 01:21:28,630
choose some of these.
Are the experts trained individually for

3688
01:21:28,630 --> 01:21:28,640
Are the experts trained individually for
 

3689
01:21:28,640 --> 01:21:32,470
Are the experts trained individually for
the downstream task? Um, no. They're

3690
01:21:32,470 --> 01:21:32,480
the downstream task? Um, no. They're
 

3691
01:21:32,480 --> 01:21:35,640
the downstream task? Um, no. They're
just trained.

